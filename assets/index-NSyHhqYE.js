const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/web-8KMa2qRF.js","assets/base-CrungHgE.js","assets/native-B0PHGN88.js"])))=>i.map(i=>d[i]);
var qy=a=>{throw TypeError(a)};var WA=(a,e,t)=>e.has(a)||qy("Cannot "+t);var Pn=(a,e,t)=>(WA(a,e,"read from private field"),t?t.call(a):e.get(a)),Ci=(a,e,t)=>e.has(a)?qy("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t),Ia=(a,e,t,n)=>(WA(a,e,"write to private field"),n?n.call(a,t):e.set(a,t),t),Si=(a,e,t)=>(WA(a,e,"access private method"),t);var Yy=(a,e,t,n)=>({set _(i){Ia(a,e,i,t)},get _(){return Pn(a,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function uS(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var $A={exports:{}},Tl={};var Xy;function ZE(){if(Xy)return Tl;Xy=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,i,s){var l=null;if(s!==void 0&&(l=""+s),i.key!==void 0&&(l=""+i.key),"key"in i){s={};for(var c in i)c!=="key"&&(s[c]=i[c])}else s=i;return i=s.ref,{$$typeof:a,type:n,key:l,ref:i!==void 0?i:null,props:s}}return Tl.Fragment=e,Tl.jsx=t,Tl.jsxs=t,Tl}var Wy;function ex(){return Wy||(Wy=1,$A.exports=ZE()),$A.exports}var T=ex(),JA={exports:{}},Pt={};var $y;function tx(){if($y)return Pt;$y=1;var a=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),p=Symbol.iterator;function b(z){return z===null||typeof z!="object"?null:(z=p&&z[p]||z["@@iterator"],typeof z=="function"?z:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,k={};function E(z,H,j){this.props=z,this.context=H,this.refs=k,this.updater=j||w}E.prototype.isReactComponent={},E.prototype.setState=function(z,H){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,H,"setState")},E.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function I(){}I.prototype=E.prototype;function P(z,H,j){this.props=z,this.context=H,this.refs=k,this.updater=j||w}var R=P.prototype=new I;R.constructor=P,S(R,E.prototype),R.isPureReactComponent=!0;var D=Array.isArray;function N(){}var _={H:null,A:null,T:null,S:null},K=Object.prototype.hasOwnProperty;function G(z,H,j){var le=j.ref;return{$$typeof:a,type:z,key:H,ref:le!==void 0?le:null,props:j}}function L(z,H){return G(z.type,H,z.props)}function O(z){return typeof z=="object"&&z!==null&&z.$$typeof===a}function q(z){var H={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(j){return H[j]})}var $=/\/+/g;function Q(z,H){return typeof z=="object"&&z!==null&&z.key!=null?q(""+z.key):H.toString(36)}function Z(z){switch(z.status){case"fulfilled":return z.value;case"rejected":throw z.reason;default:switch(typeof z.status=="string"?z.then(N,N):(z.status="pending",z.then(function(H){z.status==="pending"&&(z.status="fulfilled",z.value=H)},function(H){z.status==="pending"&&(z.status="rejected",z.reason=H)})),z.status){case"fulfilled":return z.value;case"rejected":throw z.reason}}throw z}function F(z,H,j,le,te){var oe=typeof z;(oe==="undefined"||oe==="boolean")&&(z=null);var ce=!1;if(z===null)ce=!0;else switch(oe){case"bigint":case"string":case"number":ce=!0;break;case"object":switch(z.$$typeof){case a:case e:ce=!0;break;case A:return ce=z._init,F(ce(z._payload),H,j,le,te)}}if(ce)return te=te(z),ce=le===""?"."+Q(z,0):le,D(te)?(j="",ce!=null&&(j=ce.replace($,"$&/")+"/"),F(te,H,j,"",function(Le){return Le})):te!=null&&(O(te)&&(te=L(te,j+(te.key==null||z&&z.key===te.key?"":(""+te.key).replace($,"$&/")+"/")+ce)),H.push(te)),1;ce=0;var Ge=le===""?".":le+":";if(D(z))for(var ae=0;ae<z.length;ae++)le=z[ae],oe=Ge+Q(le,ae),ce+=F(le,H,j,oe,te);else if(ae=b(z),typeof ae=="function")for(z=ae.call(z),ae=0;!(le=z.next()).done;)le=le.value,oe=Ge+Q(le,ae++),ce+=F(le,H,j,oe,te);else if(oe==="object"){if(typeof z.then=="function")return F(Z(z),H,j,le,te);throw H=String(z),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return ce}function U(z,H,j){if(z==null)return z;var le=[],te=0;return F(z,le,"","",function(oe){return H.call(j,oe,te++)}),le}function Y(z){if(z._status===-1){var H=z._result;H=H(),H.then(function(j){(z._status===0||z._status===-1)&&(z._status=1,z._result=j)},function(j){(z._status===0||z._status===-1)&&(z._status=2,z._result=j)}),z._status===-1&&(z._status=0,z._result=H)}if(z._status===1)return z._result.default;throw z._result}var ge=typeof reportError=="function"?reportError:function(z){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof z=="object"&&z!==null&&typeof z.message=="string"?String(z.message):String(z),error:z});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",z);return}console.error(z)},me={map:U,forEach:function(z,H,j){U(z,function(){H.apply(this,arguments)},j)},count:function(z){var H=0;return U(z,function(){H++}),H},toArray:function(z){return U(z,function(H){return H})||[]},only:function(z){if(!O(z))throw Error("React.Children.only expected to receive a single React element child.");return z}};return Pt.Activity=f,Pt.Children=me,Pt.Component=E,Pt.Fragment=t,Pt.Profiler=i,Pt.PureComponent=P,Pt.StrictMode=n,Pt.Suspense=h,Pt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=_,Pt.__COMPILER_RUNTIME={__proto__:null,c:function(z){return _.H.useMemoCache(z)}},Pt.cache=function(z){return function(){return z.apply(null,arguments)}},Pt.cacheSignal=function(){return null},Pt.cloneElement=function(z,H,j){if(z==null)throw Error("The argument must be a React element, but you passed "+z+".");var le=S({},z.props),te=z.key;if(H!=null)for(oe in H.key!==void 0&&(te=""+H.key),H)!K.call(H,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&H.ref===void 0||(le[oe]=H[oe]);var oe=arguments.length-2;if(oe===1)le.children=j;else if(1<oe){for(var ce=Array(oe),Ge=0;Ge<oe;Ge++)ce[Ge]=arguments[Ge+2];le.children=ce}return G(z.type,te,le)},Pt.createContext=function(z){return z={$$typeof:l,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null},z.Provider=z,z.Consumer={$$typeof:s,_context:z},z},Pt.createElement=function(z,H,j){var le,te={},oe=null;if(H!=null)for(le in H.key!==void 0&&(oe=""+H.key),H)K.call(H,le)&&le!=="key"&&le!=="__self"&&le!=="__source"&&(te[le]=H[le]);var ce=arguments.length-2;if(ce===1)te.children=j;else if(1<ce){for(var Ge=Array(ce),ae=0;ae<ce;ae++)Ge[ae]=arguments[ae+2];te.children=Ge}if(z&&z.defaultProps)for(le in ce=z.defaultProps,ce)te[le]===void 0&&(te[le]=ce[le]);return G(z,oe,te)},Pt.createRef=function(){return{current:null}},Pt.forwardRef=function(z){return{$$typeof:c,render:z}},Pt.isValidElement=O,Pt.lazy=function(z){return{$$typeof:A,_payload:{_status:-1,_result:z},_init:Y}},Pt.memo=function(z,H){return{$$typeof:d,type:z,compare:H===void 0?null:H}},Pt.startTransition=function(z){var H=_.T,j={};_.T=j;try{var le=z(),te=_.S;te!==null&&te(j,le),typeof le=="object"&&le!==null&&typeof le.then=="function"&&le.then(N,ge)}catch(oe){ge(oe)}finally{H!==null&&j.types!==null&&(H.types=j.types),_.T=H}},Pt.unstable_useCacheRefresh=function(){return _.H.useCacheRefresh()},Pt.use=function(z){return _.H.use(z)},Pt.useActionState=function(z,H,j){return _.H.useActionState(z,H,j)},Pt.useCallback=function(z,H){return _.H.useCallback(z,H)},Pt.useContext=function(z){return _.H.useContext(z)},Pt.useDebugValue=function(){},Pt.useDeferredValue=function(z,H){return _.H.useDeferredValue(z,H)},Pt.useEffect=function(z,H){return _.H.useEffect(z,H)},Pt.useEffectEvent=function(z){return _.H.useEffectEvent(z)},Pt.useId=function(){return _.H.useId()},Pt.useImperativeHandle=function(z,H,j){return _.H.useImperativeHandle(z,H,j)},Pt.useInsertionEffect=function(z,H){return _.H.useInsertionEffect(z,H)},Pt.useLayoutEffect=function(z,H){return _.H.useLayoutEffect(z,H)},Pt.useMemo=function(z,H){return _.H.useMemo(z,H)},Pt.useOptimistic=function(z,H){return _.H.useOptimistic(z,H)},Pt.useReducer=function(z,H,j){return _.H.useReducer(z,H,j)},Pt.useRef=function(z){return _.H.useRef(z)},Pt.useState=function(z){return _.H.useState(z)},Pt.useSyncExternalStore=function(z,H,j){return _.H.useSyncExternalStore(z,H,j)},Pt.useTransition=function(){return _.H.useTransition()},Pt.version="19.2.3",Pt}var Jy;function Cf(){return Jy||(Jy=1,JA.exports=tx()),JA.exports}var x=Cf();const ti=uS(x);var ZA={exports:{}},kl={},eg={exports:{}},tg={};var Zy;function nx(){return Zy||(Zy=1,(function(a){function e(F,U){var Y=F.length;F.push(U);e:for(;0<Y;){var ge=Y-1>>>1,me=F[ge];if(0<i(me,U))F[ge]=U,F[Y]=me,Y=ge;else break e}}function t(F){return F.length===0?null:F[0]}function n(F){if(F.length===0)return null;var U=F[0],Y=F.pop();if(Y!==U){F[0]=Y;e:for(var ge=0,me=F.length,z=me>>>1;ge<z;){var H=2*(ge+1)-1,j=F[H],le=H+1,te=F[le];if(0>i(j,Y))le<me&&0>i(te,j)?(F[ge]=te,F[le]=Y,ge=le):(F[ge]=j,F[H]=Y,ge=H);else if(le<me&&0>i(te,Y))F[ge]=te,F[le]=Y,ge=le;else break e}}return U}function i(F,U){var Y=F.sortIndex-U.sortIndex;return Y!==0?Y:F.id-U.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;a.unstable_now=function(){return s.now()}}else{var l=Date,c=l.now();a.unstable_now=function(){return l.now()-c}}var h=[],d=[],A=1,f=null,p=3,b=!1,w=!1,S=!1,k=!1,E=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function R(F){for(var U=t(d);U!==null;){if(U.callback===null)n(d);else if(U.startTime<=F)n(d),U.sortIndex=U.expirationTime,e(h,U);else break;U=t(d)}}function D(F){if(S=!1,R(F),!w)if(t(h)!==null)w=!0,N||(N=!0,q());else{var U=t(d);U!==null&&Z(D,U.startTime-F)}}var N=!1,_=-1,K=5,G=-1;function L(){return k?!0:!(a.unstable_now()-G<K)}function O(){if(k=!1,N){var F=a.unstable_now();G=F;var U=!0;try{e:{w=!1,S&&(S=!1,I(_),_=-1),b=!0;var Y=p;try{t:{for(R(F),f=t(h);f!==null&&!(f.expirationTime>F&&L());){var ge=f.callback;if(typeof ge=="function"){f.callback=null,p=f.priorityLevel;var me=ge(f.expirationTime<=F);if(F=a.unstable_now(),typeof me=="function"){f.callback=me,R(F),U=!0;break t}f===t(h)&&n(h),R(F)}else n(h);f=t(h)}if(f!==null)U=!0;else{var z=t(d);z!==null&&Z(D,z.startTime-F),U=!1}}break e}finally{f=null,p=Y,b=!1}U=void 0}}finally{U?q():N=!1}}}var q;if(typeof P=="function")q=function(){P(O)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,Q=$.port2;$.port1.onmessage=O,q=function(){Q.postMessage(null)}}else q=function(){E(O,0)};function Z(F,U){_=E(function(){F(a.unstable_now())},U)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(F){F.callback=null},a.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<F?Math.floor(1e3/F):5},a.unstable_getCurrentPriorityLevel=function(){return p},a.unstable_next=function(F){switch(p){case 1:case 2:case 3:var U=3;break;default:U=p}var Y=p;p=U;try{return F()}finally{p=Y}},a.unstable_requestPaint=function(){k=!0},a.unstable_runWithPriority=function(F,U){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var Y=p;p=F;try{return U()}finally{p=Y}},a.unstable_scheduleCallback=function(F,U,Y){var ge=a.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?ge+Y:ge):Y=ge,F){case 1:var me=-1;break;case 2:me=250;break;case 5:me=1073741823;break;case 4:me=1e4;break;default:me=5e3}return me=Y+me,F={id:A++,callback:U,priorityLevel:F,startTime:Y,expirationTime:me,sortIndex:-1},Y>ge?(F.sortIndex=Y,e(d,F),t(h)===null&&F===t(d)&&(S?(I(_),_=-1):S=!0,Z(D,Y-ge))):(F.sortIndex=me,e(h,F),w||b||(w=!0,N||(N=!0,q()))),F},a.unstable_shouldYield=L,a.unstable_wrapCallback=function(F){var U=p;return function(){var Y=p;p=U;try{return F.apply(this,arguments)}finally{p=Y}}}})(tg)),tg}var eb;function ax(){return eb||(eb=1,eg.exports=nx()),eg.exports}var ng={exports:{}},fa={};var tb;function ix(){if(tb)return fa;tb=1;var a=Cf();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var A=2;A<arguments.length;A++)d+="&args[]="+encodeURIComponent(arguments[A])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(h,d,A){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:f==null?null:""+f,children:h,containerInfo:d,implementation:A}}var l=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return fa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,fa.createPortal=function(h,d){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return s(h,d,null,A)},fa.flushSync=function(h){var d=l.T,A=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=d,n.p=A,n.d.f()}},fa.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},fa.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},fa.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var A=d.as,f=c(A,d.crossOrigin),p=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;A==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:f,integrity:p,fetchPriority:b}):A==="script"&&n.d.X(h,{crossOrigin:f,integrity:p,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},fa.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var A=c(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:A,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},fa.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var A=d.as,f=c(A,d.crossOrigin);n.d.L(h,A,{crossOrigin:f,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},fa.preloadModule=function(h,d){if(typeof h=="string")if(d){var A=c(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:A,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},fa.requestFormReset=function(h){n.d.r(h)},fa.unstable_batchedUpdates=function(h,d){return h(d)},fa.useFormState=function(h,d,A){return l.H.useFormState(h,d,A)},fa.useFormStatus=function(){return l.H.useHostTransitionStatus()},fa.version="19.2.3",fa}var nb;function rx(){if(nb)return ng.exports;nb=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),ng.exports=ix(),ng.exports}var ab;function sx(){if(ab)return kl;ab=1;var a=ax(),e=Cf(),t=rx();function n(r){var o="https://react.dev/errors/"+r;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function s(r){var o=r,u=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,(o.flags&4098)!==0&&(u=o.return),r=o.return;while(r)}return o.tag===3?u:null}function l(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function c(r){if(r.tag===31){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function h(r){if(s(r)!==r)throw Error(n(188))}function d(r){var o=r.alternate;if(!o){if(o=s(r),o===null)throw Error(n(188));return o!==r?null:r}for(var u=r,g=o;;){var y=u.return;if(y===null)break;var C=y.alternate;if(C===null){if(g=y.return,g!==null){u=g;continue}break}if(y.child===C.child){for(C=y.child;C;){if(C===u)return h(y),r;if(C===g)return h(y),o;C=C.sibling}throw Error(n(188))}if(u.return!==g.return)u=y,g=C;else{for(var M=!1,B=y.child;B;){if(B===u){M=!0,u=y,g=C;break}if(B===g){M=!0,g=y,u=C;break}B=B.sibling}if(!M){for(B=C.child;B;){if(B===u){M=!0,u=C,g=y;break}if(B===g){M=!0,g=C,u=y;break}B=B.sibling}if(!M)throw Error(n(189))}}if(u.alternate!==g)throw Error(n(190))}if(u.tag!==3)throw Error(n(188));return u.stateNode.current===u?r:o}function A(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r;for(r=r.child;r!==null;){if(o=A(r),o!==null)return o;r=r.sibling}return null}var f=Object.assign,p=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),w=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),I=Symbol.for("react.consumer"),P=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),K=Symbol.for("react.lazy"),G=Symbol.for("react.activity"),L=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function q(r){return r===null||typeof r!="object"?null:(r=O&&r[O]||r["@@iterator"],typeof r=="function"?r:null)}var $=Symbol.for("react.client.reference");function Q(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===$?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case S:return"Fragment";case E:return"Profiler";case k:return"StrictMode";case D:return"Suspense";case N:return"SuspenseList";case G:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case w:return"Portal";case P:return r.displayName||"Context";case I:return(r._context.displayName||"Context")+".Consumer";case R:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case _:return o=r.displayName||null,o!==null?o:Q(r.type)||"Memo";case K:o=r._payload,r=r._init;try{return Q(r(o))}catch{}}return null}var Z=Array.isArray,F=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y={pending:!1,data:null,method:null,action:null},ge=[],me=-1;function z(r){return{current:r}}function H(r){0>me||(r.current=ge[me],ge[me]=null,me--)}function j(r,o){me++,ge[me]=r.current,r.current=o}var le=z(null),te=z(null),oe=z(null),ce=z(null);function Ge(r,o){switch(j(oe,o),j(te,r),j(le,null),o.nodeType){case 9:case 11:r=(r=o.documentElement)&&(r=r.namespaceURI)?py(r):0;break;default:if(r=o.tagName,o=o.namespaceURI)o=py(o),r=my(o,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}H(le),j(le,r)}function ae(){H(le),H(te),H(oe)}function Le(r){r.memoizedState!==null&&j(ce,r);var o=le.current,u=my(o,r.type);o!==u&&(j(te,r),j(le,u))}function De(r){te.current===r&&(H(le),H(te)),ce.current===r&&(H(ce),bl._currentValue=Y)}var ue,ne;function fe(r){if(ue===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);ue=o&&o[1]||"",ne=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ue+r+ne}var Te=!1;function pe(r,o){if(!r||Te)return"";Te=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(o){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(ve){var Ae=ve}Reflect.construct(r,[],ke)}else{try{ke.call()}catch(ve){Ae=ve}r.call(ke.prototype)}}else{try{throw Error()}catch(ve){Ae=ve}(ke=r())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(ve){if(ve&&Ae&&typeof ve.stack=="string")return[ve.stack,Ae.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=g.DetermineComponentFrameRoot(),M=C[0],B=C[1];if(M&&B){var J=M.split(`
`),he=B.split(`
`);for(y=g=0;g<J.length&&!J[g].includes("DetermineComponentFrameRoot");)g++;for(;y<he.length&&!he[y].includes("DetermineComponentFrameRoot");)y++;if(g===J.length||y===he.length)for(g=J.length-1,y=he.length-1;1<=g&&0<=y&&J[g]!==he[y];)y--;for(;1<=g&&0<=y;g--,y--)if(J[g]!==he[y]){if(g!==1||y!==1)do if(g--,y--,0>y||J[g]!==he[y]){var be=`
`+J[g].replace(" at new "," at ");return r.displayName&&be.includes("<anonymous>")&&(be=be.replace("<anonymous>",r.displayName)),be}while(1<=g&&0<=y);break}}}finally{Te=!1,Error.prepareStackTrace=u}return(u=r?r.displayName||r.name:"")?fe(u):""}function ye(r,o){switch(r.tag){case 26:case 27:case 5:return fe(r.type);case 16:return fe("Lazy");case 13:return r.child!==o&&o!==null?fe("Suspense Fallback"):fe("Suspense");case 19:return fe("SuspenseList");case 0:case 15:return pe(r.type,!1);case 11:return pe(r.type.render,!1);case 1:return pe(r.type,!0);case 31:return fe("Activity");default:return""}}function Ie(r){try{var o="",u=null;do o+=ye(r,u),u=r,r=r.return;while(r);return o}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var qe=Object.prototype.hasOwnProperty,Re=a.unstable_scheduleCallback,et=a.unstable_cancelCallback,Ye=a.unstable_shouldYield,Qe=a.unstable_requestPaint,st=a.unstable_now,yt=a.unstable_getCurrentPriorityLevel,ft=a.unstable_ImmediatePriority,Ue=a.unstable_UserBlockingPriority,Be=a.unstable_NormalPriority,it=a.unstable_LowPriority,mt=a.unstable_IdlePriority,Rt=a.log,Qt=a.unstable_setDisableYieldValue,dt=null,Mt=null;function Bt(r){if(typeof Rt=="function"&&Qt(r),Mt&&typeof Mt.setStrictMode=="function")try{Mt.setStrictMode(dt,r)}catch{}}var Ce=Math.clz32?Math.clz32:wt,lt=Math.log,ht=Math.LN2;function wt(r){return r>>>=0,r===0?32:31-(lt(r)/ht|0)|0}var tn=256,Sn=262144,wn=4194304;function cn(r){var o=r&42;if(o!==0)return o;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function bt(r,o,u){var g=r.pendingLanes;if(g===0)return 0;var y=0,C=r.suspendedLanes,M=r.pingedLanes;r=r.warmLanes;var B=g&134217727;return B!==0?(g=B&~C,g!==0?y=cn(g):(M&=B,M!==0?y=cn(M):u||(u=B&~r,u!==0&&(y=cn(u))))):(B=g&~C,B!==0?y=cn(B):M!==0?y=cn(M):u||(u=g&~r,u!==0&&(y=cn(u)))),y===0?0:o!==0&&o!==y&&(o&C)===0&&(C=y&-y,u=o&-o,C>=u||C===32&&(u&4194048)!==0)?o:y}function Wt(r,o){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&o)===0}function se(r,o){switch(r){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _e(){var r=wn;return wn<<=1,(wn&62914560)===0&&(wn=4194304),r}function He(r){for(var o=[],u=0;31>u;u++)o.push(r);return o}function Ke(r,o){r.pendingLanes|=o,o!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function je(r,o,u,g,y,C){var M=r.pendingLanes;r.pendingLanes=u,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=u,r.entangledLanes&=u,r.errorRecoveryDisabledLanes&=u,r.shellSuspendCounter=0;var B=r.entanglements,J=r.expirationTimes,he=r.hiddenUpdates;for(u=M&~u;0<u;){var be=31-Ce(u),ke=1<<be;B[be]=0,J[be]=-1;var Ae=he[be];if(Ae!==null)for(he[be]=null,be=0;be<Ae.length;be++){var ve=Ae[be];ve!==null&&(ve.lane&=-536870913)}u&=~ke}g!==0&&X(r,g,0),C!==0&&y===0&&r.tag!==0&&(r.suspendedLanes|=C&~(M&~o))}function X(r,o,u){r.pendingLanes|=o,r.suspendedLanes&=~o;var g=31-Ce(o);r.entangledLanes|=o,r.entanglements[g]=r.entanglements[g]|1073741824|u&261930}function xe(r,o){var u=r.entangledLanes|=o;for(r=r.entanglements;u;){var g=31-Ce(u),y=1<<g;y&o|r[g]&o&&(r[g]|=o),u&=~y}}function Fe(r,o){var u=o&-o;return u=(u&42)!==0?1:Me(u),(u&(r.suspendedLanes|o))!==0?0:u}function Me(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function at(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Ve(){var r=U.p;return r!==0?r:(r=window.event,r===void 0?32:Ky(r.type))}function Oe(r,o){var u=U.p;try{return U.p=r,o()}finally{U.p=u}}var Pe=Math.random().toString(36).slice(2),Ne="__reactFiber$"+Pe,Je="__reactProps$"+Pe,qt="__reactContainer$"+Pe,xt="__reactEvents$"+Pe,vn="__reactListeners$"+Pe,Yt="__reactHandles$"+Pe,Xt="__reactResources$"+Pe,yn="__reactMarker$"+Pe;function ct(r){delete r[Ne],delete r[Je],delete r[xt],delete r[vn],delete r[Yt]}function vt(r){var o=r[Ne];if(o)return o;for(var u=r.parentNode;u;){if(o=u[qt]||u[Ne]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(r=Ty(r);r!==null;){if(u=r[Ne])return u;r=Ty(r)}return o}r=u,u=r.parentNode}return null}function Lt(r){if(r=r[Ne]||r[qt]){var o=r.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return r}return null}function Rn(r){var o=r.tag;if(o===5||o===26||o===27||o===6)return r.stateNode;throw Error(n(33))}function qn(r){var o=r[Xt];return o||(o=r[Xt]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Nt(r){r[yn]=!0}var li=new Set,Ha={};function $n(r,o){ze(r,o),ze(r+"Capture",o)}function ze(r,o){for(Ha[r]=o,r=0;r<o.length;r++)li.add(o[r])}var Ct=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ft={},un={};function En(r){return qe.call(un,r)?!0:qe.call(Ft,r)?!1:Ct.test(r)?un[r]=!0:(Ft[r]=!0,!1)}function tt(r,o,u){if(En(o))if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":r.removeAttribute(o);return;case"boolean":var g=o.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){r.removeAttribute(o);return}}r.setAttribute(o,""+u)}}function $t(r,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttribute(o,""+u)}}function bn(r,o,u,g){if(g===null)r.removeAttribute(u);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttributeNS(o,u,""+g)}}function re(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Xe(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function V(r,o,u){var g=Object.getOwnPropertyDescriptor(r.constructor.prototype,o);if(!r.hasOwnProperty(o)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var y=g.get,C=g.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return y.call(this)},set:function(M){u=""+M,C.call(this,M)}}),Object.defineProperty(r,o,{enumerable:g.enumerable}),{getValue:function(){return u},setValue:function(M){u=""+M},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function Se(r){if(!r._valueTracker){var o=Xe(r)?"checked":"value";r._valueTracker=V(r,o,""+r[o])}}function Ee(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var u=o.getValue(),g="";return r&&(g=Xe(r)?r.checked?"true":"false":r.value),r=g,r!==u?(o.setValue(r),!0):!1}function We(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var nt=/[\n"\\]/g;function St(r){return r.replace(nt,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Ut(r,o,u,g,y,C,M,B){r.name="",M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?r.type=M:r.removeAttribute("type"),o!=null?M==="number"?(o===0&&r.value===""||r.value!=o)&&(r.value=""+re(o)):r.value!==""+re(o)&&(r.value=""+re(o)):M!=="submit"&&M!=="reset"||r.removeAttribute("value"),o!=null?Bn(r,M,re(o)):u!=null?Bn(r,M,re(u)):g!=null&&r.removeAttribute("value"),y==null&&C!=null&&(r.defaultChecked=!!C),y!=null&&(r.checked=y&&typeof y!="function"&&typeof y!="symbol"),B!=null&&typeof B!="function"&&typeof B!="symbol"&&typeof B!="boolean"?r.name=""+re(B):r.removeAttribute("name")}function Jn(r,o,u,g,y,C,M,B){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(r.type=C),o!=null||u!=null){if(!(C!=="submit"&&C!=="reset"||o!=null)){Se(r);return}u=u!=null?""+re(u):"",o=o!=null?""+re(o):u,B||o===r.value||(r.value=o),r.defaultValue=o}g=g??y,g=typeof g!="function"&&typeof g!="symbol"&&!!g,r.checked=B?r.checked:!!g,r.defaultChecked=!!g,M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"&&(r.name=M),Se(r)}function Bn(r,o,u){o==="number"&&We(r.ownerDocument)===r||r.defaultValue===""+u||(r.defaultValue=""+u)}function Aa(r,o,u,g){if(r=r.options,o){o={};for(var y=0;y<u.length;y++)o["$"+u[y]]=!0;for(u=0;u<r.length;u++)y=o.hasOwnProperty("$"+r[u].value),r[u].selected!==y&&(r[u].selected=y),y&&g&&(r[u].defaultSelected=!0)}else{for(u=""+re(u),o=null,y=0;y<r.length;y++){if(r[y].value===u){r[y].selected=!0,g&&(r[y].defaultSelected=!0);return}o!==null||r[y].disabled||(o=r[y])}o!==null&&(o.selected=!0)}}function ga(r,o,u){if(o!=null&&(o=""+re(o),o!==r.value&&(r.value=o),u==null)){r.defaultValue!==o&&(r.defaultValue=o);return}r.defaultValue=u!=null?""+re(u):""}function Ri(r,o,u,g){if(o==null){if(g!=null){if(u!=null)throw Error(n(92));if(Z(g)){if(1<g.length)throw Error(n(93));g=g[0]}u=g}u==null&&(u=""),o=u}u=re(o),r.defaultValue=u,g=r.textContent,g===u&&g!==""&&g!==null&&(r.value=g),Se(r)}function wa(r,o){if(o){var u=r.firstChild;if(u&&u===r.lastChild&&u.nodeType===3){u.nodeValue=o;return}}r.textContent=o}var sc=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ap(r,o,u){var g=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?g?r.setProperty(o,""):o==="float"?r.cssFloat="":r[o]="":g?r.setProperty(o,u):typeof u!="number"||u===0||sc.has(o)?o==="float"?r.cssFloat=u:r[o]=(""+u).trim():r[o]=u+"px"}function gp(r,o,u){if(o!=null&&typeof o!="object")throw Error(n(62));if(r=r.style,u!=null){for(var g in u)!u.hasOwnProperty(g)||o!=null&&o.hasOwnProperty(g)||(g.indexOf("--")===0?r.setProperty(g,""):g==="float"?r.cssFloat="":r[g]="");for(var y in o)g=o[y],o.hasOwnProperty(y)&&u[y]!==g&&Ap(r,y,g)}else for(var C in o)o.hasOwnProperty(C)&&Ap(r,C,o[C])}function Qd(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var XT=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),WT=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function oc(r){return WT.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Ni(){}var qd=null;function Yd(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var bs=null,Cs=null;function fp(r){var o=Lt(r);if(o&&(r=o.stateNode)){var u=r[Je]||null;e:switch(r=o.stateNode,o.type){case"input":if(Ut(r,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=r;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+St(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var g=u[o];if(g!==r&&g.form===r.form){var y=g[Je]||null;if(!y)throw Error(n(90));Ut(g,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(o=0;o<u.length;o++)g=u[o],g.form===r.form&&Ee(g)}break e;case"textarea":ga(r,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&Aa(r,!!u.multiple,o,!1)}}}var Xd=!1;function pp(r,o,u){if(Xd)return r(o,u);Xd=!0;try{var g=r(o);return g}finally{if(Xd=!1,(bs!==null||Cs!==null)&&(Yc(),bs&&(o=bs,r=Cs,Cs=bs=null,fp(o),r)))for(o=0;o<r.length;o++)fp(r[o])}}function Bo(r,o){var u=r.stateNode;if(u===null)return null;var g=u[Je]||null;if(g===null)return null;u=g[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(r=r.type,g=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!g;break e;default:r=!1}if(r)return null;if(u&&typeof u!="function")throw Error(n(231,o,typeof u));return u}var Gi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wd=!1;if(Gi)try{var Fo={};Object.defineProperty(Fo,"passive",{get:function(){Wd=!0}}),window.addEventListener("test",Fo,Fo),window.removeEventListener("test",Fo,Fo)}catch{Wd=!1}var cr=null,$d=null,lc=null;function mp(){if(lc)return lc;var r,o=$d,u=o.length,g,y="value"in cr?cr.value:cr.textContent,C=y.length;for(r=0;r<u&&o[r]===y[r];r++);var M=u-r;for(g=1;g<=M&&o[u-g]===y[C-g];g++);return lc=y.slice(r,1<g?1-g:void 0)}function cc(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function uc(){return!0}function vp(){return!1}function Ta(r){function o(u,g,y,C,M){this._reactName=u,this._targetInst=y,this.type=g,this.nativeEvent=C,this.target=M,this.currentTarget=null;for(var B in r)r.hasOwnProperty(B)&&(u=r[B],this[B]=u?u(C):C[B]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?uc:vp,this.isPropagationStopped=vp,this}return f(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=uc)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=uc)},persist:function(){},isPersistent:uc}),o}var Vr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dc=Ta(Vr),Uo=f({},Vr,{view:0,detail:0}),$T=Ta(Uo),Jd,Zd,Ko,hc=f({},Uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:th,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Ko&&(Ko&&r.type==="mousemove"?(Jd=r.screenX-Ko.screenX,Zd=r.screenY-Ko.screenY):Zd=Jd=0,Ko=r),Jd)},movementY:function(r){return"movementY"in r?r.movementY:Zd}}),yp=Ta(hc),JT=f({},hc,{dataTransfer:0}),ZT=Ta(JT),ek=f({},Uo,{relatedTarget:0}),eh=Ta(ek),tk=f({},Vr,{animationName:0,elapsedTime:0,pseudoElement:0}),nk=Ta(tk),ak=f({},Vr,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),ik=Ta(ak),rk=f({},Vr,{data:0}),bp=Ta(rk),sk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ok={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},lk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ck(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=lk[r])?!!o[r]:!1}function th(){return ck}var uk=f({},Uo,{key:function(r){if(r.key){var o=sk[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=cc(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?ok[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:th,charCode:function(r){return r.type==="keypress"?cc(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?cc(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),dk=Ta(uk),hk=f({},hc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Cp=Ta(hk),Ak=f({},Uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:th}),gk=Ta(Ak),fk=f({},Vr,{propertyName:0,elapsedTime:0,pseudoElement:0}),pk=Ta(fk),mk=f({},hc,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),vk=Ta(mk),yk=f({},Vr,{newState:0,oldState:0}),bk=Ta(yk),Ck=[9,13,27,32],nh=Gi&&"CompositionEvent"in window,zo=null;Gi&&"documentMode"in document&&(zo=document.documentMode);var Sk=Gi&&"TextEvent"in window&&!zo,Sp=Gi&&(!nh||zo&&8<zo&&11>=zo),wp=" ",Tp=!1;function kp(r,o){switch(r){case"keyup":return Ck.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ep(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ss=!1;function wk(r,o){switch(r){case"compositionend":return Ep(o);case"keypress":return o.which!==32?null:(Tp=!0,wp);case"textInput":return r=o.data,r===wp&&Tp?null:r;default:return null}}function Tk(r,o){if(Ss)return r==="compositionend"||!nh&&kp(r,o)?(r=mp(),lc=$d=cr=null,Ss=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Sp&&o.locale!=="ko"?null:o.data;default:return null}}var kk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xp(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!kk[r.type]:o==="textarea"}function Pp(r,o,u,g){bs?Cs?Cs.push(g):Cs=[g]:bs=g,o=tu(o,"onChange"),0<o.length&&(u=new dc("onChange","change",null,u,g),r.push({event:u,listeners:o}))}var Oo=null,Ho=null;function Ek(r){uy(r,0)}function Ac(r){var o=Rn(r);if(Ee(o))return r}function Mp(r,o){if(r==="change")return o}var Ip=!1;if(Gi){var ah;if(Gi){var ih="oninput"in document;if(!ih){var Dp=document.createElement("div");Dp.setAttribute("oninput","return;"),ih=typeof Dp.oninput=="function"}ah=ih}else ah=!1;Ip=ah&&(!document.documentMode||9<document.documentMode)}function _p(){Oo&&(Oo.detachEvent("onpropertychange",Rp),Ho=Oo=null)}function Rp(r){if(r.propertyName==="value"&&Ac(Ho)){var o=[];Pp(o,Ho,r,Yd(r)),pp(Ek,o)}}function xk(r,o,u){r==="focusin"?(_p(),Oo=o,Ho=u,Oo.attachEvent("onpropertychange",Rp)):r==="focusout"&&_p()}function Pk(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Ac(Ho)}function Mk(r,o){if(r==="click")return Ac(o)}function Ik(r,o){if(r==="input"||r==="change")return Ac(o)}function Dk(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var Ra=typeof Object.is=="function"?Object.is:Dk;function Vo(r,o){if(Ra(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var u=Object.keys(r),g=Object.keys(o);if(u.length!==g.length)return!1;for(g=0;g<u.length;g++){var y=u[g];if(!qe.call(o,y)||!Ra(r[y],o[y]))return!1}return!0}function Np(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Gp(r,o){var u=Np(r);r=0;for(var g;u;){if(u.nodeType===3){if(g=r+u.textContent.length,r<=o&&g>=o)return{node:u,offset:o-r};r=g}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Np(u)}}function Lp(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?Lp(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function Bp(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var o=We(r.document);o instanceof r.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)r=o.contentWindow;else break;o=We(r.document)}return o}function rh(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}var _k=Gi&&"documentMode"in document&&11>=document.documentMode,ws=null,sh=null,jo=null,oh=!1;function Fp(r,o,u){var g=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;oh||ws==null||ws!==We(g)||(g=ws,"selectionStart"in g&&rh(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),jo&&Vo(jo,g)||(jo=g,g=tu(sh,"onSelect"),0<g.length&&(o=new dc("onSelect","select",null,o,u),r.push({event:o,listeners:g}),o.target=ws)))}function jr(r,o){var u={};return u[r.toLowerCase()]=o.toLowerCase(),u["Webkit"+r]="webkit"+o,u["Moz"+r]="moz"+o,u}var Ts={animationend:jr("Animation","AnimationEnd"),animationiteration:jr("Animation","AnimationIteration"),animationstart:jr("Animation","AnimationStart"),transitionrun:jr("Transition","TransitionRun"),transitionstart:jr("Transition","TransitionStart"),transitioncancel:jr("Transition","TransitionCancel"),transitionend:jr("Transition","TransitionEnd")},lh={},Up={};Gi&&(Up=document.createElement("div").style,"AnimationEvent"in window||(delete Ts.animationend.animation,delete Ts.animationiteration.animation,delete Ts.animationstart.animation),"TransitionEvent"in window||delete Ts.transitionend.transition);function Qr(r){if(lh[r])return lh[r];if(!Ts[r])return r;var o=Ts[r],u;for(u in o)if(o.hasOwnProperty(u)&&u in Up)return lh[r]=o[u];return r}var Kp=Qr("animationend"),zp=Qr("animationiteration"),Op=Qr("animationstart"),Rk=Qr("transitionrun"),Nk=Qr("transitionstart"),Gk=Qr("transitioncancel"),Hp=Qr("transitionend"),Vp=new Map,ch="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ch.push("scrollEnd");function ci(r,o){Vp.set(r,o),$n(o,[r])}var gc=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},Va=[],ks=0,uh=0;function fc(){for(var r=ks,o=uh=ks=0;o<r;){var u=Va[o];Va[o++]=null;var g=Va[o];Va[o++]=null;var y=Va[o];Va[o++]=null;var C=Va[o];if(Va[o++]=null,g!==null&&y!==null){var M=g.pending;M===null?y.next=y:(y.next=M.next,M.next=y),g.pending=y}C!==0&&jp(u,y,C)}}function pc(r,o,u,g){Va[ks++]=r,Va[ks++]=o,Va[ks++]=u,Va[ks++]=g,uh|=g,r.lanes|=g,r=r.alternate,r!==null&&(r.lanes|=g)}function dh(r,o,u,g){return pc(r,o,u,g),mc(r)}function qr(r,o){return pc(r,null,null,o),mc(r)}function jp(r,o,u){r.lanes|=u;var g=r.alternate;g!==null&&(g.lanes|=u);for(var y=!1,C=r.return;C!==null;)C.childLanes|=u,g=C.alternate,g!==null&&(g.childLanes|=u),C.tag===22&&(r=C.stateNode,r===null||r._visibility&1||(y=!0)),r=C,C=C.return;return r.tag===3?(C=r.stateNode,y&&o!==null&&(y=31-Ce(u),r=C.hiddenUpdates,g=r[y],g===null?r[y]=[o]:g.push(o),o.lane=u|536870912),C):null}function mc(r){if(50<Al)throw Al=0,bA=null,Error(n(185));for(var o=r.return;o!==null;)r=o,o=r.return;return r.tag===3?r.stateNode:null}var Es={};function Lk(r,o,u,g){this.tag=r,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Na(r,o,u,g){return new Lk(r,o,u,g)}function hh(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Li(r,o){var u=r.alternate;return u===null?(u=Na(r.tag,o,r.key,r.mode),u.elementType=r.elementType,u.type=r.type,u.stateNode=r.stateNode,u.alternate=r,r.alternate=u):(u.pendingProps=o,u.type=r.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=r.flags&65011712,u.childLanes=r.childLanes,u.lanes=r.lanes,u.child=r.child,u.memoizedProps=r.memoizedProps,u.memoizedState=r.memoizedState,u.updateQueue=r.updateQueue,o=r.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=r.sibling,u.index=r.index,u.ref=r.ref,u.refCleanup=r.refCleanup,u}function Qp(r,o){r.flags&=65011714;var u=r.alternate;return u===null?(r.childLanes=0,r.lanes=o,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=u.childLanes,r.lanes=u.lanes,r.child=u.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=u.memoizedProps,r.memoizedState=u.memoizedState,r.updateQueue=u.updateQueue,r.type=u.type,o=u.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),r}function vc(r,o,u,g,y,C){var M=0;if(g=r,typeof r=="function")hh(r)&&(M=1);else if(typeof r=="string")M=zE(r,u,le.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case G:return r=Na(31,u,o,y),r.elementType=G,r.lanes=C,r;case S:return Yr(u.children,y,C,o);case k:M=8,y|=24;break;case E:return r=Na(12,u,o,y|2),r.elementType=E,r.lanes=C,r;case D:return r=Na(13,u,o,y),r.elementType=D,r.lanes=C,r;case N:return r=Na(19,u,o,y),r.elementType=N,r.lanes=C,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case P:M=10;break e;case I:M=9;break e;case R:M=11;break e;case _:M=14;break e;case K:M=16,g=null;break e}M=29,u=Error(n(130,r===null?"null":typeof r,"")),g=null}return o=Na(M,u,o,y),o.elementType=r,o.type=g,o.lanes=C,o}function Yr(r,o,u,g){return r=Na(7,r,g,o),r.lanes=u,r}function Ah(r,o,u){return r=Na(6,r,null,o),r.lanes=u,r}function qp(r){var o=Na(18,null,null,0);return o.stateNode=r,o}function gh(r,o,u){return o=Na(4,r.children!==null?r.children:[],r.key,o),o.lanes=u,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}var Yp=new WeakMap;function ja(r,o){if(typeof r=="object"&&r!==null){var u=Yp.get(r);return u!==void 0?u:(o={value:r,source:o,stack:Ie(o)},Yp.set(r,o),o)}return{value:r,source:o,stack:Ie(o)}}var xs=[],Ps=0,yc=null,Qo=0,Qa=[],qa=0,ur=null,mi=1,vi="";function Bi(r,o){xs[Ps++]=Qo,xs[Ps++]=yc,yc=r,Qo=o}function Xp(r,o,u){Qa[qa++]=mi,Qa[qa++]=vi,Qa[qa++]=ur,ur=r;var g=mi;r=vi;var y=32-Ce(g)-1;g&=~(1<<y),u+=1;var C=32-Ce(o)+y;if(30<C){var M=y-y%5;C=(g&(1<<M)-1).toString(32),g>>=M,y-=M,mi=1<<32-Ce(o)+y|u<<y|g,vi=C+r}else mi=1<<C|u<<y|g,vi=r}function fh(r){r.return!==null&&(Bi(r,1),Xp(r,1,0))}function ph(r){for(;r===yc;)yc=xs[--Ps],xs[Ps]=null,Qo=xs[--Ps],xs[Ps]=null;for(;r===ur;)ur=Qa[--qa],Qa[qa]=null,vi=Qa[--qa],Qa[qa]=null,mi=Qa[--qa],Qa[qa]=null}function Wp(r,o){Qa[qa++]=mi,Qa[qa++]=vi,Qa[qa++]=ur,mi=o.id,vi=o.overflow,ur=r}var ra=null,Tn=null,Vt=!1,dr=null,Ya=!1,mh=Error(n(519));function hr(r){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw qo(ja(o,r)),mh}function $p(r){var o=r.stateNode,u=r.type,g=r.memoizedProps;switch(o[Ne]=r,o[Je]=g,u){case"dialog":zt("cancel",o),zt("close",o);break;case"iframe":case"object":case"embed":zt("load",o);break;case"video":case"audio":for(u=0;u<fl.length;u++)zt(fl[u],o);break;case"source":zt("error",o);break;case"img":case"image":case"link":zt("error",o),zt("load",o);break;case"details":zt("toggle",o);break;case"input":zt("invalid",o),Jn(o,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":zt("invalid",o);break;case"textarea":zt("invalid",o),Ri(o,g.value,g.defaultValue,g.children)}u=g.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||g.suppressHydrationWarning===!0||gy(o.textContent,u)?(g.popover!=null&&(zt("beforetoggle",o),zt("toggle",o)),g.onScroll!=null&&zt("scroll",o),g.onScrollEnd!=null&&zt("scrollend",o),g.onClick!=null&&(o.onclick=Ni),o=!0):o=!1,o||hr(r,!0)}function Jp(r){for(ra=r.return;ra;)switch(ra.tag){case 5:case 31:case 13:Ya=!1;return;case 27:case 3:Ya=!0;return;default:ra=ra.return}}function Ms(r){if(r!==ra)return!1;if(!Vt)return Jp(r),Vt=!0,!1;var o=r.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=r.type,u=!(u!=="form"&&u!=="button")||GA(r.type,r.memoizedProps)),u=!u),u&&Tn&&hr(r),Jp(r),o===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));Tn=wy(r)}else if(o===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));Tn=wy(r)}else o===27?(o=Tn,Er(r.type)?(r=KA,KA=null,Tn=r):Tn=o):Tn=ra?Wa(r.stateNode.nextSibling):null;return!0}function Xr(){Tn=ra=null,Vt=!1}function vh(){var r=dr;return r!==null&&(Pa===null?Pa=r:Pa.push.apply(Pa,r),dr=null),r}function qo(r){dr===null?dr=[r]:dr.push(r)}var yh=z(null),Wr=null,Fi=null;function Ar(r,o,u){j(yh,o._currentValue),o._currentValue=u}function Ui(r){r._currentValue=yh.current,H(yh)}function bh(r,o,u){for(;r!==null;){var g=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,g!==null&&(g.childLanes|=o)):g!==null&&(g.childLanes&o)!==o&&(g.childLanes|=o),r===u)break;r=r.return}}function Ch(r,o,u,g){var y=r.child;for(y!==null&&(y.return=r);y!==null;){var C=y.dependencies;if(C!==null){var M=y.child;C=C.firstContext;e:for(;C!==null;){var B=C;C=y;for(var J=0;J<o.length;J++)if(B.context===o[J]){C.lanes|=u,B=C.alternate,B!==null&&(B.lanes|=u),bh(C.return,u,r),g||(M=null);break e}C=B.next}}else if(y.tag===18){if(M=y.return,M===null)throw Error(n(341));M.lanes|=u,C=M.alternate,C!==null&&(C.lanes|=u),bh(M,u,r),M=null}else M=y.child;if(M!==null)M.return=y;else for(M=y;M!==null;){if(M===r){M=null;break}if(y=M.sibling,y!==null){y.return=M.return,M=y;break}M=M.return}y=M}}function Is(r,o,u,g){r=null;for(var y=o,C=!1;y!==null;){if(!C){if((y.flags&524288)!==0)C=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var M=y.alternate;if(M===null)throw Error(n(387));if(M=M.memoizedProps,M!==null){var B=y.type;Ra(y.pendingProps.value,M.value)||(r!==null?r.push(B):r=[B])}}else if(y===ce.current){if(M=y.alternate,M===null)throw Error(n(387));M.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(r!==null?r.push(bl):r=[bl])}y=y.return}r!==null&&Ch(o,r,u,g),o.flags|=262144}function bc(r){for(r=r.firstContext;r!==null;){if(!Ra(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function $r(r){Wr=r,Fi=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function sa(r){return Zp(Wr,r)}function Cc(r,o){return Wr===null&&$r(r),Zp(r,o)}function Zp(r,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},Fi===null){if(r===null)throw Error(n(308));Fi=o,r.dependencies={lanes:0,firstContext:o},r.flags|=524288}else Fi=Fi.next=o;return u}var Bk=typeof AbortController<"u"?AbortController:function(){var r=[],o=this.signal={aborted:!1,addEventListener:function(u,g){r.push(g)}};this.abort=function(){o.aborted=!0,r.forEach(function(u){return u()})}},Fk=a.unstable_scheduleCallback,Uk=a.unstable_NormalPriority,zn={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Sh(){return{controller:new Bk,data:new Map,refCount:0}}function Yo(r){r.refCount--,r.refCount===0&&Fk(Uk,function(){r.controller.abort()})}var Xo=null,wh=0,Ds=0,_s=null;function Kk(r,o){if(Xo===null){var u=Xo=[];wh=0,Ds=EA(),_s={status:"pending",value:void 0,then:function(g){u.push(g)}}}return wh++,o.then(em,em),o}function em(){if(--wh===0&&Xo!==null){_s!==null&&(_s.status="fulfilled");var r=Xo;Xo=null,Ds=0,_s=null;for(var o=0;o<r.length;o++)(0,r[o])()}}function zk(r,o){var u=[],g={status:"pending",value:null,reason:null,then:function(y){u.push(y)}};return r.then(function(){g.status="fulfilled",g.value=o;for(var y=0;y<u.length;y++)(0,u[y])(o)},function(y){for(g.status="rejected",g.reason=y,y=0;y<u.length;y++)(0,u[y])(void 0)}),g}var tm=F.S;F.S=function(r,o){Fv=st(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&Kk(r,o),tm!==null&&tm(r,o)};var Jr=z(null);function Th(){var r=Jr.current;return r!==null?r:Cn.pooledCache}function Sc(r,o){o===null?j(Jr,Jr.current):j(Jr,o.pool)}function nm(){var r=Th();return r===null?null:{parent:zn._currentValue,pool:r}}var Rs=Error(n(460)),kh=Error(n(474)),wc=Error(n(542)),Tc={then:function(){}};function am(r){return r=r.status,r==="fulfilled"||r==="rejected"}function im(r,o,u){switch(u=r[u],u===void 0?r.push(o):u!==o&&(o.then(Ni,Ni),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,sm(r),r;default:if(typeof o.status=="string")o.then(Ni,Ni);else{if(r=Cn,r!==null&&100<r.shellSuspendCounter)throw Error(n(482));r=o,r.status="pending",r.then(function(g){if(o.status==="pending"){var y=o;y.status="fulfilled",y.value=g}},function(g){if(o.status==="pending"){var y=o;y.status="rejected",y.reason=g}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw r=o.reason,sm(r),r}throw es=o,Rs}}function Zr(r){try{var o=r._init;return o(r._payload)}catch(u){throw u!==null&&typeof u=="object"&&typeof u.then=="function"?(es=u,Rs):u}}var es=null;function rm(){if(es===null)throw Error(n(459));var r=es;return es=null,r}function sm(r){if(r===Rs||r===wc)throw Error(n(483))}var Ns=null,Wo=0;function kc(r){var o=Wo;return Wo+=1,Ns===null&&(Ns=[]),im(Ns,r,o)}function $o(r,o){o=o.props.ref,r.ref=o!==void 0?o:null}function Ec(r,o){throw o.$$typeof===p?Error(n(525)):(r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r)))}function om(r){function o(ie,ee){if(r){var de=ie.deletions;de===null?(ie.deletions=[ee],ie.flags|=16):de.push(ee)}}function u(ie,ee){if(!r)return null;for(;ee!==null;)o(ie,ee),ee=ee.sibling;return null}function g(ie){for(var ee=new Map;ie!==null;)ie.key!==null?ee.set(ie.key,ie):ee.set(ie.index,ie),ie=ie.sibling;return ee}function y(ie,ee){return ie=Li(ie,ee),ie.index=0,ie.sibling=null,ie}function C(ie,ee,de){return ie.index=de,r?(de=ie.alternate,de!==null?(de=de.index,de<ee?(ie.flags|=67108866,ee):de):(ie.flags|=67108866,ee)):(ie.flags|=1048576,ee)}function M(ie){return r&&ie.alternate===null&&(ie.flags|=67108866),ie}function B(ie,ee,de,we){return ee===null||ee.tag!==6?(ee=Ah(de,ie.mode,we),ee.return=ie,ee):(ee=y(ee,de),ee.return=ie,ee)}function J(ie,ee,de,we){var At=de.type;return At===S?be(ie,ee,de.props.children,we,de.key):ee!==null&&(ee.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===K&&Zr(At)===ee.type)?(ee=y(ee,de.props),$o(ee,de),ee.return=ie,ee):(ee=vc(de.type,de.key,de.props,null,ie.mode,we),$o(ee,de),ee.return=ie,ee)}function he(ie,ee,de,we){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==de.containerInfo||ee.stateNode.implementation!==de.implementation?(ee=gh(de,ie.mode,we),ee.return=ie,ee):(ee=y(ee,de.children||[]),ee.return=ie,ee)}function be(ie,ee,de,we,At){return ee===null||ee.tag!==7?(ee=Yr(de,ie.mode,we,At),ee.return=ie,ee):(ee=y(ee,de),ee.return=ie,ee)}function ke(ie,ee,de){if(typeof ee=="string"&&ee!==""||typeof ee=="number"||typeof ee=="bigint")return ee=Ah(""+ee,ie.mode,de),ee.return=ie,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case b:return de=vc(ee.type,ee.key,ee.props,null,ie.mode,de),$o(de,ee),de.return=ie,de;case w:return ee=gh(ee,ie.mode,de),ee.return=ie,ee;case K:return ee=Zr(ee),ke(ie,ee,de)}if(Z(ee)||q(ee))return ee=Yr(ee,ie.mode,de,null),ee.return=ie,ee;if(typeof ee.then=="function")return ke(ie,kc(ee),de);if(ee.$$typeof===P)return ke(ie,Cc(ie,ee),de);Ec(ie,ee)}return null}function Ae(ie,ee,de,we){var At=ee!==null?ee.key:null;if(typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint")return At!==null?null:B(ie,ee,""+de,we);if(typeof de=="object"&&de!==null){switch(de.$$typeof){case b:return de.key===At?J(ie,ee,de,we):null;case w:return de.key===At?he(ie,ee,de,we):null;case K:return de=Zr(de),Ae(ie,ee,de,we)}if(Z(de)||q(de))return At!==null?null:be(ie,ee,de,we,null);if(typeof de.then=="function")return Ae(ie,ee,kc(de),we);if(de.$$typeof===P)return Ae(ie,ee,Cc(ie,de),we);Ec(ie,de)}return null}function ve(ie,ee,de,we,At){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return ie=ie.get(de)||null,B(ee,ie,""+we,At);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case b:return ie=ie.get(we.key===null?de:we.key)||null,J(ee,ie,we,At);case w:return ie=ie.get(we.key===null?de:we.key)||null,he(ee,ie,we,At);case K:return we=Zr(we),ve(ie,ee,de,we,At)}if(Z(we)||q(we))return ie=ie.get(de)||null,be(ee,ie,we,At,null);if(typeof we.then=="function")return ve(ie,ee,de,kc(we),At);if(we.$$typeof===P)return ve(ie,ee,de,Cc(ee,we),At);Ec(ee,we)}return null}function ot(ie,ee,de,we){for(var At=null,Jt=null,ut=ee,Gt=ee=0,Ht=null;ut!==null&&Gt<de.length;Gt++){ut.index>Gt?(Ht=ut,ut=null):Ht=ut.sibling;var Zt=Ae(ie,ut,de[Gt],we);if(Zt===null){ut===null&&(ut=Ht);break}r&&ut&&Zt.alternate===null&&o(ie,ut),ee=C(Zt,ee,Gt),Jt===null?At=Zt:Jt.sibling=Zt,Jt=Zt,ut=Ht}if(Gt===de.length)return u(ie,ut),Vt&&Bi(ie,Gt),At;if(ut===null){for(;Gt<de.length;Gt++)ut=ke(ie,de[Gt],we),ut!==null&&(ee=C(ut,ee,Gt),Jt===null?At=ut:Jt.sibling=ut,Jt=ut);return Vt&&Bi(ie,Gt),At}for(ut=g(ut);Gt<de.length;Gt++)Ht=ve(ut,ie,Gt,de[Gt],we),Ht!==null&&(r&&Ht.alternate!==null&&ut.delete(Ht.key===null?Gt:Ht.key),ee=C(Ht,ee,Gt),Jt===null?At=Ht:Jt.sibling=Ht,Jt=Ht);return r&&ut.forEach(function(Dr){return o(ie,Dr)}),Vt&&Bi(ie,Gt),At}function pt(ie,ee,de,we){if(de==null)throw Error(n(151));for(var At=null,Jt=null,ut=ee,Gt=ee=0,Ht=null,Zt=de.next();ut!==null&&!Zt.done;Gt++,Zt=de.next()){ut.index>Gt?(Ht=ut,ut=null):Ht=ut.sibling;var Dr=Ae(ie,ut,Zt.value,we);if(Dr===null){ut===null&&(ut=Ht);break}r&&ut&&Dr.alternate===null&&o(ie,ut),ee=C(Dr,ee,Gt),Jt===null?At=Dr:Jt.sibling=Dr,Jt=Dr,ut=Ht}if(Zt.done)return u(ie,ut),Vt&&Bi(ie,Gt),At;if(ut===null){for(;!Zt.done;Gt++,Zt=de.next())Zt=ke(ie,Zt.value,we),Zt!==null&&(ee=C(Zt,ee,Gt),Jt===null?At=Zt:Jt.sibling=Zt,Jt=Zt);return Vt&&Bi(ie,Gt),At}for(ut=g(ut);!Zt.done;Gt++,Zt=de.next())Zt=ve(ut,ie,Gt,Zt.value,we),Zt!==null&&(r&&Zt.alternate!==null&&ut.delete(Zt.key===null?Gt:Zt.key),ee=C(Zt,ee,Gt),Jt===null?At=Zt:Jt.sibling=Zt,Jt=Zt);return r&&ut.forEach(function(JE){return o(ie,JE)}),Vt&&Bi(ie,Gt),At}function fn(ie,ee,de,we){if(typeof de=="object"&&de!==null&&de.type===S&&de.key===null&&(de=de.props.children),typeof de=="object"&&de!==null){switch(de.$$typeof){case b:e:{for(var At=de.key;ee!==null;){if(ee.key===At){if(At=de.type,At===S){if(ee.tag===7){u(ie,ee.sibling),we=y(ee,de.props.children),we.return=ie,ie=we;break e}}else if(ee.elementType===At||typeof At=="object"&&At!==null&&At.$$typeof===K&&Zr(At)===ee.type){u(ie,ee.sibling),we=y(ee,de.props),$o(we,de),we.return=ie,ie=we;break e}u(ie,ee);break}else o(ie,ee);ee=ee.sibling}de.type===S?(we=Yr(de.props.children,ie.mode,we,de.key),we.return=ie,ie=we):(we=vc(de.type,de.key,de.props,null,ie.mode,we),$o(we,de),we.return=ie,ie=we)}return M(ie);case w:e:{for(At=de.key;ee!==null;){if(ee.key===At)if(ee.tag===4&&ee.stateNode.containerInfo===de.containerInfo&&ee.stateNode.implementation===de.implementation){u(ie,ee.sibling),we=y(ee,de.children||[]),we.return=ie,ie=we;break e}else{u(ie,ee);break}else o(ie,ee);ee=ee.sibling}we=gh(de,ie.mode,we),we.return=ie,ie=we}return M(ie);case K:return de=Zr(de),fn(ie,ee,de,we)}if(Z(de))return ot(ie,ee,de,we);if(q(de)){if(At=q(de),typeof At!="function")throw Error(n(150));return de=At.call(de),pt(ie,ee,de,we)}if(typeof de.then=="function")return fn(ie,ee,kc(de),we);if(de.$$typeof===P)return fn(ie,ee,Cc(ie,de),we);Ec(ie,de)}return typeof de=="string"&&de!==""||typeof de=="number"||typeof de=="bigint"?(de=""+de,ee!==null&&ee.tag===6?(u(ie,ee.sibling),we=y(ee,de),we.return=ie,ie=we):(u(ie,ee),we=Ah(de,ie.mode,we),we.return=ie,ie=we),M(ie)):u(ie,ee)}return function(ie,ee,de,we){try{Wo=0;var At=fn(ie,ee,de,we);return Ns=null,At}catch(ut){if(ut===Rs||ut===wc)throw ut;var Jt=Na(29,ut,null,ie.mode);return Jt.lanes=we,Jt.return=ie,Jt}}}var ts=om(!0),lm=om(!1),gr=!1;function Eh(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function xh(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function fr(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function pr(r,o,u){var g=r.updateQueue;if(g===null)return null;if(g=g.shared,(nn&2)!==0){var y=g.pending;return y===null?o.next=o:(o.next=y.next,y.next=o),g.pending=o,o=mc(r),jp(r,null,u),o}return pc(r,g,o,u),mc(r)}function Jo(r,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var g=o.lanes;g&=r.pendingLanes,u|=g,o.lanes=u,xe(r,u)}}function Ph(r,o){var u=r.updateQueue,g=r.alternate;if(g!==null&&(g=g.updateQueue,u===g)){var y=null,C=null;if(u=u.firstBaseUpdate,u!==null){do{var M={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};C===null?y=C=M:C=C.next=M,u=u.next}while(u!==null);C===null?y=C=o:C=C.next=o}else y=C=o;u={baseState:g.baseState,firstBaseUpdate:y,lastBaseUpdate:C,shared:g.shared,callbacks:g.callbacks},r.updateQueue=u;return}r=u.lastBaseUpdate,r===null?u.firstBaseUpdate=o:r.next=o,u.lastBaseUpdate=o}var Mh=!1;function Zo(){if(Mh){var r=_s;if(r!==null)throw r}}function el(r,o,u,g){Mh=!1;var y=r.updateQueue;gr=!1;var C=y.firstBaseUpdate,M=y.lastBaseUpdate,B=y.shared.pending;if(B!==null){y.shared.pending=null;var J=B,he=J.next;J.next=null,M===null?C=he:M.next=he,M=J;var be=r.alternate;be!==null&&(be=be.updateQueue,B=be.lastBaseUpdate,B!==M&&(B===null?be.firstBaseUpdate=he:B.next=he,be.lastBaseUpdate=J))}if(C!==null){var ke=y.baseState;M=0,be=he=J=null,B=C;do{var Ae=B.lane&-536870913,ve=Ae!==B.lane;if(ve?(Ot&Ae)===Ae:(g&Ae)===Ae){Ae!==0&&Ae===Ds&&(Mh=!0),be!==null&&(be=be.next={lane:0,tag:B.tag,payload:B.payload,callback:null,next:null});e:{var ot=r,pt=B;Ae=o;var fn=u;switch(pt.tag){case 1:if(ot=pt.payload,typeof ot=="function"){ke=ot.call(fn,ke,Ae);break e}ke=ot;break e;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=pt.payload,Ae=typeof ot=="function"?ot.call(fn,ke,Ae):ot,Ae==null)break e;ke=f({},ke,Ae);break e;case 2:gr=!0}}Ae=B.callback,Ae!==null&&(r.flags|=64,ve&&(r.flags|=8192),ve=y.callbacks,ve===null?y.callbacks=[Ae]:ve.push(Ae))}else ve={lane:Ae,tag:B.tag,payload:B.payload,callback:B.callback,next:null},be===null?(he=be=ve,J=ke):be=be.next=ve,M|=Ae;if(B=B.next,B===null){if(B=y.shared.pending,B===null)break;ve=B,B=ve.next,ve.next=null,y.lastBaseUpdate=ve,y.shared.pending=null}}while(!0);be===null&&(J=ke),y.baseState=J,y.firstBaseUpdate=he,y.lastBaseUpdate=be,C===null&&(y.shared.lanes=0),Cr|=M,r.lanes=M,r.memoizedState=ke}}function cm(r,o){if(typeof r!="function")throw Error(n(191,r));r.call(o)}function um(r,o){var u=r.callbacks;if(u!==null)for(r.callbacks=null,r=0;r<u.length;r++)cm(u[r],o)}var Gs=z(null),xc=z(0);function dm(r,o){r=Yi,j(xc,r),j(Gs,o),Yi=r|o.baseLanes}function Ih(){j(xc,Yi),j(Gs,Gs.current)}function Dh(){Yi=xc.current,H(Gs),H(xc)}var Ga=z(null),Xa=null;function mr(r){var o=r.alternate;j(Fn,Fn.current&1),j(Ga,r),Xa===null&&(o===null||Gs.current!==null||o.memoizedState!==null)&&(Xa=r)}function _h(r){j(Fn,Fn.current),j(Ga,r),Xa===null&&(Xa=r)}function hm(r){r.tag===22?(j(Fn,Fn.current),j(Ga,r),Xa===null&&(Xa=r)):vr()}function vr(){j(Fn,Fn.current),j(Ga,Ga.current)}function La(r){H(Ga),Xa===r&&(Xa=null),H(Fn)}var Fn=z(0);function Pc(r){for(var o=r;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||FA(u)||UA(u)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Ki=0,Dt=null,An=null,On=null,Mc=!1,Ls=!1,ns=!1,Ic=0,tl=0,Bs=null,Ok=0;function Nn(){throw Error(n(321))}function Rh(r,o){if(o===null)return!1;for(var u=0;u<o.length&&u<r.length;u++)if(!Ra(r[u],o[u]))return!1;return!0}function Nh(r,o,u,g,y,C){return Ki=C,Dt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,F.H=r===null||r.memoizedState===null?Xm:Xh,ns=!1,C=u(g,y),ns=!1,Ls&&(C=gm(o,u,g,y)),Am(r),C}function Am(r){F.H=il;var o=An!==null&&An.next!==null;if(Ki=0,On=An=Dt=null,Mc=!1,tl=0,Bs=null,o)throw Error(n(300));r===null||Hn||(r=r.dependencies,r!==null&&bc(r)&&(Hn=!0))}function gm(r,o,u,g){Dt=r;var y=0;do{if(Ls&&(Bs=null),tl=0,Ls=!1,25<=y)throw Error(n(301));if(y+=1,On=An=null,r.updateQueue!=null){var C=r.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}F.H=Wm,C=o(u,g)}while(Ls);return C}function Hk(){var r=F.H,o=r.useState()[0];return o=typeof o.then=="function"?nl(o):o,r=r.useState()[0],(An!==null?An.memoizedState:null)!==r&&(Dt.flags|=1024),o}function Gh(){var r=Ic!==0;return Ic=0,r}function Lh(r,o,u){o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~u}function Bh(r){if(Mc){for(r=r.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Mc=!1}Ki=0,On=An=Dt=null,Ls=!1,tl=Ic=0,Bs=null}function va(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return On===null?Dt.memoizedState=On=r:On=On.next=r,On}function Un(){if(An===null){var r=Dt.alternate;r=r!==null?r.memoizedState:null}else r=An.next;var o=On===null?Dt.memoizedState:On.next;if(o!==null)On=o,An=r;else{if(r===null)throw Dt.alternate===null?Error(n(467)):Error(n(310));An=r,r={memoizedState:An.memoizedState,baseState:An.baseState,baseQueue:An.baseQueue,queue:An.queue,next:null},On===null?Dt.memoizedState=On=r:On=On.next=r}return On}function Dc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function nl(r){var o=tl;return tl+=1,Bs===null&&(Bs=[]),r=im(Bs,r,o),o=Dt,(On===null?o.memoizedState:On.next)===null&&(o=o.alternate,F.H=o===null||o.memoizedState===null?Xm:Xh),r}function _c(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return nl(r);if(r.$$typeof===P)return sa(r)}throw Error(n(438,String(r)))}function Fh(r){var o=null,u=Dt.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var g=Dt.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(o={data:g.data.map(function(y){return y.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=Dc(),Dt.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(r),g=0;g<r;g++)u[g]=L;return o.index++,u}function zi(r,o){return typeof o=="function"?o(r):o}function Rc(r){var o=Un();return Uh(o,An,r)}function Uh(r,o,u){var g=r.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=u;var y=r.baseQueue,C=g.pending;if(C!==null){if(y!==null){var M=y.next;y.next=C.next,C.next=M}o.baseQueue=y=C,g.pending=null}if(C=r.baseState,y===null)r.memoizedState=C;else{o=y.next;var B=M=null,J=null,he=o,be=!1;do{var ke=he.lane&-536870913;if(ke!==he.lane?(Ot&ke)===ke:(Ki&ke)===ke){var Ae=he.revertLane;if(Ae===0)J!==null&&(J=J.next={lane:0,revertLane:0,gesture:null,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),ke===Ds&&(be=!0);else if((Ki&Ae)===Ae){he=he.next,Ae===Ds&&(be=!0);continue}else ke={lane:0,revertLane:he.revertLane,gesture:null,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},J===null?(B=J=ke,M=C):J=J.next=ke,Dt.lanes|=Ae,Cr|=Ae;ke=he.action,ns&&u(C,ke),C=he.hasEagerState?he.eagerState:u(C,ke)}else Ae={lane:ke,revertLane:he.revertLane,gesture:he.gesture,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null},J===null?(B=J=Ae,M=C):J=J.next=Ae,Dt.lanes|=ke,Cr|=ke;he=he.next}while(he!==null&&he!==o);if(J===null?M=C:J.next=B,!Ra(C,r.memoizedState)&&(Hn=!0,be&&(u=_s,u!==null)))throw u;r.memoizedState=C,r.baseState=M,r.baseQueue=J,g.lastRenderedState=C}return y===null&&(g.lanes=0),[r.memoizedState,g.dispatch]}function Kh(r){var o=Un(),u=o.queue;if(u===null)throw Error(n(311));u.lastRenderedReducer=r;var g=u.dispatch,y=u.pending,C=o.memoizedState;if(y!==null){u.pending=null;var M=y=y.next;do C=r(C,M.action),M=M.next;while(M!==y);Ra(C,o.memoizedState)||(Hn=!0),o.memoizedState=C,o.baseQueue===null&&(o.baseState=C),u.lastRenderedState=C}return[C,g]}function fm(r,o,u){var g=Dt,y=Un(),C=Vt;if(C){if(u===void 0)throw Error(n(407));u=u()}else u=o();var M=!Ra((An||y).memoizedState,u);if(M&&(y.memoizedState=u,Hn=!0),y=y.queue,Hh(vm.bind(null,g,y,r),[r]),y.getSnapshot!==o||M||On!==null&&On.memoizedState.tag&1){if(g.flags|=2048,Fs(9,{destroy:void 0},mm.bind(null,g,y,u,o),null),Cn===null)throw Error(n(349));C||(Ki&127)!==0||pm(g,o,u)}return u}function pm(r,o,u){r.flags|=16384,r={getSnapshot:o,value:u},o=Dt.updateQueue,o===null?(o=Dc(),Dt.updateQueue=o,o.stores=[r]):(u=o.stores,u===null?o.stores=[r]:u.push(r))}function mm(r,o,u,g){o.value=u,o.getSnapshot=g,ym(o)&&bm(r)}function vm(r,o,u){return u(function(){ym(o)&&bm(r)})}function ym(r){var o=r.getSnapshot;r=r.value;try{var u=o();return!Ra(r,u)}catch{return!0}}function bm(r){var o=qr(r,2);o!==null&&Ma(o,r,2)}function zh(r){var o=va();if(typeof r=="function"){var u=r;if(r=u(),ns){Bt(!0);try{u()}finally{Bt(!1)}}}return o.memoizedState=o.baseState=r,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:r},o}function Cm(r,o,u,g){return r.baseState=u,Uh(r,An,typeof g=="function"?g:zi)}function Vk(r,o,u,g,y){if(Lc(r))throw Error(n(485));if(r=o.action,r!==null){var C={payload:y,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(M){C.listeners.push(M)}};F.T!==null?u(!0):C.isTransition=!1,g(C),u=o.pending,u===null?(C.next=o.pending=C,Sm(o,C)):(C.next=u.next,o.pending=u.next=C)}}function Sm(r,o){var u=o.action,g=o.payload,y=r.state;if(o.isTransition){var C=F.T,M={};F.T=M;try{var B=u(y,g),J=F.S;J!==null&&J(M,B),wm(r,o,B)}catch(he){Oh(r,o,he)}finally{C!==null&&M.types!==null&&(C.types=M.types),F.T=C}}else try{C=u(y,g),wm(r,o,C)}catch(he){Oh(r,o,he)}}function wm(r,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(g){Tm(r,o,g)},function(g){return Oh(r,o,g)}):Tm(r,o,u)}function Tm(r,o,u){o.status="fulfilled",o.value=u,km(o),r.state=u,o=r.pending,o!==null&&(u=o.next,u===o?r.pending=null:(u=u.next,o.next=u,Sm(r,u)))}function Oh(r,o,u){var g=r.pending;if(r.pending=null,g!==null){g=g.next;do o.status="rejected",o.reason=u,km(o),o=o.next;while(o!==g)}r.action=null}function km(r){r=r.listeners;for(var o=0;o<r.length;o++)(0,r[o])()}function Em(r,o){return o}function xm(r,o){if(Vt){var u=Cn.formState;if(u!==null){e:{var g=Dt;if(Vt){if(Tn){t:{for(var y=Tn,C=Ya;y.nodeType!==8;){if(!C){y=null;break t}if(y=Wa(y.nextSibling),y===null){y=null;break t}}C=y.data,y=C==="F!"||C==="F"?y:null}if(y){Tn=Wa(y.nextSibling),g=y.data==="F!";break e}}hr(g)}g=!1}g&&(o=u[0])}}return u=va(),u.memoizedState=u.baseState=o,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Em,lastRenderedState:o},u.queue=g,u=Qm.bind(null,Dt,g),g.dispatch=u,g=zh(!1),C=Yh.bind(null,Dt,!1,g.queue),g=va(),y={state:o,dispatch:null,action:r,pending:null},g.queue=y,u=Vk.bind(null,Dt,y,C,u),y.dispatch=u,g.memoizedState=r,[o,u,!1]}function Pm(r){var o=Un();return Mm(o,An,r)}function Mm(r,o,u){if(o=Uh(r,o,Em)[0],r=Rc(zi)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var g=nl(o)}catch(M){throw M===Rs?wc:M}else g=o;o=Un();var y=o.queue,C=y.dispatch;return u!==o.memoizedState&&(Dt.flags|=2048,Fs(9,{destroy:void 0},jk.bind(null,y,u),null)),[g,C,r]}function jk(r,o){r.action=o}function Im(r){var o=Un(),u=An;if(u!==null)return Mm(o,u,r);Un(),o=o.memoizedState,u=Un();var g=u.queue.dispatch;return u.memoizedState=r,[o,g,!1]}function Fs(r,o,u,g){return r={tag:r,create:u,deps:g,inst:o,next:null},o=Dt.updateQueue,o===null&&(o=Dc(),Dt.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=r.next=r:(g=u.next,u.next=r,r.next=g,o.lastEffect=r),r}function Dm(){return Un().memoizedState}function Nc(r,o,u,g){var y=va();Dt.flags|=r,y.memoizedState=Fs(1|o,{destroy:void 0},u,g===void 0?null:g)}function Gc(r,o,u,g){var y=Un();g=g===void 0?null:g;var C=y.memoizedState.inst;An!==null&&g!==null&&Rh(g,An.memoizedState.deps)?y.memoizedState=Fs(o,C,u,g):(Dt.flags|=r,y.memoizedState=Fs(1|o,C,u,g))}function _m(r,o){Nc(8390656,8,r,o)}function Hh(r,o){Gc(2048,8,r,o)}function Qk(r){Dt.flags|=4;var o=Dt.updateQueue;if(o===null)o=Dc(),Dt.updateQueue=o,o.events=[r];else{var u=o.events;u===null?o.events=[r]:u.push(r)}}function Rm(r){var o=Un().memoizedState;return Qk({ref:o,nextImpl:r}),function(){if((nn&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function Nm(r,o){return Gc(4,2,r,o)}function Gm(r,o){return Gc(4,4,r,o)}function Lm(r,o){if(typeof o=="function"){r=r();var u=o(r);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function Bm(r,o,u){u=u!=null?u.concat([r]):null,Gc(4,4,Lm.bind(null,o,r),u)}function Vh(){}function Fm(r,o){var u=Un();o=o===void 0?null:o;var g=u.memoizedState;return o!==null&&Rh(o,g[1])?g[0]:(u.memoizedState=[r,o],r)}function Um(r,o){var u=Un();o=o===void 0?null:o;var g=u.memoizedState;if(o!==null&&Rh(o,g[1]))return g[0];if(g=r(),ns){Bt(!0);try{r()}finally{Bt(!1)}}return u.memoizedState=[g,o],g}function jh(r,o,u){return u===void 0||(Ki&1073741824)!==0&&(Ot&261930)===0?r.memoizedState=o:(r.memoizedState=u,r=Kv(),Dt.lanes|=r,Cr|=r,u)}function Km(r,o,u,g){return Ra(u,o)?u:Gs.current!==null?(r=jh(r,u,g),Ra(r,o)||(Hn=!0),r):(Ki&42)===0||(Ki&1073741824)!==0&&(Ot&261930)===0?(Hn=!0,r.memoizedState=u):(r=Kv(),Dt.lanes|=r,Cr|=r,o)}function zm(r,o,u,g,y){var C=U.p;U.p=C!==0&&8>C?C:8;var M=F.T,B={};F.T=B,Yh(r,!1,o,u);try{var J=y(),he=F.S;if(he!==null&&he(B,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var be=zk(J,g);al(r,o,be,Ua(r))}else al(r,o,g,Ua(r))}catch(ke){al(r,o,{then:function(){},status:"rejected",reason:ke},Ua())}finally{U.p=C,M!==null&&B.types!==null&&(M.types=B.types),F.T=M}}function qk(){}function Qh(r,o,u,g){if(r.tag!==5)throw Error(n(476));var y=Om(r).queue;zm(r,y,o,Y,u===null?qk:function(){return Hm(r),u(g)})}function Om(r){var o=r.memoizedState;if(o!==null)return o;o={memoizedState:Y,baseState:Y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:Y},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:zi,lastRenderedState:u},next:null},r.memoizedState=o,r=r.alternate,r!==null&&(r.memoizedState=o),o}function Hm(r){var o=Om(r);o.next===null&&(o=r.alternate.memoizedState),al(r,o.next.queue,{},Ua())}function qh(){return sa(bl)}function Vm(){return Un().memoizedState}function jm(){return Un().memoizedState}function Yk(r){for(var o=r.return;o!==null;){switch(o.tag){case 24:case 3:var u=Ua();r=fr(u);var g=pr(o,r,u);g!==null&&(Ma(g,o,u),Jo(g,o,u)),o={cache:Sh()},r.payload=o;return}o=o.return}}function Xk(r,o,u){var g=Ua();u={lane:g,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Lc(r)?qm(o,u):(u=dh(r,o,u,g),u!==null&&(Ma(u,r,g),Ym(u,o,g)))}function Qm(r,o,u){var g=Ua();al(r,o,u,g)}function al(r,o,u,g){var y={lane:g,revertLane:0,gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null};if(Lc(r))qm(o,y);else{var C=r.alternate;if(r.lanes===0&&(C===null||C.lanes===0)&&(C=o.lastRenderedReducer,C!==null))try{var M=o.lastRenderedState,B=C(M,u);if(y.hasEagerState=!0,y.eagerState=B,Ra(B,M))return pc(r,o,y,0),Cn===null&&fc(),!1}catch{}if(u=dh(r,o,y,g),u!==null)return Ma(u,r,g),Ym(u,o,g),!0}return!1}function Yh(r,o,u,g){if(g={lane:2,revertLane:EA(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Lc(r)){if(o)throw Error(n(479))}else o=dh(r,u,g,2),o!==null&&Ma(o,r,2)}function Lc(r){var o=r.alternate;return r===Dt||o!==null&&o===Dt}function qm(r,o){Ls=Mc=!0;var u=r.pending;u===null?o.next=o:(o.next=u.next,u.next=o),r.pending=o}function Ym(r,o,u){if((u&4194048)!==0){var g=o.lanes;g&=r.pendingLanes,u|=g,o.lanes=u,xe(r,u)}}var il={readContext:sa,use:_c,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useLayoutEffect:Nn,useInsertionEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useSyncExternalStore:Nn,useId:Nn,useHostTransitionStatus:Nn,useFormState:Nn,useActionState:Nn,useOptimistic:Nn,useMemoCache:Nn,useCacheRefresh:Nn};il.useEffectEvent=Nn;var Xm={readContext:sa,use:_c,useCallback:function(r,o){return va().memoizedState=[r,o===void 0?null:o],r},useContext:sa,useEffect:_m,useImperativeHandle:function(r,o,u){u=u!=null?u.concat([r]):null,Nc(4194308,4,Lm.bind(null,o,r),u)},useLayoutEffect:function(r,o){return Nc(4194308,4,r,o)},useInsertionEffect:function(r,o){Nc(4,2,r,o)},useMemo:function(r,o){var u=va();o=o===void 0?null:o;var g=r();if(ns){Bt(!0);try{r()}finally{Bt(!1)}}return u.memoizedState=[g,o],g},useReducer:function(r,o,u){var g=va();if(u!==void 0){var y=u(o);if(ns){Bt(!0);try{u(o)}finally{Bt(!1)}}}else y=o;return g.memoizedState=g.baseState=y,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:y},g.queue=r,r=r.dispatch=Xk.bind(null,Dt,r),[g.memoizedState,r]},useRef:function(r){var o=va();return r={current:r},o.memoizedState=r},useState:function(r){r=zh(r);var o=r.queue,u=Qm.bind(null,Dt,o);return o.dispatch=u,[r.memoizedState,u]},useDebugValue:Vh,useDeferredValue:function(r,o){var u=va();return jh(u,r,o)},useTransition:function(){var r=zh(!1);return r=zm.bind(null,Dt,r.queue,!0,!1),va().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,o,u){var g=Dt,y=va();if(Vt){if(u===void 0)throw Error(n(407));u=u()}else{if(u=o(),Cn===null)throw Error(n(349));(Ot&127)!==0||pm(g,o,u)}y.memoizedState=u;var C={value:u,getSnapshot:o};return y.queue=C,_m(vm.bind(null,g,C,r),[r]),g.flags|=2048,Fs(9,{destroy:void 0},mm.bind(null,g,C,u,o),null),u},useId:function(){var r=va(),o=Cn.identifierPrefix;if(Vt){var u=vi,g=mi;u=(g&~(1<<32-Ce(g)-1)).toString(32)+u,o="_"+o+"R_"+u,u=Ic++,0<u&&(o+="H"+u.toString(32)),o+="_"}else u=Ok++,o="_"+o+"r_"+u.toString(32)+"_";return r.memoizedState=o},useHostTransitionStatus:qh,useFormState:xm,useActionState:xm,useOptimistic:function(r){var o=va();o.memoizedState=o.baseState=r;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=Yh.bind(null,Dt,!0,u),u.dispatch=o,[r,o]},useMemoCache:Fh,useCacheRefresh:function(){return va().memoizedState=Yk.bind(null,Dt)},useEffectEvent:function(r){var o=va(),u={impl:r};return o.memoizedState=u,function(){if((nn&2)!==0)throw Error(n(440));return u.impl.apply(void 0,arguments)}}},Xh={readContext:sa,use:_c,useCallback:Fm,useContext:sa,useEffect:Hh,useImperativeHandle:Bm,useInsertionEffect:Nm,useLayoutEffect:Gm,useMemo:Um,useReducer:Rc,useRef:Dm,useState:function(){return Rc(zi)},useDebugValue:Vh,useDeferredValue:function(r,o){var u=Un();return Km(u,An.memoizedState,r,o)},useTransition:function(){var r=Rc(zi)[0],o=Un().memoizedState;return[typeof r=="boolean"?r:nl(r),o]},useSyncExternalStore:fm,useId:Vm,useHostTransitionStatus:qh,useFormState:Pm,useActionState:Pm,useOptimistic:function(r,o){var u=Un();return Cm(u,An,r,o)},useMemoCache:Fh,useCacheRefresh:jm};Xh.useEffectEvent=Rm;var Wm={readContext:sa,use:_c,useCallback:Fm,useContext:sa,useEffect:Hh,useImperativeHandle:Bm,useInsertionEffect:Nm,useLayoutEffect:Gm,useMemo:Um,useReducer:Kh,useRef:Dm,useState:function(){return Kh(zi)},useDebugValue:Vh,useDeferredValue:function(r,o){var u=Un();return An===null?jh(u,r,o):Km(u,An.memoizedState,r,o)},useTransition:function(){var r=Kh(zi)[0],o=Un().memoizedState;return[typeof r=="boolean"?r:nl(r),o]},useSyncExternalStore:fm,useId:Vm,useHostTransitionStatus:qh,useFormState:Im,useActionState:Im,useOptimistic:function(r,o){var u=Un();return An!==null?Cm(u,An,r,o):(u.baseState=r,[r,u.queue.dispatch])},useMemoCache:Fh,useCacheRefresh:jm};Wm.useEffectEvent=Rm;function Wh(r,o,u,g){o=r.memoizedState,u=u(g,o),u=u==null?o:f({},o,u),r.memoizedState=u,r.lanes===0&&(r.updateQueue.baseState=u)}var $h={enqueueSetState:function(r,o,u){r=r._reactInternals;var g=Ua(),y=fr(g);y.payload=o,u!=null&&(y.callback=u),o=pr(r,y,g),o!==null&&(Ma(o,r,g),Jo(o,r,g))},enqueueReplaceState:function(r,o,u){r=r._reactInternals;var g=Ua(),y=fr(g);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=pr(r,y,g),o!==null&&(Ma(o,r,g),Jo(o,r,g))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var u=Ua(),g=fr(u);g.tag=2,o!=null&&(g.callback=o),o=pr(r,g,u),o!==null&&(Ma(o,r,u),Jo(o,r,u))}};function $m(r,o,u,g,y,C,M){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(g,C,M):o.prototype&&o.prototype.isPureReactComponent?!Vo(u,g)||!Vo(y,C):!0}function Jm(r,o,u,g){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,g),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,g),o.state!==r&&$h.enqueueReplaceState(o,o.state,null)}function as(r,o){var u=o;if("ref"in o){u={};for(var g in o)g!=="ref"&&(u[g]=o[g])}if(r=r.defaultProps){u===o&&(u=f({},u));for(var y in r)u[y]===void 0&&(u[y]=r[y])}return u}function Zm(r){gc(r)}function ev(r){console.error(r)}function tv(r){gc(r)}function Bc(r,o){try{var u=r.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(g){setTimeout(function(){throw g})}}function nv(r,o,u){try{var g=r.onCaughtError;g(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function Jh(r,o,u){return u=fr(u),u.tag=3,u.payload={element:null},u.callback=function(){Bc(r,o)},u}function av(r){return r=fr(r),r.tag=3,r}function iv(r,o,u,g){var y=u.type.getDerivedStateFromError;if(typeof y=="function"){var C=g.value;r.payload=function(){return y(C)},r.callback=function(){nv(o,u,g)}}var M=u.stateNode;M!==null&&typeof M.componentDidCatch=="function"&&(r.callback=function(){nv(o,u,g),typeof y!="function"&&(Sr===null?Sr=new Set([this]):Sr.add(this));var B=g.stack;this.componentDidCatch(g.value,{componentStack:B!==null?B:""})})}function Wk(r,o,u,g,y){if(u.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(o=u.alternate,o!==null&&Is(o,u,y,!0),u=Ga.current,u!==null){switch(u.tag){case 31:case 13:return Xa===null?Xc():u.alternate===null&&Gn===0&&(Gn=3),u.flags&=-257,u.flags|=65536,u.lanes=y,g===Tc?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([g]):o.add(g),wA(r,g,y)),!1;case 22:return u.flags|=65536,g===Tc?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([g])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([g]):u.add(g)),wA(r,g,y)),!1}throw Error(n(435,u.tag))}return wA(r,g,y),Xc(),!1}if(Vt)return o=Ga.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=y,g!==mh&&(r=Error(n(422),{cause:g}),qo(ja(r,u)))):(g!==mh&&(o=Error(n(423),{cause:g}),qo(ja(o,u))),r=r.current.alternate,r.flags|=65536,y&=-y,r.lanes|=y,g=ja(g,u),y=Jh(r.stateNode,g,y),Ph(r,y),Gn!==4&&(Gn=2)),!1;var C=Error(n(520),{cause:g});if(C=ja(C,u),hl===null?hl=[C]:hl.push(C),Gn!==4&&(Gn=2),o===null)return!0;g=ja(g,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,r=y&-y,u.lanes|=r,r=Jh(u.stateNode,g,r),Ph(u,r),!1;case 1:if(o=u.type,C=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(Sr===null||!Sr.has(C))))return u.flags|=65536,y&=-y,u.lanes|=y,y=av(y),iv(y,r,u,g),Ph(u,y),!1}u=u.return}while(u!==null);return!1}var Zh=Error(n(461)),Hn=!1;function oa(r,o,u,g){o.child=r===null?lm(o,null,u,g):ts(o,r.child,u,g)}function rv(r,o,u,g,y){u=u.render;var C=o.ref;if("ref"in g){var M={};for(var B in g)B!=="ref"&&(M[B]=g[B])}else M=g;return $r(o),g=Nh(r,o,u,M,C,y),B=Gh(),r!==null&&!Hn?(Lh(r,o,y),Oi(r,o,y)):(Vt&&B&&fh(o),o.flags|=1,oa(r,o,g,y),o.child)}function sv(r,o,u,g,y){if(r===null){var C=u.type;return typeof C=="function"&&!hh(C)&&C.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=C,ov(r,o,C,g,y)):(r=vc(u.type,null,g,o,o.mode,y),r.ref=o.ref,r.return=o,o.child=r)}if(C=r.child,!oA(r,y)){var M=C.memoizedProps;if(u=u.compare,u=u!==null?u:Vo,u(M,g)&&r.ref===o.ref)return Oi(r,o,y)}return o.flags|=1,r=Li(C,g),r.ref=o.ref,r.return=o,o.child=r}function ov(r,o,u,g,y){if(r!==null){var C=r.memoizedProps;if(Vo(C,g)&&r.ref===o.ref)if(Hn=!1,o.pendingProps=g=C,oA(r,y))(r.flags&131072)!==0&&(Hn=!0);else return o.lanes=r.lanes,Oi(r,o,y)}return eA(r,o,u,g,y)}function lv(r,o,u,g){var y=g.children,C=r!==null?r.memoizedState:null;if(r===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((o.flags&128)!==0){if(C=C!==null?C.baseLanes|u:u,r!==null){for(g=o.child=r.child,y=0;g!==null;)y=y|g.lanes|g.childLanes,g=g.sibling;g=y&~C}else g=0,o.child=null;return cv(r,o,C,u,g)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},r!==null&&Sc(o,C!==null?C.cachePool:null),C!==null?dm(o,C):Ih(),hm(o);else return g=o.lanes=536870912,cv(r,o,C!==null?C.baseLanes|u:u,u,g)}else C!==null?(Sc(o,C.cachePool),dm(o,C),vr(),o.memoizedState=null):(r!==null&&Sc(o,null),Ih(),vr());return oa(r,o,y,u),o.child}function rl(r,o){return r!==null&&r.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function cv(r,o,u,g,y){var C=Th();return C=C===null?null:{parent:zn._currentValue,pool:C},o.memoizedState={baseLanes:u,cachePool:C},r!==null&&Sc(o,null),Ih(),hm(o),r!==null&&Is(r,o,g,!0),o.childLanes=y,null}function Fc(r,o){return o=Kc({mode:o.mode,children:o.children},r.mode),o.ref=r.ref,r.child=o,o.return=r,o}function uv(r,o,u){return ts(o,r.child,null,u),r=Fc(o,o.pendingProps),r.flags|=2,La(o),o.memoizedState=null,r}function $k(r,o,u){var g=o.pendingProps,y=(o.flags&128)!==0;if(o.flags&=-129,r===null){if(Vt){if(g.mode==="hidden")return r=Fc(o,g),o.lanes=536870912,rl(null,r);if(_h(o),(r=Tn)?(r=Sy(r,Ya),r=r!==null&&r.data==="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:ur!==null?{id:mi,overflow:vi}:null,retryLane:536870912,hydrationErrors:null},u=qp(r),u.return=o,o.child=u,ra=o,Tn=null)):r=null,r===null)throw hr(o);return o.lanes=536870912,null}return Fc(o,g)}var C=r.memoizedState;if(C!==null){var M=C.dehydrated;if(_h(o),y)if(o.flags&256)o.flags&=-257,o=uv(r,o,u);else if(o.memoizedState!==null)o.child=r.child,o.flags|=128,o=null;else throw Error(n(558));else if(Hn||Is(r,o,u,!1),y=(u&r.childLanes)!==0,Hn||y){if(g=Cn,g!==null&&(M=Fe(g,u),M!==0&&M!==C.retryLane))throw C.retryLane=M,qr(r,M),Ma(g,r,M),Zh;Xc(),o=uv(r,o,u)}else r=C.treeContext,Tn=Wa(M.nextSibling),ra=o,Vt=!0,dr=null,Ya=!1,r!==null&&Wp(o,r),o=Fc(o,g),o.flags|=4096;return o}return r=Li(r.child,{mode:g.mode,children:g.children}),r.ref=o.ref,o.child=r,r.return=o,r}function Uc(r,o){var u=o.ref;if(u===null)r!==null&&r.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(n(284));(r===null||r.ref!==u)&&(o.flags|=4194816)}}function eA(r,o,u,g,y){return $r(o),u=Nh(r,o,u,g,void 0,y),g=Gh(),r!==null&&!Hn?(Lh(r,o,y),Oi(r,o,y)):(Vt&&g&&fh(o),o.flags|=1,oa(r,o,u,y),o.child)}function dv(r,o,u,g,y,C){return $r(o),o.updateQueue=null,u=gm(o,g,u,y),Am(r),g=Gh(),r!==null&&!Hn?(Lh(r,o,C),Oi(r,o,C)):(Vt&&g&&fh(o),o.flags|=1,oa(r,o,u,C),o.child)}function hv(r,o,u,g,y){if($r(o),o.stateNode===null){var C=Es,M=u.contextType;typeof M=="object"&&M!==null&&(C=sa(M)),C=new u(g,C),o.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=$h,o.stateNode=C,C._reactInternals=o,C=o.stateNode,C.props=g,C.state=o.memoizedState,C.refs={},Eh(o),M=u.contextType,C.context=typeof M=="object"&&M!==null?sa(M):Es,C.state=o.memoizedState,M=u.getDerivedStateFromProps,typeof M=="function"&&(Wh(o,u,M,g),C.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(M=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),M!==C.state&&$h.enqueueReplaceState(C,C.state,null),el(o,g,C,y),Zo(),C.state=o.memoizedState),typeof C.componentDidMount=="function"&&(o.flags|=4194308),g=!0}else if(r===null){C=o.stateNode;var B=o.memoizedProps,J=as(u,B);C.props=J;var he=C.context,be=u.contextType;M=Es,typeof be=="object"&&be!==null&&(M=sa(be));var ke=u.getDerivedStateFromProps;be=typeof ke=="function"||typeof C.getSnapshotBeforeUpdate=="function",B=o.pendingProps!==B,be||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(B||he!==M)&&Jm(o,C,g,M),gr=!1;var Ae=o.memoizedState;C.state=Ae,el(o,g,C,y),Zo(),he=o.memoizedState,B||Ae!==he||gr?(typeof ke=="function"&&(Wh(o,u,ke,g),he=o.memoizedState),(J=gr||$m(o,u,J,g,Ae,he,M))?(be||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(o.flags|=4194308)):(typeof C.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=g,o.memoizedState=he),C.props=g,C.state=he,C.context=M,g=J):(typeof C.componentDidMount=="function"&&(o.flags|=4194308),g=!1)}else{C=o.stateNode,xh(r,o),M=o.memoizedProps,be=as(u,M),C.props=be,ke=o.pendingProps,Ae=C.context,he=u.contextType,J=Es,typeof he=="object"&&he!==null&&(J=sa(he)),B=u.getDerivedStateFromProps,(he=typeof B=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(M!==ke||Ae!==J)&&Jm(o,C,g,J),gr=!1,Ae=o.memoizedState,C.state=Ae,el(o,g,C,y),Zo();var ve=o.memoizedState;M!==ke||Ae!==ve||gr||r!==null&&r.dependencies!==null&&bc(r.dependencies)?(typeof B=="function"&&(Wh(o,u,B,g),ve=o.memoizedState),(be=gr||$m(o,u,be,g,Ae,ve,J)||r!==null&&r.dependencies!==null&&bc(r.dependencies))?(he||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(g,ve,J),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(g,ve,J)),typeof C.componentDidUpdate=="function"&&(o.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof C.componentDidUpdate!="function"||M===r.memoizedProps&&Ae===r.memoizedState||(o.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||M===r.memoizedProps&&Ae===r.memoizedState||(o.flags|=1024),o.memoizedProps=g,o.memoizedState=ve),C.props=g,C.state=ve,C.context=J,g=be):(typeof C.componentDidUpdate!="function"||M===r.memoizedProps&&Ae===r.memoizedState||(o.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||M===r.memoizedProps&&Ae===r.memoizedState||(o.flags|=1024),g=!1)}return C=g,Uc(r,o),g=(o.flags&128)!==0,C||g?(C=o.stateNode,u=g&&typeof u.getDerivedStateFromError!="function"?null:C.render(),o.flags|=1,r!==null&&g?(o.child=ts(o,r.child,null,y),o.child=ts(o,null,u,y)):oa(r,o,u,y),o.memoizedState=C.state,r=o.child):r=Oi(r,o,y),r}function Av(r,o,u,g){return Xr(),o.flags|=256,oa(r,o,u,g),o.child}var tA={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function nA(r){return{baseLanes:r,cachePool:nm()}}function aA(r,o,u){return r=r!==null?r.childLanes&~u:0,o&&(r|=Fa),r}function gv(r,o,u){var g=o.pendingProps,y=!1,C=(o.flags&128)!==0,M;if((M=C)||(M=r!==null&&r.memoizedState===null?!1:(Fn.current&2)!==0),M&&(y=!0,o.flags&=-129),M=(o.flags&32)!==0,o.flags&=-33,r===null){if(Vt){if(y?mr(o):vr(),(r=Tn)?(r=Sy(r,Ya),r=r!==null&&r.data!=="&"?r:null,r!==null&&(o.memoizedState={dehydrated:r,treeContext:ur!==null?{id:mi,overflow:vi}:null,retryLane:536870912,hydrationErrors:null},u=qp(r),u.return=o,o.child=u,ra=o,Tn=null)):r=null,r===null)throw hr(o);return UA(r)?o.lanes=32:o.lanes=536870912,null}var B=g.children;return g=g.fallback,y?(vr(),y=o.mode,B=Kc({mode:"hidden",children:B},y),g=Yr(g,y,u,null),B.return=o,g.return=o,B.sibling=g,o.child=B,g=o.child,g.memoizedState=nA(u),g.childLanes=aA(r,M,u),o.memoizedState=tA,rl(null,g)):(mr(o),iA(o,B))}var J=r.memoizedState;if(J!==null&&(B=J.dehydrated,B!==null)){if(C)o.flags&256?(mr(o),o.flags&=-257,o=rA(r,o,u)):o.memoizedState!==null?(vr(),o.child=r.child,o.flags|=128,o=null):(vr(),B=g.fallback,y=o.mode,g=Kc({mode:"visible",children:g.children},y),B=Yr(B,y,u,null),B.flags|=2,g.return=o,B.return=o,g.sibling=B,o.child=g,ts(o,r.child,null,u),g=o.child,g.memoizedState=nA(u),g.childLanes=aA(r,M,u),o.memoizedState=tA,o=rl(null,g));else if(mr(o),UA(B)){if(M=B.nextSibling&&B.nextSibling.dataset,M)var he=M.dgst;M=he,g=Error(n(419)),g.stack="",g.digest=M,qo({value:g,source:null,stack:null}),o=rA(r,o,u)}else if(Hn||Is(r,o,u,!1),M=(u&r.childLanes)!==0,Hn||M){if(M=Cn,M!==null&&(g=Fe(M,u),g!==0&&g!==J.retryLane))throw J.retryLane=g,qr(r,g),Ma(M,r,g),Zh;FA(B)||Xc(),o=rA(r,o,u)}else FA(B)?(o.flags|=192,o.child=r.child,o=null):(r=J.treeContext,Tn=Wa(B.nextSibling),ra=o,Vt=!0,dr=null,Ya=!1,r!==null&&Wp(o,r),o=iA(o,g.children),o.flags|=4096);return o}return y?(vr(),B=g.fallback,y=o.mode,J=r.child,he=J.sibling,g=Li(J,{mode:"hidden",children:g.children}),g.subtreeFlags=J.subtreeFlags&65011712,he!==null?B=Li(he,B):(B=Yr(B,y,u,null),B.flags|=2),B.return=o,g.return=o,g.sibling=B,o.child=g,rl(null,g),g=o.child,B=r.child.memoizedState,B===null?B=nA(u):(y=B.cachePool,y!==null?(J=zn._currentValue,y=y.parent!==J?{parent:J,pool:J}:y):y=nm(),B={baseLanes:B.baseLanes|u,cachePool:y}),g.memoizedState=B,g.childLanes=aA(r,M,u),o.memoizedState=tA,rl(r.child,g)):(mr(o),u=r.child,r=u.sibling,u=Li(u,{mode:"visible",children:g.children}),u.return=o,u.sibling=null,r!==null&&(M=o.deletions,M===null?(o.deletions=[r],o.flags|=16):M.push(r)),o.child=u,o.memoizedState=null,u)}function iA(r,o){return o=Kc({mode:"visible",children:o},r.mode),o.return=r,r.child=o}function Kc(r,o){return r=Na(22,r,null,o),r.lanes=0,r}function rA(r,o,u){return ts(o,r.child,null,u),r=iA(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function fv(r,o,u){r.lanes|=o;var g=r.alternate;g!==null&&(g.lanes|=o),bh(r.return,o,u)}function sA(r,o,u,g,y,C){var M=r.memoizedState;M===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:g,tail:u,tailMode:y,treeForkCount:C}:(M.isBackwards=o,M.rendering=null,M.renderingStartTime=0,M.last=g,M.tail=u,M.tailMode=y,M.treeForkCount=C)}function pv(r,o,u){var g=o.pendingProps,y=g.revealOrder,C=g.tail;g=g.children;var M=Fn.current,B=(M&2)!==0;if(B?(M=M&1|2,o.flags|=128):M&=1,j(Fn,M),oa(r,o,g,u),g=Vt?Qo:0,!B&&r!==null&&(r.flags&128)!==0)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&fv(r,u,o);else if(r.tag===19)fv(r,u,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(y){case"forwards":for(u=o.child,y=null;u!==null;)r=u.alternate,r!==null&&Pc(r)===null&&(y=u),u=u.sibling;u=y,u===null?(y=o.child,o.child=null):(y=u.sibling,u.sibling=null),sA(o,!1,y,u,C,g);break;case"backwards":case"unstable_legacy-backwards":for(u=null,y=o.child,o.child=null;y!==null;){if(r=y.alternate,r!==null&&Pc(r)===null){o.child=y;break}r=y.sibling,y.sibling=u,u=y,y=r}sA(o,!0,u,null,C,g);break;case"together":sA(o,!1,null,null,void 0,g);break;default:o.memoizedState=null}return o.child}function Oi(r,o,u){if(r!==null&&(o.dependencies=r.dependencies),Cr|=o.lanes,(u&o.childLanes)===0)if(r!==null){if(Is(r,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,u=Li(r,r.pendingProps),o.child=u,u.return=o;r.sibling!==null;)r=r.sibling,u=u.sibling=Li(r,r.pendingProps),u.return=o;u.sibling=null}return o.child}function oA(r,o){return(r.lanes&o)!==0?!0:(r=r.dependencies,!!(r!==null&&bc(r)))}function Jk(r,o,u){switch(o.tag){case 3:Ge(o,o.stateNode.containerInfo),Ar(o,zn,r.memoizedState.cache),Xr();break;case 27:case 5:Le(o);break;case 4:Ge(o,o.stateNode.containerInfo);break;case 10:Ar(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,_h(o),null;break;case 13:var g=o.memoizedState;if(g!==null)return g.dehydrated!==null?(mr(o),o.flags|=128,null):(u&o.child.childLanes)!==0?gv(r,o,u):(mr(o),r=Oi(r,o,u),r!==null?r.sibling:null);mr(o);break;case 19:var y=(r.flags&128)!==0;if(g=(u&o.childLanes)!==0,g||(Is(r,o,u,!1),g=(u&o.childLanes)!==0),y){if(g)return pv(r,o,u);o.flags|=128}if(y=o.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),j(Fn,Fn.current),g)break;return null;case 22:return o.lanes=0,lv(r,o,u,o.pendingProps);case 24:Ar(o,zn,r.memoizedState.cache)}return Oi(r,o,u)}function mv(r,o,u){if(r!==null)if(r.memoizedProps!==o.pendingProps)Hn=!0;else{if(!oA(r,u)&&(o.flags&128)===0)return Hn=!1,Jk(r,o,u);Hn=(r.flags&131072)!==0}else Hn=!1,Vt&&(o.flags&1048576)!==0&&Xp(o,Qo,o.index);switch(o.lanes=0,o.tag){case 16:e:{var g=o.pendingProps;if(r=Zr(o.elementType),o.type=r,typeof r=="function")hh(r)?(g=as(r,g),o.tag=1,o=hv(null,o,r,g,u)):(o.tag=0,o=eA(null,o,r,g,u));else{if(r!=null){var y=r.$$typeof;if(y===R){o.tag=11,o=rv(null,o,r,g,u);break e}else if(y===_){o.tag=14,o=sv(null,o,r,g,u);break e}}throw o=Q(r)||r,Error(n(306,o,""))}}return o;case 0:return eA(r,o,o.type,o.pendingProps,u);case 1:return g=o.type,y=as(g,o.pendingProps),hv(r,o,g,y,u);case 3:e:{if(Ge(o,o.stateNode.containerInfo),r===null)throw Error(n(387));g=o.pendingProps;var C=o.memoizedState;y=C.element,xh(r,o),el(o,g,null,u);var M=o.memoizedState;if(g=M.cache,Ar(o,zn,g),g!==C.cache&&Ch(o,[zn],u,!0),Zo(),g=M.element,C.isDehydrated)if(C={element:g,isDehydrated:!1,cache:M.cache},o.updateQueue.baseState=C,o.memoizedState=C,o.flags&256){o=Av(r,o,g,u);break e}else if(g!==y){y=ja(Error(n(424)),o),qo(y),o=Av(r,o,g,u);break e}else for(r=o.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,Tn=Wa(r.firstChild),ra=o,Vt=!0,dr=null,Ya=!0,u=lm(o,null,g,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Xr(),g===y){o=Oi(r,o,u);break e}oa(r,o,g,u)}o=o.child}return o;case 26:return Uc(r,o),r===null?(u=Py(o.type,null,o.pendingProps,null))?o.memoizedState=u:Vt||(u=o.type,r=o.pendingProps,g=nu(oe.current).createElement(u),g[Ne]=o,g[Je]=r,la(g,u,r),Nt(g),o.stateNode=g):o.memoizedState=Py(o.type,r.memoizedProps,o.pendingProps,r.memoizedState),null;case 27:return Le(o),r===null&&Vt&&(g=o.stateNode=ky(o.type,o.pendingProps,oe.current),ra=o,Ya=!0,y=Tn,Er(o.type)?(KA=y,Tn=Wa(g.firstChild)):Tn=y),oa(r,o,o.pendingProps.children,u),Uc(r,o),r===null&&(o.flags|=4194304),o.child;case 5:return r===null&&Vt&&((y=g=Tn)&&(g=PE(g,o.type,o.pendingProps,Ya),g!==null?(o.stateNode=g,ra=o,Tn=Wa(g.firstChild),Ya=!1,y=!0):y=!1),y||hr(o)),Le(o),y=o.type,C=o.pendingProps,M=r!==null?r.memoizedProps:null,g=C.children,GA(y,C)?g=null:M!==null&&GA(y,M)&&(o.flags|=32),o.memoizedState!==null&&(y=Nh(r,o,Hk,null,null,u),bl._currentValue=y),Uc(r,o),oa(r,o,g,u),o.child;case 6:return r===null&&Vt&&((r=u=Tn)&&(u=ME(u,o.pendingProps,Ya),u!==null?(o.stateNode=u,ra=o,Tn=null,r=!0):r=!1),r||hr(o)),null;case 13:return gv(r,o,u);case 4:return Ge(o,o.stateNode.containerInfo),g=o.pendingProps,r===null?o.child=ts(o,null,g,u):oa(r,o,g,u),o.child;case 11:return rv(r,o,o.type,o.pendingProps,u);case 7:return oa(r,o,o.pendingProps,u),o.child;case 8:return oa(r,o,o.pendingProps.children,u),o.child;case 12:return oa(r,o,o.pendingProps.children,u),o.child;case 10:return g=o.pendingProps,Ar(o,o.type,g.value),oa(r,o,g.children,u),o.child;case 9:return y=o.type._context,g=o.pendingProps.children,$r(o),y=sa(y),g=g(y),o.flags|=1,oa(r,o,g,u),o.child;case 14:return sv(r,o,o.type,o.pendingProps,u);case 15:return ov(r,o,o.type,o.pendingProps,u);case 19:return pv(r,o,u);case 31:return $k(r,o,u);case 22:return lv(r,o,u,o.pendingProps);case 24:return $r(o),g=sa(zn),r===null?(y=Th(),y===null&&(y=Cn,C=Sh(),y.pooledCache=C,C.refCount++,C!==null&&(y.pooledCacheLanes|=u),y=C),o.memoizedState={parent:g,cache:y},Eh(o),Ar(o,zn,y)):((r.lanes&u)!==0&&(xh(r,o),el(o,null,null,u),Zo()),y=r.memoizedState,C=o.memoizedState,y.parent!==g?(y={parent:g,cache:g},o.memoizedState=y,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=y),Ar(o,zn,g)):(g=C.cache,Ar(o,zn,g),g!==y.cache&&Ch(o,[zn],u,!0))),oa(r,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function Hi(r){r.flags|=4}function lA(r,o,u,g,y){if((o=(r.mode&32)!==0)&&(o=!1),o){if(r.flags|=16777216,(y&335544128)===y)if(r.stateNode.complete)r.flags|=8192;else if(Vv())r.flags|=8192;else throw es=Tc,kh}else r.flags&=-16777217}function vv(r,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Ry(o))if(Vv())r.flags|=8192;else throw es=Tc,kh}function zc(r,o){o!==null&&(r.flags|=4),r.flags&16384&&(o=r.tag!==22?_e():536870912,r.lanes|=o,Os|=o)}function sl(r,o){if(!Vt)switch(r.tailMode){case"hidden":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?r.tail=null:u.sibling=null;break;case"collapsed":u=r.tail;for(var g=null;u!==null;)u.alternate!==null&&(g=u),u=u.sibling;g===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:g.sibling=null}}function kn(r){var o=r.alternate!==null&&r.alternate.child===r.child,u=0,g=0;if(o)for(var y=r.child;y!==null;)u|=y.lanes|y.childLanes,g|=y.subtreeFlags&65011712,g|=y.flags&65011712,y.return=r,y=y.sibling;else for(y=r.child;y!==null;)u|=y.lanes|y.childLanes,g|=y.subtreeFlags,g|=y.flags,y.return=r,y=y.sibling;return r.subtreeFlags|=g,r.childLanes=u,o}function Zk(r,o,u){var g=o.pendingProps;switch(ph(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kn(o),null;case 1:return kn(o),null;case 3:return u=o.stateNode,g=null,r!==null&&(g=r.memoizedState.cache),o.memoizedState.cache!==g&&(o.flags|=2048),Ui(zn),ae(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(r===null||r.child===null)&&(Ms(o)?Hi(o):r===null||r.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,vh())),kn(o),null;case 26:var y=o.type,C=o.memoizedState;return r===null?(Hi(o),C!==null?(kn(o),vv(o,C)):(kn(o),lA(o,y,null,g,u))):C?C!==r.memoizedState?(Hi(o),kn(o),vv(o,C)):(kn(o),o.flags&=-16777217):(r=r.memoizedProps,r!==g&&Hi(o),kn(o),lA(o,y,r,g,u)),null;case 27:if(De(o),u=oe.current,y=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==g&&Hi(o);else{if(!g){if(o.stateNode===null)throw Error(n(166));return kn(o),null}r=le.current,Ms(o)?$p(o):(r=ky(y,g,u),o.stateNode=r,Hi(o))}return kn(o),null;case 5:if(De(o),y=o.type,r!==null&&o.stateNode!=null)r.memoizedProps!==g&&Hi(o);else{if(!g){if(o.stateNode===null)throw Error(n(166));return kn(o),null}if(C=le.current,Ms(o))$p(o);else{var M=nu(oe.current);switch(C){case 1:C=M.createElementNS("http://www.w3.org/2000/svg",y);break;case 2:C=M.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;default:switch(y){case"svg":C=M.createElementNS("http://www.w3.org/2000/svg",y);break;case"math":C=M.createElementNS("http://www.w3.org/1998/Math/MathML",y);break;case"script":C=M.createElement("div"),C.innerHTML="<script><\/script>",C=C.removeChild(C.firstChild);break;case"select":C=typeof g.is=="string"?M.createElement("select",{is:g.is}):M.createElement("select"),g.multiple?C.multiple=!0:g.size&&(C.size=g.size);break;default:C=typeof g.is=="string"?M.createElement(y,{is:g.is}):M.createElement(y)}}C[Ne]=o,C[Je]=g;e:for(M=o.child;M!==null;){if(M.tag===5||M.tag===6)C.appendChild(M.stateNode);else if(M.tag!==4&&M.tag!==27&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===o)break e;for(;M.sibling===null;){if(M.return===null||M.return===o)break e;M=M.return}M.sibling.return=M.return,M=M.sibling}o.stateNode=C;e:switch(la(C,y,g),y){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&Hi(o)}}return kn(o),lA(o,o.type,r===null?null:r.memoizedProps,o.pendingProps,u),null;case 6:if(r&&o.stateNode!=null)r.memoizedProps!==g&&Hi(o);else{if(typeof g!="string"&&o.stateNode===null)throw Error(n(166));if(r=oe.current,Ms(o)){if(r=o.stateNode,u=o.memoizedProps,g=null,y=ra,y!==null)switch(y.tag){case 27:case 5:g=y.memoizedProps}r[Ne]=o,r=!!(r.nodeValue===u||g!==null&&g.suppressHydrationWarning===!0||gy(r.nodeValue,u)),r||hr(o,!0)}else r=nu(r).createTextNode(g),r[Ne]=o,o.stateNode=r}return kn(o),null;case 31:if(u=o.memoizedState,r===null||r.memoizedState!==null){if(g=Ms(o),u!==null){if(r===null){if(!g)throw Error(n(318));if(r=o.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(557));r[Ne]=o}else Xr(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;kn(o),r=!1}else u=vh(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=u),r=!0;if(!r)return o.flags&256?(La(o),o):(La(o),null);if((o.flags&128)!==0)throw Error(n(558))}return kn(o),null;case 13:if(g=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(y=Ms(o),g!==null&&g.dehydrated!==null){if(r===null){if(!y)throw Error(n(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(n(317));y[Ne]=o}else Xr(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;kn(o),y=!1}else y=vh(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=y),y=!0;if(!y)return o.flags&256?(La(o),o):(La(o),null)}return La(o),(o.flags&128)!==0?(o.lanes=u,o):(u=g!==null,r=r!==null&&r.memoizedState!==null,u&&(g=o.child,y=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(y=g.alternate.memoizedState.cachePool.pool),C=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(C=g.memoizedState.cachePool.pool),C!==y&&(g.flags|=2048)),u!==r&&u&&(o.child.flags|=8192),zc(o,o.updateQueue),kn(o),null);case 4:return ae(),r===null&&IA(o.stateNode.containerInfo),kn(o),null;case 10:return Ui(o.type),kn(o),null;case 19:if(H(Fn),g=o.memoizedState,g===null)return kn(o),null;if(y=(o.flags&128)!==0,C=g.rendering,C===null)if(y)sl(g,!1);else{if(Gn!==0||r!==null&&(r.flags&128)!==0)for(r=o.child;r!==null;){if(C=Pc(r),C!==null){for(o.flags|=128,sl(g,!1),r=C.updateQueue,o.updateQueue=r,zc(o,r),o.subtreeFlags=0,r=u,u=o.child;u!==null;)Qp(u,r),u=u.sibling;return j(Fn,Fn.current&1|2),Vt&&Bi(o,g.treeForkCount),o.child}r=r.sibling}g.tail!==null&&st()>Qc&&(o.flags|=128,y=!0,sl(g,!1),o.lanes=4194304)}else{if(!y)if(r=Pc(C),r!==null){if(o.flags|=128,y=!0,r=r.updateQueue,o.updateQueue=r,zc(o,r),sl(g,!0),g.tail===null&&g.tailMode==="hidden"&&!C.alternate&&!Vt)return kn(o),null}else 2*st()-g.renderingStartTime>Qc&&u!==536870912&&(o.flags|=128,y=!0,sl(g,!1),o.lanes=4194304);g.isBackwards?(C.sibling=o.child,o.child=C):(r=g.last,r!==null?r.sibling=C:o.child=C,g.last=C)}return g.tail!==null?(r=g.tail,g.rendering=r,g.tail=r.sibling,g.renderingStartTime=st(),r.sibling=null,u=Fn.current,j(Fn,y?u&1|2:u&1),Vt&&Bi(o,g.treeForkCount),r):(kn(o),null);case 22:case 23:return La(o),Dh(),g=o.memoizedState!==null,r!==null?r.memoizedState!==null!==g&&(o.flags|=8192):g&&(o.flags|=8192),g?(u&536870912)!==0&&(o.flags&128)===0&&(kn(o),o.subtreeFlags&6&&(o.flags|=8192)):kn(o),u=o.updateQueue,u!==null&&zc(o,u.retryQueue),u=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),g=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(g=o.memoizedState.cachePool.pool),g!==u&&(o.flags|=2048),r!==null&&H(Jr),null;case 24:return u=null,r!==null&&(u=r.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),Ui(zn),kn(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function eE(r,o){switch(ph(o),o.tag){case 1:return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return Ui(zn),ae(),r=o.flags,(r&65536)!==0&&(r&128)===0?(o.flags=r&-65537|128,o):null;case 26:case 27:case 5:return De(o),null;case 31:if(o.memoizedState!==null){if(La(o),o.alternate===null)throw Error(n(340));Xr()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 13:if(La(o),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Xr()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return H(Fn),null;case 4:return ae(),null;case 10:return Ui(o.type),null;case 22:case 23:return La(o),Dh(),r!==null&&H(Jr),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 24:return Ui(zn),null;case 25:return null;default:return null}}function yv(r,o){switch(ph(o),o.tag){case 3:Ui(zn),ae();break;case 26:case 27:case 5:De(o);break;case 4:ae();break;case 31:o.memoizedState!==null&&La(o);break;case 13:La(o);break;case 19:H(Fn);break;case 10:Ui(o.type);break;case 22:case 23:La(o),Dh(),r!==null&&H(Jr);break;case 24:Ui(zn)}}function ol(r,o){try{var u=o.updateQueue,g=u!==null?u.lastEffect:null;if(g!==null){var y=g.next;u=y;do{if((u.tag&r)===r){g=void 0;var C=u.create,M=u.inst;g=C(),M.destroy=g}u=u.next}while(u!==y)}}catch(B){hn(o,o.return,B)}}function yr(r,o,u){try{var g=o.updateQueue,y=g!==null?g.lastEffect:null;if(y!==null){var C=y.next;g=C;do{if((g.tag&r)===r){var M=g.inst,B=M.destroy;if(B!==void 0){M.destroy=void 0,y=o;var J=u,he=B;try{he()}catch(be){hn(y,J,be)}}}g=g.next}while(g!==C)}}catch(be){hn(o,o.return,be)}}function bv(r){var o=r.updateQueue;if(o!==null){var u=r.stateNode;try{um(o,u)}catch(g){hn(r,r.return,g)}}}function Cv(r,o,u){u.props=as(r.type,r.memoizedProps),u.state=r.memoizedState;try{u.componentWillUnmount()}catch(g){hn(r,o,g)}}function ll(r,o){try{var u=r.ref;if(u!==null){switch(r.tag){case 26:case 27:case 5:var g=r.stateNode;break;case 30:g=r.stateNode;break;default:g=r.stateNode}typeof u=="function"?r.refCleanup=u(g):u.current=g}}catch(y){hn(r,o,y)}}function yi(r,o){var u=r.ref,g=r.refCleanup;if(u!==null)if(typeof g=="function")try{g()}catch(y){hn(r,o,y)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(y){hn(r,o,y)}else u.current=null}function Sv(r){var o=r.type,u=r.memoizedProps,g=r.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&g.focus();break e;case"img":u.src?g.src=u.src:u.srcSet&&(g.srcset=u.srcSet)}}catch(y){hn(r,r.return,y)}}function cA(r,o,u){try{var g=r.stateNode;SE(g,r.type,u,o),g[Je]=o}catch(y){hn(r,r.return,y)}}function wv(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Er(r.type)||r.tag===4}function uA(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||wv(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Er(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function dA(r,o,u){var g=r.tag;if(g===5||g===6)r=r.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(r,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(r),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Ni));else if(g!==4&&(g===27&&Er(r.type)&&(u=r.stateNode,o=null),r=r.child,r!==null))for(dA(r,o,u),r=r.sibling;r!==null;)dA(r,o,u),r=r.sibling}function Oc(r,o,u){var g=r.tag;if(g===5||g===6)r=r.stateNode,o?u.insertBefore(r,o):u.appendChild(r);else if(g!==4&&(g===27&&Er(r.type)&&(u=r.stateNode),r=r.child,r!==null))for(Oc(r,o,u),r=r.sibling;r!==null;)Oc(r,o,u),r=r.sibling}function Tv(r){var o=r.stateNode,u=r.memoizedProps;try{for(var g=r.type,y=o.attributes;y.length;)o.removeAttributeNode(y[0]);la(o,g,u),o[Ne]=r,o[Je]=u}catch(C){hn(r,r.return,C)}}var Vi=!1,Vn=!1,hA=!1,kv=typeof WeakSet=="function"?WeakSet:Set,Zn=null;function tE(r,o){if(r=r.containerInfo,RA=cu,r=Bp(r),rh(r)){if("selectionStart"in r)var u={start:r.selectionStart,end:r.selectionEnd};else e:{u=(u=r.ownerDocument)&&u.defaultView||window;var g=u.getSelection&&u.getSelection();if(g&&g.rangeCount!==0){u=g.anchorNode;var y=g.anchorOffset,C=g.focusNode;g=g.focusOffset;try{u.nodeType,C.nodeType}catch{u=null;break e}var M=0,B=-1,J=-1,he=0,be=0,ke=r,Ae=null;t:for(;;){for(var ve;ke!==u||y!==0&&ke.nodeType!==3||(B=M+y),ke!==C||g!==0&&ke.nodeType!==3||(J=M+g),ke.nodeType===3&&(M+=ke.nodeValue.length),(ve=ke.firstChild)!==null;)Ae=ke,ke=ve;for(;;){if(ke===r)break t;if(Ae===u&&++he===y&&(B=M),Ae===C&&++be===g&&(J=M),(ve=ke.nextSibling)!==null)break;ke=Ae,Ae=ke.parentNode}ke=ve}u=B===-1||J===-1?null:{start:B,end:J}}else u=null}u=u||{start:0,end:0}}else u=null;for(NA={focusedElem:r,selectionRange:u},cu=!1,Zn=o;Zn!==null;)if(o=Zn,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,Zn=r;else for(;Zn!==null;){switch(o=Zn,C=o.alternate,r=o.flags,o.tag){case 0:if((r&4)!==0&&(r=o.updateQueue,r=r!==null?r.events:null,r!==null))for(u=0;u<r.length;u++)y=r[u],y.ref.impl=y.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&C!==null){r=void 0,u=o,y=C.memoizedProps,C=C.memoizedState,g=u.stateNode;try{var ot=as(u.type,y);r=g.getSnapshotBeforeUpdate(ot,C),g.__reactInternalSnapshotBeforeUpdate=r}catch(pt){hn(u,u.return,pt)}}break;case 3:if((r&1024)!==0){if(r=o.stateNode.containerInfo,u=r.nodeType,u===9)BA(r);else if(u===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":BA(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(n(163))}if(r=o.sibling,r!==null){r.return=o.return,Zn=r;break}Zn=o.return}}function Ev(r,o,u){var g=u.flags;switch(u.tag){case 0:case 11:case 15:Qi(r,u),g&4&&ol(5,u);break;case 1:if(Qi(r,u),g&4)if(r=u.stateNode,o===null)try{r.componentDidMount()}catch(M){hn(u,u.return,M)}else{var y=as(u.type,o.memoizedProps);o=o.memoizedState;try{r.componentDidUpdate(y,o,r.__reactInternalSnapshotBeforeUpdate)}catch(M){hn(u,u.return,M)}}g&64&&bv(u),g&512&&ll(u,u.return);break;case 3:if(Qi(r,u),g&64&&(r=u.updateQueue,r!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{um(r,o)}catch(M){hn(u,u.return,M)}}break;case 27:o===null&&g&4&&Tv(u);case 26:case 5:Qi(r,u),o===null&&g&4&&Sv(u),g&512&&ll(u,u.return);break;case 12:Qi(r,u);break;case 31:Qi(r,u),g&4&&Mv(r,u);break;case 13:Qi(r,u),g&4&&Iv(r,u),g&64&&(r=u.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(u=uE.bind(null,u),IE(r,u))));break;case 22:if(g=u.memoizedState!==null||Vi,!g){o=o!==null&&o.memoizedState!==null||Vn,y=Vi;var C=Vn;Vi=g,(Vn=o)&&!C?qi(r,u,(u.subtreeFlags&8772)!==0):Qi(r,u),Vi=y,Vn=C}break;case 30:break;default:Qi(r,u)}}function xv(r){var o=r.alternate;o!==null&&(r.alternate=null,xv(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&ct(o)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var xn=null,ka=!1;function ji(r,o,u){for(u=u.child;u!==null;)Pv(r,o,u),u=u.sibling}function Pv(r,o,u){if(Mt&&typeof Mt.onCommitFiberUnmount=="function")try{Mt.onCommitFiberUnmount(dt,u)}catch{}switch(u.tag){case 26:Vn||yi(u,o),ji(r,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Vn||yi(u,o);var g=xn,y=ka;Er(u.type)&&(xn=u.stateNode,ka=!1),ji(r,o,u),ml(u.stateNode),xn=g,ka=y;break;case 5:Vn||yi(u,o);case 6:if(g=xn,y=ka,xn=null,ji(r,o,u),xn=g,ka=y,xn!==null)if(ka)try{(xn.nodeType===9?xn.body:xn.nodeName==="HTML"?xn.ownerDocument.body:xn).removeChild(u.stateNode)}catch(C){hn(u,o,C)}else try{xn.removeChild(u.stateNode)}catch(C){hn(u,o,C)}break;case 18:xn!==null&&(ka?(r=xn,by(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,u.stateNode),Ws(r)):by(xn,u.stateNode));break;case 4:g=xn,y=ka,xn=u.stateNode.containerInfo,ka=!0,ji(r,o,u),xn=g,ka=y;break;case 0:case 11:case 14:case 15:yr(2,u,o),Vn||yr(4,u,o),ji(r,o,u);break;case 1:Vn||(yi(u,o),g=u.stateNode,typeof g.componentWillUnmount=="function"&&Cv(u,o,g)),ji(r,o,u);break;case 21:ji(r,o,u);break;case 22:Vn=(g=Vn)||u.memoizedState!==null,ji(r,o,u),Vn=g;break;default:ji(r,o,u)}}function Mv(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{Ws(r)}catch(u){hn(o,o.return,u)}}}function Iv(r,o){if(o.memoizedState===null&&(r=o.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Ws(r)}catch(u){hn(o,o.return,u)}}function nE(r){switch(r.tag){case 31:case 13:case 19:var o=r.stateNode;return o===null&&(o=r.stateNode=new kv),o;case 22:return r=r.stateNode,o=r._retryCache,o===null&&(o=r._retryCache=new kv),o;default:throw Error(n(435,r.tag))}}function Hc(r,o){var u=nE(r);o.forEach(function(g){if(!u.has(g)){u.add(g);var y=dE.bind(null,r,g);g.then(y,y)}})}function Ea(r,o){var u=o.deletions;if(u!==null)for(var g=0;g<u.length;g++){var y=u[g],C=r,M=o,B=M;e:for(;B!==null;){switch(B.tag){case 27:if(Er(B.type)){xn=B.stateNode,ka=!1;break e}break;case 5:xn=B.stateNode,ka=!1;break e;case 3:case 4:xn=B.stateNode.containerInfo,ka=!0;break e}B=B.return}if(xn===null)throw Error(n(160));Pv(C,M,y),xn=null,ka=!1,C=y.alternate,C!==null&&(C.return=null),y.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)Dv(o,r),o=o.sibling}var ui=null;function Dv(r,o){var u=r.alternate,g=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Ea(o,r),xa(r),g&4&&(yr(3,r,r.return),ol(3,r),yr(5,r,r.return));break;case 1:Ea(o,r),xa(r),g&512&&(Vn||u===null||yi(u,u.return)),g&64&&Vi&&(r=r.updateQueue,r!==null&&(g=r.callbacks,g!==null&&(u=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=u===null?g:u.concat(g))));break;case 26:var y=ui;if(Ea(o,r),xa(r),g&512&&(Vn||u===null||yi(u,u.return)),g&4){var C=u!==null?u.memoizedState:null;if(g=r.memoizedState,u===null)if(g===null)if(r.stateNode===null){e:{g=r.type,u=r.memoizedProps,y=y.ownerDocument||y;t:switch(g){case"title":C=y.getElementsByTagName("title")[0],(!C||C[yn]||C[Ne]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=y.createElement(g),y.head.insertBefore(C,y.querySelector("head > title"))),la(C,g,u),C[Ne]=r,Nt(C),g=C;break e;case"link":var M=Dy("link","href",y).get(g+(u.href||""));if(M){for(var B=0;B<M.length;B++)if(C=M[B],C.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&C.getAttribute("rel")===(u.rel==null?null:u.rel)&&C.getAttribute("title")===(u.title==null?null:u.title)&&C.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){M.splice(B,1);break t}}C=y.createElement(g),la(C,g,u),y.head.appendChild(C);break;case"meta":if(M=Dy("meta","content",y).get(g+(u.content||""))){for(B=0;B<M.length;B++)if(C=M[B],C.getAttribute("content")===(u.content==null?null:""+u.content)&&C.getAttribute("name")===(u.name==null?null:u.name)&&C.getAttribute("property")===(u.property==null?null:u.property)&&C.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&C.getAttribute("charset")===(u.charSet==null?null:u.charSet)){M.splice(B,1);break t}}C=y.createElement(g),la(C,g,u),y.head.appendChild(C);break;default:throw Error(n(468,g))}C[Ne]=r,Nt(C),g=C}r.stateNode=g}else _y(y,r.type,r.stateNode);else r.stateNode=Iy(y,g,r.memoizedProps);else C!==g?(C===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):C.count--,g===null?_y(y,r.type,r.stateNode):Iy(y,g,r.memoizedProps)):g===null&&r.stateNode!==null&&cA(r,r.memoizedProps,u.memoizedProps)}break;case 27:Ea(o,r),xa(r),g&512&&(Vn||u===null||yi(u,u.return)),u!==null&&g&4&&cA(r,r.memoizedProps,u.memoizedProps);break;case 5:if(Ea(o,r),xa(r),g&512&&(Vn||u===null||yi(u,u.return)),r.flags&32){y=r.stateNode;try{wa(y,"")}catch(ot){hn(r,r.return,ot)}}g&4&&r.stateNode!=null&&(y=r.memoizedProps,cA(r,y,u!==null?u.memoizedProps:y)),g&1024&&(hA=!0);break;case 6:if(Ea(o,r),xa(r),g&4){if(r.stateNode===null)throw Error(n(162));g=r.memoizedProps,u=r.stateNode;try{u.nodeValue=g}catch(ot){hn(r,r.return,ot)}}break;case 3:if(ru=null,y=ui,ui=au(o.containerInfo),Ea(o,r),ui=y,xa(r),g&4&&u!==null&&u.memoizedState.isDehydrated)try{Ws(o.containerInfo)}catch(ot){hn(r,r.return,ot)}hA&&(hA=!1,_v(r));break;case 4:g=ui,ui=au(r.stateNode.containerInfo),Ea(o,r),xa(r),ui=g;break;case 12:Ea(o,r),xa(r);break;case 31:Ea(o,r),xa(r),g&4&&(g=r.updateQueue,g!==null&&(r.updateQueue=null,Hc(r,g)));break;case 13:Ea(o,r),xa(r),r.child.flags&8192&&r.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(jc=st()),g&4&&(g=r.updateQueue,g!==null&&(r.updateQueue=null,Hc(r,g)));break;case 22:y=r.memoizedState!==null;var J=u!==null&&u.memoizedState!==null,he=Vi,be=Vn;if(Vi=he||y,Vn=be||J,Ea(o,r),Vn=be,Vi=he,xa(r),g&8192)e:for(o=r.stateNode,o._visibility=y?o._visibility&-2:o._visibility|1,y&&(u===null||J||Vi||Vn||is(r)),u=null,o=r;;){if(o.tag===5||o.tag===26){if(u===null){J=u=o;try{if(C=J.stateNode,y)M=C.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none";else{B=J.stateNode;var ke=J.memoizedProps.style,Ae=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;B.style.display=Ae==null||typeof Ae=="boolean"?"":(""+Ae).trim()}}catch(ot){hn(J,J.return,ot)}}}else if(o.tag===6){if(u===null){J=o;try{J.stateNode.nodeValue=y?"":J.memoizedProps}catch(ot){hn(J,J.return,ot)}}}else if(o.tag===18){if(u===null){J=o;try{var ve=J.stateNode;y?Cy(ve,!0):Cy(J.stateNode,!1)}catch(ot){hn(J,J.return,ot)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===r)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break e;for(;o.sibling===null;){if(o.return===null||o.return===r)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}g&4&&(g=r.updateQueue,g!==null&&(u=g.retryQueue,u!==null&&(g.retryQueue=null,Hc(r,u))));break;case 19:Ea(o,r),xa(r),g&4&&(g=r.updateQueue,g!==null&&(r.updateQueue=null,Hc(r,g)));break;case 30:break;case 21:break;default:Ea(o,r),xa(r)}}function xa(r){var o=r.flags;if(o&2){try{for(var u,g=r.return;g!==null;){if(wv(g)){u=g;break}g=g.return}if(u==null)throw Error(n(160));switch(u.tag){case 27:var y=u.stateNode,C=uA(r);Oc(r,C,y);break;case 5:var M=u.stateNode;u.flags&32&&(wa(M,""),u.flags&=-33);var B=uA(r);Oc(r,B,M);break;case 3:case 4:var J=u.stateNode.containerInfo,he=uA(r);dA(r,he,J);break;default:throw Error(n(161))}}catch(be){hn(r,r.return,be)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function _v(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var o=r;_v(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),r=r.sibling}}function Qi(r,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Ev(r,o.alternate,o),o=o.sibling}function is(r){for(r=r.child;r!==null;){var o=r;switch(o.tag){case 0:case 11:case 14:case 15:yr(4,o,o.return),is(o);break;case 1:yi(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&Cv(o,o.return,u),is(o);break;case 27:ml(o.stateNode);case 26:case 5:yi(o,o.return),is(o);break;case 22:o.memoizedState===null&&is(o);break;case 30:is(o);break;default:is(o)}r=r.sibling}}function qi(r,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var g=o.alternate,y=r,C=o,M=C.flags;switch(C.tag){case 0:case 11:case 15:qi(y,C,u),ol(4,C);break;case 1:if(qi(y,C,u),g=C,y=g.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(he){hn(g,g.return,he)}if(g=C,y=g.updateQueue,y!==null){var B=g.stateNode;try{var J=y.shared.hiddenCallbacks;if(J!==null)for(y.shared.hiddenCallbacks=null,y=0;y<J.length;y++)cm(J[y],B)}catch(he){hn(g,g.return,he)}}u&&M&64&&bv(C),ll(C,C.return);break;case 27:Tv(C);case 26:case 5:qi(y,C,u),u&&g===null&&M&4&&Sv(C),ll(C,C.return);break;case 12:qi(y,C,u);break;case 31:qi(y,C,u),u&&M&4&&Mv(y,C);break;case 13:qi(y,C,u),u&&M&4&&Iv(y,C);break;case 22:C.memoizedState===null&&qi(y,C,u),ll(C,C.return);break;case 30:break;default:qi(y,C,u)}o=o.sibling}}function AA(r,o){var u=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(u=r.memoizedState.cachePool.pool),r=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(r=o.memoizedState.cachePool.pool),r!==u&&(r!=null&&r.refCount++,u!=null&&Yo(u))}function gA(r,o){r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Yo(r))}function di(r,o,u,g){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)Rv(r,o,u,g),o=o.sibling}function Rv(r,o,u,g){var y=o.flags;switch(o.tag){case 0:case 11:case 15:di(r,o,u,g),y&2048&&ol(9,o);break;case 1:di(r,o,u,g);break;case 3:di(r,o,u,g),y&2048&&(r=null,o.alternate!==null&&(r=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==r&&(o.refCount++,r!=null&&Yo(r)));break;case 12:if(y&2048){di(r,o,u,g),r=o.stateNode;try{var C=o.memoizedProps,M=C.id,B=C.onPostCommit;typeof B=="function"&&B(M,o.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(J){hn(o,o.return,J)}}else di(r,o,u,g);break;case 31:di(r,o,u,g);break;case 13:di(r,o,u,g);break;case 23:break;case 22:C=o.stateNode,M=o.alternate,o.memoizedState!==null?C._visibility&2?di(r,o,u,g):cl(r,o):C._visibility&2?di(r,o,u,g):(C._visibility|=2,Us(r,o,u,g,(o.subtreeFlags&10256)!==0||!1)),y&2048&&AA(M,o);break;case 24:di(r,o,u,g),y&2048&&gA(o.alternate,o);break;default:di(r,o,u,g)}}function Us(r,o,u,g,y){for(y=y&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var C=r,M=o,B=u,J=g,he=M.flags;switch(M.tag){case 0:case 11:case 15:Us(C,M,B,J,y),ol(8,M);break;case 23:break;case 22:var be=M.stateNode;M.memoizedState!==null?be._visibility&2?Us(C,M,B,J,y):cl(C,M):(be._visibility|=2,Us(C,M,B,J,y)),y&&he&2048&&AA(M.alternate,M);break;case 24:Us(C,M,B,J,y),y&&he&2048&&gA(M.alternate,M);break;default:Us(C,M,B,J,y)}o=o.sibling}}function cl(r,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=r,g=o,y=g.flags;switch(g.tag){case 22:cl(u,g),y&2048&&AA(g.alternate,g);break;case 24:cl(u,g),y&2048&&gA(g.alternate,g);break;default:cl(u,g)}o=o.sibling}}var ul=8192;function Ks(r,o,u){if(r.subtreeFlags&ul)for(r=r.child;r!==null;)Nv(r,o,u),r=r.sibling}function Nv(r,o,u){switch(r.tag){case 26:Ks(r,o,u),r.flags&ul&&r.memoizedState!==null&&OE(u,ui,r.memoizedState,r.memoizedProps);break;case 5:Ks(r,o,u);break;case 3:case 4:var g=ui;ui=au(r.stateNode.containerInfo),Ks(r,o,u),ui=g;break;case 22:r.memoizedState===null&&(g=r.alternate,g!==null&&g.memoizedState!==null?(g=ul,ul=16777216,Ks(r,o,u),ul=g):Ks(r,o,u));break;default:Ks(r,o,u)}}function Gv(r){var o=r.alternate;if(o!==null&&(r=o.child,r!==null)){o.child=null;do o=r.sibling,r.sibling=null,r=o;while(r!==null)}}function dl(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var g=o[u];Zn=g,Bv(g,r)}Gv(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)Lv(r),r=r.sibling}function Lv(r){switch(r.tag){case 0:case 11:case 15:dl(r),r.flags&2048&&yr(9,r,r.return);break;case 3:dl(r);break;case 12:dl(r);break;case 22:var o=r.stateNode;r.memoizedState!==null&&o._visibility&2&&(r.return===null||r.return.tag!==13)?(o._visibility&=-3,Vc(r)):dl(r);break;default:dl(r)}}function Vc(r){var o=r.deletions;if((r.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var g=o[u];Zn=g,Bv(g,r)}Gv(r)}for(r=r.child;r!==null;){switch(o=r,o.tag){case 0:case 11:case 15:yr(8,o,o.return),Vc(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,Vc(o));break;default:Vc(o)}r=r.sibling}}function Bv(r,o){for(;Zn!==null;){var u=Zn;switch(u.tag){case 0:case 11:case 15:yr(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var g=u.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:Yo(u.memoizedState.cache)}if(g=u.child,g!==null)g.return=u,Zn=g;else e:for(u=r;Zn!==null;){g=Zn;var y=g.sibling,C=g.return;if(xv(g),g===u){Zn=null;break e}if(y!==null){y.return=C,Zn=y;break e}Zn=C}}}var aE={getCacheForType:function(r){var o=sa(zn),u=o.data.get(r);return u===void 0&&(u=r(),o.data.set(r,u)),u},cacheSignal:function(){return sa(zn).controller.signal}},iE=typeof WeakMap=="function"?WeakMap:Map,nn=0,Cn=null,Kt=null,Ot=0,dn=0,Ba=null,br=!1,zs=!1,fA=!1,Yi=0,Gn=0,Cr=0,rs=0,pA=0,Fa=0,Os=0,hl=null,Pa=null,mA=!1,jc=0,Fv=0,Qc=1/0,qc=null,Sr=null,Yn=0,wr=null,Hs=null,Xi=0,vA=0,yA=null,Uv=null,Al=0,bA=null;function Ua(){return(nn&2)!==0&&Ot!==0?Ot&-Ot:F.T!==null?EA():Ve()}function Kv(){if(Fa===0)if((Ot&536870912)===0||Vt){var r=Sn;Sn<<=1,(Sn&3932160)===0&&(Sn=262144),Fa=r}else Fa=536870912;return r=Ga.current,r!==null&&(r.flags|=32),Fa}function Ma(r,o,u){(r===Cn&&(dn===2||dn===9)||r.cancelPendingCommit!==null)&&(Vs(r,0),Tr(r,Ot,Fa,!1)),Ke(r,u),((nn&2)===0||r!==Cn)&&(r===Cn&&((nn&2)===0&&(rs|=u),Gn===4&&Tr(r,Ot,Fa,!1)),bi(r))}function zv(r,o,u){if((nn&6)!==0)throw Error(n(327));var g=!u&&(o&127)===0&&(o&r.expiredLanes)===0||Wt(r,o),y=g?oE(r,o):SA(r,o,!0),C=g;do{if(y===0){zs&&!g&&Tr(r,o,0,!1);break}else{if(u=r.current.alternate,C&&!rE(u)){y=SA(r,o,!1),C=!1;continue}if(y===2){if(C=o,r.errorRecoveryDisabledLanes&C)var M=0;else M=r.pendingLanes&-536870913,M=M!==0?M:M&536870912?536870912:0;if(M!==0){o=M;e:{var B=r;y=hl;var J=B.current.memoizedState.isDehydrated;if(J&&(Vs(B,M).flags|=256),M=SA(B,M,!1),M!==2){if(fA&&!J){B.errorRecoveryDisabledLanes|=C,rs|=C,y=4;break e}C=Pa,Pa=y,C!==null&&(Pa===null?Pa=C:Pa.push.apply(Pa,C))}y=M}if(C=!1,y!==2)continue}}if(y===1){Vs(r,0),Tr(r,o,0,!0);break}e:{switch(g=r,C=y,C){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:Tr(g,o,Fa,!br);break e;case 2:Pa=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(y=jc+300-st(),10<y)){if(Tr(g,o,Fa,!br),bt(g,0,!0)!==0)break e;Xi=o,g.timeoutHandle=vy(Ov.bind(null,g,u,Pa,qc,mA,o,Fa,rs,Os,br,C,"Throttled",-0,0),y);break e}Ov(g,u,Pa,qc,mA,o,Fa,rs,Os,br,C,null,-0,0)}}break}while(!0);bi(r)}function Ov(r,o,u,g,y,C,M,B,J,he,be,ke,Ae,ve){if(r.timeoutHandle=-1,ke=o.subtreeFlags,ke&8192||(ke&16785408)===16785408){ke={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ni},Nv(o,C,ke);var ot=(C&62914560)===C?jc-st():(C&4194048)===C?Fv-st():0;if(ot=HE(ke,ot),ot!==null){Xi=C,r.cancelPendingCommit=ot(Wv.bind(null,r,o,C,u,g,y,M,B,J,be,ke,null,Ae,ve)),Tr(r,C,M,!he);return}}Wv(r,o,C,u,g,y,M,B,J)}function rE(r){for(var o=r;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var g=0;g<u.length;g++){var y=u[g],C=y.getSnapshot;y=y.value;try{if(!Ra(C(),y))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Tr(r,o,u,g){o&=~pA,o&=~rs,r.suspendedLanes|=o,r.pingedLanes&=~o,g&&(r.warmLanes|=o),g=r.expirationTimes;for(var y=o;0<y;){var C=31-Ce(y),M=1<<C;g[C]=-1,y&=~M}u!==0&&X(r,u,o)}function Yc(){return(nn&6)===0?(gl(0),!1):!0}function CA(){if(Kt!==null){if(dn===0)var r=Kt.return;else r=Kt,Fi=Wr=null,Bh(r),Ns=null,Wo=0,r=Kt;for(;r!==null;)yv(r.alternate,r),r=r.return;Kt=null}}function Vs(r,o){var u=r.timeoutHandle;u!==-1&&(r.timeoutHandle=-1,kE(u)),u=r.cancelPendingCommit,u!==null&&(r.cancelPendingCommit=null,u()),Xi=0,CA(),Cn=r,Kt=u=Li(r.current,null),Ot=o,dn=0,Ba=null,br=!1,zs=Wt(r,o),fA=!1,Os=Fa=pA=rs=Cr=Gn=0,Pa=hl=null,mA=!1,(o&8)!==0&&(o|=o&32);var g=r.entangledLanes;if(g!==0)for(r=r.entanglements,g&=o;0<g;){var y=31-Ce(g),C=1<<y;o|=r[y],g&=~C}return Yi=o,fc(),u}function Hv(r,o){Dt=null,F.H=il,o===Rs||o===wc?(o=rm(),dn=3):o===kh?(o=rm(),dn=4):dn=o===Zh?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,Ba=o,Kt===null&&(Gn=1,Bc(r,ja(o,r.current)))}function Vv(){var r=Ga.current;return r===null?!0:(Ot&4194048)===Ot?Xa===null:(Ot&62914560)===Ot||(Ot&536870912)!==0?r===Xa:!1}function jv(){var r=F.H;return F.H=il,r===null?il:r}function Qv(){var r=F.A;return F.A=aE,r}function Xc(){Gn=4,br||(Ot&4194048)!==Ot&&Ga.current!==null||(zs=!0),(Cr&134217727)===0&&(rs&134217727)===0||Cn===null||Tr(Cn,Ot,Fa,!1)}function SA(r,o,u){var g=nn;nn|=2;var y=jv(),C=Qv();(Cn!==r||Ot!==o)&&(qc=null,Vs(r,o)),o=!1;var M=Gn;e:do try{if(dn!==0&&Kt!==null){var B=Kt,J=Ba;switch(dn){case 8:CA(),M=6;break e;case 3:case 2:case 9:case 6:Ga.current===null&&(o=!0);var he=dn;if(dn=0,Ba=null,js(r,B,J,he),u&&zs){M=0;break e}break;default:he=dn,dn=0,Ba=null,js(r,B,J,he)}}sE(),M=Gn;break}catch(be){Hv(r,be)}while(!0);return o&&r.shellSuspendCounter++,Fi=Wr=null,nn=g,F.H=y,F.A=C,Kt===null&&(Cn=null,Ot=0,fc()),M}function sE(){for(;Kt!==null;)qv(Kt)}function oE(r,o){var u=nn;nn|=2;var g=jv(),y=Qv();Cn!==r||Ot!==o?(qc=null,Qc=st()+500,Vs(r,o)):zs=Wt(r,o);e:do try{if(dn!==0&&Kt!==null){o=Kt;var C=Ba;t:switch(dn){case 1:dn=0,Ba=null,js(r,o,C,1);break;case 2:case 9:if(am(C)){dn=0,Ba=null,Yv(o);break}o=function(){dn!==2&&dn!==9||Cn!==r||(dn=7),bi(r)},C.then(o,o);break e;case 3:dn=7;break e;case 4:dn=5;break e;case 7:am(C)?(dn=0,Ba=null,Yv(o)):(dn=0,Ba=null,js(r,o,C,7));break;case 5:var M=null;switch(Kt.tag){case 26:M=Kt.memoizedState;case 5:case 27:var B=Kt;if(M?Ry(M):B.stateNode.complete){dn=0,Ba=null;var J=B.sibling;if(J!==null)Kt=J;else{var he=B.return;he!==null?(Kt=he,Wc(he)):Kt=null}break t}}dn=0,Ba=null,js(r,o,C,5);break;case 6:dn=0,Ba=null,js(r,o,C,6);break;case 8:CA(),Gn=6;break e;default:throw Error(n(462))}}lE();break}catch(be){Hv(r,be)}while(!0);return Fi=Wr=null,F.H=g,F.A=y,nn=u,Kt!==null?0:(Cn=null,Ot=0,fc(),Gn)}function lE(){for(;Kt!==null&&!Ye();)qv(Kt)}function qv(r){var o=mv(r.alternate,r,Yi);r.memoizedProps=r.pendingProps,o===null?Wc(r):Kt=o}function Yv(r){var o=r,u=o.alternate;switch(o.tag){case 15:case 0:o=dv(u,o,o.pendingProps,o.type,void 0,Ot);break;case 11:o=dv(u,o,o.pendingProps,o.type.render,o.ref,Ot);break;case 5:Bh(o);default:yv(u,o),o=Kt=Qp(o,Yi),o=mv(u,o,Yi)}r.memoizedProps=r.pendingProps,o===null?Wc(r):Kt=o}function js(r,o,u,g){Fi=Wr=null,Bh(o),Ns=null,Wo=0;var y=o.return;try{if(Wk(r,y,o,u,Ot)){Gn=1,Bc(r,ja(u,r.current)),Kt=null;return}}catch(C){if(y!==null)throw Kt=y,C;Gn=1,Bc(r,ja(u,r.current)),Kt=null;return}o.flags&32768?(Vt||g===1?r=!0:zs||(Ot&536870912)!==0?r=!1:(br=r=!0,(g===2||g===9||g===3||g===6)&&(g=Ga.current,g!==null&&g.tag===13&&(g.flags|=16384))),Xv(o,r)):Wc(o)}function Wc(r){var o=r;do{if((o.flags&32768)!==0){Xv(o,br);return}r=o.return;var u=Zk(o.alternate,o,Yi);if(u!==null){Kt=u;return}if(o=o.sibling,o!==null){Kt=o;return}Kt=o=r}while(o!==null);Gn===0&&(Gn=5)}function Xv(r,o){do{var u=eE(r.alternate,r);if(u!==null){u.flags&=32767,Kt=u;return}if(u=r.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(r=r.sibling,r!==null)){Kt=r;return}Kt=r=u}while(r!==null);Gn=6,Kt=null}function Wv(r,o,u,g,y,C,M,B,J){r.cancelPendingCommit=null;do $c();while(Yn!==0);if((nn&6)!==0)throw Error(n(327));if(o!==null){if(o===r.current)throw Error(n(177));if(C=o.lanes|o.childLanes,C|=uh,je(r,u,C,M,B,J),r===Cn&&(Kt=Cn=null,Ot=0),Hs=o,wr=r,Xi=u,vA=C,yA=y,Uv=g,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,hE(Be,function(){return ty(),null})):(r.callbackNode=null,r.callbackPriority=0),g=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||g){g=F.T,F.T=null,y=U.p,U.p=2,M=nn,nn|=4;try{tE(r,o,u)}finally{nn=M,U.p=y,F.T=g}}Yn=1,$v(),Jv(),Zv()}}function $v(){if(Yn===1){Yn=0;var r=wr,o=Hs,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=F.T,F.T=null;var g=U.p;U.p=2;var y=nn;nn|=4;try{Dv(o,r);var C=NA,M=Bp(r.containerInfo),B=C.focusedElem,J=C.selectionRange;if(M!==B&&B&&B.ownerDocument&&Lp(B.ownerDocument.documentElement,B)){if(J!==null&&rh(B)){var he=J.start,be=J.end;if(be===void 0&&(be=he),"selectionStart"in B)B.selectionStart=he,B.selectionEnd=Math.min(be,B.value.length);else{var ke=B.ownerDocument||document,Ae=ke&&ke.defaultView||window;if(Ae.getSelection){var ve=Ae.getSelection(),ot=B.textContent.length,pt=Math.min(J.start,ot),fn=J.end===void 0?pt:Math.min(J.end,ot);!ve.extend&&pt>fn&&(M=fn,fn=pt,pt=M);var ie=Gp(B,pt),ee=Gp(B,fn);if(ie&&ee&&(ve.rangeCount!==1||ve.anchorNode!==ie.node||ve.anchorOffset!==ie.offset||ve.focusNode!==ee.node||ve.focusOffset!==ee.offset)){var de=ke.createRange();de.setStart(ie.node,ie.offset),ve.removeAllRanges(),pt>fn?(ve.addRange(de),ve.extend(ee.node,ee.offset)):(de.setEnd(ee.node,ee.offset),ve.addRange(de))}}}}for(ke=[],ve=B;ve=ve.parentNode;)ve.nodeType===1&&ke.push({element:ve,left:ve.scrollLeft,top:ve.scrollTop});for(typeof B.focus=="function"&&B.focus(),B=0;B<ke.length;B++){var we=ke[B];we.element.scrollLeft=we.left,we.element.scrollTop=we.top}}cu=!!RA,NA=RA=null}finally{nn=y,U.p=g,F.T=u}}r.current=o,Yn=2}}function Jv(){if(Yn===2){Yn=0;var r=wr,o=Hs,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=F.T,F.T=null;var g=U.p;U.p=2;var y=nn;nn|=4;try{Ev(r,o.alternate,o)}finally{nn=y,U.p=g,F.T=u}}Yn=3}}function Zv(){if(Yn===4||Yn===3){Yn=0,Qe();var r=wr,o=Hs,u=Xi,g=Uv;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Yn=5:(Yn=0,Hs=wr=null,ey(r,r.pendingLanes));var y=r.pendingLanes;if(y===0&&(Sr=null),at(u),o=o.stateNode,Mt&&typeof Mt.onCommitFiberRoot=="function")try{Mt.onCommitFiberRoot(dt,o,void 0,(o.current.flags&128)===128)}catch{}if(g!==null){o=F.T,y=U.p,U.p=2,F.T=null;try{for(var C=r.onRecoverableError,M=0;M<g.length;M++){var B=g[M];C(B.value,{componentStack:B.stack})}}finally{F.T=o,U.p=y}}(Xi&3)!==0&&$c(),bi(r),y=r.pendingLanes,(u&261930)!==0&&(y&42)!==0?r===bA?Al++:(Al=0,bA=r):Al=0,gl(0)}}function ey(r,o){(r.pooledCacheLanes&=o)===0&&(o=r.pooledCache,o!=null&&(r.pooledCache=null,Yo(o)))}function $c(){return $v(),Jv(),Zv(),ty()}function ty(){if(Yn!==5)return!1;var r=wr,o=vA;vA=0;var u=at(Xi),g=F.T,y=U.p;try{U.p=32>u?32:u,F.T=null,u=yA,yA=null;var C=wr,M=Xi;if(Yn=0,Hs=wr=null,Xi=0,(nn&6)!==0)throw Error(n(331));var B=nn;if(nn|=4,Lv(C.current),Rv(C,C.current,M,u),nn=B,gl(0,!1),Mt&&typeof Mt.onPostCommitFiberRoot=="function")try{Mt.onPostCommitFiberRoot(dt,C)}catch{}return!0}finally{U.p=y,F.T=g,ey(r,o)}}function ny(r,o,u){o=ja(u,o),o=Jh(r.stateNode,o,2),r=pr(r,o,2),r!==null&&(Ke(r,2),bi(r))}function hn(r,o,u){if(r.tag===3)ny(r,r,u);else for(;o!==null;){if(o.tag===3){ny(o,r,u);break}else if(o.tag===1){var g=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Sr===null||!Sr.has(g))){r=ja(u,r),u=av(2),g=pr(o,u,2),g!==null&&(iv(u,g,o,r),Ke(g,2),bi(g));break}}o=o.return}}function wA(r,o,u){var g=r.pingCache;if(g===null){g=r.pingCache=new iE;var y=new Set;g.set(o,y)}else y=g.get(o),y===void 0&&(y=new Set,g.set(o,y));y.has(u)||(fA=!0,y.add(u),r=cE.bind(null,r,o,u),o.then(r,r))}function cE(r,o,u){var g=r.pingCache;g!==null&&g.delete(o),r.pingedLanes|=r.suspendedLanes&u,r.warmLanes&=~u,Cn===r&&(Ot&u)===u&&(Gn===4||Gn===3&&(Ot&62914560)===Ot&&300>st()-jc?(nn&2)===0&&Vs(r,0):pA|=u,Os===Ot&&(Os=0)),bi(r)}function ay(r,o){o===0&&(o=_e()),r=qr(r,o),r!==null&&(Ke(r,o),bi(r))}function uE(r){var o=r.memoizedState,u=0;o!==null&&(u=o.retryLane),ay(r,u)}function dE(r,o){var u=0;switch(r.tag){case 31:case 13:var g=r.stateNode,y=r.memoizedState;y!==null&&(u=y.retryLane);break;case 19:g=r.stateNode;break;case 22:g=r.stateNode._retryCache;break;default:throw Error(n(314))}g!==null&&g.delete(o),ay(r,u)}function hE(r,o){return Re(r,o)}var Jc=null,Qs=null,TA=!1,Zc=!1,kA=!1,kr=0;function bi(r){r!==Qs&&r.next===null&&(Qs===null?Jc=Qs=r:Qs=Qs.next=r),Zc=!0,TA||(TA=!0,gE())}function gl(r,o){if(!kA&&Zc){kA=!0;do for(var u=!1,g=Jc;g!==null;){if(r!==0){var y=g.pendingLanes;if(y===0)var C=0;else{var M=g.suspendedLanes,B=g.pingedLanes;C=(1<<31-Ce(42|r)+1)-1,C&=y&~(M&~B),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(u=!0,oy(g,C))}else C=Ot,C=bt(g,g===Cn?C:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(C&3)===0||Wt(g,C)||(u=!0,oy(g,C));g=g.next}while(u);kA=!1}}function AE(){iy()}function iy(){Zc=TA=!1;var r=0;kr!==0&&TE()&&(r=kr);for(var o=st(),u=null,g=Jc;g!==null;){var y=g.next,C=ry(g,o);C===0?(g.next=null,u===null?Jc=y:u.next=y,y===null&&(Qs=u)):(u=g,(r!==0||(C&3)!==0)&&(Zc=!0)),g=y}Yn!==0&&Yn!==5||gl(r),kr!==0&&(kr=0)}function ry(r,o){for(var u=r.suspendedLanes,g=r.pingedLanes,y=r.expirationTimes,C=r.pendingLanes&-62914561;0<C;){var M=31-Ce(C),B=1<<M,J=y[M];J===-1?((B&u)===0||(B&g)!==0)&&(y[M]=se(B,o)):J<=o&&(r.expiredLanes|=B),C&=~B}if(o=Cn,u=Ot,u=bt(r,r===o?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),g=r.callbackNode,u===0||r===o&&(dn===2||dn===9)||r.cancelPendingCommit!==null)return g!==null&&g!==null&&et(g),r.callbackNode=null,r.callbackPriority=0;if((u&3)===0||Wt(r,u)){if(o=u&-u,o===r.callbackPriority)return o;switch(g!==null&&et(g),at(u)){case 2:case 8:u=Ue;break;case 32:u=Be;break;case 268435456:u=mt;break;default:u=Be}return g=sy.bind(null,r),u=Re(u,g),r.callbackPriority=o,r.callbackNode=u,o}return g!==null&&g!==null&&et(g),r.callbackPriority=2,r.callbackNode=null,2}function sy(r,o){if(Yn!==0&&Yn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var u=r.callbackNode;if($c()&&r.callbackNode!==u)return null;var g=Ot;return g=bt(r,r===Cn?g:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),g===0?null:(zv(r,g,o),ry(r,st()),r.callbackNode!=null&&r.callbackNode===u?sy.bind(null,r):null)}function oy(r,o){if($c())return null;zv(r,o,!0)}function gE(){EE(function(){(nn&6)!==0?Re(ft,AE):iy()})}function EA(){if(kr===0){var r=Ds;r===0&&(r=tn,tn<<=1,(tn&261888)===0&&(tn=256)),kr=r}return kr}function ly(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:oc(""+r)}function cy(r,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,r.id&&u.setAttribute("form",r.id),o.parentNode.insertBefore(u,o),r=new FormData(r),u.parentNode.removeChild(u),r}function fE(r,o,u,g,y){if(o==="submit"&&u&&u.stateNode===y){var C=ly((y[Je]||null).action),M=g.submitter;M&&(o=(o=M[Je]||null)?ly(o.formAction):M.getAttribute("formAction"),o!==null&&(C=o,M=null));var B=new dc("action","action",null,g,y);r.push({event:B,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(kr!==0){var J=M?cy(y,M):new FormData(y);Qh(u,{pending:!0,data:J,method:y.method,action:C},null,J)}}else typeof C=="function"&&(B.preventDefault(),J=M?cy(y,M):new FormData(y),Qh(u,{pending:!0,data:J,method:y.method,action:C},C,J))},currentTarget:y}]})}}for(var xA=0;xA<ch.length;xA++){var PA=ch[xA],pE=PA.toLowerCase(),mE=PA[0].toUpperCase()+PA.slice(1);ci(pE,"on"+mE)}ci(Kp,"onAnimationEnd"),ci(zp,"onAnimationIteration"),ci(Op,"onAnimationStart"),ci("dblclick","onDoubleClick"),ci("focusin","onFocus"),ci("focusout","onBlur"),ci(Rk,"onTransitionRun"),ci(Nk,"onTransitionStart"),ci(Gk,"onTransitionCancel"),ci(Hp,"onTransitionEnd"),ze("onMouseEnter",["mouseout","mouseover"]),ze("onMouseLeave",["mouseout","mouseover"]),ze("onPointerEnter",["pointerout","pointerover"]),ze("onPointerLeave",["pointerout","pointerover"]),$n("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$n("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$n("onBeforeInput",["compositionend","keypress","textInput","paste"]),$n("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$n("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$n("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fl));function uy(r,o){o=(o&4)!==0;for(var u=0;u<r.length;u++){var g=r[u],y=g.event;g=g.listeners;e:{var C=void 0;if(o)for(var M=g.length-1;0<=M;M--){var B=g[M],J=B.instance,he=B.currentTarget;if(B=B.listener,J!==C&&y.isPropagationStopped())break e;C=B,y.currentTarget=he;try{C(y)}catch(be){gc(be)}y.currentTarget=null,C=J}else for(M=0;M<g.length;M++){if(B=g[M],J=B.instance,he=B.currentTarget,B=B.listener,J!==C&&y.isPropagationStopped())break e;C=B,y.currentTarget=he;try{C(y)}catch(be){gc(be)}y.currentTarget=null,C=J}}}}function zt(r,o){var u=o[xt];u===void 0&&(u=o[xt]=new Set);var g=r+"__bubble";u.has(g)||(dy(o,r,2,!1),u.add(g))}function MA(r,o,u){var g=0;o&&(g|=4),dy(u,r,g,o)}var eu="_reactListening"+Math.random().toString(36).slice(2);function IA(r){if(!r[eu]){r[eu]=!0,li.forEach(function(u){u!=="selectionchange"&&(vE.has(u)||MA(u,!1,r),MA(u,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[eu]||(o[eu]=!0,MA("selectionchange",!1,o))}}function dy(r,o,u,g){switch(Ky(o)){case 2:var y=QE;break;case 8:y=qE;break;default:y=jA}u=y.bind(null,o,u,r),y=void 0,!Wd||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(y=!0),g?y!==void 0?r.addEventListener(o,u,{capture:!0,passive:y}):r.addEventListener(o,u,!0):y!==void 0?r.addEventListener(o,u,{passive:y}):r.addEventListener(o,u,!1)}function DA(r,o,u,g,y){var C=g;if((o&1)===0&&(o&2)===0&&g!==null)e:for(;;){if(g===null)return;var M=g.tag;if(M===3||M===4){var B=g.stateNode.containerInfo;if(B===y)break;if(M===4)for(M=g.return;M!==null;){var J=M.tag;if((J===3||J===4)&&M.stateNode.containerInfo===y)return;M=M.return}for(;B!==null;){if(M=vt(B),M===null)return;if(J=M.tag,J===5||J===6||J===26||J===27){g=C=M;continue e}B=B.parentNode}}g=g.return}pp(function(){var he=C,be=Yd(u),ke=[];e:{var Ae=Vp.get(r);if(Ae!==void 0){var ve=dc,ot=r;switch(r){case"keypress":if(cc(u)===0)break e;case"keydown":case"keyup":ve=dk;break;case"focusin":ot="focus",ve=eh;break;case"focusout":ot="blur",ve=eh;break;case"beforeblur":case"afterblur":ve=eh;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ve=yp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ve=ZT;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ve=gk;break;case Kp:case zp:case Op:ve=nk;break;case Hp:ve=pk;break;case"scroll":case"scrollend":ve=$T;break;case"wheel":ve=vk;break;case"copy":case"cut":case"paste":ve=ik;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ve=Cp;break;case"toggle":case"beforetoggle":ve=bk}var pt=(o&4)!==0,fn=!pt&&(r==="scroll"||r==="scrollend"),ie=pt?Ae!==null?Ae+"Capture":null:Ae;pt=[];for(var ee=he,de;ee!==null;){var we=ee;if(de=we.stateNode,we=we.tag,we!==5&&we!==26&&we!==27||de===null||ie===null||(we=Bo(ee,ie),we!=null&&pt.push(pl(ee,we,de))),fn)break;ee=ee.return}0<pt.length&&(Ae=new ve(Ae,ot,null,u,be),ke.push({event:Ae,listeners:pt}))}}if((o&7)===0){e:{if(Ae=r==="mouseover"||r==="pointerover",ve=r==="mouseout"||r==="pointerout",Ae&&u!==qd&&(ot=u.relatedTarget||u.fromElement)&&(vt(ot)||ot[qt]))break e;if((ve||Ae)&&(Ae=be.window===be?be:(Ae=be.ownerDocument)?Ae.defaultView||Ae.parentWindow:window,ve?(ot=u.relatedTarget||u.toElement,ve=he,ot=ot?vt(ot):null,ot!==null&&(fn=s(ot),pt=ot.tag,ot!==fn||pt!==5&&pt!==27&&pt!==6)&&(ot=null)):(ve=null,ot=he),ve!==ot)){if(pt=yp,we="onMouseLeave",ie="onMouseEnter",ee="mouse",(r==="pointerout"||r==="pointerover")&&(pt=Cp,we="onPointerLeave",ie="onPointerEnter",ee="pointer"),fn=ve==null?Ae:Rn(ve),de=ot==null?Ae:Rn(ot),Ae=new pt(we,ee+"leave",ve,u,be),Ae.target=fn,Ae.relatedTarget=de,we=null,vt(be)===he&&(pt=new pt(ie,ee+"enter",ot,u,be),pt.target=de,pt.relatedTarget=fn,we=pt),fn=we,ve&&ot)t:{for(pt=yE,ie=ve,ee=ot,de=0,we=ie;we;we=pt(we))de++;we=0;for(var At=ee;At;At=pt(At))we++;for(;0<de-we;)ie=pt(ie),de--;for(;0<we-de;)ee=pt(ee),we--;for(;de--;){if(ie===ee||ee!==null&&ie===ee.alternate){pt=ie;break t}ie=pt(ie),ee=pt(ee)}pt=null}else pt=null;ve!==null&&hy(ke,Ae,ve,pt,!1),ot!==null&&fn!==null&&hy(ke,fn,ot,pt,!0)}}e:{if(Ae=he?Rn(he):window,ve=Ae.nodeName&&Ae.nodeName.toLowerCase(),ve==="select"||ve==="input"&&Ae.type==="file")var Jt=Mp;else if(xp(Ae))if(Ip)Jt=Ik;else{Jt=Pk;var ut=xk}else ve=Ae.nodeName,!ve||ve.toLowerCase()!=="input"||Ae.type!=="checkbox"&&Ae.type!=="radio"?he&&Qd(he.elementType)&&(Jt=Mp):Jt=Mk;if(Jt&&(Jt=Jt(r,he))){Pp(ke,Jt,u,be);break e}ut&&ut(r,Ae,he),r==="focusout"&&he&&Ae.type==="number"&&he.memoizedProps.value!=null&&Bn(Ae,"number",Ae.value)}switch(ut=he?Rn(he):window,r){case"focusin":(xp(ut)||ut.contentEditable==="true")&&(ws=ut,sh=he,jo=null);break;case"focusout":jo=sh=ws=null;break;case"mousedown":oh=!0;break;case"contextmenu":case"mouseup":case"dragend":oh=!1,Fp(ke,u,be);break;case"selectionchange":if(_k)break;case"keydown":case"keyup":Fp(ke,u,be)}var Gt;if(nh)e:{switch(r){case"compositionstart":var Ht="onCompositionStart";break e;case"compositionend":Ht="onCompositionEnd";break e;case"compositionupdate":Ht="onCompositionUpdate";break e}Ht=void 0}else Ss?kp(r,u)&&(Ht="onCompositionEnd"):r==="keydown"&&u.keyCode===229&&(Ht="onCompositionStart");Ht&&(Sp&&u.locale!=="ko"&&(Ss||Ht!=="onCompositionStart"?Ht==="onCompositionEnd"&&Ss&&(Gt=mp()):(cr=be,$d="value"in cr?cr.value:cr.textContent,Ss=!0)),ut=tu(he,Ht),0<ut.length&&(Ht=new bp(Ht,r,null,u,be),ke.push({event:Ht,listeners:ut}),Gt?Ht.data=Gt:(Gt=Ep(u),Gt!==null&&(Ht.data=Gt)))),(Gt=Sk?wk(r,u):Tk(r,u))&&(Ht=tu(he,"onBeforeInput"),0<Ht.length&&(ut=new bp("onBeforeInput","beforeinput",null,u,be),ke.push({event:ut,listeners:Ht}),ut.data=Gt)),fE(ke,r,he,u,be)}uy(ke,o)})}function pl(r,o,u){return{instance:r,listener:o,currentTarget:u}}function tu(r,o){for(var u=o+"Capture",g=[];r!==null;){var y=r,C=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||C===null||(y=Bo(r,u),y!=null&&g.unshift(pl(r,y,C)),y=Bo(r,o),y!=null&&g.push(pl(r,y,C))),r.tag===3)return g;r=r.return}return[]}function yE(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function hy(r,o,u,g,y){for(var C=o._reactName,M=[];u!==null&&u!==g;){var B=u,J=B.alternate,he=B.stateNode;if(B=B.tag,J!==null&&J===g)break;B!==5&&B!==26&&B!==27||he===null||(J=he,y?(he=Bo(u,C),he!=null&&M.unshift(pl(u,he,J))):y||(he=Bo(u,C),he!=null&&M.push(pl(u,he,J)))),u=u.return}M.length!==0&&r.push({event:o,listeners:M})}var bE=/\r\n?/g,CE=/\u0000|\uFFFD/g;function Ay(r){return(typeof r=="string"?r:""+r).replace(bE,`
`).replace(CE,"")}function gy(r,o){return o=Ay(o),Ay(r)===o}function gn(r,o,u,g,y,C){switch(u){case"children":typeof g=="string"?o==="body"||o==="textarea"&&g===""||wa(r,g):(typeof g=="number"||typeof g=="bigint")&&o!=="body"&&wa(r,""+g);break;case"className":$t(r,"class",g);break;case"tabIndex":$t(r,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":$t(r,u,g);break;case"style":gp(r,g,C);break;case"data":if(o!=="object"){$t(r,"data",g);break}case"src":case"href":if(g===""&&(o!=="a"||u!=="href")){r.removeAttribute(u);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){r.removeAttribute(u);break}g=oc(""+g),r.setAttribute(u,g);break;case"action":case"formAction":if(typeof g=="function"){r.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(u==="formAction"?(o!=="input"&&gn(r,o,"name",y.name,y,null),gn(r,o,"formEncType",y.formEncType,y,null),gn(r,o,"formMethod",y.formMethod,y,null),gn(r,o,"formTarget",y.formTarget,y,null)):(gn(r,o,"encType",y.encType,y,null),gn(r,o,"method",y.method,y,null),gn(r,o,"target",y.target,y,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){r.removeAttribute(u);break}g=oc(""+g),r.setAttribute(u,g);break;case"onClick":g!=null&&(r.onclick=Ni);break;case"onScroll":g!=null&&zt("scroll",r);break;case"onScrollEnd":g!=null&&zt("scrollend",r);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(u=g.__html,u!=null){if(y.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"multiple":r.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":r.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){r.removeAttribute("xlink:href");break}u=oc(""+g),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?r.setAttribute(u,""+g):r.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?r.setAttribute(u,""):r.removeAttribute(u);break;case"capture":case"download":g===!0?r.setAttribute(u,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?r.setAttribute(u,g):r.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?r.setAttribute(u,g):r.removeAttribute(u);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?r.removeAttribute(u):r.setAttribute(u,g);break;case"popover":zt("beforetoggle",r),zt("toggle",r),tt(r,"popover",g);break;case"xlinkActuate":bn(r,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":bn(r,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":bn(r,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":bn(r,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":bn(r,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":bn(r,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":bn(r,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":bn(r,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":bn(r,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":tt(r,"is",g);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=XT.get(u)||u,tt(r,u,g))}}function _A(r,o,u,g,y,C){switch(u){case"style":gp(r,g,C);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(u=g.__html,u!=null){if(y.children!=null)throw Error(n(60));r.innerHTML=u}}break;case"children":typeof g=="string"?wa(r,g):(typeof g=="number"||typeof g=="bigint")&&wa(r,""+g);break;case"onScroll":g!=null&&zt("scroll",r);break;case"onScrollEnd":g!=null&&zt("scrollend",r);break;case"onClick":g!=null&&(r.onclick=Ni);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ha.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(y=u.endsWith("Capture"),o=u.slice(2,y?u.length-7:void 0),C=r[Je]||null,C=C!=null?C[u]:null,typeof C=="function"&&r.removeEventListener(o,C,y),typeof g=="function")){typeof C!="function"&&C!==null&&(u in r?r[u]=null:r.hasAttribute(u)&&r.removeAttribute(u)),r.addEventListener(o,g,y);break e}u in r?r[u]=g:g===!0?r.setAttribute(u,""):tt(r,u,g)}}}function la(r,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zt("error",r),zt("load",r);var g=!1,y=!1,C;for(C in u)if(u.hasOwnProperty(C)){var M=u[C];if(M!=null)switch(C){case"src":g=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:gn(r,o,C,M,u,null)}}y&&gn(r,o,"srcSet",u.srcSet,u,null),g&&gn(r,o,"src",u.src,u,null);return;case"input":zt("invalid",r);var B=C=M=y=null,J=null,he=null;for(g in u)if(u.hasOwnProperty(g)){var be=u[g];if(be!=null)switch(g){case"name":y=be;break;case"type":M=be;break;case"checked":J=be;break;case"defaultChecked":he=be;break;case"value":C=be;break;case"defaultValue":B=be;break;case"children":case"dangerouslySetInnerHTML":if(be!=null)throw Error(n(137,o));break;default:gn(r,o,g,be,u,null)}}Jn(r,C,B,J,he,M,y,!1);return;case"select":zt("invalid",r),g=M=C=null;for(y in u)if(u.hasOwnProperty(y)&&(B=u[y],B!=null))switch(y){case"value":C=B;break;case"defaultValue":M=B;break;case"multiple":g=B;default:gn(r,o,y,B,u,null)}o=C,u=M,r.multiple=!!g,o!=null?Aa(r,!!g,o,!1):u!=null&&Aa(r,!!g,u,!0);return;case"textarea":zt("invalid",r),C=y=g=null;for(M in u)if(u.hasOwnProperty(M)&&(B=u[M],B!=null))switch(M){case"value":g=B;break;case"defaultValue":y=B;break;case"children":C=B;break;case"dangerouslySetInnerHTML":if(B!=null)throw Error(n(91));break;default:gn(r,o,M,B,u,null)}Ri(r,g,y,C);return;case"option":for(J in u)u.hasOwnProperty(J)&&(g=u[J],g!=null)&&(J==="selected"?r.selected=g&&typeof g!="function"&&typeof g!="symbol":gn(r,o,J,g,u,null));return;case"dialog":zt("beforetoggle",r),zt("toggle",r),zt("cancel",r),zt("close",r);break;case"iframe":case"object":zt("load",r);break;case"video":case"audio":for(g=0;g<fl.length;g++)zt(fl[g],r);break;case"image":zt("error",r),zt("load",r);break;case"details":zt("toggle",r);break;case"embed":case"source":case"link":zt("error",r),zt("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(he in u)if(u.hasOwnProperty(he)&&(g=u[he],g!=null))switch(he){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:gn(r,o,he,g,u,null)}return;default:if(Qd(o)){for(be in u)u.hasOwnProperty(be)&&(g=u[be],g!==void 0&&_A(r,o,be,g,u,void 0));return}}for(B in u)u.hasOwnProperty(B)&&(g=u[B],g!=null&&gn(r,o,B,g,u,null))}function SE(r,o,u,g){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,C=null,M=null,B=null,J=null,he=null,be=null;for(ve in u){var ke=u[ve];if(u.hasOwnProperty(ve)&&ke!=null)switch(ve){case"checked":break;case"value":break;case"defaultValue":J=ke;default:g.hasOwnProperty(ve)||gn(r,o,ve,null,g,ke)}}for(var Ae in g){var ve=g[Ae];if(ke=u[Ae],g.hasOwnProperty(Ae)&&(ve!=null||ke!=null))switch(Ae){case"type":C=ve;break;case"name":y=ve;break;case"checked":he=ve;break;case"defaultChecked":be=ve;break;case"value":M=ve;break;case"defaultValue":B=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,o));break;default:ve!==ke&&gn(r,o,Ae,ve,g,ke)}}Ut(r,M,B,J,he,be,C,y);return;case"select":ve=M=B=Ae=null;for(C in u)if(J=u[C],u.hasOwnProperty(C)&&J!=null)switch(C){case"value":break;case"multiple":ve=J;default:g.hasOwnProperty(C)||gn(r,o,C,null,g,J)}for(y in g)if(C=g[y],J=u[y],g.hasOwnProperty(y)&&(C!=null||J!=null))switch(y){case"value":Ae=C;break;case"defaultValue":B=C;break;case"multiple":M=C;default:C!==J&&gn(r,o,y,C,g,J)}o=B,u=M,g=ve,Ae!=null?Aa(r,!!u,Ae,!1):!!g!=!!u&&(o!=null?Aa(r,!!u,o,!0):Aa(r,!!u,u?[]:"",!1));return;case"textarea":ve=Ae=null;for(B in u)if(y=u[B],u.hasOwnProperty(B)&&y!=null&&!g.hasOwnProperty(B))switch(B){case"value":break;case"children":break;default:gn(r,o,B,null,g,y)}for(M in g)if(y=g[M],C=u[M],g.hasOwnProperty(M)&&(y!=null||C!=null))switch(M){case"value":Ae=y;break;case"defaultValue":ve=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(n(91));break;default:y!==C&&gn(r,o,M,y,g,C)}ga(r,Ae,ve);return;case"option":for(var ot in u)Ae=u[ot],u.hasOwnProperty(ot)&&Ae!=null&&!g.hasOwnProperty(ot)&&(ot==="selected"?r.selected=!1:gn(r,o,ot,null,g,Ae));for(J in g)Ae=g[J],ve=u[J],g.hasOwnProperty(J)&&Ae!==ve&&(Ae!=null||ve!=null)&&(J==="selected"?r.selected=Ae&&typeof Ae!="function"&&typeof Ae!="symbol":gn(r,o,J,Ae,g,ve));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var pt in u)Ae=u[pt],u.hasOwnProperty(pt)&&Ae!=null&&!g.hasOwnProperty(pt)&&gn(r,o,pt,null,g,Ae);for(he in g)if(Ae=g[he],ve=u[he],g.hasOwnProperty(he)&&Ae!==ve&&(Ae!=null||ve!=null))switch(he){case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(n(137,o));break;default:gn(r,o,he,Ae,g,ve)}return;default:if(Qd(o)){for(var fn in u)Ae=u[fn],u.hasOwnProperty(fn)&&Ae!==void 0&&!g.hasOwnProperty(fn)&&_A(r,o,fn,void 0,g,Ae);for(be in g)Ae=g[be],ve=u[be],!g.hasOwnProperty(be)||Ae===ve||Ae===void 0&&ve===void 0||_A(r,o,be,Ae,g,ve);return}}for(var ie in u)Ae=u[ie],u.hasOwnProperty(ie)&&Ae!=null&&!g.hasOwnProperty(ie)&&gn(r,o,ie,null,g,Ae);for(ke in g)Ae=g[ke],ve=u[ke],!g.hasOwnProperty(ke)||Ae===ve||Ae==null&&ve==null||gn(r,o,ke,Ae,g,ve)}function fy(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function wE(){if(typeof performance.getEntriesByType=="function"){for(var r=0,o=0,u=performance.getEntriesByType("resource"),g=0;g<u.length;g++){var y=u[g],C=y.transferSize,M=y.initiatorType,B=y.duration;if(C&&B&&fy(M)){for(M=0,B=y.responseEnd,g+=1;g<u.length;g++){var J=u[g],he=J.startTime;if(he>B)break;var be=J.transferSize,ke=J.initiatorType;be&&fy(ke)&&(J=J.responseEnd,M+=be*(J<B?1:(B-he)/(J-he)))}if(--g,o+=8*(C+M)/(y.duration/1e3),r++,10<r)break}}if(0<r)return o/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var RA=null,NA=null;function nu(r){return r.nodeType===9?r:r.ownerDocument}function py(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function my(r,o){if(r===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&o==="foreignObject"?0:r}function GA(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var LA=null;function TE(){var r=window.event;return r&&r.type==="popstate"?r===LA?!1:(LA=r,!0):(LA=null,!1)}var vy=typeof setTimeout=="function"?setTimeout:void 0,kE=typeof clearTimeout=="function"?clearTimeout:void 0,yy=typeof Promise=="function"?Promise:void 0,EE=typeof queueMicrotask=="function"?queueMicrotask:typeof yy<"u"?function(r){return yy.resolve(null).then(r).catch(xE)}:vy;function xE(r){setTimeout(function(){throw r})}function Er(r){return r==="head"}function by(r,o){var u=o,g=0;do{var y=u.nextSibling;if(r.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"||u==="/&"){if(g===0){r.removeChild(y),Ws(o);return}g--}else if(u==="$"||u==="$?"||u==="$~"||u==="$!"||u==="&")g++;else if(u==="html")ml(r.ownerDocument.documentElement);else if(u==="head"){u=r.ownerDocument.head,ml(u);for(var C=u.firstChild;C;){var M=C.nextSibling,B=C.nodeName;C[yn]||B==="SCRIPT"||B==="STYLE"||B==="LINK"&&C.rel.toLowerCase()==="stylesheet"||u.removeChild(C),C=M}}else u==="body"&&ml(r.ownerDocument.body);u=y}while(u);Ws(o)}function Cy(r,o){var u=r;r=0;do{var g=u.nextSibling;if(u.nodeType===1?o?(u._stashedDisplay=u.style.display,u.style.display="none"):(u.style.display=u._stashedDisplay||"",u.getAttribute("style")===""&&u.removeAttribute("style")):u.nodeType===3&&(o?(u._stashedText=u.nodeValue,u.nodeValue=""):u.nodeValue=u._stashedText||""),g&&g.nodeType===8)if(u=g.data,u==="/$"){if(r===0)break;r--}else u!=="$"&&u!=="$?"&&u!=="$~"&&u!=="$!"||r++;u=g}while(u)}function BA(r){var o=r.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":BA(u),ct(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}r.removeChild(u)}}function PE(r,o,u,g){for(;r.nodeType===1;){var y=u;if(r.nodeName.toLowerCase()!==o.toLowerCase()){if(!g&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(g){if(!r[yn])switch(o){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(C=r.getAttribute("rel"),C==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(C!==y.rel||r.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||r.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||r.getAttribute("title")!==(y.title==null?null:y.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(C=r.getAttribute("src"),(C!==(y.src==null?null:y.src)||r.getAttribute("type")!==(y.type==null?null:y.type)||r.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&C&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(o==="input"&&r.type==="hidden"){var C=y.name==null?null:""+y.name;if(y.type==="hidden"&&r.getAttribute("name")===C)return r}else return r;if(r=Wa(r.nextSibling),r===null)break}return null}function ME(r,o,u){if(o==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!u||(r=Wa(r.nextSibling),r===null))return null;return r}function Sy(r,o){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=Wa(r.nextSibling),r===null))return null;return r}function FA(r){return r.data==="$?"||r.data==="$~"}function UA(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function IE(r,o){var u=r.ownerDocument;if(r.data==="$~")r._reactRetry=o;else if(r.data!=="$?"||u.readyState!=="loading")o();else{var g=function(){o(),u.removeEventListener("DOMContentLoaded",g)};u.addEventListener("DOMContentLoaded",g),r._reactRetry=g}}function Wa(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return r}var KA=null;function wy(r){r=r.nextSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="/$"||u==="/&"){if(o===0)return Wa(r.nextSibling);o--}else u!=="$"&&u!=="$!"&&u!=="$?"&&u!=="$~"&&u!=="&"||o++}r=r.nextSibling}return null}function Ty(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var u=r.data;if(u==="$"||u==="$!"||u==="$?"||u==="$~"||u==="&"){if(o===0)return r;o--}else u!=="/$"&&u!=="/&"||o++}r=r.previousSibling}return null}function ky(r,o,u){switch(o=nu(u),r){case"html":if(r=o.documentElement,!r)throw Error(n(452));return r;case"head":if(r=o.head,!r)throw Error(n(453));return r;case"body":if(r=o.body,!r)throw Error(n(454));return r;default:throw Error(n(451))}}function ml(r){for(var o=r.attributes;o.length;)r.removeAttributeNode(o[0]);ct(r)}var $a=new Map,Ey=new Set;function au(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Wi=U.d;U.d={f:DE,r:_E,D:RE,C:NE,L:GE,m:LE,X:FE,S:BE,M:UE};function DE(){var r=Wi.f(),o=Yc();return r||o}function _E(r){var o=Lt(r);o!==null&&o.tag===5&&o.type==="form"?Hm(o):Wi.r(r)}var qs=typeof document>"u"?null:document;function xy(r,o,u){var g=qs;if(g&&typeof o=="string"&&o){var y=St(o);y='link[rel="'+r+'"][href="'+y+'"]',typeof u=="string"&&(y+='[crossorigin="'+u+'"]'),Ey.has(y)||(Ey.add(y),r={rel:r,crossOrigin:u,href:o},g.querySelector(y)===null&&(o=g.createElement("link"),la(o,"link",r),Nt(o),g.head.appendChild(o)))}}function RE(r){Wi.D(r),xy("dns-prefetch",r,null)}function NE(r,o){Wi.C(r,o),xy("preconnect",r,o)}function GE(r,o,u){Wi.L(r,o,u);var g=qs;if(g&&r&&o){var y='link[rel="preload"][as="'+St(o)+'"]';o==="image"&&u&&u.imageSrcSet?(y+='[imagesrcset="'+St(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(y+='[imagesizes="'+St(u.imageSizes)+'"]')):y+='[href="'+St(r)+'"]';var C=y;switch(o){case"style":C=Ys(r);break;case"script":C=Xs(r)}$a.has(C)||(r=f({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:r,as:o},u),$a.set(C,r),g.querySelector(y)!==null||o==="style"&&g.querySelector(vl(C))||o==="script"&&g.querySelector(yl(C))||(o=g.createElement("link"),la(o,"link",r),Nt(o),g.head.appendChild(o)))}}function LE(r,o){Wi.m(r,o);var u=qs;if(u&&r){var g=o&&typeof o.as=="string"?o.as:"script",y='link[rel="modulepreload"][as="'+St(g)+'"][href="'+St(r)+'"]',C=y;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=Xs(r)}if(!$a.has(C)&&(r=f({rel:"modulepreload",href:r},o),$a.set(C,r),u.querySelector(y)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(yl(C)))return}g=u.createElement("link"),la(g,"link",r),Nt(g),u.head.appendChild(g)}}}function BE(r,o,u){Wi.S(r,o,u);var g=qs;if(g&&r){var y=qn(g).hoistableStyles,C=Ys(r);o=o||"default";var M=y.get(C);if(!M){var B={loading:0,preload:null};if(M=g.querySelector(vl(C)))B.loading=5;else{r=f({rel:"stylesheet",href:r,"data-precedence":o},u),(u=$a.get(C))&&zA(r,u);var J=M=g.createElement("link");Nt(J),la(J,"link",r),J._p=new Promise(function(he,be){J.onload=he,J.onerror=be}),J.addEventListener("load",function(){B.loading|=1}),J.addEventListener("error",function(){B.loading|=2}),B.loading|=4,iu(M,o,g)}M={type:"stylesheet",instance:M,count:1,state:B},y.set(C,M)}}}function FE(r,o){Wi.X(r,o);var u=qs;if(u&&r){var g=qn(u).hoistableScripts,y=Xs(r),C=g.get(y);C||(C=u.querySelector(yl(y)),C||(r=f({src:r,async:!0},o),(o=$a.get(y))&&OA(r,o),C=u.createElement("script"),Nt(C),la(C,"link",r),u.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},g.set(y,C))}}function UE(r,o){Wi.M(r,o);var u=qs;if(u&&r){var g=qn(u).hoistableScripts,y=Xs(r),C=g.get(y);C||(C=u.querySelector(yl(y)),C||(r=f({src:r,async:!0,type:"module"},o),(o=$a.get(y))&&OA(r,o),C=u.createElement("script"),Nt(C),la(C,"link",r),u.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},g.set(y,C))}}function Py(r,o,u,g){var y=(y=oe.current)?au(y):null;if(!y)throw Error(n(446));switch(r){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Ys(u.href),u=qn(y).hoistableStyles,g=u.get(o),g||(g={type:"style",instance:null,count:0,state:null},u.set(o,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){r=Ys(u.href);var C=qn(y).hoistableStyles,M=C.get(r);if(M||(y=y.ownerDocument||y,M={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(r,M),(C=y.querySelector(vl(r)))&&!C._p&&(M.instance=C,M.state.loading=5),$a.has(r)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},$a.set(r,u),C||KE(y,r,u,M.state))),o&&g===null)throw Error(n(528,""));return M}if(o&&g!==null)throw Error(n(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Xs(u),u=qn(y).hoistableScripts,g=u.get(o),g||(g={type:"script",instance:null,count:0,state:null},u.set(o,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,r))}}function Ys(r){return'href="'+St(r)+'"'}function vl(r){return'link[rel="stylesheet"]['+r+"]"}function My(r){return f({},r,{"data-precedence":r.precedence,precedence:null})}function KE(r,o,u,g){r.querySelector('link[rel="preload"][as="style"]['+o+"]")?g.loading=1:(o=r.createElement("link"),g.preload=o,o.addEventListener("load",function(){return g.loading|=1}),o.addEventListener("error",function(){return g.loading|=2}),la(o,"link",u),Nt(o),r.head.appendChild(o))}function Xs(r){return'[src="'+St(r)+'"]'}function yl(r){return"script[async]"+r}function Iy(r,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var g=r.querySelector('style[data-href~="'+St(u.href)+'"]');if(g)return o.instance=g,Nt(g),g;var y=f({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return g=(r.ownerDocument||r).createElement("style"),Nt(g),la(g,"style",y),iu(g,u.precedence,r),o.instance=g;case"stylesheet":y=Ys(u.href);var C=r.querySelector(vl(y));if(C)return o.state.loading|=4,o.instance=C,Nt(C),C;g=My(u),(y=$a.get(y))&&zA(g,y),C=(r.ownerDocument||r).createElement("link"),Nt(C);var M=C;return M._p=new Promise(function(B,J){M.onload=B,M.onerror=J}),la(C,"link",g),o.state.loading|=4,iu(C,u.precedence,r),o.instance=C;case"script":return C=Xs(u.src),(y=r.querySelector(yl(C)))?(o.instance=y,Nt(y),y):(g=u,(y=$a.get(C))&&(g=f({},u),OA(g,y)),r=r.ownerDocument||r,y=r.createElement("script"),Nt(y),la(y,"link",g),r.head.appendChild(y),o.instance=y);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(g=o.instance,o.state.loading|=4,iu(g,u.precedence,r));return o.instance}function iu(r,o,u){for(var g=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=g.length?g[g.length-1]:null,C=y,M=0;M<g.length;M++){var B=g[M];if(B.dataset.precedence===o)C=B;else if(C!==y)break}C?C.parentNode.insertBefore(r,C.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(r,o.firstChild))}function zA(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.title==null&&(r.title=o.title)}function OA(r,o){r.crossOrigin==null&&(r.crossOrigin=o.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=o.referrerPolicy),r.integrity==null&&(r.integrity=o.integrity)}var ru=null;function Dy(r,o,u){if(ru===null){var g=new Map,y=ru=new Map;y.set(u,g)}else y=ru,g=y.get(u),g||(g=new Map,y.set(u,g));if(g.has(r))return g;for(g.set(r,null),u=u.getElementsByTagName(r),y=0;y<u.length;y++){var C=u[y];if(!(C[yn]||C[Ne]||r==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var M=C.getAttribute(o)||"";M=r+M;var B=g.get(M);B?B.push(C):g.set(M,[C])}}return g}function _y(r,o,u){r=r.ownerDocument||r,r.head.insertBefore(u,o==="title"?r.querySelector("head > title"):null)}function zE(r,o,u){if(u===1||o.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;return o.rel==="stylesheet"?(r=o.disabled,typeof o.precedence=="string"&&r==null):!0;case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function Ry(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function OE(r,o,u,g){if(u.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var y=Ys(g.href),C=o.querySelector(vl(y));if(C){o=C._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(r.count++,r=su.bind(r),o.then(r,r)),u.state.loading|=4,u.instance=C,Nt(C);return}C=o.ownerDocument||o,g=My(g),(y=$a.get(y))&&zA(g,y),C=C.createElement("link"),Nt(C);var M=C;M._p=new Promise(function(B,J){M.onload=B,M.onerror=J}),la(C,"link",g),u.instance=C}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(r.count++,u=su.bind(r),o.addEventListener("load",u),o.addEventListener("error",u))}}var HA=0;function HE(r,o){return r.stylesheets&&r.count===0&&lu(r,r.stylesheets),0<r.count||0<r.imgCount?function(u){var g=setTimeout(function(){if(r.stylesheets&&lu(r,r.stylesheets),r.unsuspend){var C=r.unsuspend;r.unsuspend=null,C()}},6e4+o);0<r.imgBytes&&HA===0&&(HA=62500*wE());var y=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&lu(r,r.stylesheets),r.unsuspend)){var C=r.unsuspend;r.unsuspend=null,C()}},(r.imgBytes>HA?50:800)+o);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(g),clearTimeout(y)}}:null}function su(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)lu(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var ou=null;function lu(r,o){r.stylesheets=null,r.unsuspend!==null&&(r.count++,ou=new Map,o.forEach(VE,r),ou=null,su.call(r))}function VE(r,o){if(!(o.state.loading&4)){var u=ou.get(r);if(u)var g=u.get(null);else{u=new Map,ou.set(r,u);for(var y=r.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<y.length;C++){var M=y[C];(M.nodeName==="LINK"||M.getAttribute("media")!=="not all")&&(u.set(M.dataset.precedence,M),g=M)}g&&u.set(null,g)}y=o.instance,M=y.getAttribute("data-precedence"),C=u.get(M)||g,C===g&&u.set(null,y),u.set(M,y),this.count++,g=su.bind(this),y.addEventListener("load",g),y.addEventListener("error",g),C?C.parentNode.insertBefore(y,C.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(y,r.firstChild)),o.state.loading|=4}}var bl={$$typeof:P,Provider:null,Consumer:null,_currentValue:Y,_currentValue2:Y,_threadCount:0};function jE(r,o,u,g,y,C,M,B,J){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=He(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=He(0),this.hiddenUpdates=He(null),this.identifierPrefix=g,this.onUncaughtError=y,this.onCaughtError=C,this.onRecoverableError=M,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=J,this.incompleteTransitions=new Map}function Ny(r,o,u,g,y,C,M,B,J,he,be,ke){return r=new jE(r,o,u,M,J,he,be,ke,B),o=1,C===!0&&(o|=24),C=Na(3,null,null,o),r.current=C,C.stateNode=r,o=Sh(),o.refCount++,r.pooledCache=o,o.refCount++,C.memoizedState={element:g,isDehydrated:u,cache:o},Eh(C),r}function Gy(r){return r?(r=Es,r):Es}function Ly(r,o,u,g,y,C){y=Gy(y),g.context===null?g.context=y:g.pendingContext=y,g=fr(o),g.payload={element:u},C=C===void 0?null:C,C!==null&&(g.callback=C),u=pr(r,g,o),u!==null&&(Ma(u,r,o),Jo(u,r,o))}function By(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var u=r.retryLane;r.retryLane=u!==0&&u<o?u:o}}function VA(r,o){By(r,o),(r=r.alternate)&&By(r,o)}function Fy(r){if(r.tag===13||r.tag===31){var o=qr(r,67108864);o!==null&&Ma(o,r,67108864),VA(r,67108864)}}function Uy(r){if(r.tag===13||r.tag===31){var o=Ua();o=Me(o);var u=qr(r,o);u!==null&&Ma(u,r,o),VA(r,o)}}var cu=!0;function QE(r,o,u,g){var y=F.T;F.T=null;var C=U.p;try{U.p=2,jA(r,o,u,g)}finally{U.p=C,F.T=y}}function qE(r,o,u,g){var y=F.T;F.T=null;var C=U.p;try{U.p=8,jA(r,o,u,g)}finally{U.p=C,F.T=y}}function jA(r,o,u,g){if(cu){var y=QA(g);if(y===null)DA(r,o,g,uu,u),zy(r,g);else if(XE(y,r,o,u,g))g.stopPropagation();else if(zy(r,g),o&4&&-1<YE.indexOf(r)){for(;y!==null;){var C=Lt(y);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var M=cn(C.pendingLanes);if(M!==0){var B=C;for(B.pendingLanes|=2,B.entangledLanes|=2;M;){var J=1<<31-Ce(M);B.entanglements[1]|=J,M&=~J}bi(C),(nn&6)===0&&(Qc=st()+500,gl(0))}}break;case 31:case 13:B=qr(C,2),B!==null&&Ma(B,C,2),Yc(),VA(C,2)}if(C=QA(g),C===null&&DA(r,o,g,uu,u),C===y)break;y=C}y!==null&&g.stopPropagation()}else DA(r,o,g,null,u)}}function QA(r){return r=Yd(r),qA(r)}var uu=null;function qA(r){if(uu=null,r=vt(r),r!==null){var o=s(r);if(o===null)r=null;else{var u=o.tag;if(u===13){if(r=l(o),r!==null)return r;r=null}else if(u===31){if(r=c(o),r!==null)return r;r=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null)}}return uu=r,null}function Ky(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(yt()){case ft:return 2;case Ue:return 8;case Be:case it:return 32;case mt:return 268435456;default:return 32}default:return 32}}var YA=!1,xr=null,Pr=null,Mr=null,Cl=new Map,Sl=new Map,Ir=[],YE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function zy(r,o){switch(r){case"focusin":case"focusout":xr=null;break;case"dragenter":case"dragleave":Pr=null;break;case"mouseover":case"mouseout":Mr=null;break;case"pointerover":case"pointerout":Cl.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sl.delete(o.pointerId)}}function wl(r,o,u,g,y,C){return r===null||r.nativeEvent!==C?(r={blockedOn:o,domEventName:u,eventSystemFlags:g,nativeEvent:C,targetContainers:[y]},o!==null&&(o=Lt(o),o!==null&&Fy(o)),r):(r.eventSystemFlags|=g,o=r.targetContainers,y!==null&&o.indexOf(y)===-1&&o.push(y),r)}function XE(r,o,u,g,y){switch(o){case"focusin":return xr=wl(xr,r,o,u,g,y),!0;case"dragenter":return Pr=wl(Pr,r,o,u,g,y),!0;case"mouseover":return Mr=wl(Mr,r,o,u,g,y),!0;case"pointerover":var C=y.pointerId;return Cl.set(C,wl(Cl.get(C)||null,r,o,u,g,y)),!0;case"gotpointercapture":return C=y.pointerId,Sl.set(C,wl(Sl.get(C)||null,r,o,u,g,y)),!0}return!1}function Oy(r){var o=vt(r.target);if(o!==null){var u=s(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){r.blockedOn=o,Oe(r.priority,function(){Uy(u)});return}}else if(o===31){if(o=c(u),o!==null){r.blockedOn=o,Oe(r.priority,function(){Uy(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){r.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}r.blockedOn=null}function du(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var u=QA(r.nativeEvent);if(u===null){u=r.nativeEvent;var g=new u.constructor(u.type,u);qd=g,u.target.dispatchEvent(g),qd=null}else return o=Lt(u),o!==null&&Fy(o),r.blockedOn=u,!1;o.shift()}return!0}function Hy(r,o,u){du(r)&&u.delete(o)}function WE(){YA=!1,xr!==null&&du(xr)&&(xr=null),Pr!==null&&du(Pr)&&(Pr=null),Mr!==null&&du(Mr)&&(Mr=null),Cl.forEach(Hy),Sl.forEach(Hy)}function hu(r,o){r.blockedOn===o&&(r.blockedOn=null,YA||(YA=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,WE)))}var Au=null;function Vy(r){Au!==r&&(Au=r,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){Au===r&&(Au=null);for(var o=0;o<r.length;o+=3){var u=r[o],g=r[o+1],y=r[o+2];if(typeof g!="function"){if(qA(g||u)===null)continue;break}var C=Lt(u);C!==null&&(r.splice(o,3),o-=3,Qh(C,{pending:!0,data:y,method:u.method,action:g},g,y))}}))}function Ws(r){function o(J){return hu(J,r)}xr!==null&&hu(xr,r),Pr!==null&&hu(Pr,r),Mr!==null&&hu(Mr,r),Cl.forEach(o),Sl.forEach(o);for(var u=0;u<Ir.length;u++){var g=Ir[u];g.blockedOn===r&&(g.blockedOn=null)}for(;0<Ir.length&&(u=Ir[0],u.blockedOn===null);)Oy(u),u.blockedOn===null&&Ir.shift();if(u=(r.ownerDocument||r).$$reactFormReplay,u!=null)for(g=0;g<u.length;g+=3){var y=u[g],C=u[g+1],M=y[Je]||null;if(typeof C=="function")M||Vy(u);else if(M){var B=null;if(C&&C.hasAttribute("formAction")){if(y=C,M=C[Je]||null)B=M.formAction;else if(qA(y)!==null)continue}else B=M.action;typeof B=="function"?u[g+1]=B:(u.splice(g,3),g-=3),Vy(u)}}}function jy(){function r(C){C.canIntercept&&C.info==="react-transition"&&C.intercept({handler:function(){return new Promise(function(M){return y=M})},focusReset:"manual",scroll:"manual"})}function o(){y!==null&&(y(),y=null),g||setTimeout(u,20)}function u(){if(!g&&!navigation.transition){var C=navigation.currentEntry;C&&C.url!=null&&navigation.navigate(C.url,{state:C.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,y=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(u,100),function(){g=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),y!==null&&(y(),y=null)}}}function XA(r){this._internalRoot=r}gu.prototype.render=XA.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));var u=o.current,g=Ua();Ly(u,g,r,o,null,null)},gu.prototype.unmount=XA.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;Ly(r.current,2,null,r,null,null),Yc(),o[qt]=null}};function gu(r){this._internalRoot=r}gu.prototype.unstable_scheduleHydration=function(r){if(r){var o=Ve();r={blockedOn:null,target:r,priority:o};for(var u=0;u<Ir.length&&o!==0&&o<Ir[u].priority;u++);Ir.splice(u,0,r),u===0&&Oy(r)}};var Qy=e.version;if(Qy!=="19.2.3")throw Error(n(527,Qy,"19.2.3"));U.findDOMNode=function(r){var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=d(o),r=r!==null?A(r):null,r=r===null?null:r.stateNode,r};var $E={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:F,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fu.isDisabled&&fu.supportsFiber)try{dt=fu.inject($E),Mt=fu}catch{}}return kl.createRoot=function(r,o){if(!i(r))throw Error(n(299));var u=!1,g="",y=Zm,C=ev,M=tv;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(C=o.onCaughtError),o.onRecoverableError!==void 0&&(M=o.onRecoverableError)),o=Ny(r,1,!1,null,null,u,g,null,y,C,M,jy),r[qt]=o.current,IA(r),new XA(o)},kl.hydrateRoot=function(r,o,u){if(!i(r))throw Error(n(299));var g=!1,y="",C=Zm,M=ev,B=tv,J=null;return u!=null&&(u.unstable_strictMode===!0&&(g=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onUncaughtError!==void 0&&(C=u.onUncaughtError),u.onCaughtError!==void 0&&(M=u.onCaughtError),u.onRecoverableError!==void 0&&(B=u.onRecoverableError),u.formState!==void 0&&(J=u.formState)),o=Ny(r,1,!0,o,u??null,g,y,J,C,M,B,jy),o.context=Gy(null),u=o.current,g=Ua(),g=Me(g),y=fr(g),y.callback=null,pr(u,y,g),u=g,o.current.lanes=u,Ke(o,u),bi(o),r[qt]=o.current,IA(r),new gu(o)},kl.version="19.2.3",kl}var ib;function ox(){if(ib)return ZA.exports;ib=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),ZA.exports=sx(),ZA.exports}var lx=ox();const cx=uS(lx),dS=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})}),hS=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),vo=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})}),ux=a=>T.jsxs("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.07 17.71a11.14 11.14 0 0 1-8.15-4.32.75.75 0 0 1 .89-1.2l.06.03A9.64 9.64 0 0 0 12 14.25a9.59 9.59 0 0 0 5.42-1.63l.06-.03a.75.75 0 0 1 .9 1.2 11.12 11.12 0 0 1-8.31 3.9Z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.75A4.5 4.5 0 0 1 16.5 11.25H7.5A4.5 4.5 0 0 1 12 6.75Z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.25 7.5a.75.75 0 0 1 .75-.75h.01a.75.75 0 0 1 .75.75v.01a.75.75 0 0 1-.75.75h-.01a.75.75 0 0 1-.75-.75V7.5Zm-3.75 1.5a.75.75 0 0 1 .75-.75h.01a.75.75 0 0 1 .75.75v.01a.75.75 0 0 1-.75.75h-.01a.75.75 0 0 1-.75-.75v-.01Zm-3.75-1.5a.75.75 0 0 1 .75-.75h.01a.75.75 0 0 1 .75.75v.01a.75.75 0 0 1-.75.75H9.76a.75.75 0 0 1-.75-.75V7.5Z"})]}),Vu=a=>T.jsxs("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})]}),dx=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})}),AS=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3.75H6.912a2.25 2.25 0 0 0-2.15 1.588L2.35 13.177a2.25 2.25 0 0 0-.1.661V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18v-4.162c0-.224-.034-.447-.1-.661L19.24 5.338a2.25 2.25 0 0 0-2.15-1.588H15M2.25 13.5h3.86a2.25 2.25 0 0 1 2.012 1.244l.256.512a2.25 2.25 0 0 0 2.013 1.244h3.718a2.25 2.25 0 0 0 2.013-1.244l.256-.512a2.25 2.25 0 0 1 2.013-1.244h3.859M12 3v8.25m0 0-3-3m3 3 3-3"})}),gS=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3.75 9.75v6.172c0 .621.504 1.125 1.125 1.125h16.5c.621 0 1.125-.504 1.125-1.125V9.75M3.75 9.75l.75-4.5a2.25 2.25 0 0 1 2.14-1.875h4.16c.928 0 1.77.522 2.14 1.333l.93 1.682M3.75 9.75h16.5"})}),ju=a=>T.jsxs("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5Z"})]}),xg=a=>T.jsxs("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.5 9.75A2.25 2.25 0 0 1 6.75 7.5h10.5a2.25 2.25 0 0 1 2.25 2.25v7.5a2.25 2.25 0 0 1-2.25-2.25H6.75a2.25 2.25 0 0 1-2.25-2.25v-7.5Z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 2.25 2.25V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039h-5.232a2.192 2.192 0 0 0-1.736 1.039l-.821 1.316Z"})]}),Pg=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.827 6.175A2.31 2.31 0 0 1 5.186 7.23c-.38.054-.757.112-1.134.175C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 0 0 2.25 2.25h15A2.25 2.25 0 0 0 21.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 0 0-1.134-.175 2.31 2.31 0 0 1-1.64-1.055l-.822-1.316a2.192 2.192 0 0 0-1.736-1.039 48.774 48.774 0 0 0-5.232 0 2.192 2.192 0 0 0-1.736 1.039l-.821 1.316ZM16.5 12.75a4.5 4.5 0 1 1-9 0 4.5 4.5 0 0 1 9 0ZM18.75 10.5h.008v.008h-.008V10.5ZM6 18 18 6M6 6l12 12"})}),tr=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})}),fS=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5"})}),pd=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"})}),pS=a=>T.jsxs("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.97 12.64L10.25 16.5V7.5L15.97 12.64Z"})]}),mS=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.75 5.25v13.5m-7.5-13.5v13.5"})}),Pi=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18 18 6M6 6l12 12"})}),vS=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.09 9a3 3 0 0 1 5.82 1c0 1.657-1.79 2.25-2.5 2.75-.5.35-.5.75-.5 1.25m.01 4h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),md=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),vd=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),Qu=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.5v15m7.5-7.5h-15"})}),yS=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.5 21L10.5 15.75M10.5 15.75C10.5 14.925 10.185 14.1375 9.645 13.5975L4.8 9M10.5 15.75L15.3 9M19.5 9L15.3 9M15.3 9C14.475 9 13.6875 8.685 13.1475 8.145L10.5 5.25M4.5 9H7.5M4.5 9L2.25 6.75M4.5 9L2.25 11.25M19.5 9L21.75 6.75M19.5 9L21.75 11.25"})}),Sf=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-7.5-3-4.72-4.72a.75.75 0 0 0-1.28.53v15.88a.75.75 0 0 0 1.28.53l4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.01 9.01 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"})}),hx=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})}),Ax=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.355a7.5 7.5 0 0 1-5.25 0M12 18a3.75 3.75 0 0 0 3.75-3.75V9.75A3.75 3.75 0 0 0 12 6V4.5m0 1.5A3.75 3.75 0 0 1 8.25 9.75V14.25A3.75 3.75 0 0 0 12 18Zm0-13.5h.008v.008H12V4.5Z"})}),Nr=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 15 3 9m0 0 6-6M3 9h12a6 6 0 0 1 0 12h-3"})}),Zl=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.687 7.687a1.5 1.5 0 0 0 2.122 2.122l7.687-7.687-2.122-2.122Z"})}),bS=a=>T.jsxs("svg",{...a,viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[T.jsx("path",{d:"M9 1L1 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.8"}),T.jsx("path",{d:"M9 5L5 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeOpacity:"0.8"})]}),yd=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12.56 0c1.153 0 2.243.096 3.298.29m9.262 0c-.342.052-.682.107-1.022.166m0 0a48.11 48.11 0 0 1 3.478-.397m0 0a48.997 48.997 0 0 1-10.026 0c-1.153 0-2.243.096-3.298.29m10.026 0c.342.052.682.107 1.022.166m-3.478-.397a48.755 48.755 0 0 1-4.254-.2 48.755 48.755 0 0 0-4.254.2M14.74 9v10.5m-5.088 0V9"})}),qu=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.25 6.75v12.088a.75.75 0 0 1-1.125.65L12 17.25l-4.125 2.238a.75.75 0 0 1-1.125-.65V6.75A2.25 2.25 0 0 1 9 4.5h6a2.25 2.25 0 0 1 2.25 2.25Z"})}),As=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.5 12.75l6 6 9-13.5"})}),Mg=a=>T.jsxs("svg",{...a,fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.343 3.94c.09-.542.56-.94 1.11-.94h1.093c.55 0 1.02.398 1.11.94l.149.894c.07.424.384.764.78.93s.844.17 1.259.077l.806-.295c.502-.184 1.036.023 1.298.47l.568.875c.262.447.212.998-.106 1.349l-.658.54c-.417.345-.635.848-.635 1.374v.266c0 .526.218 1.03.635 1.374l.658.54c.318.351.368.902.106 1.349l-.568.875c-.262.447-.796.655-1.298.47l-.806-.295c-.415-.093-.839.007-1.259.077s-.71.506-.78.93l-.149.894c-.09.542-.56.94-1.11-.94h-1.093c-.55 0-1.02-.398-1.11-.94l-.149-.894c-.07-.424-.384-.764-.78-.93s-.844-.17-1.259.077l-.806.295c-.502-.184-1.036.023-1.298.47l-.568.875c-.262.447-.212.998.106 1.349l.658.54c.417-.345.635.848-.635-1.374v-.266c0-.526-.218-1.03-.635-1.374l-.658-.54c-.318-.351-.368.902-.106-1.349l.568.875c.262.447.796.655 1.298.47l.806.295c.415.093.839.007 1.259.077s.71-.506.78.93l.149.894Z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})]}),gx=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})}),CS=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 9l3 3-3 3m5 0h3M5 20h14a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),fx=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.05 4.575a1.575 1.575 0 1 0-3.15 0v3m3.15-3v-1.5a1.575 1.575 0 0 1 3.15 0v1.5m-3.15 0 .075 5.951a.983.983 0 0 1-.825 1.002l-.005.001a1 1 0 0 1-1.03-.997L8.165 4.656a1.575 1.575 0 0 0-3.15 0v3.333c0 .526.17 1.033.486 1.442l3.45 4.6 2.25 7.5a2.25 2.25 0 0 0 4.306 0l2.25-7.5a6.002 6.002 0 0 0-4.05-7.658V4.575a1.575 1.575 0 0 0-3.15 0v1.5"})}),px=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.348 14.652a3.75 3.75 0 0 1 0-5.304m5.304 0a3.75 3.75 0 0 1 0 5.304m-7.425 2.121a6.75 6.75 0 0 1 0-9.546m9.546 0a6.75 6.75 0 0 1 0 9.546M5.106 18.894c-3.808-3.807-3.808-9.98 0-13.788m13.788 0c3.808 3.807 3.808 9.98 0 13.788M12 12h.008v.008H12V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"})}),SS=a=>T.jsxs("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7.5c3 0 6 0 9 0 2 0 3-1.5 3-3s-1.5-3-3-3"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12h12c1.5 0 2.5-1 2.5-2.5S16.5 7 15 7"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 16.5h6c1.5 0 2.5 1 2.5 2.5S10.5 21 9 21"})]}),Yu=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3l7 3v6c0 5-3.5 8.5-7 9-3.5-.5-7-4-7-9V6l7-3z"})}),wS=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 2L4 14h7l-2 8 9-12h-7l2-8z"})}),TS=a=>T.jsxs("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5.5c2.7-1.2 5.3-1.2 8 0 2.7-1.2 5.3-1.2 8 0v4c0 4-3 7.5-8 8-5-.5-8-4-8-8v-4z"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.5 10.5h.01M12 11.5h.01M9 14c1.2.8 2.8.8 4 0"})]}),kS=a=>T.jsxs("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[T.jsx("circle",{cx:"12",cy:"12",r:"9",strokeWidth:2}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.5 8.5l-2.2 5.4-5.4 2.2 2.2-5.4 5.4-2.2z"})]}),Ig=a=>T.jsxs("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7l-3 3 3 3M4 10h9a4 4 0 0 0 4-4V5"}),T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17l3-3-3-3M20 14H11a4 4 0 0 1-4 4v1"})]}),ES=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7.5 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm9 0a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5ZM10.5 10l3 3m0 0 3-3m-3 3V3"})}),xS=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"})}),Dg=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z"})}),PS=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"})}),Xu=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.75 5.25a3 3 0 0 1 3 3m3 0a6 6 0 0 1-7.029 5.912c-.563-.097-1.159.026-1.563.43L10.5 17.25H8.25v2.25H6v2.25H2.25v-2.818c0-.597.237-1.17.659-1.591l6.499-6.499c.404-.404.527-1 .43-1.563A6 6 0 1 1 21.75 8.25Z"})}),MS=a=>T.jsx("svg",{...a,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:T.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.25 8.25h19.5M2.25 9h19.5m-16.5 5.25h6m-6 2.25h3m-3.75 3h15a2.25 2.25 0 0 0 2.25-2.25V6.75a2.25 2.25 0 0 0-2.25-2.25h-15a2.25 2.25 0 0 0-2.25 2.25v10.5a2.25 2.25 0 0 0 2.25 2.25Z"})}),ag=Object.freeze(Object.defineProperty({__proto__:null,IconBolt:wS,IconBookOpen:hS,IconBookmark:qu,IconCamera:ju,IconCameraFront:xg,IconCameraOff:Pg,IconCheck:As,IconChevronLeft:md,IconChevronRight:vd,IconClock:hx,IconCog:Mg,IconCompass:kS,IconCreditCard:MS,IconEyeOpen:Vu,IconFolderOpen:gS,IconGlobe:xS,IconGripCorner:bS,IconHandRaised:fx,IconKey:Xu,IconKeyboard:dx,IconLightBulb:Ax,IconMask:TS,IconMessageSquare:Dg,IconMicrophone:dS,IconPaperclip:Zl,IconPause:mS,IconPencil:tr,IconPlay:pS,IconPlus:Qu,IconQuestionMarkCircle:vS,IconRobot:gx,IconSave:AS,IconScissors:ES,IconSend:fS,IconShield:Yu,IconSleepingZzz:ux,IconSparkles:vo,IconSpeaker:pd,IconSwap:Ig,IconTarget:PS,IconTerminal:CS,IconTranslate:yS,IconTrash:yd,IconUndo:Nr,IconVolumeOff:Sf,IconWaveform:px,IconWind:SS,IconXMark:Pi},Symbol.toStringTag,{value:"Module"})),rb=({t:a,message:e,maxVisibleMessages:t,onChangeMaxVisibleMessages:n,updateMessage:i})=>{const[s,l]=x.useState(!1),[c,h]=x.useState(""),d=k=>{k.stopPropagation(),k.preventDefault(),h(e.chatSummary||""),l(!0)},A=k=>{k?.stopPropagation(),k?.preventDefault(),i&&i(e.id,{chatSummary:c.trim()||void 0}),l(!1)},f=k=>{k.stopPropagation(),k.preventDefault(),l(!1)},p=k=>{k.stopPropagation(),k.key==="Enter"?(k.preventDefault(),A()):k.key==="Escape"&&(k.preventDefault(),l(!1))},b=k=>{k.stopPropagation();const E=Math.max(2,Math.min(100,(t||2)-2));E!==t&&n(E)},w=k=>{k.stopPropagation();const E=Math.max(2,Math.min(100,(t||2)+2));E!==t&&n(E)},S="flex items-center gap-1 px-1.5 py-0.5 bg-accent/90 text-accent-foreground sketchy-border-thin shadow-sm";return s?T.jsxs("div",{className:S,role:"region","aria-label":"Edit bookmark summary",onPointerDown:k=>k.stopPropagation(),onClick:k=>k.stopPropagation(),children:[T.jsx("input",{type:"text",value:c,onChange:k=>h(k.target.value),onKeyDown:p,className:"bg-card/80 border border-pencil-light/30 rounded-sketchy px-2 py-0.5 text-xs text-foreground placeholder-muted-foreground/60 focus:outline-none focus:border-accent focus:bg-card w-48 transition-colors font-hand",placeholder:"Summary...",autoFocus:!0}),T.jsx("button",{type:"button",onClick:A,className:"p-1 rounded-sketchy hover:bg-accent/50 text-accent-foreground transition-colors",title:"Save",children:T.jsx(As,{className:"w-3.5 h-3.5"})}),T.jsx("button",{type:"button",onClick:f,className:"p-1 rounded-sketchy hover:bg-accent/50 text-accent-foreground transition-colors",title:"Cancel",children:T.jsx(Pi,{className:"w-3.5 h-3.5"})})]}):T.jsxs("div",{className:S,role:"region","aria-label":a("chat.bookmark.actionsRegionAria")||"Bookmark actions",onPointerDown:k=>k.stopPropagation(),onClick:k=>k.stopPropagation(),children:[T.jsx("button",{type:"button",onClick:b,disabled:t<=2,className:"px-2 py-0.5 text-xs font-hand rounded-sketchy hover:bg-accent/30 disabled:opacity-50","aria-label":a("chat.bookmark.decrementAria")||"Decrease maximum visible messages",title:a("chat.bookmark.decrementTitle")||"Decrease",children:""}),T.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold font-hand select-none min-w-[2.5rem] text-center","aria-live":"polite","aria-atomic":"true",children:t}),T.jsx("button",{type:"button",onClick:w,disabled:t>=100,className:"px-2 py-0.5 text-xs font-hand rounded-sketchy hover:bg-accent/30 disabled:opacity-50","aria-label":a("chat.bookmark.incrementAria")||"Increase maximum visible messages",title:a("chat.bookmark.incrementTitle")||"Increase",children:"+"}),T.jsx("div",{className:"w-px h-4 bg-pencil-light/40 mx-1","aria-hidden":!0}),T.jsx("button",{type:"button",onClick:d,className:"px-1.5 py-0.5 rounded-sketchy hover:bg-accent/30",title:"Edit bookmark summary","aria-label":"Edit bookmark summary",children:T.jsx(tr,{className:"w-3.5 h-3.5"})})]})},Ii=({className:a})=>T.jsxs("svg",{className:`animate-spin ${a}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[T.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),T.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),IS=ti.memo(({translations:a,speakingUtteranceText:e,currentTargetLangCode:t,currentNativeLangCode:n,t:i,isSpeaking:s,isSending:l,speakText:c,stopSpeaking:h,speakNativeLang:d,onToggleSpeakNativeLang:A,messageId:f})=>{const p=x.useRef(null),b=x.useRef([]),w=x.useRef(!1),S=x.useRef(null),k=x.useRef(null),E=x.useRef(null),[I,P]=x.useState(null),[R,D]=x.useState(!1),N=x.useRef(null),{allLinePairs:_,pairIndexByFlatIndex:K}=x.useMemo(()=>{const Q=a.map(U=>({target:{type:"target",text:U.target,lang:t},native:{type:"native",text:U.native,lang:n}})),Z=[],F=[];return Q.forEach((U,Y)=>{const ge=U.target.text&&U.target.text.trim(),me=U.native.text&&U.native.text.trim();ge&&(Z.push({type:"target",text:U.target.text,lang:U.target.lang,counterpart:me?{text:U.native.text,lang:U.native.lang}:null}),F.push(Y)),me&&(Z.push({type:"native",text:U.native.text,lang:U.native.lang,counterpart:ge?{text:U.target.text,lang:U.target.lang}:null}),F.push(Y))}),{allLinePairs:Z,pairIndexByFlatIndex:F}},[a,t,n]),G=x.useMemo(()=>{if(!e)return-1;const Q=e.replace(/\*/g,""),Z=_.findIndex(F=>F.text.replace(/\*/g,"")===Q);return Z!==-1&&(w.current=!1),Z},[e,_]);x.useEffect(()=>{G!==-1&&!w.current&&b.current[G]?.scrollIntoView({behavior:"smooth",block:"center"})},[G]);const L=()=>{w.current=!0,S.current&&clearTimeout(S.current),S.current=window.setTimeout(()=>{w.current=!1},2e3)};x.useEffect(()=>()=>{S.current&&clearTimeout(S.current)},[]);const O=Q=>{k.current&&clearTimeout(k.current),E.current={x:Q.clientX,y:Q.clientY}},q=(Q,Z,F)=>{if(k.current&&clearTimeout(k.current),E.current){const U=Math.abs(Q.clientX-E.current.x),Y=Math.abs(Q.clientY-E.current.y);if(U<10&&Y<10){if(Q.preventDefault(),Z.type==="native"){const H=!d;P(F),D(H),N.current&&clearTimeout(N.current),N.current=window.setTimeout(()=>{P(null)},900),A();return}if(s){h();return}if(l)return;const ge=K[F]??0,me=[],z=f?{source:"message",messageId:f}:{source:"adHoc"};for(let H=ge;H<a.length;H++){const j=a[H],le=j.target?.trim(),te=j.native?.trim();le&&me.push({text:le,langCode:t,context:z}),d&&te&&me.push({text:te,langCode:n,context:z})}me.length>0&&c(me,me[0].langCode)}}E.current=null},$=()=>{k.current&&(clearTimeout(k.current),k.current=null),E.current=null};return T.jsxs("div",{ref:p,onScroll:L,className:"overflow-y-auto relative scrollbar-hide",style:{WebkitMaskImage:"linear-gradient(to top, rgba(0,0,0,0.1) 0%, rgba(0,0,0,1) 40%, rgba(0,0,0,1) 60%, rgba(0,0,0,0.7) 65%, rgba(0,0,0,0) 75%, rgba(0,0,0,0) 100%)",maskImage:"linear-gradient(to top, rgba(0,0,0,0.1) 0%, rgba(0,0,0,1) 40%, rgba(0,0,0,1) 60%, rgba(0,0,0,0.7) 65%, rgba(0,0,0,0) 75%, rgba(0,0,0,0) 100%)",height:"33cqw",containerType:"inline-size"},"aria-label":i("chat.maestroTranscriptScrollwheel"),children:[T.jsx("style",{children:`
            @keyframes pop-fade-speak {
              0% { transform: scale(0.85); opacity: 0; }
              20% { transform: scale(1.15); opacity: 1; }
              80% { transform: scale(1.0); opacity: 1; }
              100% { transform: scale(0.95); opacity: 0; }
            }
            .animate-speak-flash { animation: pop-fade-speak 900ms ease-out both; }
          `}),T.jsxs("div",{className:"flex flex-col items-center justify-start",style:{paddingTop:"8cqw",paddingBottom:"8cqw"},children:[T.jsx("div",{"aria-hidden":!0,role:"presentation",className:"text-center p-1 w-full opacity-0 select-none pointer-events-none",children:T.jsx("p",{className:"italic text-white/40",style:{fontSize:"3.55cqw",lineHeight:1.3},children:"\\u00A0"})}),_.map((Q,Z)=>T.jsx("div",{ref:F=>{b.current[Z]=F},className:`text-center p-1 w-full transition-all duration-300 transform-gpu cursor-pointer ${Z===G?"opacity-100 scale-105":"opacity-70 scale-100"}`,onPointerDown:O,onPointerUp:F=>q(F,Q,Z),onPointerLeave:$,onContextMenu:F=>F.preventDefault(),children:T.jsxs("p",{className:`${Q.type==="target"?"font-semibold text-white":"italic text-white/50"} pointer-events-none`,style:{fontSize:Q.type==="target"?"4cqw":"3.55cqw",lineHeight:1.3},children:[Q.text,Q.type==="native"&&Z===I&&T.jsx("span",{className:"ml-2 inline-block align-middle animate-speak-flash",children:R?T.jsx(pd,{className:"w-3 h-3 inline"}):T.jsx(Sf,{className:"w-3 h-3 inline"})})]})},Z)),T.jsx("div",{"aria-hidden":!0,role:"presentation",className:"text-center p-1 w-full opacity-0 select-none pointer-events-none",children:T.jsx("p",{className:"italic text-white/40",style:{fontSize:"3.55cqw",lineHeight:1.3},children:"\\u00A0"})})]})]})});IS.displayName="TextScrollwheel";const mx=32,vx=24;function yx(a,e){let t=0;for(let i=0;i<Math.min(a.length,200);i++)t=(t<<5)-t+a.charCodeAt(i)|0;const n=[];for(let i=0;i<e;i++){t=t<<13^t|0,t=t*1597334677|0;const s=(t>>>0)%100/100,l=e/2,h=1-Math.abs(i-l)/l*.5;n.push(.15+s*.85*h)}return n}async function bx(a,e){const n=await(await fetch(a)).arrayBuffer(),i=new(window.AudioContext||window.webkitAudioContext);try{const l=(await i.decodeAudioData(n)).getChannelData(0),c=Math.floor(l.length/e),h=[];for(let A=0;A<e;A++){let f=0;const p=A*c,b=Math.min(p+c,l.length);for(let w=p;w<b;w++)f+=Math.abs(l[w]);h.push(f/(b-p))}const d=Math.max(...h)||1;return h.map(A=>.1+A/d*.9)}finally{i.close()}}function sb(a){if(!isFinite(a)||a<0)return"0:00";const e=Math.floor(a/60),t=Math.floor(a%60);return`${e}:${t.toString().padStart(2,"0")}`}const wf=ti.memo(({src:a,variant:e,compact:t=!1})=>{const n=x.useRef(null),[i,s]=x.useState(!1),[l,c]=x.useState(0),[h,d]=x.useState(0),[A,f]=x.useState(!1),p=x.useRef(0),b=x.useRef(null),w=t?vx:mx,S=x.useMemo(()=>yx(a,w),[a,w]),[k,E]=x.useState(S);x.useEffect(()=>{let U=!1;return bx(a,w).then(Y=>{U||E(Y)}).catch(()=>{}),()=>{U=!0}},[a,w]);const I=h>0?l/h:0,P=x.useCallback(()=>{const U=n.current;U&&(c(U.currentTime),U.paused||(p.current=requestAnimationFrame(P)))},[]);x.useEffect(()=>{const U=n.current;if(!U)return;let Y=!1;const ge=()=>{const oe=U.duration;isFinite(oe)&&oe>0&&(Y||(Y=!0,d(oe),f(!0)))},me=()=>{if(isFinite(U.duration)&&U.duration>0){ge();return}const oe=()=>{U.removeEventListener("seeked",oe),ge(),U.currentTime=0};U.addEventListener("seeked",oe),U.currentTime=1e101},z=()=>{isFinite(U.duration)&&U.duration>0?ge():me()},H=()=>ge(),j=()=>{s(!0),p.current=requestAnimationFrame(P)},le=()=>{s(!1),cancelAnimationFrame(p.current)},te=()=>{s(!1),c(0),cancelAnimationFrame(p.current),ge()};return U.addEventListener("loadedmetadata",z),U.addEventListener("durationchange",H),U.addEventListener("play",j),U.addEventListener("pause",le),U.addEventListener("ended",te),U.readyState>=1&&z(),()=>{cancelAnimationFrame(p.current),U.removeEventListener("loadedmetadata",z),U.removeEventListener("durationchange",H),U.removeEventListener("play",j),U.removeEventListener("pause",le),U.removeEventListener("ended",te)}},[P]);const R=x.useCallback(()=>{const U=n.current;U&&(U.paused?U.play().catch(()=>{}):U.pause())},[]),D=x.useCallback(U=>{const Y=n.current,ge=b.current;if(!Y||!ge||!h)return;const me=ge.getBoundingClientRect();let z;"touches"in U?z=U.touches[0]?.clientX??U.changedTouches[0]?.clientX??0:z=U.clientX;const H=Math.max(0,Math.min(1,(z-me.left)/me.width));Y.currentTime=H*h,c(Y.currentTime)},[h]),N=e==="user",_=e==="preview",K=N?"bg-primary/30":"bg-secondary",G=N?"bg-white/20 hover:bg-white/30 text-white":"bg-accent hover:bg-accent/80 text-accent-foreground",L=N?"bg-white":"bg-accent",O=N?"bg-white/35":"bg-accent/30",q=N?"text-white/70":"text-muted-foreground",$=t?"w-8 h-8":"w-10 h-10",Q=t?"w-4 h-4":"w-5 h-5",Z=t?"h-6":"h-8",F=t?"p-1.5 gap-2":"p-2 gap-2.5";return T.jsxs("div",{className:`flex items-center ${F} ${K} w-full select-none sketchy-border-thin`,children:[T.jsx("audio",{ref:n,src:a,preload:"metadata"}),T.jsx("button",{type:"button",onClick:R,className:`flex-shrink-0 ${$} flex items-center justify-center transition-colors ${G} sketchy-border-thin`,"aria-label":i?"Pause":"Play",children:i?T.jsxs("svg",{className:Q,viewBox:"0 0 20 20",fill:"currentColor",children:[T.jsx("rect",{x:"5",y:"4",width:"3.5",height:"12",rx:"1"}),T.jsx("rect",{x:"11.5",y:"4",width:"3.5",height:"12",rx:"1"})]}):T.jsx("svg",{className:Q,viewBox:"0 0 20 20",fill:"currentColor",children:T.jsx("path",{d:"M6.5 4.2a1 1 0 0 1 1.02.04l8 5.5a1 1 0 0 1 0 1.66l-8 5.08A1 1 0 0 1 6 15.58V4.92a1 1 0 0 1 .5-.72Z"})})}),T.jsxs("div",{className:"flex-1 min-w-0 flex flex-col gap-1",children:[T.jsx("div",{ref:b,className:`flex items-end gap-[2px] ${Z} cursor-pointer`,onClick:D,role:"slider","aria-label":"Audio progress","aria-valuenow":Math.round(I*100),"aria-valuemin":0,"aria-valuemax":100,tabIndex:0,children:k.map((U,Y)=>{const me=Y/w<=I;return T.jsx("div",{className:`flex-1 rounded-full transition-colors duration-150 ${me?L:O}`,style:{height:`${U*100}%`,minHeight:"3px"}},Y)})}),T.jsxs("div",{className:`flex justify-between text-[10px] ${q} font-medium leading-none`,children:[T.jsx("span",{children:sb(l)}),T.jsx("span",{children:A?sb(h):"--:--"})]})]})]})});wf.displayName="AudioPlayer";const ba=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),_g=[.001,0,0,.001,0,0],ig=1.35,Ka={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},_r={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Ol="pdfjs_internal_editor_",It={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},jt={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Cx={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Rg={TRIANGLES:1,LATTICE:2},Xn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Bu={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Qn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},no={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},bd={ERRORS:0,WARNINGS:1,INFOS:5},Hl={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},El={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},Sx={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Cd=bd.WARNINGS;function wx(a){Number.isInteger(a)&&(Cd=a)}function Tx(){return Cd}function Sd(a){Cd>=bd.INFOS&&console.info(`Info: ${a}`)}function kt(a){Cd>=bd.WARNINGS&&console.warn(`Warning: ${a}`)}function ln(a){throw new Error(a)}function on(a,e){a||ln(e)}function kx(a){switch(a?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function DS(a,e=null,t=null){if(!a)return null;if(t&&typeof a=="string"&&(t.addDefaultProtocol&&a.startsWith("www.")&&a.match(/\./g)?.length>=2&&(a=`http://${a}`),t.tryConvertEncoding))try{a=Dx(a)}catch{}const n=e?URL.parse(a,e):URL.parse(a);return kx(n)?n:null}function _S(a,e,t=!1){const n=URL.parse(a);return n?(n.hash=e,n.href):t&&DS(a,"http://example.com")?a.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Et(a,e,t,n=!1){return Object.defineProperty(a,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const ps=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class ob extends ps{constructor(e,t){super(e,"PasswordException"),this.code=t}}class rg extends ps{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Ng extends ps{constructor(e){super(e,"InvalidPDFException")}}class Wu extends ps{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class Ex extends ps{constructor(e){super(e,"FormatError")}}class Br extends ps{constructor(e){super(e,"AbortException")}}function xx(a){(typeof a!="object"||a?.length===void 0)&&ln("Invalid argument for bytesToString");const e=a.length,t=8192;if(e<t)return String.fromCharCode.apply(null,a);const n=[];for(let i=0;i<e;i+=t){const s=Math.min(i+t,e),l=a.subarray(i,s);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function wd(a){typeof a!="string"&&ln("Invalid argument for stringToBytes");const e=a.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=a.charCodeAt(n)&255;return t}function Px(a){return String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255)}function Mx(){const a=new Uint8Array(4);return a[0]=1,new Uint32Array(a.buffer,0,1)[0]===1}function Ix(){try{return new Function(""),!0}catch{return!1}}class Wn{static get isLittleEndian(){return Et(this,"isLittleEndian",Mx())}static get isEvalSupported(){return Et(this,"isEvalSupported",Ix())}static get isOffscreenCanvasSupported(){return Et(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Et(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return Et(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return Et(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Et(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return Et(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const sg=Array.from(Array(256).keys(),a=>a.toString(16).padStart(2,"0"));class Ze{static makeHexColor(e,t,n){return`#${sg[e]}${sg[t]}${sg[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){const i=e[n],s=e[n+1];e[n]=i*t[0]+s*t[2]+t[4],e[n+1]=i*t[1]+s*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const i=t[0],s=t[1],l=t[2],c=t[3],h=t[4],d=t[5];for(let A=0;A<6;A+=2){const f=e[n+A],p=e[n+A+1];e[n+A]=f*i+p*l+h,e[n+A+1]=f*s+p*c+d}}static applyInverseTransform(e,t){const n=e[0],i=e[1],s=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/s,e[1]=(-n*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/s}static axialAlignedBoundingBox(e,t,n){const i=t[0],s=t[1],l=t[2],c=t[3],h=t[4],d=t[5],A=e[0],f=e[1],p=e[2],b=e[3];let w=i*A+h,S=w,k=i*p+h,E=k,I=c*f+d,P=I,R=c*b+d,D=R;if(s!==0||l!==0){const N=s*A,_=s*p,K=l*f,G=l*b;w+=K,E+=K,k+=G,S+=G,I+=N,D+=N,R+=_,P+=_}n[0]=Math.min(n[0],w,k,S,E),n[1]=Math.min(n[1],I,R,P,D),n[2]=Math.max(n[2],w,k,S,E),n[3]=Math.max(n[3],I,R,P,D)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],i=e[1],s=e[2],l=e[3],c=n**2+i**2,h=n*s+i*l,d=s**2+l**2,A=(c+d)/2,f=Math.sqrt(A**2-(c*d-h**2));t[0]=Math.sqrt(A+f||1),t[1]=Math.sqrt(A-f||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>i)return null;const s=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),l=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return s>l?null:[n,s,i,l]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,i,s){s[0]=Math.min(s[0],e,n),s[1]=Math.min(s[1],t,i),s[2]=Math.max(s[2],e,n),s[3]=Math.max(s[3],t,i)}static#e(e,t,n,i,s,l,c,h,d,A){if(d<=0||d>=1)return;const f=1-d,p=d*d,b=p*d,w=f*(f*(f*e+3*d*t)+3*p*n)+b*i,S=f*(f*(f*s+3*d*l)+3*p*c)+b*h;A[0]=Math.min(A[0],w),A[1]=Math.min(A[1],S),A[2]=Math.max(A[2],w),A[3]=Math.max(A[3],S)}static#t(e,t,n,i,s,l,c,h,d,A,f,p){if(Math.abs(d)<1e-12){Math.abs(A)>=1e-12&&this.#e(e,t,n,i,s,l,c,h,-f/A,p);return}const b=A**2-4*f*d;if(b<0)return;const w=Math.sqrt(b),S=2*d;this.#e(e,t,n,i,s,l,c,h,(-A+w)/S,p),this.#e(e,t,n,i,s,l,c,h,(-A-w)/S,p)}static bezierBoundingBox(e,t,n,i,s,l,c,h,d){d[0]=Math.min(d[0],e,c),d[1]=Math.min(d[1],t,h),d[2]=Math.max(d[2],e,c),d[3]=Math.max(d[3],t,h),this.#t(e,n,s,c,t,i,l,h,3*(-e+3*(n-s)+c),6*(e-2*n+s),3*(n-e),d),this.#t(e,n,s,c,t,i,l,h,3*(-t+3*(i-l)+h),6*(t-2*i+l),3*(i-t),d)}}function Dx(a){return decodeURIComponent(escape(a))}let og=null,lb=null;function _x(a){return og||(og=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,lb=new Map([["","t"]])),a.replaceAll(og,(e,t,n)=>t?t.normalize("NFKC"):lb.get(n))}function RS(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const a=new Uint8Array(32);return crypto.getRandomValues(a),xx(a)}const lo="pdfjs_internal_id_";function Rx(a,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,i,...s]=t;if(!a(n)&&!Number.isInteger(n)||!e(i))return!1;const l=s.length;let c=!0;switch(i.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;c=!1;break;default:return!1}for(const h of s)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function ua(a,e,t){return Math.min(Math.max(a,e),t)}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(a){return a.reduce((e,t)=>e+t,0)});class Vl{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function i(s){if(!s)return;let l=null;const c=s.name;if(c==="#text")l=s.value;else if(Vl.shouldBuildText(c))s?.attributes?.textContent?l=s.attributes.textContent:s.value&&(l=s.value);else return;if(l!==null&&t.push({str:l}),!!s.children)for(const h of s.children)i(h)}return i(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class NS{static setupStorage(e,t,n,i,s){const l=i.getValue(t,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(e.textContent=l.value),s==="print")break;e.addEventListener("input",c=>{i.setValue(t,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?e.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&e.removeAttribute("checked"),s==="print")break;e.addEventListener("change",c=>{i.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&e.setAttribute("value",l.value),s==="print")break;e.addEventListener("input",c=>{i.setValue(t,{value:c.target.value})})}break;case"select":if(l.value!==null){e.setAttribute("value",l.value);for(const c of n.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const h=c.target.options,d=h.selectedIndex===-1?"":h[h.selectedIndex].value;i.setValue(t,{value:d})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:i,linkService:s}){const{attributes:l}=t,c=e instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${i}`);for(const[h,d]of Object.entries(l))if(d!=null)switch(h){case"class":d.length&&e.setAttribute(h,d.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",d);break;case"style":Object.assign(e.style,d);break;case"textContent":e.textContent=d;break;default:(!c||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,d)}c&&s.addLinkAttributes(e,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(e,l.dataId,t,n)}static render(e){const t=e.annotationStorage,n=e.linkService,i=e.xfaHtml,s=e.intent||"display",l=document.createElement(i.name);i.attributes&&this.setAttributes({html:l,element:i,intent:s,linkService:n});const c=s!=="richText",h=e.div;if(h.append(l),e.viewport){const f=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=f}c&&h.setAttribute("class","xfaLayer xfaFont");const d=[];if(i.children.length===0){if(i.value){const f=document.createTextNode(i.value);l.append(f),c&&Vl.shouldBuildText(i.name)&&d.push(f)}return{textDivs:d}}const A=[[i,-1,l]];for(;A.length>0;){const[f,p,b]=A.at(-1);if(p+1===f.children.length){A.pop();continue}const w=f.children[++A.at(-1)[1]];if(w===null)continue;const{name:S}=w;if(S==="#text"){const E=document.createTextNode(w.value);d.push(E),b.append(E);continue}const k=w?.attributes?.xmlns?document.createElementNS(w.attributes.xmlns,S):document.createElement(S);if(b.append(k),w.attributes&&this.setAttributes({html:k,element:w,storage:t,intent:s,linkService:n}),w.children?.length>0)A.push([w,-1,k]);else if(w.value){const E=document.createTextNode(w.value);c&&Vl.shouldBuildText(S)&&d.push(E),k.append(E)}}for(const f of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:d}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const $i="http://www.w3.org/2000/svg";class Eo{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function ec(a,e="text"){if(Nl(a,document.baseURI)){const t=await fetch(a);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const i=new XMLHttpRequest;i.open("GET",a,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}n(new Error(i.statusText))}},i.send(null)})}class tc{constructor({viewBox:e,userUnit:t,scale:n,rotation:i,offsetX:s=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=i,this.offsetX=s,this.offsetY=l,n*=t;const h=(e[2]+e[0])/2,d=(e[3]+e[1])/2;let A,f,p,b;switch(i%=360,i<0&&(i+=360),i){case 180:A=-1,f=0,p=0,b=1;break;case 90:A=0,f=1,p=1,b=0;break;case 270:A=0,f=-1,p=-1,b=0;break;case 0:A=1,f=0,p=0,b=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(p=-p,b=-b);let w,S,k,E;A===0?(w=Math.abs(d-e[1])*n+s,S=Math.abs(h-e[0])*n+l,k=(e[3]-e[1])*n,E=(e[2]-e[0])*n):(w=Math.abs(h-e[0])*n+s,S=Math.abs(d-e[1])*n+l,k=(e[2]-e[0])*n,E=(e[3]-e[1])*n),this.transform=[A*n,f*n,p*n,b*n,w-A*n*h-p*n*d,S-f*n*h-b*n*d],this.width=k,this.height=E}get rawDims(){const e=this.viewBox;return Et(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:s=!1}={}){return new tc({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:s})}convertToViewportPoint(e,t){const n=[e,t];return Ze.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];Ze.applyTransform(t,this.transform);const n=[e[2],e[3]];return Ze.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return Ze.applyInverseTransform(n,this.transform),n}}class Tf extends ps{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Td(a){const e=a.length;let t=0;for(;t<e&&a[t].trim()==="";)t++;return a.substring(t,t+5).toLowerCase()==="data:"}function kf(a){return typeof a=="string"&&/\.pdf$/i.test(a)}function Nx(a){return[a]=a.split(/[#?]/,1),a.substring(a.lastIndexOf("/")+1)}function Gx(a,e="document.pdf"){if(typeof a!="string")return e;if(Td(a))return kt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(a);if(!n)return e;const i=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},s=/\.pdf$/i,l=n.pathname.split("/").at(-1);if(s.test(l))return i(l);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const d of c)if(s.test(d))return i(d);const h=Array.from(n.searchParams.keys()).reverse();for(const d of h)if(s.test(d))return i(d)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return i(h[0])}return e}class cb{started=Object.create(null);times=[];time(e){e in this.started&&kt(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||kt(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:i,end:s}of this.times)e.push(`${n.padEnd(t)} ${s-i}ms
`);return e.join("")}}function Nl(a,e){const t=e?URL.parse(a,e):URL.parse(a);return t?.protocol==="http:"||t?.protocol==="https:"}function ii(a){a.preventDefault()}function Ln(a){a.preventDefault(),a.stopPropagation()}function Lx(a){console.log("Deprecated API usage: "+a)}class Gg{static#e;static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const n=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let l=parseInt(t[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const d=t[7]||"Z";let A=parseInt(t[8],10);A=A>=0&&A<=23?A:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,d==="-"?(l+=A,c+=f):d==="+"&&(l-=A,c-=f),new Date(Date.UTC(n,i,s,l,c,h))}}function Bx(a,{scale:e=1,rotation:t=0}){const{width:n,height:i}=a.attributes.style,s=[0,0,parseInt(n),parseInt(i)];return new tc({viewBox:s,userUnit:1,scale:e,rotation:t})}function nc(a){if(a.startsWith("#")){const e=parseInt(a.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return a.startsWith("rgb(")?a.slice(4,-1).split(",").map(e=>parseInt(e)):a.startsWith("rgba(")?a.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(kt(`Not a valid color format: "${a}"`),[0,0,0])}function Fx(a){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of a.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;a.set(t,nc(n))}e.remove()}function Dn(a){const{a:e,b:t,c:n,d:i,e:s,f:l}=a.getTransform();return[e,t,n,i,s,l]}function wi(a){const{a:e,b:t,c:n,d:i,e:s,f:l}=a.getTransform().invertSelf();return[e,t,n,i,s,l]}function gs(a,e,t=!1,n=!0){if(e instanceof tc){const{pageWidth:i,pageHeight:s}=e.rawDims,{style:l}=a,c=Wn.isCSSRoundSupported,h=`var(--total-scale-factor) * ${i}px`,d=`var(--total-scale-factor) * ${s}px`,A=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,f=c?`round(down, ${d}, var(--scale-round-y))`:`calc(${d})`;!t||e.rotation%180===0?(l.width=A,l.height=f):(l.width=f,l.height=A)}n&&a.setAttribute("data-main-rotation",e.rotation)}class Di{constructor(){const{pixelRatio:e}=Di;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,i,s=-1){let l=1/0,c=1/0,h=1/0;n=Di.capPixels(n,s),n>0&&(l=Math.sqrt(n/(e*t))),i!==-1&&(c=i/e,h=i/t);const d=Math.min(l,c,h);return this.sx>d||this.sy>d?(this.sx=d,this.sy=d,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const Lg=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Ux{static get isDarkMode(){return Et(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class Kx{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),Et(this,"commentForegroundColor",nc(n))}}function zx(a,e,t,n){n=Math.min(Math.max(n??1,0),1);const i=255*(1-n);return a=Math.round(a*n+i),e=Math.round(e*n+i),t=Math.round(t*n+i),[a,e,t]}function ub(a,e){const t=a[0]/255,n=a[1]/255,i=a[2]/255,s=Math.max(t,n,i),l=Math.min(t,n,i),c=(s+l)/2;if(s===l)e[0]=e[1]=0;else{const h=s-l;switch(e[1]=c<.5?h/(s+l):h/(2-s-l),s){case t:e[0]=((n-i)/h+(n<i?6:0))*60;break;case n:e[0]=((i-t)/h+2)*60;break;case i:e[0]=((t-n)/h+4)*60;break}}e[2]=c}function Bg(a,e){const t=a[0],n=a[1],i=a[2],s=(1-Math.abs(2*i-1))*n,l=s*(1-Math.abs(t/60%2-1)),c=i-s/2;switch(Math.floor(t/60)){case 0:e[0]=s+c,e[1]=l+c,e[2]=c;break;case 1:e[0]=l+c,e[1]=s+c,e[2]=c;break;case 2:e[0]=c,e[1]=s+c,e[2]=l+c;break;case 3:e[0]=c,e[1]=l+c,e[2]=s+c;break;case 4:e[0]=l+c,e[1]=c,e[2]=s+c;break;case 5:case 6:e[0]=s+c,e[1]=c,e[2]=l+c;break}}function db(a){return a<=.03928?a/12.92:((a+.055)/1.055)**2.4}function hb(a,e,t){Bg(a,t),t.map(db);const n=.2126*t[0]+.7152*t[1]+.0722*t[2];Bg(e,t),t.map(db);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];return n>i?(n+.05)/(i+.05):(i+.05)/(n+.05)}const Ab=new Map;function Ox(a,e){const t=a[0]+a[1]*256+a[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let n=Ab.get(t);if(n)return n;const i=new Float32Array(9),s=i.subarray(0,3),l=i.subarray(3,6);ub(a,l);const c=i.subarray(6,9);ub(e,c);const h=c[2]<.5,d=h?12:4.5;if(l[2]=h?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),hb(l,c,s)<d){let A,f;h?(A=l[2],f=1):(A=0,f=l[2]);const p=.005;for(;f-A>p;){const b=l[2]=(A+f)/2;h===hb(l,c,s)<d?A=b:f=b}l[2]=h?f:A}return Bg(l,s),n=Ze.makeHexColor(Math.round(s[0]*255),Math.round(s[1]*255),Math.round(s[2]*255)),Ab.set(t,n),n}function GS({html:a,dir:e,className:t},n){const i=document.createDocumentFragment();if(typeof a=="string"){const s=document.createElement("p");s.dir=e||"auto";const l=a.split(/(?:\r\n?|\n)/);for(let c=0,h=l.length;c<h;++c){const d=l[c];s.append(document.createTextNode(d)),c<h-1&&s.append(document.createElement("br"))}i.append(s)}else NS.render({xfaHtml:a,div:i,intent:"richText"});i.firstElementChild.classList.add("richText",t),n.append(i)}function LS(a){const e=new Path2D;if(!a)return e;for(let t=0,n=a.length;t<n;)switch(a[t++]){case El.moveTo:e.moveTo(a[t++],a[t++]);break;case El.lineTo:e.lineTo(a[t++],a[t++]);break;case El.curveTo:e.bezierCurveTo(a[t++],a[t++],a[t++],a[t++],a[t++],a[t++]);break;case El.quadraticCurveTo:e.quadraticCurveTo(a[t++],a[t++],a[t++],a[t++]);break;case El.closePath:e.closePath();break;default:kt(`Unrecognized drawing path operator: ${a[t-1]}`);break}return e}class rn{static#e=null;static#t=null;static#a=null;static#n=0;static#r=[];get pagesNumber(){return rn.#n}set pagesNumber(e){rn.#n!==e&&(rn.#n=e,e===0&&(rn.#t=null,rn.#e=null))}addListener(e){rn.#r.push(e)}removeListener(e){const t=rn.#r.indexOf(e);t>=0&&rn.#r.splice(t,1)}#s(){for(const e of rn.#r)e()}#i(e){if(rn.#t)return;const t=rn.#n,n=new Uint32Array(3*t),i=rn.#t=n.subarray(0,t),s=rn.#e=n.subarray(t,2*t);if(e)for(let l=0;l<t;l++)i[l]=s[l]=l+1;rn.#a=n.subarray(2*t)}movePages(e,t,n){this.#i(!0);const i=rn.#t,s=rn.#e;rn.#a.set(s);const l=t.length,c=new Uint32Array(l);let h=0;for(let b=0;b<l;b++){const w=t[b]-1;c[b]=i[w],w<n&&(h+=1)}const d=rn.#n;let A=n-h;const f=d-l;A=ua(A,0,f);for(let b=0,w=0;b<d;b++)e.has(b+1)||(i[w++]=i[b]);i.copyWithin(A+l,A,f),i.set(c,A);let p=!1;for(let b=0,w=d;b<w;b++){const S=i[b];p||=S!==b+1,s[S-1]=b+1}this.#s(),p||(this.pagesNumber=0)}hasBeenAltered(){return rn.#t!==null}getPageMappingForSaving(){return{pageIndices:rn.#e?rn.#e.map(e=>e-1):null}}getPrevPageNumber(e){return rn.#a[rn.#t[e-1]-1]}getPageNumber(e){return rn.#e?.[e-1]??e}getPageId(e){return rn.#t?.[e-1]??e}static get instance(){return Et(this,"instance",new rn)}getMapping(){return rn.#t.subarray(0,this.pagesNumber)}}class Kl{#e=null;#t=null;#a;#n=null;#r=null;#s=null;#i=null;#o=null;static#c=null;constructor(e){this.#a=e,Kl.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#a._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",ii,{signal:t}),e.addEventListener("pointerdown",Kl.#l,{signal:t}));const n=this.#n=document.createElement("div");n.className="buttons",e.append(n);const i=this.#a.toolbarPosition;if(i){const{style:s}=e,l=this.#a._uiManager.direction==="ltr"?1-i[0]:i[0];s.insetInlineEnd=`${100*l}%`,s.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#l(e){e.stopPropagation()}#h(e){this.#a._focusEventsAllowed=!1,Ln(e)}#d(e){this.#a._focusEventsAllowed=!0,Ln(e)}#A(e){const t=this.#a._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#d.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",ii,{signal:t}),!0)}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#r?.shown(),this.#s?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#a,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",Kl.#c[e]),this.#A(n)&&n.addEventListener("click",i=>{t.delete()},{signal:t._signal}),this.#n.append(n)}get#p(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#A(t),this.#n.append(t,this.#p),this.#r=e}addComment(e,t=null){if(this.#s)return;const n=e.renderForToolbar();if(!n)return;this.#A(n);const i=this.#i=this.#p;t?(this.#n.insertBefore(n,t),this.#n.insertBefore(i,t)):this.#n.append(n,i),this.#s=e,e.toolbar=this}addColorPicker(e){if(this.#t)return;this.#t=e;const t=e.renderButton();this.#A(t),this.#n.append(t,this.#p)}async addEditSignatureButton(e){const t=this.#o=await e.renderEditButton(this.#a);this.#A(t),this.#n.append(t,this.#p)}removeButton(e){e==="comment"&&(this.#s?.removeToolbarCommentButton(),this.#s=null,this.#i?.remove(),this.#i=null)}async addButton(e,t){switch(e){case"colorPicker":t&&this.addColorPicker(t);break;case"altText":t&&await this.addAltText(t);break;case"editSignature":t&&await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":t&&this.addComment(t);break}}async addButtonBefore(e,t,n){if(!t&&e==="comment")return;const i=this.#n.querySelector(n);i&&e==="comment"&&this.addComment(t,i)}updateEditSignatureButton(e){this.#o&&(this.#o.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class Hx{#e=null;#t=null;#a;constructor(e){this.#a=e}#n(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar");const t=this.#a._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",ii,{signal:t});const n=this.#e=document.createElement("div");return n.className="buttons",e.append(n),this.#a.hasCommentManager()&&this.#s("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#a.commentSelection("floating_button")}),this.#s("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#a.highlightSelection("floating_button")}),e}#r(e,t){let n=0,i=0;for(const s of e){const l=s.y+s.height;if(l<n)continue;const c=s.x+(t?s.width:0);if(l>n){i=c,n=l;continue}t?c>i&&(i=c):c<i&&(i=c)}return[t?1-i:i,n]}show(e,t,n){const[i,s]=this.#r(t,n),{style:l}=this.#t||=this.#n();e.append(this.#t),l.insetInlineEnd=`${100*i}%`,l.top=`calc(${100*s}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#s(e,t,n,i){const s=document.createElement("button");s.classList.add("basic",e),s.tabIndex=0,s.setAttribute("data-l10n-id",t);const l=document.createElement("span");s.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",n);const c=this.#a._signal;c instanceof AbortSignal&&!c.aborted&&(s.addEventListener("contextmenu",ii,{signal:c}),s.addEventListener("click",i,{signal:c})),this.#e.append(s)}}function BS(a,e,t){for(const n of t)e.addEventListener(n,a[n].bind(a))}class sn{static#e=NaN;static#t=null;static#a=NaN;static#n=null;static initializeAndAddPointerId(e){(sn.#t||=new Set).add(e)}static setPointer(e,t){sn.#e||=t,sn.#n??=e}static setTimeStamp(e){sn.#a=e}static isSamePointerId(e){return sn.#e===e}static isSamePointerIdOrRemove(e){return sn.#e===e?!0:(sn.#t?.delete(e),!1)}static isSamePointerType(e){return sn.#n===e}static isInitializedAndDifferentPointerType(e){return sn.#n!==null&&!sn.isSamePointerType(e)}static isSameTimeStamp(e){return sn.#a===e}static isUsingMultiplePointers(){return sn.#t?.size>=1}static clearPointerType(){sn.#n=null}static clearPointerIds(){sn.#e=NaN,sn.#t=null}static clearTimeStamp(){sn.#a=NaN}}class Vx{#e=0;get id(){return`${Ol}${this.#e++}`}}class Ef{#e=RS();#t=0;#a=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const s=i.decode().then(()=>(n.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Et(this,"_isSVGFittingCanvas",s)}async#n(e,t){this.#a||=new Map;let n=this.#a.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let i;if(typeof t=="string"?(n.url=t,i=await ec(t,"blob")):t instanceof File?i=n.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const s=Ef._isSVGFittingCanvas,l=new FileReader,c=new Image,h=new Promise((d,A)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,d()},l.onload=async()=>{const f=n.svgUrl=l.result;c.src=await s?`${f}#svgView(preserveAspectRatio(none))`:f},c.onerror=l.onerror=A});l.readAsDataURL(i),await h}else n.bitmap=await createImageBitmap(i);n.refCounter=1}catch(i){kt(i),n=null}return this.#a.set(e,n),n&&this.#a.set(n.id,n),n}async getFromFile(e){const{lastModified:t,name:n,size:i,type:s}=e;return this.#n(`${t}_${n}_${i}_${s}`,e)}async getFromUrl(e){return this.#n(e,e)}async getFromBlob(e,t){const n=await t;return this.#n(e,n)}async getFromId(e){this.#a||=new Map;const t=this.#a.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#a||=new Map;let n=this.#a.get(e);if(n?.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#a.set(e,n),this.#a.set(n.id,n),n}getSvgUrl(e){const t=this.#a.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#a||=new Map;const t=this.#a.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(n.width,n.height);i.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=i.convertToBlob()}n.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class jx{#e=[];#t=!1;#a;#n=-1;constructor(e=128){this.#a=e}add({cmd:e,undo:t,post:n,mustExec:i,type:s=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(i&&e(),this.#t)return;const h={cmd:e,undo:t,post:n,type:s};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(h);return}if(l&&this.#e[this.#n].type===s){c&&(h.undo=this.#e[this.#n].undo),this.#e[this.#n]=h;return}const d=this.#n+1;d===this.#a?this.#e.splice(0,1):(this.#n=d,d<this.#e.length&&this.#e.splice(d)),this.#e.push(h)}undo(){if(this.#n===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1,this.#n-=1}redo(){if(this.#n<this.#e.length-1){this.#n+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}cleanType(e){if(this.#n!==-1){for(let t=this.#n;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#n-t),this.#n=t;return}this.#e.length=0,this.#n=-1}}destroy(){this.#e=null}}class ac{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Wn.platform;for(const[n,i,s={}]of e)for(const l of n){const c=l.startsWith("mac+");t&&c?(this.callbacks.set(l.slice(4),{callback:i,options:s}),this.allKeys.add(l.split("+").at(-1))):!t&&!c&&(this.callbacks.set(l,{callback:i,options:s}),this.allKeys.add(l.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(this.#e(t));if(!n)return;const{callback:i,options:{bubbles:s=!1,args:l=[],checker:c=null}}=n;c&&!c(e,t)||(i.bind(e,...l,t)(),s||Ln(t))}}class xf{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return Fx(e),Et(this,"_colors",e)}convert(e){const t=nc(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,i]of this._colors)if(i.every((s,l)=>s===t[l]))return xf._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?Ze.makeHexColor(...t):e}}class Fr{#e=new AbortController;#t=null;#a=null;#n=new Map;#r=new Map;#s=null;#i=null;#o=null;#c=new jx;#l=null;#h=null;#d=null;#A=0;#p=new Set;#f=null;#u=null;#g=new Set;_editorUndoBar=null;#m=!1;#y=!1;#v=!1;#k=null;#w=null;#C=null;#x=null;#b=!1;#T=null;#I=new Vx;#P=!1;#M=!1;#B=!1;#_=null;#N=null;#F=null;#G=null;#V=null;#E=It.NONE;#S=new Set;#R=null;#U=null;#z=null;#q=null;#Q=null;#Y={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#O=[0,0];#L=null;#j=null;#J=null;#Z=null;#K=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=Fr.prototype,t=l=>l.#j.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},i=this.TRANSLATE_SMALL,s=this.TRANSLATE_BIG;return Et(this,"_keyboardManager",new ac([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#j.contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#j.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}]]))}constructor(e,t,n,i,s,l,c,h,d,A,f,p,b,w,S,k){const E=this._signal=this.#e.signal;this.#j=e,this.#J=t,this.#Z=n,this.#s=i,this.#l=s,this.#U=l,this.#Q=h,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:E}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:E}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:E}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:E}),c._on("setpreference",this.onSetPreference.bind(this),{signal:E}),c._on("switchannotationeditorparams",I=>this.updateParams(I.type,I.value),{signal:E}),c._on("pagesedited",this.onPagesEdited.bind(this),{signal:E}),window.addEventListener("pointerdown",()=>{this.#M=!0},{capture:!0,signal:E}),window.addEventListener("pointerup",()=>{this.#M=!1},{capture:!0,signal:E}),this.#se(),this.#he(),this.#te(),this.#i=h.annotationStorage,this.#k=h.filterFactory,this.#z=d,this.#x=A||null,this.#m=f,this.#y=p,this.#v=b,this.#V=w||null,this.viewParameters={realScale:Eo.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=S||null,this._supportsPinchToZoom=k!==!1,s?.setSidebarUiManager(this)}destroy(){this.#K?.resolve(),this.#K=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#r.values())e.destroy();this.#r.clear(),this.#n.clear(),this.#g.clear(),this.#G?.clear(),this.#t=null,this.#S.clear(),this.#c.destroy(),this.#s?.destroy(),this.#l?.destroy(),this.#U?.destroy(),this.#T?.hide(),this.#T=null,this.#F?.destroy(),this.#F=null,this.#a=null,this.#w&&(clearTimeout(this.#w),this.#w=null),this.#L&&(clearTimeout(this.#L),this.#L=null),this._editorUndoBar?.destroy(),this.#Q=null}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#V}get useNewAltTextFlow(){return this.#y}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Et(this,"hcmFilter",this.#z?this.#k.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return Et(this,"direction",getComputedStyle(this.#j).direction)}get _highlightColors(){return Et(this,"_highlightColors",this.#x?new Map(this.#x.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Et(this,"highlightColors",null);const t=new Map,n=!!this.#z;for(const[i,s]of e){const l=i.endsWith("_HCM");if(n&&l){t.set(i.replace("_HCM",""),s);continue}!n&&!l&&t.set(i,s)}return Et(this,"highlightColors",t)}get highlightColorNames(){return Et(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#d=e}setMainHighlightColorPicker(e){this.#F=e}editAltText(e,t=!1){this.#s?.editAltText(this,e,t)}hasCommentManager(){return!!this.#l}editComment(e,t,n,i){this.#l?.showDialog(this,e,t,n,i)}selectComment(e,t){this.#r.get(e)?.getEditorByUID(t)?.toggleComment(!0,!0)}updateComment(e){this.#l?.updateComment(e.getData())}updatePopupColor(e){this.#l?.updatePopupColor(e)}removeComment(e){this.#l?.removeComments([e.uid])}deleteComment(e,t){const n=()=>{e.comment=t},i=()=>{this._editorUndoBar?.show(n,"comment"),this.toggleComment(null),e.comment=null};this.addCommands({cmd:i,undo:n,mustExec:!0})}toggleComment(e,t,n=void 0){this.#l?.toggleCommentPopup(e,t,n)}makeCommentColor(e,t){return e&&this.#l?.makeCommentColor(e,t)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(e){if(this.#r.has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),i=s=>{s.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await n}getSignature(e){this.#U?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#U}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){e==="enableNewAltTextWhenAddingImage"&&(this.#v=t)}onPagesEdited({pagesMapper:e}){for(const i of this.#n.values())i.updatePageIndex(e.getPrevPageNumber(i.pageIndex+1)-1);const t=this.#r,n=this.#r=new Map;for(const[i,s]of t){const l=e.getPrevPageNumber(i+1)-1;if(l===-1){s.destroy();continue}n.set(l,s),s.updatePageIndex(l)}}onPageChanging({pageNumber:e}){this.#A=e-1}focusMainContainer(){this.#j.focus()}findParent(e,t){for(const n of this.#r.values()){const{x:i,y:s,width:l,height:c}=n.div.getBoundingClientRect();if(e>=i&&e<=i+l&&t>=s&&t<=s+c)return n}return null}disableUserSelect(e=!1){this.#J.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#g.add(e)}removeShouldRescale(e){this.#g.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*Eo.PDF_TO_CSS_UNITS;for(const t of this.#g)t.onScaleChanging();this.#d?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#$({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#ee(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of this.#r.values())if(n.hasTextLayer(e))return n;return null}highlightSelection(e="",t=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:l,focusOffset:c}=n,h=n.toString(),A=this.#$(n).closest(".textLayer"),f=this.getSelectionBoxes(A);if(!f)return;n.empty();const p=this.#ee(A),b=this.#E===It.NONE,w=()=>{const S=p?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:f,anchorNode:i,anchorOffset:s,focusNode:l,focusOffset:c,text:h});b&&this.showAllEditors("highlight",!0,!0),t&&S?.editComment()};if(b){this.switchToMode(It.HIGHLIGHT,w);return}w()}commentSelection(e=""){this.highlightSelection(e,!0)}#ie(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=this.#$(e).closest(".textLayer"),i=this.getSelectionBoxes(n);i&&(this.#T||=new Hx(this),this.#T.show(n,i,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(e){if(!this.#i)return null;const t=`${Ol}${e}`,n=this.#i.getRawValue(t);return n&&this.#i.remove(t),n}addToAnnotationStorage(e){!e.isEmpty()&&this.#i&&!this.#i.has(e.id)&&this.#i.setValue(e.id,e)}a11yAlert(e,t=null){const n=this.#Z;n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}#re(){const e=document.getSelection();if(!e||e.isCollapsed){this.#R&&(this.#T?.hide(),this.#R=null,this.#D({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#R)return;const i=this.#$(e).closest(".textLayer");if(!i){this.#R&&(this.#T?.hide(),this.#R=null,this.#D({hasSelectedText:!1}));return}if(this.#T?.hide(),this.#R=t,this.#D({hasSelectedText:!0}),!(this.#E!==It.HIGHLIGHT&&this.#E!==It.NONE)&&(this.#E===It.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#b=this.isShiftKeyDown,!this.isShiftKeyDown)){const s=this.#E===It.HIGHLIGHT?this.#ee(i):null;if(s?.toggleDrawing(),this.#M){const l=new AbortController,c=this.combinedSignal(l),h=d=>{d.type==="pointerup"&&d.button!==0||(l.abort(),s?.toggleDrawing(!0),d.type==="pointerup"&&this.#X("main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}else s?.toggleDrawing(!0),this.#X("main_toolbar")}}#X(e=""){this.#E===It.HIGHLIGHT?this.highlightSelection(e):this.#m&&this.#ie()}#se(){document.addEventListener("selectionchange",this.#re.bind(this),{signal:this._signal})}#oe(){if(this.#C)return;this.#C=new AbortController;const e=this.combinedSignal(this.#C);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#le(){this.#C?.abort(),this.#C=null}blur(){if(this.isShiftKeyDown=!1,this.#b&&(this.#b=!1,this.#X("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#S)if(t.div.contains(e)){this.#N=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#N)return;const[e,t]=this.#N;this.#N=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#te(){if(this.#_)return;this.#_=new AbortController;const e=this.combinedSignal(this.#_);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#ce(){this.#_?.abort(),this.#_=null}#ue(){if(this.#h)return;this.#h=new AbortController;const e=this.combinedSignal(this.#h);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#de(){this.#h?.abort(),this.#h=null}#he(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#te(),this.setEditingState(!0)}removeEditListeners(){this.#ce(),this.setEditingState(!1)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of this.#S){const i=n.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const s of t.items)for(const l of this.#u)if(l.isHandlingMimeForPasting(s.type)){l.paste(s,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(s){kt(`paste: "${s.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const s=[];for(const h of n){const d=await i.deserialize(h);if(!d)return;s.push(d)}const l=()=>{for(const h of s)this.#ne(h);this.#ae(s)},c=()=>{for(const h of s)h.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(s){kt(`paste: "${s.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#E!==It.NONE&&!this.isEditorHandlingKeyboard&&Fr._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#b&&(this.#b=!1,this.#X("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#D(e){Object.entries(e).some(([n,i])=>this.#Y[n]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#Y,e)}),this.#E===It.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#H([[jt.HIGHLIGHT_FREE,!0]]))}#H(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#oe(),this.#ue(),this.#D({isEditing:this.#E!==It.NONE,isEmpty:this.#W(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#le(),this.#de(),this.#D({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#u){this.#u=e;for(const t of this.#u)this.#H(t.defaultPropertiesToUpdate)}}getId(){return this.#I.id}get currentLayer(){return this.#r.get(this.#A)}getLayer(e){return this.#r.get(e)}get currentPageIndex(){return this.#A}addLayer(e){this.#r.set(e.pageIndex,e),this.#P?e.enable():e.disable()}removeLayer(e){this.#r.delete(e.pageIndex)}async updateMode(e,t=null,n=!1,i=!1,s=!1,l=!1){if(this.#E!==e&&!(this.#K&&(await this.#K.promise,!this.#K))){if(this.#K=Promise.withResolvers(),this.#d?.commitOrRemove(),this.#E===It.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#E=e,e===It.NONE){this.setEditingState(!1),this.#ge();for(const c of this.#n.values())c.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#K.resolve();return}for(const c of this.#n.values())c.addStandaloneCommentButton();e===It.SIGNATURE&&await this.#U?.loadSignatures(),n&&sn.clearPointerType(),this.setEditingState(!0),await this.#Ae(),this.unselectAll();for(const c of this.#r.values())c.updateMode(e);if(e===It.POPUP){this.#a||=await this.#Q.getAnnotationsByType(new Set(this.#u.map(d=>d._editorType)));const c=new Set,h=[];for(const d of this.#n.values()){const{annotationElementId:A,hasComment:f,deleted:p}=d;A&&c.add(A),f&&!p&&h.push(d.getData())}for(const d of this.#a){const{id:A,popupRef:f,contentsObj:p}=d;f&&p?.str&&!c.has(A)&&!this.#p.has(A)&&h.push(d)}this.#l?.showSidebar(h)}if(!t){i&&this.addNewEditorFromKeyboard(),this.#K.resolve();return}for(const c of this.#n.values())c.uid===t?(this.setSelected(c),l?c.editComment():s?c.enterInEditMode():c.focus()):c.unselect();this.#K.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#E&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#u){switch(e){case jt.CREATE:this.currentLayer.addNewEditor(t);return;case jt.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#q||=new Map).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of this.#S)n.updateParams(e,t);else for(const n of this.#u)n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){for(const s of this.#n.values())s.editorType===e&&s.show(t);(this.#q?.get(jt.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#H([[jt.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#B!==e){this.#B=e;for(const t of this.#r.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#Ae(){if(!this.#P){this.#P=!0;const e=[];for(const t of this.#r.values())e.push(t.enable());await Promise.all(e);for(const t of this.#n.values())t.enable()}}#ge(){if(this.unselectAll(),this.#P){this.#P=!1;for(const e of this.#r.values())e.disable();for(const e of this.#n.values())e.disable()}}*getEditors(e){for(const t of this.#n.values())t.pageIndex===e&&(yield t)}getEditor(e){return this.#n.get(e)}addEditor(e){this.#n.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#w&&clearTimeout(this.#w),this.#w=setTimeout(()=>{this.focusMainContainer(),this.#w=null},0)),this.#n.delete(e.id),e.annotationElementId&&this.#G?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#p.has(e.annotationElementId))&&this.#i?.remove(e.id)}addDeletedAnnotationElement(e){this.#p.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#p.has(e)}removeDeletedAnnotationElement(e){this.#p.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#ne(e){const t=this.#r.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#H(e.propertiesToUpdate))}get#fe(){let e=null;for(e of this.#S);return e}updateUI(e){this.#fe===e&&this.#H(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#H(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#S.has(e)){this.#S.delete(e),e.unselect(),this.#D({hasSelectedEditor:this.hasSelection});return}this.#S.add(e),e.select(),this.#H(e.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.uid}),this.#d?.commitOrRemove();for(const t of this.#S)t!==e&&t.unselect();this.#S.clear(),this.#S.add(e),e.select(),this.#H(e.propertiesToUpdate),this.#D({hasSelectedEditor:!0})}isSelected(e){return this.#S.has(e)}get firstSelectedEditor(){return this.#S.values().next().value}unselect(e){e.unselect(),this.#S.delete(e),this.#D({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#S.size!==0}get isEnterHandled(){return this.#S.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#D({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#W()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#W()})}addCommands(e){this.#c.add(e),this.#D({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#W()})}cleanUndoStack(e){this.#c.cleanType(e)}#W(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const e of this.#n.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#S],n=()=>{this._editorUndoBar?.show(i,t.length===1?t[0].editorType:t.length);for(const s of t)s.remove()},i=()=>{for(const s of t)this.#ne(s)};this.addCommands({cmd:n,undo:i,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#ae(e){for(const t of this.#S)t.unselect();this.#S.clear();for(const t of e)t.isEmpty()||(this.#S.add(t),t.select());this.#D({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#S)e.commit();this.#ae(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#E!==It.NONE))&&!this.#d?.commitOrRemove()&&this.hasSelection){for(const e of this.#S)e.unselect();this.#S.clear(),this.#D({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#O[0]+=e,this.#O[1]+=t;const[i,s]=this.#O,l=[...this.#S],c=1e3;this.#L&&clearTimeout(this.#L),this.#L=setTimeout(()=>{this.#L=null,this.#O[0]=this.#O[1]=0,this.addCommands({cmd:()=>{for(const h of l)this.#n.has(h.id)&&(h.translateInPage(i,s),h.translationDone())},undo:()=>{for(const h of l)this.#n.has(h.id)&&(h.translateInPage(-i,-s),h.translationDone())},mustExec:!1})},c);for(const h of l)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#f=new Map;for(const e of this.#S)this.#f.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#f)return!1;this.disableUserSelect(!1);const e=this.#f;this.#f=null;let t=!1;for(const[{x:i,y:s,pageIndex:l},c]of e)c.newX=i,c.newY=s,c.newPageIndex=l,t||=i!==c.savedX||s!==c.savedY||l!==c.savedPageIndex;if(!t)return!1;const n=(i,s,l,c)=>{if(this.#n.has(i.id)){const h=this.#r.get(c);h?i._setParentAndPosition(h,s,l):(i.pageIndex=c,i.x=s,i.y=l)}};return this.addCommands({cmd:()=>{for(const[i,{newX:s,newY:l,newPageIndex:c}]of e)n(i,s,l,c)},undo:()=>{for(const[i,{savedX:s,savedY:l,savedPageIndex:c}]of e)n(i,s,l,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#f)for(const n of this.#f.keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#S.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#E}isEditingMode(){return this.#E!==It.NONE}get imageManager(){return Et(this,"imageManager",new Ef)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let d=0,A=t.rangeCount;d<A;d++)if(!e.contains(t.getRangeAt(d).commonAncestorContainer))return null;const{x:n,y:i,width:s,height:l}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(d,A,f,p)=>({x:(A-i)/l,y:1-(d+f-n)/s,width:p/l,height:f/s});break;case"180":c=(d,A,f,p)=>({x:1-(d+f-n)/s,y:1-(A+p-i)/l,width:f/s,height:p/l});break;case"270":c=(d,A,f,p)=>({x:1-(A+p-i)/l,y:(d-n)/s,width:p/l,height:f/s});break;default:c=(d,A,f,p)=>({x:(d-n)/s,y:(A-i)/l,width:f/s,height:p/l});break}const h=[];for(let d=0,A=t.rangeCount;d<A;d++){const f=t.getRangeAt(d);if(!f.collapsed)for(const{x:p,y:b,width:w,height:S}of f.getClientRects())w===0||S===0||h.push(c(p,b,w,S))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#o||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#o?.delete(e)}renderAnnotationElement(e){const t=this.#o?.get(e.data.id);if(!t)return;const n=this.#i.getRawValue(t);n&&(this.#E===It.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){const i=this.#G?.get(e);i&&(i.setCanvas(t,n),this.#G.delete(e))}addMissingCanvas(e,t){(this.#G||=new Map).set(e,t)}}class Ei{#e=null;#t=!1;#a=null;#n=null;#r=null;#s=null;#i=!1;#o=null;#c=null;#l=null;#h=null;#d=!1;static#A=null;static _l10n=null;constructor(e){this.#c=e,this.#d=e._uiManager.useNewAltTextFlow,Ei.#A||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){Ei._l10n??=e}async render(){const e=this.#a=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#n=document.createElement("span");e.append(t),this.#d?(e.classList.add("new"),e.setAttribute("data-l10n-id",Ei.#A.missing),t.setAttribute("data-l10n-id",Ei.#A["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#c._uiManager._signal;e.addEventListener("contextmenu",ii,{signal:n}),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:n});const i=s=>{s.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#d&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#p}})};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(this.#i=!0,i(s))},{signal:n}),await this.#f(),e}get#p(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#a&&(this.#a.focus({focusVisible:this.#i}),this.#i=!1)}isEmpty(){return this.#d?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#d?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#h=await Ei._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#f())}toggleAltTextBadge(e=!1){if(!this.#d||this.#e){this.#o?.remove(),this.#o=null;return}if(!this.#o){const t=this.#o=document.createElement("div");t.className="noAltTextBadge",this.#c.div.append(t)}this.#o.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#h),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#h}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:i,cancel:s=!1}){n&&(this.#l=n,this.#h=i),!(this.#e===e&&this.#t===t)&&(s||(this.#e=e,this.#t=t),this.#f())}toggle(e=!1){this.#a&&(!e&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#a.disabled=!e)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#p}})}destroy(){this.#a?.remove(),this.#a=null,this.#n=null,this.#r=null,this.#o?.remove(),this.#o=null}async#f(){const e=this.#a;if(!e)return;if(this.#d){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",Ei.#A[this.#p]),this.#n?.setAttribute("data-l10n-id",Ei.#A[`${this.#p}-label`]),!this.#e){this.#r?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#r?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#r;if(!t){this.#r=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#c.id}`;const i=100,s=this.#c._uiManager._signal;s.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#r.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},i)},{signal:s}),e.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#r?.classList.remove("show")},{signal:s})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#c.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class pu{#e=null;#t=null;#a=!1;#n=null;#r=null;#s=null;#i=null;#o=null;#c=!1;#l=null;constructor(e){this.#n=e}renderForToolbar(){const e=this.#t=document.createElement("button");return e.className="comment",this.#h(e,!1)}renderForStandalone(){const e=this.#e=document.createElement("button");e.className="annotationCommentButton";const t=this.#n.commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const i=this.#n.commentButtonColor;i&&(n.backgroundColor=i)}return this.#h(e,!0)}focusButton(){setTimeout(()=>{(this.#e??this.#t)?.focus()},0)}onUpdatedColor(){if(!this.#e)return;const e=this.#n.commentButtonColor;e&&(this.#e.style.backgroundColor=e),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#e?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#e)return null;const{x:e,y:t,height:n}=this.#e.getBoundingClientRect(),{x:i,y:s,width:l,height:c}=this.#n.parent.boundingClientRect;return[(e-i)/l,(t+n-s)/c]}set commentPopupPositionInLayer(e){this.#l=e}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#e?.remove(),this.#e=null}removeToolbarCommentButton(){this.#t?.remove(),this.#t=null}setCommentButtonStates({selected:e,hasPopup:t}){this.#e&&(this.#e.classList.toggle("selected",e),this.#e.ariaExpanded=t)}#h(e,t){if(!this.#n._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const n=this.#n._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",ii,{signal:n}),t&&(e.addEventListener("focusin",s=>{this.#n._focusEventsAllowed=!1,Ln(s)},{capture:!0,signal:n}),e.addEventListener("focusout",s=>{this.#n._focusEventsAllowed=!0,Ln(s)},{capture:!0,signal:n})),e.addEventListener("pointerdown",s=>s.stopPropagation(),{signal:n});const i=s=>{s.preventDefault(),e===this.#t?this.edit():this.#n.toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",s=>{s.target===e&&s.key==="Enter"&&(this.#a=!0,i(s))},{signal:n}),e.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:n}),e}edit(e){const t=this.commentPopupPositionInLayer;let n,i;if(t)[n,i]=t;else{[n,i]=this.#n.commentButtonPosition;const{width:A,height:f,x:p,y:b}=this.#n;n=p+n*A,i=b+i*f}const s=this.#n.parent.boundingClientRect,{x:l,y:c,width:h,height:d}=s;this.#n._uiManager.editComment(this.#n,l+n*h,c+i*d,{...e,parentDimensions:s})}finish(){this.#t&&(this.#t.focus({focusVisible:this.#a}),this.#a=!1)}isDeleted(){return this.#c||this.#i===""}isEmpty(){return this.#i===null}hasBeenEdited(){return this.isDeleted()||this.#i!==this.#r}serialize(){return this.data}get data(){return{text:this.#i,richText:this.#s,date:this.#o,deleted:this.isDeleted()}}set data(e){if(e!==this.#i&&(this.#s=null),e===null){this.#i="",this.#c=!0;return}this.#i=e,this.#o=new Date,this.#c=!1}restoreData({text:e,richText:t,date:n}){this.#i=e,this.#s=t,this.#o=n,this.#c=!1}setInitialText(e,t=null){this.#r=e,this.data=e,this.#o=null,this.#s=t}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#e?.remove(),this.#e=null,this.#i="",this.#s=null,this.#o=null,this.#n=null,this.#a=!1,this.#c=!1}}class kd{#e;#t=!1;#a=null;#n;#r;#s;#i;#o=null;#c;#l=null;#h;#d=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:i=null,onPinching:s=null,onPinchEnd:l=null,signal:c}){this.#e=e,this.#a=n,this.#n=t,this.#r=i,this.#s=s,this.#i=l,this.#h=new AbortController,this.#c=AbortSignal.any([c,this.#h.signal]),e.addEventListener("touchstart",this.#A.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Di.pixelRatio}#A(e){if(this.#n?.())return;if(e.touches.length===1){if(this.#o)return;const i=this.#o=new AbortController,s=AbortSignal.any([this.#c,i.signal]),l=this.#e,c={capture:!0,signal:s,passive:!1},h=d=>{d.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};l.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(Ln(d),h(d))},c),l.addEventListener("pointerup",h,c),l.addEventListener("pointercancel",h,c);return}if(!this.#d){this.#d=new AbortController;const i=AbortSignal.any([this.#c,this.#d.signal]),s=this.#e,l={signal:i,capture:!1,passive:!1};s.addEventListener("touchmove",this.#p.bind(this),l);const c=this.#f.bind(this);s.addEventListener("touchend",c,l),s.addEventListener("touchcancel",c,l),l.capture=!0,s.addEventListener("pointerdown",Ln,l),s.addEventListener("pointermove",Ln,l),s.addEventListener("pointercancel",Ln,l),s.addEventListener("pointerup",Ln,l),this.#r?.()}if(Ln(e),e.touches.length!==2||this.#a?.()){this.#l=null;return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),this.#l={touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#p(e){if(!this.#l||e.touches.length!==2)return;Ln(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:i,screenY:s}=t,{screenX:l,screenY:c}=n,h=this.#l,{touch0X:d,touch0Y:A,touch1X:f,touch1Y:p}=h,b=f-d,w=p-A,S=l-i,k=c-s,E=Math.hypot(S,k)||1,I=Math.hypot(b,w)||1;if(!this.#t&&Math.abs(I-E)<=kd.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=i,h.touch0Y=s,h.touch1X=l,h.touch1Y=c,!this.#t){this.#t=!0;return}const P=[(i+l)/2,(s+c)/2];this.#s?.(P,I,E)}#f(e){e.touches.length>=2||(this.#d&&(this.#d.abort(),this.#d=null,this.#i?.()),this.#l&&(Ln(e),this.#l=null,this.#t=!1))}destroy(){this.#h?.abort(),this.#h=null,this.#o?.abort(),this.#o=null}}class gt{#e=null;#t=null;#a=null;#n=null;#r=null;#s=!1;#i=null;#o="";#c=null;#l=null;#h=null;#d=null;#A=null;#p="";#f=!1;#u=null;#g=!1;#m=!1;#y=!1;#v=null;#k=0;#w=0;#C=null;#x=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#b=!1;#T=gt._zIndex++;static _borderLineWidth=-1;static _colorManager=new xf;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=gt.prototype._resizeWithKeyboard,t=Fr.TRANSLATE_SMALL,n=Fr.TRANSLATE_BIG;return Et(this,"_resizerKeyboardManager",new ac([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],gt.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null,this.canAddComment=!0;const{rotation:t,rawDims:{pageWidth:n,pageHeight:i,pageX:s,pageY:l}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[s,l];const[c,h]=this.parentDimensions;this.x=e.x/c,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}updatePageIndex(e){this.pageIndex=e}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Et(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new Qx({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(gt._l10n??=e,gt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),gt._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);gt._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){ln("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#b}set _isDraggable(e){this.#b=e,this.div?.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#T}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(this.#L(),this.#d?.remove(),this.#d=null),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#f?this.#f=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,i){const[s,l]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(e+n)/s,this.y=(t+i)/l,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,i]=this.parentDimensions;this.setAt(e*n,t*i,this.width*n,this.height*i),this._onTranslated()}#I([e,t],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#I(this.parentDimensions,e,t)}translateInPage(e,t){this.#u||=[this.x,this.y,this.width,this.height],this.#I(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#u||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[i,s]}=this;if(this.x+=e/i,this.y+=t/s,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[h,d]=this.getBaseTranslation();l+=h,c+=d;const{style:A}=n;A.left=`${(100*l).toFixed(2)}%`,A.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=gt,i=n/e,s=n/t;switch(this.rotation){case 90:return[-i,s];case 180:return[i,s];case 270:return[i,-s];default:return[-i,-s]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,i]}=this;let{x:s,y:l,width:c,height:h}=this;if(c*=n,h*=i,s*=n,l*=i,this._mustFixPosition)switch(e){case 0:s=ua(s,0,n-c),l=ua(l,0,i-h);break;case 90:s=ua(s,0,n-h),l=ua(l,c,i);break;case 180:s=ua(s,c,n),l=ua(l,h,i);break;case 270:s=ua(s,h,n),l=ua(l,0,i-c);break}this.x=s/=n,this.y=l/=i;const[d,A]=this.getBaseTranslation();s+=d,l+=A,t.left=`${(100*s).toFixed(2)}%`,t.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#P(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return gt.#P(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return gt.#P(e,t,360-this.parentRotation)}#M(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#B(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const i=document.createElement("div");this.#c.append(i),i.classList.add("resizer",n),i.setAttribute("data-resizer-name",n),i.addEventListener("pointerdown",this.#_.bind(this,n),{signal:t}),i.addEventListener("contextmenu",ii,{signal:t}),i.tabIndex=-1}this.div.prepend(this.#c)}#_(e,t){t.preventDefault();const{isMac:n}=Wn.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#a?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,this.#l=[t.screenX,t.screenY];const s=new AbortController,l=this._uiManager.combinedSignal(s);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#G.bind(this,e),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Ln,{passive:!1,signal:l}),window.addEventListener("contextmenu",ii,{signal:l}),this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const d=()=>{s.abort(),this.parent.togglePointerEvents(!0),this.#a?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=c,this.div.style.cursor=h,this.#F()};window.addEventListener("pointerup",d,{signal:l}),window.addEventListener("blur",d,{signal:l})}#N(e,t,n,i){this.width=n,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#h)return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:i}=this.#h;this.#h=null;const s=this.x,l=this.y,c=this.width,h=this.height;s===e&&l===t&&c===n&&h===i||this.addCommands({cmd:this.#N.bind(this,s,l,c,h),undo:this.#N.bind(this,e,t,n,i),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#G(e,t){const[n,i]=this.parentDimensions,s=this.x,l=this.y,c=this.width,h=this.height,d=gt.MIN_SIZE/n,A=gt.MIN_SIZE/i,f=this.#M(this.rotation),p=(F,U)=>[f[0]*F+f[2]*U,f[1]*F+f[3]*U],b=this.#M(360-this.rotation),w=(F,U)=>[b[0]*F+b[2]*U,b[1]*F+b[3]*U];let S,k,E=!1,I=!1;switch(e){case"topLeft":E=!0,S=(F,U)=>[0,0],k=(F,U)=>[F,U];break;case"topMiddle":S=(F,U)=>[F/2,0],k=(F,U)=>[F/2,U];break;case"topRight":E=!0,S=(F,U)=>[F,0],k=(F,U)=>[0,U];break;case"middleRight":I=!0,S=(F,U)=>[F,U/2],k=(F,U)=>[0,U/2];break;case"bottomRight":E=!0,S=(F,U)=>[F,U],k=(F,U)=>[0,0];break;case"bottomMiddle":S=(F,U)=>[F/2,U],k=(F,U)=>[F/2,0];break;case"bottomLeft":E=!0,S=(F,U)=>[0,U],k=(F,U)=>[F,0];break;case"middleLeft":I=!0,S=(F,U)=>[0,U/2],k=(F,U)=>[F,U/2];break}const P=S(c,h),R=k(c,h);let D=p(...R);const N=gt._round(s+D[0]),_=gt._round(l+D[1]);let K=1,G=1,L,O;if(t.fromKeyboard)({deltaX:L,deltaY:O}=t);else{const{screenX:F,screenY:U}=t,[Y,ge]=this.#l;[L,O]=this.screenToPageTranslation(F-Y,U-ge),this.#l[0]=F,this.#l[1]=U}if([L,O]=w(L/n,O/i),E){const F=Math.hypot(c,h);K=G=Math.max(Math.min(Math.hypot(R[0]-P[0]-L,R[1]-P[1]-O)/F,1/c,1/h),d/c,A/h)}else I?K=ua(Math.abs(R[0]-P[0]-L),d,1)/c:G=ua(Math.abs(R[1]-P[1]-O),A,1)/h;const q=gt._round(c*K),$=gt._round(h*G);D=p(...k(q,$));const Q=N-D[0],Z=_-D[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=q,this.height=$,this.x=Q,this.y=Z,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#a?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#m)return this._editToolbar;this._editToolbar=new Kl(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#a?.destroy()}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#a||(Ei.initialize(gt._l10n),this.#a=new Ei(this),this.#e&&(this.#a.data=this.#e,this.#e=null)),this.#a}get altTextData(){return this.#a?.data}set altTextData(e){this.#a&&(this.#a.data=e)}get guessedAltText(){return this.#a?.guessedText}async setGuessedAltText(e){await this.#a?.setGuessedText(e)}serializeAltText(e){return this.#a?.serialize(e)}hasAltText(){return!!this.#a&&!this.#a.isEmpty()}hasAltTextData(){return this.#a?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new pu(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#r){this._uiManager.isEditingMode()&&this.#r.classList.remove("hidden");return}this.hasComment&&(this.#r=this.#n.renderForStandalone(),this.div.append(this.#r))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#r=null}hideStandaloneCommentButton(){this.#r?.classList.add("hidden")}get comment(){if(!this.#n)return null;const{data:{richText:e,text:t,date:n,deleted:i}}=this.#n;return{text:t,richText:e,date:n,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){this.#n||=new pu(this),typeof e=="object"&&e!==null?this.#n.restoreData(e):this.#n.data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:n}){if(!t||(this.#n||=new pu(this),this.#n.setInitialText(e,n),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(e){this.#n||=new pu(this),this.#n.edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){this.#n.setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[s]=this.pageDimensions,[l]=this.pageTranslation,c=l+s+1,h=i-100,d=c+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,d,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){this.#n.data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#s?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#z();const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),BS(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#x||=new kd({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#V.bind(this),onPinching:this.#E.bind(this),onPinchEnd:this.#S.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),e}#V(){this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#a?.toggle(!1),this.parent.togglePointerEvents(!1)}#E(e,t,n){let s=.7*(n/t)+1-.7;if(s===1)return;const l=this.#M(this.rotation),c=(N,_)=>[l[0]*N+l[2]*_,l[1]*N+l[3]*_],[h,d]=this.parentDimensions,A=this.x,f=this.y,p=this.width,b=this.height,w=gt.MIN_SIZE/h,S=gt.MIN_SIZE/d;s=Math.max(Math.min(s,1/p,1/b),w/p,S/b);const k=gt._round(p*s),E=gt._round(b*s);if(k===p&&E===b)return;this.#u||=[A,f,p,b];const I=c(p/2,b/2),P=gt._round(A+I[0]),R=gt._round(f+I[1]),D=c(k/2,E/2);this.x=P-D[0],this.y=R-D[1],this.width=k,this.height=E,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#S(){this.#a?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(e){const{isMac:t}=Wn.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#f=!0,this._isDraggable){this.#U(e);return}this.#R(e)}#R(e){const{isMac:t}=Wn.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,s=this._uiManager.combinedSignal(i),l={capture:!0,passive:!1,signal:s},c=d=>{i.abort(),this.#i=null,this.#f=!1,this._uiManager.endDragSession()||this.#R(d),n&&this._onStopDragging()};t&&(this.#k=e.clientX,this.#w=e.clientY,this.#i=e.pointerId,this.#o=e.pointerType,window.addEventListener("pointermove",d=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:A,clientY:f,pointerId:p}=d;if(p!==this.#i){Ln(d);return}const[b,w]=this.screenToPageTranslation(A-this.#k,f-this.#w);this.#k=A,this.#w=f,this._uiManager.dragSelectedEditors(b,w)},l),window.addEventListener("touchmove",Ln,l),window.addEventListener("pointerdown",d=>{d.pointerType===this.#o&&(this.#x||d.isPrimary)&&c(d),Ln(d)},l));const h=d=>{if(!this.#i||this.#i===d.pointerId){c(d);return}Ln(d)};window.addEventListener("pointerup",h,{signal:s}),window.addEventListener("blur",h,{signal:s})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const i=this.parentScale,[s,l]=this.pageDimensions,[c,h]=this.pageTranslation,d=e/i,A=t/i,f=this.x*s,p=this.y*l,b=this.width*s,w=this.height*l;switch(n){case 0:return[f+d+c,l-p-A-w+h,f+d+b+c,l-p-A+h];case 90:return[f+A+c,l-p+d+h,f+A+w+c,l-p+d+b+h];case 180:return[f-d-b+c,l-p+A+h,f-d+c,l-p+A+w+h];case 270:return[f-A-w+c,l-p-d-b+h,f-A+c,l-p-d+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,i,s,l]=e,c=s-n,h=l-i;switch(this.rotation){case 0:return[n,t-l,c,h];case 90:return[n,t-i,h,c];case 180:return[s,t-i,c,h];case 270:return[s,t-l,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&gt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:i,deleted:s,richText:l},uid:c,pageIndex:h,creationDate:d,modificationDate:A}=this;return{id:c,pageIndex:h,rect:this.getPDFRect(),richText:l,contentsObj:{str:e},creationDate:d,modificationDate:n||A,popupRef:!s,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#m=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#m=!1,!0):!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#y}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:s,innerWidth:l}=window;return t<l&&i>0&&e<s&&n>0}#z(){if(this.#A||!this.div)return;this.#A=new AbortController;const e=this._uiManager.combinedSignal(this.#A);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#z()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(e,t,n){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,i.#e=e.accessibilityData,i._isCopy=e.isCopy||!1;const[s,l]=i.pageDimensions,[c,h,d,A]=i.getRectInCurrentCoords(e.rect,l);return i.x=c/s,i.y=h/l,i.width=d/s,i.height=A/l,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#A?.abort(),this.#A=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#L(),this.removeEditToolbar(),this.#C){for(const e of this.#C.values())clearTimeout(e);this.#C=null}this.parent=null,this.#x?.destroy(),this.#x=null,this.#d?.remove(),this.#d=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#B(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,i,s,l]=this.getPDFRect();return[gt._round(n+(s-n)*e),gt._round(i+(l-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(e){this.#n.commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){this.#n?.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#c.children;if(!this.#t){this.#t=Array.from(t);const l=this.#q.bind(this),c=this.#Q.bind(this),h=this._uiManager._signal;for(const d of this.#t){const A=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",l,{signal:h}),d.addEventListener("blur",c,{signal:h}),d.addEventListener("focus",this.#Y.bind(this,A),{signal:h}),d.setAttribute("data-l10n-id",gt._l10nResizer[A])}}const n=this.#t[0];let i=0;for(const l of t){if(l===n)break;i++}const s=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(s!==i){if(s<i)for(let c=0;c<i-s;c++)this.#c.append(this.#c.firstElementChild);else if(s>i)for(let c=0;c<s-i;c++)this.#c.firstElementChild.before(this.#c.lastElementChild);let l=0;for(const c of t){const d=this.#t[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",gt._l10nResizer[d])}}this.#O(0),this.#y=!0,this.#c.firstElementChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#q(e){gt._resizerKeyboardManager.exec(this,e)}#Q(e){this.#y&&e.relatedTarget?.parentNode!==this.#c&&this.#L()}#Y(e){this.#p=this.#y?e:""}#O(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#y&&this.#G(this.#p,{deltaX:e,deltaY:t,fromKeyboard:!0})}#L(){this.#y=!1,this.#O(-1),this.#F()}_stopResizingWithKeyboard(){this.#L(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#a?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#a?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#g}set isEditing(e){this.#g=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#C||=new Map;const{action:n}=e;let i=this.#C.get(n);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),this.#C.delete(n),this.#C.size===0&&(this.#C=null)},gt._telemetryTimeout),this.#C.set(n,i);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#s=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#s=!0}updateFakeAnnotationElement(e){if(!this.#d&&!this.deleted){this.#d=e.addFakeAnnotation(this);return}if(this.deleted){this.#d.remove(),this.#d=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#d.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstElementChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class Qx extends gt{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const gb=3285377520,Ja=4294901760,Ti=65535;class FS{constructor(e){this.h1=e?e&4294967295:gb,this.h2=e?e&4294967295:gb}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let S=0,k=e.length;S<k;S++){const E=e.charCodeAt(S);E<=255?t[n++]=E:(t[n++]=E>>>8,t[n++]=E&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=n>>2,s=n-i*4,l=new Uint32Array(t.buffer,0,i);let c=0,h=0,d=this.h1,A=this.h2;const f=3432918353,p=461845907,b=f&Ti,w=p&Ti;for(let S=0;S<i;S++)S&1?(c=l[S],c=c*f&Ja|c*b&Ti,c=c<<15|c>>>17,c=c*p&Ja|c*w&Ti,d^=c,d=d<<13|d>>>19,d=d*5+3864292196):(h=l[S],h=h*f&Ja|h*b&Ti,h=h<<15|h>>>17,h=h*p&Ja|h*w&Ti,A^=h,A=A<<13|A>>>19,A=A*5+3864292196);switch(c=0,s){case 3:c^=t[i*4+2]<<16;case 2:c^=t[i*4+1]<<8;case 1:c^=t[i*4],c=c*f&Ja|c*b&Ti,c=c<<15|c>>>17,c=c*p&Ja|c*w&Ti,i&1?d^=c:A^=c}this.h1=d,this.h2=A}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Ja|e*36045&Ti,t=t*4283543511&Ja|((t<<16|e>>>16)*2950163797&Ja)>>>16,e^=t>>>1,e=e*444984403&Ja|e*60499&Ti,t=t*3301882366&Ja|((t<<16|e>>>16)*3120437893&Ja)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Fg=Object.freeze({map:null,hash:"",transfer:void 0});class Pf{#e=!1;#t=null;#a=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=this.#n.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#n.get(e)}remove(e){const t=this.#n.get(e);if(t!==void 0&&(t instanceof gt&&this.#a.delete(t.annotationElementId),this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of this.#n.values())if(n instanceof gt)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=this.#n.get(e);let i=!1;if(n!==void 0)for(const[s,l]of Object.entries(t))n[s]!==l&&(i=!0,n[s]=l);else i=!0,this.#n.set(e,t);i&&this.#r(),t instanceof gt&&((this.#a||=new Map).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return this.#n.has(e)}get size(){return this.#n.size}#r(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new US(this)}get serializable(){if(this.#n.size===0)return Fg;const e=new Map,t=new FS,n=[],i=Object.create(null);let s=!1;for(const[l,c]of this.#n){const h=c instanceof gt?c.serialize(!1,i):c;c.page&&(c.pageIndex=c.page._pageIndex,delete c.page),h&&(e.set(l,h),t.update(`${l}:${JSON.stringify(h)}`),s||=!!h.bitmap)}if(s)for(const l of e.values())l.bitmap&&n.push(l.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:Fg}get editorStats(){let e=null;const t=new Map;let n=0,i=0;for(const s of this.#n.values()){if(!(s instanceof gt)){s.popup&&(s.popup.deleted?i+=1:n+=1);continue}s.isCommentDeleted?i+=1:s.hasEditedComment&&(n+=1);const l=s.telemetryFinalData;if(!l)continue;const{type:c}=l;t.has(c)||t.set(c,Object.getPrototypeOf(s).constructor),e||=Object.create(null);const h=e[c]||=new Map;for(const[d,A]of Object.entries(l)){if(d==="type")continue;let f=h.get(d);f||(f=new Map,h.set(d,f));const p=f.get(A)??0;f.set(A,p+1)}}if((i>0||n>0)&&(e||=Object.create(null),e.comments={deleted:i,edited:n}),!e)return null;for(const[s,l]of t)e[s]=l.computeTelemetryFinalData(e[s]);return e}resetModifiedIds(){this.#t=null}updateEditor(e,t){const n=this.#a?.get(e);return n?(n.updateFromAnnotationLayer(t),!0):!1}getEditor(e){return this.#a?.get(e)||null}get modifiedIds(){if(this.#t)return this.#t;const e=[];if(this.#a)for(const t of this.#a.values())t.serialize()&&e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class US extends Pf{#e;constructor(e){super();const{map:t,hash:n,transfer:i}=e.serializable,s=structuredClone(t,i?{transfer:i}:null);this.#e={map:s,hash:n,transfer:i}}get print(){ln("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return Et(this,"modifiedIds",{ids:new Set,hash:""})}}class qx{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||this.#e.has(e.loadedName))){if(on(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:l}=e,c=new FontFace(i,s,l);this.addNativeFontFace(c);try{await c.load(),this.#e.add(i),n?.(e)}catch{kt(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}ln("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(i){throw kt(`Failed to load font '${n.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const i=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return Et(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Et(this,"isSyncFontLoadingSupported",ba||Wn.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(on(!i.done,"completeRequest() cannot be called twice."),i.done=!0;n.length>0&&n[0].done;){const s=n.shift();setTimeout(s.callback,0)}}const{loadingRequests:n}=this,i={done:!1,complete:t,callback:e};return n.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Et(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(R,D){return R.charCodeAt(D)<<24|R.charCodeAt(D+1)<<16|R.charCodeAt(D+2)<<8|R.charCodeAt(D+3)&255}function i(R,D,N,_){const K=R.substring(0,D),G=R.substring(D+N);return K+_+G}let s,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let d=0;function A(R,D){if(++d>30){kt("Load test font never loaded."),D();return}if(h.font="30px "+R,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){D();return}setTimeout(A.bind(null,R,D))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=i(p,976,f.length,f);const w=16,S=1482184792;let k=n(p,w);for(s=0,l=f.length-3;s<l;s+=4)k=k-S+n(f,s)|0;s<f.length&&(k=k-S+n(f+"XXX",s)|0),p=i(p,w,4,Px(k));const E=`url(data:font/opentype;base64,${btoa(p)});`,I=`@font-face {font-family:"${f}";src:${E}}`;this.insertRule(I);const P=this._document.createElement("div");P.style.visibility="hidden",P.style.width=P.style.height="10px",P.style.position="absolute",P.style.top=P.style.left="0px";for(const R of[e.loadedName,f]){const D=this._document.createElement("span");D.textContent="Hi",D.style.fontFamily=R,P.append(D)}this._document.body.append(P),A(f,()=>{P.remove(),t.complete()})}}class Yx{#e;constructor(e,t=null,n,i){this.compiledGlyphs=Object.create(null),this.#e=e,this._inspectFont=t,n&&Object.assign(this,n),i&&(this.charProcOperatorList=i)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${this.data.toBase64()});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let i;try{i=e.get(n)}catch(l){kt(`getPathGenerator - ignoring character: "${l}".`)}const s=LS(i?.path);return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=s}get black(){return this.#e.black}get bold(){return this.#e.bold}get disableFontFace(){return this.#e.disableFontFace??!1}set disableFontFace(e){Et(this,"disableFontFace",!!e)}get fontExtraProperties(){return this.#e.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#e.isInvalidPDFjsFont}get isType3Font(){return this.#e.isType3Font}get italic(){return this.#e.italic}get missingFile(){return this.#e.missingFile}get remeasure(){return this.#e.remeasure}get vertical(){return this.#e.vertical}get ascent(){return this.#e.ascent}get defaultWidth(){return this.#e.defaultWidth}get descent(){return this.#e.descent}get bbox(){return this.#e.bbox}set bbox(e){Et(this,"bbox",e)}get fontMatrix(){return this.#e.fontMatrix}get fallbackName(){return this.#e.fallbackName}get loadedName(){return this.#e.loadedName}get mimetype(){return this.#e.mimetype}get name(){return this.#e.name}get data(){return this.#e.data}clearData(){this.#e.clearData()}get cssFontInfo(){return this.#e.cssFontInfo}get systemFontInfo(){return this.#e.systemFontInfo}get defaultVMetrics(){return this.#e.defaultVMetrics}}class yo{#e;#t;#a;static strings=["fontFamily","fontWeight","italicAngle"];static write(e){const t=new TextEncoder,n={};let i=0;for(const d of yo.strings){const A=t.encode(e[d]);n[d]=A,i+=4+A.length}const s=new ArrayBuffer(i),l=new Uint8Array(s),c=new DataView(s);let h=0;for(const d of yo.strings){const A=n[d],f=A.length;c.setUint32(h,f),l.set(A,h+4),h+=4+f}return on(h===s.byteLength,"CssFontInfo.write: Buffer overflow"),s}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#a=new TextDecoder}#n(e){on(e<yo.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#a.decode(new Uint8Array(this.#e,t+4,n))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class bo{#e;#t;#a;static strings=["css","loadedName","baseFontName","src"];static write(e){const t=new TextEncoder,n={};let i=0;for(const p of bo.strings){const b=t.encode(e[p]);n[p]=b,i+=4+b.length}i+=4;let s,l,c=1+i;e.style&&(s=t.encode(e.style.style),l=t.encode(e.style.weight),c+=4+s.length+4+l.length);const h=new ArrayBuffer(c),d=new Uint8Array(h),A=new DataView(h);let f=0;A.setUint8(f++,e.guessFallback?1:0),A.setUint32(f,0),f+=4,i=0;for(const p of bo.strings){const b=n[p],w=b.length;i+=4+w,A.setUint32(f,w),d.set(b,f+4),f+=4+w}return A.setUint32(f-i-4,i),e.style&&(A.setUint32(f,s.length),d.set(s,f+4),f+=4+s.length,A.setUint32(f,l.length),d.set(l,f+4),f+=4+l.length),on(f<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(f)}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#a=new TextDecoder}get guessFallback(){return this.#t.getUint8(0)!==0}#n(e){on(e<bo.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#a.decode(new Uint8Array(this.#e,t+4,n))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let e=1;e+=4+this.#t.getUint32(e);const t=this.#t.getUint32(e),n=this.#a.decode(new Uint8Array(this.#e,e+4,t));e+=4+t;const i=this.#t.getUint32(e),s=this.#a.decode(new Uint8Array(this.#e,e+4,i));return{style:n,weight:s}}}class pn{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#e=Math.ceil(this.bools.length*2/8);static#t=this.#e+this.numbers.length*8;static#a=this.#t+1+8;static#n=this.#a+1+48;static#r=this.#n+1+6;#s;#i;#o;constructor({data:e,extra:t}){this.#s=e,this.#i=new TextDecoder,this.#o=new DataView(this.#s),t&&Object.assign(this,t)}#c(e){on(e<pn.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=e*2%8,i=this.#o.getUint8(t)>>n&3;return i===0?void 0:i===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(e){return on(e<pn.numbers.length,"Invalid number index"),this.#o.getFloat64(pn.#e+e*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let e=pn.#t;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<4;i++)n.push(this.#o.getInt16(e,!0)),e+=2;return n}get fontMatrix(){let e=pn.#a;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<6;i++)n.push(this.#o.getFloat64(e,!0)),e+=8;return n}get defaultVMetrics(){let e=pn.#n;if(this.#o.getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<3;i++)n.push(this.#o.getInt16(e,!0)),e+=2;return n}#h(e){on(e<pn.strings.length,"Invalid string index");let t=pn.#r+4;for(let s=0;s<e;s++)t+=this.#o.getUint32(t)+4;const n=this.#o.getUint32(t),i=new Uint8Array(n);return i.set(new Uint8Array(this.#s,t+4,n)),this.#i.decode(i)}get fallbackName(){return this.#h(0)}get loadedName(){return this.#h(1)}get mimetype(){return this.#h(2)}get name(){return this.#h(3)}get data(){let e=pn.#r;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const i=this.#o.getUint32(e);e+=4+i;const s=this.#o.getUint32(e);if(s!==0)return new Uint8Array(this.#s,e+4,s)}clearData(){let e=pn.#r;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const i=this.#o.getUint32(e);e+=4+i;const s=this.#o.getUint32(e);new Uint8Array(this.#s,e+4,s).fill(0),this.#o.setUint32(e,0)}get cssFontInfo(){let e=pn.#r;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);e+=4+n;const i=this.#o.getUint32(e);if(i===0)return null;const s=new Uint8Array(i);return s.set(new Uint8Array(this.#s,e+4,i)),new yo(s.buffer)}get systemFontInfo(){let e=pn.#r;const t=this.#o.getUint32(e);e+=4+t;const n=this.#o.getUint32(e);if(n===0)return null;const i=new Uint8Array(n);return i.set(new Uint8Array(this.#s,e+4,n)),new bo(i.buffer)}static write(e){const t=e.systemFontInfo?bo.write(e.systemFontInfo):null,n=e.cssFontInfo?yo.write(e.cssFontInfo):null,i=new TextEncoder,s={};let l=0;for(const S of pn.strings)s[S]=i.encode(e[S]),l+=4+s[S].length;const c=pn.#r+4+l+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),h=new ArrayBuffer(c),d=new Uint8Array(h),A=new DataView(h);let f=0;const p=pn.bools.length;let b=0,w=0;for(let S=0;S<p;S++){const k=e[pn.bools[S]];b|=(k===void 0?0:k?2:1)<<w,w+=2,(w===8||S===p-1)&&(A.setUint8(f++,b),b=0,w=0)}on(f===pn.#e,"FontInfo.write: Boolean properties offset mismatch");for(const S of pn.numbers)A.setFloat64(f,e[S]),f+=8;if(on(f===pn.#t,"FontInfo.write: Number properties offset mismatch"),e.bbox){A.setUint8(f++,4);for(const S of e.bbox)A.setInt16(f,S,!0),f+=2}else A.setUint8(f++,0),f+=8;if(on(f===pn.#a,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){A.setUint8(f++,6);for(const S of e.fontMatrix)A.setFloat64(f,S,!0),f+=8}else A.setUint8(f++,0),f+=48;if(on(f===pn.#n,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){A.setUint8(f++,1);for(const S of e.defaultVMetrics)A.setInt16(f,S,!0),f+=2}else A.setUint8(f++,0),f+=6;on(f===pn.#r,"FontInfo.write: DefaultVMetrics properties offset mismatch"),A.setUint32(pn.#r,0),f+=4;for(const S of pn.strings){const k=s[S],E=k.length;A.setUint32(f,E),d.set(k,f+4),f+=4+E}if(A.setUint32(pn.#r,f-pn.#r-4),!t)A.setUint32(f,0),f+=4;else{const S=t.byteLength;A.setUint32(f,S),on(f+4+S<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),d.set(new Uint8Array(t),f+4),f+=4+S}if(!n)A.setUint32(f,0),f+=4;else{const S=n.byteLength;A.setUint32(f,S),on(f+4+S<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),d.set(new Uint8Array(n),f+4),f+=4+S}return e.data===void 0?(A.setUint32(f,0),f+=4):(A.setUint32(f,e.data.length),d.set(e.data,f+4),f+=4+e.data.length),on(f<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(f)}}class ta{static#e=0;static#t=1;static#a=2;static#n=3;static#r=4;static#s=8;static#i=12;static#o=16;constructor(e){this.buffer=e,this.view=new DataView(e),this.data=new Uint8Array(e)}static write(e){let t,n=null,i=[],s=[],l=[],c=[],h=null,d=null;switch(e[0]){case"RadialAxial":t=e[1]==="axial"?1:2,n=e[2],l=e[3],t===1?i.push(...e[4],...e[5]):i.push(e[4][0],e[4][1],e[6],e[5][0],e[5][1],e[7]);break;case"Mesh":t=3,h=e[1],i=e[2],s=e[3],c=e[4]||[],n=e[6],d=e[7];break;default:throw new Error(`Unsupported pattern type: ${e[0]}`)}const A=Math.floor(i.length/2),f=Math.floor(s.length/3),p=l.length,b=c.length;let w=0;for(const D of c)w+=1,w=Math.ceil(w/4)*4,w+=4+D.coords.length*4,w+=4+D.colors.length*4,D.verticesPerRow!==void 0&&(w+=4);const S=20+A*8+f*3+p*8+(n?16:0)+(d?3:0)+w,k=new ArrayBuffer(S),E=new DataView(k),I=new Uint8Array(k);E.setUint8(ta.#e,t),E.setUint8(ta.#t,n?1:0),E.setUint8(ta.#a,d?1:0),E.setUint8(ta.#n,h),E.setUint32(ta.#r,A,!0),E.setUint32(ta.#s,f,!0),E.setUint32(ta.#i,p,!0),E.setUint32(ta.#o,b,!0);let P=20;new Float32Array(k,P,A*2).set(i),P+=A*8,I.set(s,P),P+=f*3;for(const[D,N]of l)E.setFloat32(P,D,!0),P+=4,E.setUint32(P,parseInt(N.slice(1),16),!0),P+=4;if(n)for(const D of n)E.setFloat32(P,D,!0),P+=4;d&&(I.set(d,P),P+=3);for(let D=0;D<c.length;D++){const N=c[D];E.setUint8(P,N.type),P+=1,P=Math.ceil(P/4)*4,E.setUint32(P,N.coords.length,!0),P+=4,new Int32Array(k,P,N.coords.length).set(N.coords),P+=N.coords.length*4,E.setUint32(P,N.colors.length,!0),P+=4,new Int32Array(k,P,N.colors.length).set(N.colors),P+=N.colors.length*4,N.verticesPerRow!==void 0&&(E.setUint32(P,N.verticesPerRow,!0),P+=4)}return k}getIR(){const e=this.view,t=this.data[ta.#e],n=!!this.data[ta.#t],i=!!this.data[ta.#a],s=e.getUint32(ta.#r,!0),l=e.getUint32(ta.#s,!0),c=e.getUint32(ta.#i,!0),h=e.getUint32(ta.#o,!0);let d=20;const A=new Float32Array(this.buffer,d,s*2);d+=s*8;const f=new Uint8Array(this.buffer,d,l*3);d+=l*3;const p=[];for(let k=0;k<c;++k){const E=e.getFloat32(d,!0);d+=4;const I=e.getUint32(d,!0);d+=4,p.push([E,`#${I.toString(16).padStart(6,"0")}`])}let b=null;if(n){b=[];for(let k=0;k<4;++k)b.push(e.getFloat32(d,!0)),d+=4}let w=null;i&&(w=new Uint8Array(this.buffer,d,3),d+=3);const S=[];for(let k=0;k<h;++k){const E=e.getUint8(d);d+=1,d=Math.ceil(d/4)*4;const I=e.getUint32(d,!0);d+=4;const P=new Int32Array(this.buffer,d,I);d+=I*4;const R=e.getUint32(d,!0);d+=4;const D=new Int32Array(this.buffer,d,R);d+=R*4;const N={type:E,coords:P,colors:D};E===Rg.LATTICE&&(N.verticesPerRow=e.getUint32(d,!0),d+=4),S.push(N)}if(t===1)return["RadialAxial","axial",b,p,Array.from(A.slice(0,2)),Array.from(A.slice(2,4)),null,null];if(t===2)return["RadialAxial","radial",b,p,[A[0],A[1]],[A[3],A[4]],A[2],A[5]];if(t===3){const k=this.data[ta.#n];let E=null;if(A.length>0){let I=A[0],P=A[0],R=A[1],D=A[1];for(let N=0;N<A.length;N+=2){const _=A[N],K=A[N+1];I=I>_?_:I,R=R>K?K:R,P=P<_?_:P,D=D<K?K:D}E=[I,R,P,D]}return["Mesh",k,A,f,S,E,b,w]}throw new Error(`Unsupported pattern kind: ${t}`)}}class Xx{static write(e){let t,n;return Wn.isFloat16ArraySupported?(n=new ArrayBuffer(e.length*2),t=new Float16Array(n)):(n=new ArrayBuffer(e.length*4),t=new Float32Array(n)),t.set(e),n}#e;constructor(e){this.#e=e}get path(){return Wn.isFloat16ArraySupported?new Float16Array(this.#e):new Float32Array(this.#e)}}function Wx(a){if(a instanceof URL)return a.href;if(typeof a=="string"){if(ba)return a;const e=URL.parse(a,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function $x(a){if(ba&&typeof Buffer<"u"&&a instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength)return a;if(typeof a=="string")return wd(a);if(a instanceof ArrayBuffer||ArrayBuffer.isView(a)||typeof a=="object"&&!isNaN(a?.length))return new Uint8Array(a);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function mu(a){if(typeof a!="string")return null;if(a.endsWith("/"))return a;throw new Error(`Invalid factory url: "${a}" must include trailing slash.`)}const Ug=a=>typeof a=="object"&&Number.isInteger(a?.num)&&a.num>=0&&Number.isInteger(a?.gen)&&a.gen>=0,Jx=a=>typeof a=="object"&&typeof a?.name=="string",Zx=Rx.bind(null,Ug,Jx);class eP{#e=new Map;#t=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[i]of this.#e)i.call(this,n)})}addEventListener(e,t,n=null){let i=null;if(n?.signal instanceof AbortSignal){const{signal:s}=n;if(s.aborted){kt("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(e,t);i=()=>s.removeEventListener("abort",l),s.addEventListener("abort",l)}this.#e.set(t,i)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const vu={DATA:1,ERROR:2},jn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function fb(){}function Da(a){if(a instanceof Br||a instanceof Ng||a instanceof ob||a instanceof Wu||a instanceof rg)return a;switch(a instanceof Error||typeof a=="object"&&a!==null||ln('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),a.name){case"AbortException":return new Br(a.message);case"InvalidPDFException":return new Ng(a.message);case"PasswordException":return new ob(a.message,a.code);case"ResponseException":return new Wu(a.message,a.status,a.missing);case"UnknownErrorException":return new rg(a.message,a.details)}return new rg(a.message,a.toString())}class Gl{#e=new AbortController;constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#n(e);return}if(e.callback){const n=e.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===vu.DATA)i.resolve(e.data);else if(e.callback===vu.ERROR)i.reject(Da(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,i=e.sourceName,s=this.comObj;Promise.try(t,e.data).then(function(l){s.postMessage({sourceName:n,targetName:i,callback:vu.DATA,callbackId:e.callbackId,data:l})},function(l){s.postMessage({sourceName:n,targetName:i,callback:vu.ERROR,callbackId:e.callbackId,reason:Da(l)})});return}if(e.streamId){this.#a(e);return}t(e.data)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const i=this.callbackId++,s=Promise.withResolvers();this.callbackCapabilities[i]=s;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},n)}catch(l){s.reject(l)}return s.promise}sendWithStream(e,t,n,i){const s=this.streamId++,l=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:d=>{const A=Promise.withResolvers();return this.streamControllers[s]={controller:d,startCall:A,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:c,action:e,streamId:s,data:t,desiredSize:d.desiredSize},i),A.promise},pull:d=>{const A=Promise.withResolvers();return this.streamControllers[s].pullCall=A,h.postMessage({sourceName:l,targetName:c,stream:jn.PULL,streamId:s,desiredSize:d.desiredSize}),A.promise},cancel:d=>{on(d instanceof Error,"cancel must have a valid reason");const A=Promise.withResolvers();return this.streamControllers[s].cancelCall=A,this.streamControllers[s].isClosed=!0,h.postMessage({sourceName:l,targetName:c,stream:jn.CANCEL,streamId:s,reason:Da(d)}),A.promise}},n)}#a(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,s=this.comObj,l=this,c=this.actionHandler[e.action],h={enqueue(d,A=1,f){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=A,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),s.postMessage({sourceName:n,targetName:i,stream:jn.ENQUEUE,streamId:t,chunk:d},f)},close(){this.isCancelled||(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:jn.CLOSE,streamId:t}),delete l.streamSinks[t])},error(d){on(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,s.postMessage({sourceName:n,targetName:i,stream:jn.ERROR,streamId:t,reason:Da(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(c,e.data,h).then(function(){s.postMessage({sourceName:n,targetName:i,stream:jn.START_COMPLETE,streamId:t,success:!0})},function(d){s.postMessage({sourceName:n,targetName:i,stream:jn.START_COMPLETE,streamId:t,reason:Da(d)})})}#n(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,s=this.comObj,l=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case jn.START_COMPLETE:e.success?l.startCall.resolve():l.startCall.reject(Da(e.reason));break;case jn.PULL_COMPLETE:e.success?l.pullCall.resolve():l.pullCall.reject(Da(e.reason));break;case jn.PULL:if(!c){s.postMessage({sourceName:n,targetName:i,stream:jn.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||fb).then(function(){s.postMessage({sourceName:n,targetName:i,stream:jn.PULL_COMPLETE,streamId:t,success:!0})},function(d){s.postMessage({sourceName:n,targetName:i,stream:jn.PULL_COMPLETE,streamId:t,reason:Da(d)})});break;case jn.ENQUEUE:if(on(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(e.chunk);break;case jn.CLOSE:if(on(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#r(l,t);break;case jn.ERROR:on(l,"error should have stream controller"),l.controller.error(Da(e.reason)),this.#r(l,t);break;case jn.CANCEL_COMPLETE:e.success?l.cancelCall.resolve():l.cancelCall.reject(Da(e.reason)),this.#r(l,t);break;case jn.CANCEL:if(!c)break;const h=Da(e.reason);Promise.try(c.onCancel||fb,h).then(function(){s.postMessage({sourceName:n,targetName:i,stream:jn.CANCEL_COMPLETE,streamId:t,success:!0})},function(d){s.postMessage({sourceName:n,targetName:i,stream:jn.CANCEL_COMPLETE,streamId:t,reason:Da(d)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#r(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class KS{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){ln("Abstract method `_createCanvas` called.")}}class tP extends KS{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class zS{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){ln("Abstract method `_fetch` called.")}}class pb extends zS{async _fetch(e){const t=await ec(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):wd(t)}}class OS{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,i,s){return"none"}destroy(e=!1){}}class nP extends OS{#e;#t;#a;#n;#r;#s;#i=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#n=e,this.#r=t}get#o(){return this.#t||=new Map}get#c(){return this.#s||=new Map}get#l(){if(!this.#a){const e=this.#r.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=this.#r.createElementNS($i,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#a=this.#r.createElementNS($i,"defs"),e.append(n),n.append(this.#a),this.#r.body.append(e)}return this.#a}#h(e){if(e.length===1){const h=e[0],d=new Array(256);for(let f=0;f<256;f++)d[f]=h[f]/255;const A=d.join(",");return[A,A,A]}const[t,n,i]=e,s=new Array(256),l=new Array(256),c=new Array(256);for(let h=0;h<256;h++)s[h]=t[h]/255,l[h]=n[h]/255,c[h]=i[h]/255;return[s.join(","),l.join(","),c.join(",")]}#d(e){if(this.#e===void 0){this.#e="";const t=this.#r.URL;t!==this.#r.baseURI&&(Td(t)?kt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=_S(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#o.get(e);if(t)return t;const[n,i,s]=this.#h(e),l=e.length===1?n:`${n}${i}${s}`;if(t=this.#o.get(l),t)return this.#o.set(e,t),t;const c=`g_${this.#n}_transfer_map_${this.#i++}`,h=this.#d(c);this.#o.set(e,h),this.#o.set(l,h);const d=this.#f(c);return this.#g(n,i,s,d),h}addHCMFilter(e,t){const n=`${e}-${t}`,i="base";let s=this.#c.get(i);if(s?.key===n||(s?(s.filter?.remove(),s.key=n,s.url="none",s.filter=null):(s={key:n,url:"none",filter:null},this.#c.set(i,s)),!e||!t))return s.url;const l=this.#y(e);e=Ze.makeHexColor(...l);const c=this.#y(t);if(t=Ze.makeHexColor(...c),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return s.url;const h=new Array(256);for(let b=0;b<=255;b++){const w=b/255;h[b]=w<=.03928?w/12.92:((w+.055)/1.055)**2.4}const d=h.join(","),A=`g_${this.#n}_hcm_filter`,f=s.filter=this.#f(A);this.#g(d,d,d,f),this.#p(f);const p=(b,w)=>{const S=l[b]/255,k=c[b]/255,E=new Array(w+1);for(let I=0;I<=w;I++)E[I]=S+I/w*(k-S);return E.join(",")};return this.#g(p(0,5),p(1,5),p(2,5),f),s.url=this.#d(A),s.url}addAlphaFilter(e){let t=this.#o.get(e);if(t)return t;const[n]=this.#h([e]),i=`alpha_${n}`;if(t=this.#o.get(i),t)return this.#o.set(e,t),t;const s=`g_${this.#n}_alpha_map_${this.#i++}`,l=this.#d(s);this.#o.set(e,l),this.#o.set(i,l);const c=this.#f(s);return this.#m(n,c),l}addLuminosityFilter(e){let t=this.#o.get(e||"luminosity");if(t)return t;let n,i;if(e?([n]=this.#h([e]),i=`luminosity_${n}`):i="luminosity",t=this.#o.get(i),t)return this.#o.set(e,t),t;const s=`g_${this.#n}_luminosity_map_${this.#i++}`,l=this.#d(s);this.#o.set(e,l),this.#o.set(i,l);const c=this.#f(s);return this.#A(c),e&&this.#m(n,c),l}addHighlightHCMFilter(e,t,n,i,s){const l=`${t}-${n}-${i}-${s}`;let c=this.#c.get(e);if(c?.key===l||(c?(c.filter?.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},this.#c.set(e,c)),!t||!n))return c.url;const[h,d]=[t,n].map(this.#y.bind(this));let A=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),f=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[p,b]=[i,s].map(this.#y.bind(this));f<A&&([A,f,p,b]=[f,A,b,p]),this.#l.style.color="";const w=(E,I,P)=>{const R=new Array(256),D=(f-A)/P,N=E/255,_=(I-E)/(255*P);let K=0;for(let G=0;G<=P;G++){const L=Math.round(A+G*D),O=N+G*_;for(let q=K;q<=L;q++)R[q]=O;K=L+1}for(let G=K;G<256;G++)R[G]=R[K-1];return R.join(",")},S=`g_${this.#n}_hcm_${e}_filter`,k=c.filter=this.#f(S);return this.#p(k),this.#g(w(p[0],b[0],5),w(p[1],b[1],5),w(p[2],b[2],5),k),c.url=this.#d(S),c.url}destroy(e=!1){e&&this.#s?.size||(this.#a?.parentNode.parentNode.remove(),this.#a=null,this.#t?.clear(),this.#t=null,this.#s?.clear(),this.#s=null,this.#i=0)}#A(e){const t=this.#r.createElementNS($i,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#p(e){const t=this.#r.createElementNS($i,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#f(e){const t=this.#r.createElementNS($i,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#u(e,t,n){const i=this.#r.createElementNS($i,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),e.append(i)}#g(e,t,n,i){const s=this.#r.createElementNS($i,"feComponentTransfer");i.append(s),this.#u(s,"feFuncR",e),this.#u(s,"feFuncG",t),this.#u(s,"feFuncB",n)}#m(e,t){const n=this.#r.createElementNS($i,"feComponentTransfer");t.append(n),this.#u(n,"feFuncA",e)}#y(e){return this.#l.style.color=e,nc(getComputedStyle(this.#l).getPropertyValue("color"))}}class HS{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){ln("Abstract method `_fetch` called.")}}class mb extends HS{async _fetch(e){const t=await ec(e,"arraybuffer");return new Uint8Array(t)}}class VS{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){ln("Abstract method `_fetch` called.")}}class vb extends VS{async _fetch(e){const t=await ec(e,"arraybuffer");return new Uint8Array(t)}}ba&&kt("Please use the `legacy` build in Node.js environments.");async function Mf(a){const t=await process.getBuiltinModule("fs").promises.readFile(a);return new Uint8Array(t)}class aP extends OS{}class iP extends KS{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class rP extends zS{async _fetch(e){return Mf(e)}}class sP extends HS{async _fetch(e){return Mf(e)}}class oP extends VS{async _fetch(e){return Mf(e)}}const $s="__forcedDependency",{floor:yb,ceil:bb}=Math;function yu(a,e,t,n,i,s){a[e*4+0]=Math.min(a[e*4+0],t),a[e*4+1]=Math.min(a[e*4+1],n),a[e*4+2]=Math.max(a[e*4+2],i),a[e*4+3]=Math.max(a[e*4+3],s)}const Kg=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class lP{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get length(){return this.#e.length}isEmpty(e){return this.#e[e]===Kg}minX(e){return this.#t[e*4+0]/256}minY(e){return this.#t[e*4+1]/256}maxX(e){return(this.#t[e*4+2]+1)/256}maxY(e){return(this.#t[e*4+3]+1)/256}}const bu=(a,e)=>{if(!a)return;let t=a.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},a.set(e,t)),t};class cP{#e={__proto__:null};#t={__proto__:null,transform:[],moveText:[],sameLineText:[],[$s]:[]};#a=new Map;#n=[];#r=[];#s=[[1,0,0,1,0,0]];#i=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#h=new Map;#d=new Map;#A;#p;#f;#u;#g;constructor(e,t,n=!1){this.#A=e.width,this.#p=e.height,this.#m(t),n&&(this.#g=new Map)}growOperationsCount(e){e>=this.#u.length&&this.#m(e,this.#u)}#m(e,t){const n=new ArrayBuffer(e*4);this.#f=new Uint8ClampedArray(n),this.#u=new Uint32Array(n),t&&t.length>0?(this.#u.set(t),this.#u.fill(Kg,t.length)):this.#u.fill(Kg)}save(e){return this.#e={__proto__:this.#e},this.#t={__proto__:this.#t,transform:{__proto__:this.#t.transform},moveText:{__proto__:this.#t.moveText},sameLineText:{__proto__:this.#t.sameLineText},[$s]:{__proto__:this.#t[$s]}},this.#i={__proto__:this.#i},this.#n.push(e),this}restore(e){const t=Object.getPrototypeOf(this.#e);if(t===null)return this;this.#e=t,this.#t=Object.getPrototypeOf(this.#t),this.#i=Object.getPrototypeOf(this.#i);const n=this.#n.pop();return n!==void 0&&(bu(this.#g,e)?.dependencies.add(n),this.#u[e]=this.#u[n]),this}recordOpenMarker(e){return this.#n.push(e),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(e){const t=this.#n.pop();return t!==void 0&&(bu(this.#g,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}beginMarkedContent(e){return this.#r.push(e),this}endMarkedContent(e){const t=this.#r.pop();return t!==void 0&&(bu(this.#g,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}pushBaseTransform(e){return this.#s.push(Ze.multiplyByDOMMatrix(this.#s.at(-1),e.getTransform())),this}popBaseTransform(){return this.#s.length>1&&this.#s.pop(),this}recordSimpleData(e,t){return this.#e[e]=t,this}recordIncrementalData(e,t){return this.#t[e].push(t),this}resetIncrementalData(e,t){return this.#t[e].length=0,this}recordNamedData(e,t){return this.#a.set(e,t),this}recordSimpleDataFromNamed(e,t,n){this.#e[e]=this.#a.get(t)??n}recordFutureForcedDependency(e,t){return this.recordIncrementalData($s,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in this.#e&&this.recordFutureForcedDependency(t,this.#e[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of this.#l)this.recordFutureForcedDependency($s,e);return this}resetBBox(e){return this.#c!==e&&(this.#c=e,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(e,t,n,i,s,l){const c=Ze.multiplyByDOMMatrix(this.#s.at(-1),t.getTransform()),h=[1/0,1/0,-1/0,-1/0];Ze.axialAlignedBoundingBox([n,s,i,l],c,h);const d=Ze.intersect(this.#i,h);return d?(this.#i[0]=d[0],this.#i[1]=d[1],this.#i[2]=d[2],this.#i[3]=d[3]):(this.#i[0]=this.#i[1]=1/0,this.#i[2]=this.#i[3]=-1/0),this}recordBBox(e,t,n,i,s,l){const c=this.#i;if(c[0]===1/0)return this;const h=Ze.multiplyByDOMMatrix(this.#s.at(-1),t.getTransform());if(c[0]===-1/0)return Ze.axialAlignedBoundingBox([n,s,i,l],h,this.#o),this;const d=[1/0,1/0,-1/0,-1/0];return Ze.axialAlignedBoundingBox([n,s,i,l],h,d),this.#o[0]=Math.min(this.#o[0],Math.max(d[0],c[0])),this.#o[1]=Math.min(this.#o[1],Math.max(d[1],c[1])),this.#o[2]=Math.max(this.#o[2],Math.min(d[2],c[2])),this.#o[3]=Math.max(this.#o[3],Math.min(d[3],c[3])),this}recordCharacterBBox(e,t,n,i=1,s=0,l=0,c){const h=n.bbox;let d,A;if(h&&(d=h[2]!==h[0]&&h[3]!==h[1]&&this.#d.get(n),d!==!1&&(A=[0,0,0,0],Ze.axialAlignedBoundingBox(h,n.fontMatrix,A),(i!==1||s!==0||l!==0)&&Ze.scaleMinMax([i,0,0,-i,s,l],A),d)))return this.recordBBox(e,t,A[0],A[2],A[1],A[3]);if(!c)return this.recordFullPageBBox(e);const f=c();return h&&A&&d===void 0&&(d=A[0]<=s-f.actualBoundingBoxLeft&&A[2]>=s+f.actualBoundingBoxRight&&A[1]<=l-f.actualBoundingBoxAscent&&A[3]>=l+f.actualBoundingBoxDescent,this.#d.set(n,d),d)?this.recordBBox(e,t,A[0],A[2],A[1],A[3]):this.recordBBox(e,t,s-f.actualBoundingBoxLeft,s+f.actualBoundingBoxRight,l-f.actualBoundingBoxAscent,l+f.actualBoundingBoxDescent)}recordFullPageBBox(e){return this.#o[0]=Math.max(0,this.#i[0]),this.#o[1]=Math.max(0,this.#i[1]),this.#o[2]=Math.min(this.#A,this.#i[2]),this.#o[3]=Math.min(this.#p,this.#i[3]),this}getSimpleIndex(e){return this.#e[e]}recordDependencies(e,t){const n=this.#l,i=this.#e,s=this.#t;for(const l of t)l in this.#e?n.add(i[l]):l in s&&s[l].forEach(n.add,n);return this}recordNamedDependency(e,t){return this.#a.has(t)&&this.#l.add(this.#a.get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[$s]),this.#g){const n=bu(this.#g,e),{dependencies:i}=n;this.#l.forEach(i.add,i),this.#n.forEach(i.add,i),this.#r.forEach(i.add,i),i.delete(e),n.isRenderingOperation=!0}if(this.#c===e){const n=yb(this.#o[0]*256/this.#A),i=yb(this.#o[1]*256/this.#p),s=bb(this.#o[2]*256/this.#A),l=bb(this.#o[3]*256/this.#p);yu(this.#f,e,n,i,s,l);for(const c of this.#l)c!==e&&yu(this.#f,c,n,i,s,l);for(const c of this.#n)c!==e&&yu(this.#f,c,n,i,s,l);for(const c of this.#r)c!==e&&yu(this.#f,c,n,i,s,l);t||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(e,t=!1){const n=Array.from(this.#l);this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of n)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,t=!1){return this.#c===e&&(this.#c=-1,this.#i[0]=Math.max(this.#i[0],this.#o[0]),this.#i[1]=Math.max(this.#i[1],this.#o[1]),this.#i[2]=Math.min(this.#i[2],this.#o[2]),this.#i[3]=Math.min(this.#i[3],this.#o[3]),t||this.#l.clear()),this}_takePendingDependencies(){const e=this.#l;return this.#l=new Set,e}_extractOperation(e){const t=this.#h.get(e);return this.#h.delete(e),t}_pushPendingDependencies(e){for(const t of e)this.#l.add(t)}take(){return this.#d.clear(),new lP(this.#u,this.#f)}takeDebugMetadata(){return this.#g}}class $u{#e;#t;#a;#n=0;#r=0;constructor(e,t,n){if(e instanceof $u&&e.#a===!!n)return e;this.#e=e,this.#t=t,this.#a=!!n}growOperationsCount(){throw new Error("Unreachable")}save(e){return this.#r++,this.#e.save(this.#t),this}restore(e){return this.#r>0&&(this.#e.restore(this.#t),this.#r--),this}recordOpenMarker(e){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#t:this.#e.getOpenMarker()}recordCloseMarker(e){return this.#n--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return this.#e.pushBaseTransform(e),this}popBaseTransform(){return this.#e.popBaseTransform(),this}recordSimpleData(e,t){return this.#e.recordSimpleData(e,this.#t),this}recordIncrementalData(e,t){return this.#e.recordIncrementalData(e,this.#t),this}resetIncrementalData(e,t){return this.#e.resetIncrementalData(e,this.#t),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return this.#e.recordSimpleDataFromNamed(e,t,this.#t),this}recordFutureForcedDependency(e,t){return this.#e.recordFutureForcedDependency(e,this.#t),this}inheritSimpleDataAsFutureForcedDependencies(e){return this.#e.inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#e.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return this.#a||this.#e.resetBBox(this.#t),this}recordClipBox(e,t,n,i,s,l){return this.#a||this.#e.recordClipBox(this.#t,t,n,i,s,l),this}recordBBox(e,t,n,i,s,l){return this.#a||this.#e.recordBBox(this.#t,t,n,i,s,l),this}recordCharacterBBox(e,t,n,i,s,l,c){return this.#a||this.#e.recordCharacterBBox(this.#t,t,n,i,s,l,c),this}recordFullPageBBox(e){return this.#a||this.#e.recordFullPageBBox(this.#t),this}getSimpleIndex(e){return this.#e.getSimpleIndex(e)}recordDependencies(e,t){return this.#e.recordDependencies(this.#t,t),this}recordNamedDependency(e,t){return this.#e.recordNamedDependency(this.#t,t),this}recordOperation(e){return this.#e.recordOperation(this.#t,!0),this}recordShowTextOperation(e){return this.#e.recordShowTextOperation(this.#t,!0),this}bboxToClipBoxDropOperation(e){return this.#a||this.#e.bboxToClipBoxDropOperation(this.#t,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Za={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},da={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function zg(a,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,n),a.clip(i)}class If{isModifyingCurrentTransform(){return!1}getPattern(){ln("Abstract method `getPattern` called.")}}class uP extends If{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(e,t=null){let n,i=this._p0,s=this._p1;if(t&&(i=i.slice(),s=s.slice(),Ze.applyTransform(i,t),Ze.applyTransform(s,t)),this._type==="axial")n=e.createLinearGradient(i[0],i[1],s[0],s[1]);else if(this._type==="radial"){let l=this._r0,c=this._r1;if(t){const h=new Float32Array(2);Ze.singularValueDecompose2dScale(t,h),l*=h[0],c*=h[0]}n=e.createRadialGradient(i[0],i[1],l,s[0],s[1],c)}for(const l of this._colorStops)n.addColorStop(l[0],l[1]);return n}getPattern(e,t,n,i){let s;if(i===da.STROKE||i===da.FILL){if(this.isOriginBased()){let p=Ze.transform(n,t.baseTransform);this.matrix&&(p=Ze.transform(p,this.matrix));const b=.001,w=Math.hypot(p[0],p[1]),S=Math.hypot(p[2],p[3]),k=(p[0]*p[2]+p[1]*p[3])/(w*S);if(Math.abs(k)<b)if(this.isRadial()){if(Math.abs(w-S)<b)return this._createGradient(e,p)}else return this._createGradient(e,p)}const l=t.current.getClippedPathBoundingBox(i,Dn(e))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,d=t.cachedCanvases.getCanvas("pattern",c,h),A=d.context;A.clearRect(0,0,A.canvas.width,A.canvas.height),A.beginPath(),A.rect(0,0,A.canvas.width,A.canvas.height),A.translate(-l[0],-l[1]),n=Ze.transform(n,[1,0,0,1,l[0],l[1]]),A.transform(...t.baseTransform),this.matrix&&A.transform(...this.matrix),zg(A,this._bbox),A.fillStyle=this._createGradient(A),A.fill(),s=e.createPattern(d.canvas,"no-repeat");const f=new DOMMatrix(n);s.setTransform(f)}else zg(e,this._bbox),s=this._createGradient(e);return s}}function lg(a,e,t,n,i,s,l,c){const h=e.coords,d=e.colors,A=a.data,f=a.width*4;let p;h[t+1]>h[n+1]&&(p=t,t=n,n=p,p=s,s=l,l=p),h[n+1]>h[i+1]&&(p=n,n=i,i=p,p=l,l=c,c=p),h[t+1]>h[n+1]&&(p=t,t=n,n=p,p=s,s=l,l=p);const b=(h[t]+e.offsetX)*e.scaleX,w=(h[t+1]+e.offsetY)*e.scaleY,S=(h[n]+e.offsetX)*e.scaleX,k=(h[n+1]+e.offsetY)*e.scaleY,E=(h[i]+e.offsetX)*e.scaleX,I=(h[i+1]+e.offsetY)*e.scaleY;if(w>=I)return;const P=d[s],R=d[s+1],D=d[s+2],N=d[l],_=d[l+1],K=d[l+2],G=d[c],L=d[c+1],O=d[c+2],q=Math.round(w),$=Math.round(I);let Q,Z,F,U,Y,ge,me,z;for(let H=q;H<=$;H++){if(H<k){const ce=H<w?0:(w-H)/(w-k);Q=b-(b-S)*ce,Z=P-(P-N)*ce,F=R-(R-_)*ce,U=D-(D-K)*ce}else{let ce;H>I?ce=1:k===I?ce=0:ce=(k-H)/(k-I),Q=S-(S-E)*ce,Z=N-(N-G)*ce,F=_-(_-L)*ce,U=K-(K-O)*ce}let j;H<w?j=0:H>I?j=1:j=(w-H)/(w-I),Y=b-(b-E)*j,ge=P-(P-G)*j,me=R-(R-L)*j,z=D-(D-O)*j;const le=Math.round(Math.min(Q,Y)),te=Math.round(Math.max(Q,Y));let oe=f*H+le*4;for(let ce=le;ce<=te;ce++)j=(Q-ce)/(Q-Y),j<0?j=0:j>1&&(j=1),A[oe++]=Z-(Z-ge)*j|0,A[oe++]=F-(F-me)*j|0,A[oe++]=U-(U-z)*j|0,A[oe++]=255}}function dP(a,e,t){const n=e.coords,i=e.colors;let s,l;switch(e.type){case Rg.LATTICE:const c=e.verticesPerRow,h=Math.floor(n.length/c)-1,d=c-1;for(s=0;s<h;s++){let A=s*c;for(let f=0;f<d;f++,A++)lg(a,t,n[A],n[A+1],n[A+c],i[A],i[A+1],i[A+c]),lg(a,t,n[A+c+1],n[A+1],n[A+c],i[A+c+1],i[A+1],i[A+c])}break;case Rg.TRIANGLES:for(s=0,l=n.length;s<l;s+=3)lg(a,t,n[s],n[s+1],n[s+2],i[s],i[s+1],i[s+2]);break;default:throw new Error("illegal figure")}}class hP extends If{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-c,A=Math.ceil(this._bounds[3])-h,f=Math.min(Math.ceil(Math.abs(d*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(A*e[1]*1.1)),3e3),b=d/f,w=A/p,S={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/b,scaleY:1/w},k=f+4,E=p+4,I=n.getCanvas("mesh",k,E),P=I.context,R=P.createImageData(f,p);if(t){const N=R.data;for(let _=0,K=N.length;_<K;_+=4)N[_]=t[0],N[_+1]=t[1],N[_+2]=t[2],N[_+3]=255}for(const N of this._figures)dP(R,N,S);return P.putImageData(R,2,2),{canvas:I.canvas,offsetX:c-2*b,offsetY:h-2*w,scaleX:b,scaleY:w}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,i){zg(e,this._bbox);const s=new Float32Array(2);if(i===da.SHADING)Ze.singularValueDecompose2dScale(Dn(e),s);else if(this.matrix){Ze.singularValueDecompose2dScale(this.matrix,s);const[c,h]=s;Ze.singularValueDecompose2dScale(t.baseTransform,s),s[0]*=c,s[1]*=h}else Ze.singularValueDecompose2dScale(t.baseTransform,s);const l=this._createMeshCanvas(s,i===da.SHADING?null:this._background,t.cachedCanvases);return i!==da.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(l.offsetX,l.offsetY),e.scale(l.scaleX,l.scaleY),e.createPattern(l.canvas,"no-repeat")}}class AP extends If{getPattern(){return"hotpink"}}function gP(a){switch(a[0]){case"RadialAxial":return new uP(a);case"Mesh":return new hP(a);case"Dummy":return new AP}throw new Error(`Unknown IR type: ${a[0]}`)}const Cb={COLORED:1,UNCOLORED:2};class Df{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(e,t){const{bbox:n,operatorList:i,paintType:s,tilingType:l,color:c,canvasGraphicsFactory:h}=this;let{xstep:d,ystep:A}=this;d=Math.abs(d),A=Math.abs(A),Sd("TilingType: "+l);const f=n[0],p=n[1],b=n[2],w=n[3],S=b-f,k=w-p,E=new Float32Array(2);Ze.singularValueDecompose2dScale(this.matrix,E);const[I,P]=E;Ze.singularValueDecompose2dScale(this.baseTransform,E);const R=I*E[0],D=P*E[1];let N=S,_=k,K=!1,G=!1;const L=Math.ceil(d*R),O=Math.ceil(A*D),q=Math.ceil(S*R),$=Math.ceil(k*D);L>=q?N=d:K=!0,O>=$?_=A:G=!0;const Q=this.getSizeAndScale(N,this.ctx.canvas.width,R),Z=this.getSizeAndScale(_,this.ctx.canvas.height,D),F=e.cachedCanvases.getCanvas("pattern",Q.size,Z.size),U=F.context,Y=h.createCanvasGraphics(U,t);if(Y.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(Y,s,c),U.translate(-Q.scale*f,-Z.scale*p),Y.transform(0,Q.scale,0,0,Z.scale,0,0),U.save(),Y.dependencyTracker?.save(),this.clipBbox(Y,f,p,b,w),Y.baseTransform=Dn(Y.ctx),Y.executeOperatorList(i),Y.endDrawing(),Y.dependencyTracker?.restore(),U.restore(),K||G){const ge=F.canvas;K&&(N=d),G&&(_=A);const me=this.getSizeAndScale(N,this.ctx.canvas.width,R),z=this.getSizeAndScale(_,this.ctx.canvas.height,D),H=me.size,j=z.size,le=e.cachedCanvases.getCanvas("pattern-workaround",H,j),te=le.context,oe=K?Math.floor(S/d):0,ce=G?Math.floor(k/A):0;for(let Ge=0;Ge<=oe;Ge++)for(let ae=0;ae<=ce;ae++)te.drawImage(ge,H*Ge,j*ae,H,j,0,0,H,j);return{canvas:le.canvas,scaleX:me.scale,scaleY:z.scale,offsetX:f,offsetY:p}}return{canvas:F.canvas,scaleX:Q.scale,scaleY:Z.scale,offsetX:f,offsetY:p}}getSizeAndScale(e,t,n){const i=Math.max(Df.MAX_PATTERN_SIZE,t);let s=Math.ceil(e*n);return s>=i?s=i:n=s/e,{scale:n,size:s}}clipBbox(e,t,n,i,s){const l=i-t,c=s-n;e.ctx.rect(t,n,l,c),Ze.axialAlignedBoundingBox([t,n,i,s],Dn(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const i=e.ctx,s=e.current;switch(t){case Cb.COLORED:const{fillStyle:l,strokeStyle:c}=this.ctx;i.fillStyle=s.fillColor=l,i.strokeStyle=s.strokeColor=c;break;case Cb.UNCOLORED:i.fillStyle=i.strokeStyle=n,s.fillColor=s.strokeColor=n;break;default:throw new Ex(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,i,s){let l=n;i!==da.SHADING&&(l=Ze.transform(l,t.baseTransform),this.matrix&&(l=Ze.transform(l,this.matrix)));const c=this.createPatternCanvas(t,s);let h=new DOMMatrix(l);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const d=e.createPattern(c.canvas,"repeat");return d.setTransform(h),d}}function fP({src:a,srcPos:e=0,dest:t,width:n,height:i,nonBlackColor:s=4294967295,inverseDecode:l=!1}){const c=Wn.isLittleEndian?4278190080:255,[h,d]=l?[s,c]:[c,s],A=n>>3,f=n&7,p=a.length;t=new Uint32Array(t.buffer);let b=0;for(let w=0;w<i;w++){for(const k=e+A;e<k;e++){const E=e<p?a[e]:255;t[b++]=E&128?d:h,t[b++]=E&64?d:h,t[b++]=E&32?d:h,t[b++]=E&16?d:h,t[b++]=E&8?d:h,t[b++]=E&4?d:h,t[b++]=E&2?d:h,t[b++]=E&1?d:h}if(f===0)continue;const S=e<p?a[e++]:255;for(let k=0;k<f;k++)t[b++]=S&1<<7-k?d:h}return{srcPos:e,destPos:b}}const Sb=16,wb=100,pP=15,Tb=10,_a=16,cg=new DOMMatrix,Oa=new Float32Array(2),co=new Float32Array([1/0,1/0,-1/0,-1/0]);function mP(a,e){if(a._removeMirroring)throw new Error("Context is already forwarding operations.");a.__originalSave=a.save,a.__originalRestore=a.restore,a.__originalRotate=a.rotate,a.__originalScale=a.scale,a.__originalTranslate=a.translate,a.__originalTransform=a.transform,a.__originalSetTransform=a.setTransform,a.__originalResetTransform=a.resetTransform,a.__originalClip=a.clip,a.__originalMoveTo=a.moveTo,a.__originalLineTo=a.lineTo,a.__originalBezierCurveTo=a.bezierCurveTo,a.__originalRect=a.rect,a.__originalClosePath=a.closePath,a.__originalBeginPath=a.beginPath,a._removeMirroring=()=>{a.save=a.__originalSave,a.restore=a.__originalRestore,a.rotate=a.__originalRotate,a.scale=a.__originalScale,a.translate=a.__originalTranslate,a.transform=a.__originalTransform,a.setTransform=a.__originalSetTransform,a.resetTransform=a.__originalResetTransform,a.clip=a.__originalClip,a.moveTo=a.__originalMoveTo,a.lineTo=a.__originalLineTo,a.bezierCurveTo=a.__originalBezierCurveTo,a.rect=a.__originalRect,a.closePath=a.__originalClosePath,a.beginPath=a.__originalBeginPath,delete a._removeMirroring},a.save=function(){e.save(),this.__originalSave()},a.restore=function(){e.restore(),this.__originalRestore()},a.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},a.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},a.transform=function(t,n,i,s,l,c){e.transform(t,n,i,s,l,c),this.__originalTransform(t,n,i,s,l,c)},a.setTransform=function(t,n,i,s,l,c){e.setTransform(t,n,i,s,l,c),this.__originalSetTransform(t,n,i,s,l,c)},a.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},a.rotate=function(t){e.rotate(t),this.__originalRotate(t)},a.clip=function(t){e.clip(t),this.__originalClip(t)},a.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},a.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},a.bezierCurveTo=function(t,n,i,s,l,c){e.bezierCurveTo(t,n,i,s,l,c),this.__originalBezierCurveTo(t,n,i,s,l,c)},a.rect=function(t,n,i,s){e.rect(t,n,i,s),this.__originalRect(t,n,i,s)},a.closePath=function(){e.closePath(),this.__originalClosePath()},a.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class vP{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,n)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function Cu(a,e,t,n,i,s,l,c,h,d){const[A,f,p,b,w,S]=Dn(a);if(f===0&&p===0){const I=l*A+w,P=Math.round(I),R=c*b+S,D=Math.round(R),N=(l+h)*A+w,_=Math.abs(Math.round(N)-P)||1,K=(c+d)*b+S,G=Math.abs(Math.round(K)-D)||1;return a.setTransform(Math.sign(A),0,0,Math.sign(b),P,D),a.drawImage(e,t,n,i,s,0,0,_,G),a.setTransform(A,f,p,b,w,S),[_,G]}if(A===0&&b===0){const I=c*p+w,P=Math.round(I),R=l*f+S,D=Math.round(R),N=(c+d)*p+w,_=Math.abs(Math.round(N)-P)||1,K=(l+h)*f+S,G=Math.abs(Math.round(K)-D)||1;return a.setTransform(0,Math.sign(f),Math.sign(p),0,P,D),a.drawImage(e,t,n,i,s,0,0,G,_),a.setTransform(A,f,p,b,w,S),[G,_]}a.drawImage(e,t,n,i,s,l,c,h,d);const k=Math.hypot(A,f),E=Math.hypot(p,b);return[k*h,E*d]}class kb{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=_g;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Xn.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t,n){n?.(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=co.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=da.FILL,t=null){const n=this.minMax.slice();if(e===da.STROKE){t||ln("Stroke bounding box must include transform."),Ze.singularValueDecompose2dScale(t,Oa);const i=Oa[0]*this.lineWidth/2,s=Oa[1]*this.lineWidth/2;n[0]-=i,n[1]-=s,n[2]+=i,n[3]+=s}return n}updateClipFromPath(){const e=Ze.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(co,0)}getClippedPathBoundingBox(e=da.FILL,t=null){return Ze.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function Eb(a,e){if(e instanceof ImageData){a.putImageData(e,0,0);return}const t=e.height,n=e.width,i=t%_a,s=(t-i)/_a,l=i===0?s:s+1,c=a.createImageData(n,_a);let h=0,d;const A=e.data,f=c.data;let p,b,w,S;if(e.kind===Bu.GRAYSCALE_1BPP){const k=A.byteLength,E=new Uint32Array(f.buffer,0,f.byteLength>>2),I=E.length,P=n+7>>3,R=4294967295,D=Wn.isLittleEndian?4278190080:255;for(p=0;p<l;p++){for(w=p<s?_a:i,d=0,b=0;b<w;b++){const N=k-h;let _=0;const K=N>P?n:N*8-7,G=K&-8;let L=0,O=0;for(;_<G;_+=8)O=A[h++],E[d++]=O&128?R:D,E[d++]=O&64?R:D,E[d++]=O&32?R:D,E[d++]=O&16?R:D,E[d++]=O&8?R:D,E[d++]=O&4?R:D,E[d++]=O&2?R:D,E[d++]=O&1?R:D;for(;_<K;_++)L===0&&(O=A[h++],L=128),E[d++]=O&L?R:D,L>>=1}for(;d<I;)E[d++]=0;a.putImageData(c,0,p*_a)}}else if(e.kind===Bu.RGBA_32BPP){for(b=0,S=n*_a*4,p=0;p<s;p++)f.set(A.subarray(h,h+S)),h+=S,a.putImageData(c,0,b),b+=_a;p<l&&(S=n*i*4,f.set(A.subarray(h,h+S)),a.putImageData(c,0,b))}else if(e.kind===Bu.RGB_24BPP)for(w=_a,S=n*w,p=0;p<l;p++){for(p>=s&&(w=i,S=n*w),d=0,b=S;b--;)f[d++]=A[h++],f[d++]=A[h++],f[d++]=A[h++],f[d++]=255;a.putImageData(c,0,p*_a)}else throw new Error(`bad image kind: ${e.kind}`)}function xb(a,e){if(e.bitmap){a.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,i=t%_a,s=(t-i)/_a,l=i===0?s:s+1,c=a.createImageData(n,_a);let h=0;const d=e.data,A=c.data;for(let f=0;f<l;f++){const p=f<s?_a:i;({srcPos:h}=fP({src:d,srcPos:h,dest:A,width:n,height:p,nonBlackColor:0})),a.putImageData(c,0,f*_a)}}function xl(a,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)a[n]!==void 0&&(e[n]=a[n]);a.setLineDash!==void 0&&(e.setLineDash(a.getLineDash()),e.lineDashOffset=a.lineDashOffset)}function Su(a){a.strokeStyle=a.fillStyle="#000000",a.fillRule="nonzero",a.globalAlpha=1,a.lineWidth=1,a.lineCap="butt",a.lineJoin="miter",a.miterLimit=10,a.globalCompositeOperation="source-over",a.font="10px sans-serif",a.setLineDash!==void 0&&(a.setLineDash([]),a.lineDashOffset=0);const{filter:e}=a;e!=="none"&&e!==""&&(a.filter="none")}function Pb(a,e){if(e)return!0;Ze.singularValueDecompose2dScale(a,Oa);const t=Math.fround(Di.pixelRatio*Eo.PDF_TO_CSS_UNITS);return Oa[0]<=t&&Oa[1]<=t}const yP=["butt","round","square"],bP=["miter","round","bevel"],CP={},Mb={};class Co{constructor(e,t,n,i,s,{optionalContentConfig:l,markedContentStack:c=null},h,d,A){this.ctx=e,this.current=new kb(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.filterFactory=s,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new vP(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=A??null}getObject(e,t,n=null){return typeof t=="string"?(this.dependencyTracker?.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:i=null}){const s=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,s,l),this.ctx.fillStyle=c,n){const h=this.cachedCanvases.getCanvas("transparent",s,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Dn(this.compositeCtx))}this.ctx.save(),Su(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Dn(this.ctx)}executeOperatorList(e,t,n,i,s){const l=e.argsArray,c=e.fnArray;let h=t||0;const d=l.length;if(d===h)return h;const A=d-h>Tb&&typeof n=="function",f=A?Date.now()+pP:0;let p=0;const b=this.commonObjs,w=this.objs;let S,k;for(;;){if(i!==void 0&&h===i.nextBreakPoint)return i.breakIt(h,n),h;if(!s||s(h))if(S=c[h],k=l[h]??null,S!==Hl.dependency)k===null?this[S](h):this[S](h,...k);else for(const E of k){this.dependencyTracker?.recordNamedData(E,h);const I=E.startsWith("g_")?b:w;if(!I.has(E))return I.get(E,n),h}if(h++,h===d)return h;if(A&&++p>Tb){if(Date.now()>f)return n(),h;p=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const n=e.width??e.displayWidth,i=e.height??e.displayHeight;let s=Math.max(Math.hypot(t[0],t[1]),1),l=Math.max(Math.hypot(t[2],t[3]),1),c=n,h=i,d="prescale1",A,f;for(;s>2&&c>1||l>2&&h>1;){let p=c,b=h;s>2&&c>1&&(p=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),s/=c/p),l>2&&h>1&&(b=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/b),A=this.cachedCanvases.getCanvas(d,p,b),f=A.context,f.clearRect(0,0,p,b),f.drawImage(e,0,0,c,h,0,0,p,b),e=A.canvas,c=p,h=b,d=d==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:h}}_createMaskCanvas(e,t){const n=this.ctx,{width:i,height:s}=t,l=this.current.fillColor,c=this.current.patternFill,h=Dn(n);let d,A,f,p;if((t.bitmap||t.data)&&t.count>1){const L=t.bitmap||t.data.buffer;A=JSON.stringify(c?h:[h.slice(0,4),l]),d=this._cachedBitmapsMap.get(L),d||(d=new Map,this._cachedBitmapsMap.set(L,d));const O=d.get(A);if(O&&!c){const q=Math.round(Math.min(h[0],h[2])+h[4]),$=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(e,Za.transformAndFill),{canvas:O,offsetX:q,offsetY:$}}f=O}f||(p=this.cachedCanvases.getCanvas("maskCanvas",i,s),xb(p.context,t));let b=Ze.transform(h,[1/i,0,0,-1/s,0,0]);b=Ze.transform(b,[1,0,0,1,0,-s]);const w=co.slice();Ze.axialAlignedBoundingBox([0,0,i,s],b,w);const[S,k,E,I]=w,P=Math.round(E-S)||1,R=Math.round(I-k)||1,D=this.cachedCanvases.getCanvas("fillCanvas",P,R),N=D.context,_=S,K=k;N.translate(-_,-K),N.transform(...b),f||(f=this._scaleImage(p.canvas,wi(N)),f=f.img,d&&c&&d.set(A,f)),N.imageSmoothingEnabled=Pb(Dn(N),t.interpolate),Cu(N,f,0,0,f.width,f.height,0,0,i,s),N.globalCompositeOperation="source-in";const G=Ze.transform(wi(N),[1,0,0,1,-_,-K]);return N.fillStyle=c?l.getPattern(n,this,G,da.FILL,e):l,N.fillRect(0,0,i,s),d&&!c&&(this.cachedCanvases.delete("fillCanvas"),d.set(A,D.canvas)),this.dependencyTracker?.recordDependencies(e,Za.transformAndFill),{canvas:D.canvas,offsetX:Math.round(_),offsetY:Math.round(K)}}setLineWidth(e,t){this.dependencyTracker?.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){this.dependencyTracker?.recordSimpleData("lineCap",e),this.ctx.lineCap=yP[t]}setLineJoin(e,t){this.dependencyTracker?.recordSimpleData("lineJoin",e),this.ctx.lineJoin=bP[t]}setMiterLimit(e,t){this.dependencyTracker?.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){this.dependencyTracker?.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){for(const[n,i]of t)switch(n){case"LW":this.setLineWidth(e,i);break;case"LC":this.setLineCap(e,i);break;case"LJ":this.setLineJoin(e,i);break;case"ML":this.setMiterLimit(e,i);break;case"D":this.setDash(e,i[0],i[1]);break;case"RI":this.setRenderingIntent(e,i);break;case"FL":this.setFlatness(e,i);break;case"Font":this.setFont(e,i[0],i[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=i;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=i;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=i;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",e),this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,t,n);this.suspendedCtx=this.ctx;const l=this.ctx=s.context;l.setTransform(this.suspendedCtx.getTransform()),xl(this.suspendedCtx,l),mP(l,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),xl(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,i){const s=i[0],l=i[1],c=i[2]-s,h=i[3]-l;c===0||h===0||(this.genericComposeSMask(t.context,n,c,h,t.subtype,t.backdrop,t.transferMap,s,l,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,i,s,l,c,h,d,A,f){let p=e.canvas,b=h-A,w=d-f;if(l)if(b<0||w<0||b+n>p.width||w+i>p.height){const k=this.cachedCanvases.getCanvas("maskExtension",n,i),E=k.context;E.drawImage(p,-b,-w),E.globalCompositeOperation="destination-atop",E.fillStyle=l,E.fillRect(0,0,n,i),E.globalCompositeOperation="source-over",p=k.canvas,b=w=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const k=new Path2D;k.rect(b,w,n,i),e.clip(k),e.globalCompositeOperation="destination-atop",e.fillStyle=l,e.fillRect(b,w,n,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),s==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):s==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const S=new Path2D;S.rect(h,d,n,i),t.clip(S),t.globalCompositeOperation="destination-in",t.drawImage(p,b,w,n,i,h,d,n,i),t.restore()}save(e){this.inSMaskMode&&xl(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),this.dependencyTracker?.save(e)}restore(e){if(this.dependencyTracker?.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&xl(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,i,s,l,c){this.dependencyTracker?.recordIncrementalData("transform",e),this.ctx.transform(t,n,i,s,l,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,i){let[s]=n;if(!i){s||=n[0]=new Path2D,this[t](e,s);return}if(this.dependencyTracker!==null){const l=t===Hl.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-l,i[2]+l,i[1]-l,i[3]+l).recordDependencies(e,["transform"])}s instanceof Path2D||(s=n[0]=LS(s)),Ze.axialAlignedBoundingBox(i,Dn(this.ctx),this.current.minMax),this[t](e,s),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){const i=this.ctx,s=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof s=="object"&&s?.getPattern){const l=s.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=s.getPattern(i,this,wi(i),da.STROKE,e),l){const c=new Path2D;c.addPath(t,i.getTransform().invertSelf().multiplySelf(l)),t=c}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);this.dependencyTracker?.recordDependencies(e,Za.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(da.STROKE,Dn(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){const i=this.ctx,s=this.current.fillColor,l=this.current.patternFill;let c=!1;if(l){const d=s.isModifyingCurrentTransform()?i.getTransform():null;if(this.dependencyTracker?.save(e),i.save(),i.fillStyle=s.getPattern(i,this,wi(i),da.FILL,e),d){const A=new Path2D;A.addPath(t,i.getTransform().invertSelf().multiplySelf(d)),t=A}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),this.dependencyTracker?.recordDependencies(e,Za.fill),c&&(i.restore(),this.dependencyTracker?.restore(e)),n&&this.consumePath(e,t,h)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){this.ctx.fill(t),this.dependencyTracker?.recordDependencies(e,Za.rawFillPath).recordOperation(e)}clip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=CP}eoClip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=Mb}beginText(e){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;t!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(t!==void 0){const i=new Path2D,s=n.getTransform().invertSelf();for(const{transform:l,x:c,y:h,fontSize:d,path:A}of t)A&&i.addPath(A,new DOMMatrix(l).preMultiplySelf(s).translate(c,h).scale(d,-d));n.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,t){this.dependencyTracker?.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){this.dependencyTracker?.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){this.dependencyTracker?.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){this.dependencyTracker?.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){this.dependencyTracker?.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const i=this.commonObjs.get(t),s=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(s.fontMatrix=i.fontMatrix||_g,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&kt("Invalid font matrix for font "+t),n<0?(n=-n,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=n,i.isType3Font)return;const l=i.loadedName||"sans-serif",c=i.systemFontInfo?.css||`"${l}", ${i.fallbackName}`;let h="normal";i.black?h="900":i.bold&&(h="bold");const d=i.italic?"italic":"normal";let A=n;n<Sb?A=Sb:n>wb&&(A=wb),this.current.fontSizeScale=n/A,this.ctx.font=`${d} ${h} ${A}px ${c}`}setTextRenderingMode(e,t){this.dependencyTracker?.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){this.dependencyTracker?.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",e);const{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){this.moveText(e,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}#a(e,t,n){const i=new Path2D;return i.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),i}paintChar(e,t,n,i,s,l){const c=this.ctx,h=this.current,d=h.font,A=h.textRenderingMode,f=h.fontSize/h.fontSizeScale,p=A&Xn.FILL_STROKE_MASK,b=!!(A&Xn.ADD_TO_PATH_FLAG),w=h.patternFill&&!d.missingFile,S=h.patternStroke&&!d.missingFile;let k;if((d.disableFontFace||b||w||S)&&!d.missingFile&&(k=d.getPathGenerator(this.commonObjs,t)),k&&(d.disableFontFace||w||S)){c.save(),c.translate(n,i),c.scale(f,-f),this.dependencyTracker?.recordCharacterBBox(e,c,d);let E;if(p===Xn.FILL||p===Xn.FILL_STROKE)if(s){E=c.getTransform(),c.setTransform(...s);const I=this.#a(k,E,s);c.fill(I)}else c.fill(k);if(p===Xn.STROKE||p===Xn.FILL_STROKE)if(l){E||=c.getTransform(),c.setTransform(...l);const{a:I,b:P,c:R,d:D}=E,N=Ze.inverseTransform(l),_=Ze.transform([I,P,R,D,0,0],N);Ze.singularValueDecompose2dScale(_,Oa),c.lineWidth*=Math.max(Oa[0],Oa[1])/f,c.stroke(this.#a(k,E,l))}else c.lineWidth/=f,c.stroke(k);c.restore()}else(p===Xn.FILL||p===Xn.FILL_STROKE)&&(c.fillText(t,n,i),this.dependencyTracker?.recordCharacterBBox(e,c,d,f,n,i,()=>c.measureText(t))),(p===Xn.STROKE||p===Xn.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(e,c,d,f,n,i,()=>c.measureText(t)).recordDependencies(e,Za.stroke),c.strokeText(t,n,i));b&&((this.pendingTextPaths||=[]).push({transform:Dn(c),x:n,y:i,fontSize:f,path:k}),this.dependencyTracker?.recordCharacterBBox(e,c,d,f,n,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return Et(this,"isFontSubpixelAAEnabled",n)}showText(e,t){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Za.showText).resetBBox(e),this.current.textRenderingMode&Xn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,i=n.font;if(i.isType3Font){this.showType3Text(e,t),this.dependencyTracker?.recordShowTextOperation(e);return}const s=n.fontSize;if(s===0){this.dependencyTracker?.recordOperation(e);return}const l=this.ctx,c=n.fontSizeScale,h=n.charSpacing,d=n.wordSpacing,A=n.fontDirection,f=n.textHScale*A,p=t.length,b=i.vertical,w=b?1:-1,S=i.defaultVMetrics,k=s*n.fontMatrix[0],E=n.textRenderingMode===Xn.FILL&&!i.disableFontFace&&!n.patternFill;l.save(),n.textMatrix&&l.transform(...n.textMatrix),l.translate(n.x,n.y+n.textRise),A>0?l.scale(f,-1):l.scale(f,1);let I,P;const R=n.textRenderingMode&Xn.FILL_STROKE_MASK,D=R===Xn.FILL||R===Xn.FILL_STROKE,N=R===Xn.STROKE||R===Xn.FILL_STROKE;if(D&&n.patternFill){l.save();const O=n.fillColor.getPattern(l,this,wi(l),da.FILL,e);I=Dn(l),l.restore(),l.fillStyle=O}if(N&&n.patternStroke){l.save();const O=n.strokeColor.getPattern(l,this,wi(l),da.STROKE,e);P=Dn(l),l.restore(),l.strokeStyle=O}let _=n.lineWidth;const K=n.textMatrixScale;if(K===0||_===0?N&&(_=this.getSinglePixelWidth()):_/=K,c!==1&&(l.scale(c,c),_/=c),l.lineWidth=_,i.isInvalidPDFjsFont){const O=[];let q=0;for(const Q of t)O.push(Q.unicode),q+=Q.width;const $=O.join("");if(l.fillText($,0,0),this.dependencyTracker!==null){const Q=l.measureText($);this.dependencyTracker.recordBBox(e,this.ctx,-Q.actualBoundingBoxLeft,Q.actualBoundingBoxRight,-Q.actualBoundingBoxAscent,Q.actualBoundingBoxDescent).recordShowTextOperation(e)}n.x+=q*k*f,l.restore(),this.compose();return}let G=0,L;for(L=0;L<p;++L){const O=t[L];if(typeof O=="number"){G+=w*O*s/1e3;continue}let q=!1;const $=(O.isSpace?d:0)+h,Q=O.fontChar,Z=O.accent;let F,U,Y=O.width;if(b){const z=O.vmetric||S,H=-(O.vmetric?z[1]:Y*.5)*k,j=z[2]*k;Y=z?-z[0]:Y,F=H/c,U=(G+j)/c}else F=G/c,U=0;let ge;if(i.remeasure&&Y>0){ge=l.measureText(Q);const z=ge.width*1e3/s*c;if(Y<z&&this.isFontSubpixelAAEnabled){const H=Y/z;q=!0,l.save(),l.scale(H,1),F/=H}else Y!==z&&(F+=(Y-z)/2e3*s/c)}if(this.contentVisible&&(O.isInFont||i.missingFile)){if(E&&!Z)l.fillText(Q,F,U),this.dependencyTracker?.recordCharacterBBox(e,l,ge?{bbox:null}:i,s/c,F,U,()=>ge??l.measureText(Q));else if(this.paintChar(e,Q,F,U,I,P),Z){const z=F+s*Z.offset.x/c,H=U-s*Z.offset.y/c;this.paintChar(e,Z.fontChar,z,H,I,P)}}const me=b?Y*k-$*A:Y*k+$*A;G+=me,q&&l.restore()}b?n.y-=G:n.x+=G*f,l.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,i=this.current,s=i.font,l=i.fontSize,c=i.fontDirection,h=s.vertical?1:-1,d=i.charSpacing,A=i.wordSpacing,f=i.textHScale*c,p=i.fontMatrix||_g,b=t.length,w=i.textRenderingMode===Xn.INVISIBLE;let S,k,E,I;if(w||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),i.textMatrix&&n.transform(...i.textMatrix),n.translate(i.x,i.y+i.textRise),n.scale(f,c);const P=this.dependencyTracker;for(this.dependencyTracker=P?new $u(P,e):null,S=0;S<b;++S){if(k=t[S],typeof k=="number"){I=h*k*l/1e3,this.ctx.translate(I,0),i.x+=I*f;continue}const R=(k.isSpace?A:0)+d,D=s.charProcOperatorList[k.operatorListId];D?this.contentVisible&&(this.save(),n.scale(l,l),n.transform(...p),this.executeOperatorList(D),this.restore()):kt(`Type3 character "${k.operatorListId}" is not available.`);const N=[k.width,0];Ze.applyTransform(N,p),E=N[0]*l+R,n.translate(E,0),i.x+=E*f}n.restore(),P&&(this.dependencyTracker=P)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,i,s,l,c){const h=new Path2D;h.rect(i,s,l-i,c-s),this.ctx.clip(h),this.dependencyTracker?.recordBBox(e,this.ctx,i,l,s,c).recordClipBox(e,this.ctx,i,l,s,c),this.endPath(e)}getColorN_Pattern(e,t){let n;if(t[0]==="TilingPattern"){const i=this.baseTransform||Dn(this.ctx),s={createCanvasGraphics:(l,c)=>new Co(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new $u(this.dependencyTracker,c,!0):null)};n=new Df(t,this.ctx,s,i)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e,...t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,n=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=gP(this.getObject(e,t)),this.cachedPatterns.set(t,i)),n&&(i.matrix=n),i}shadingFill(e,t){if(!this.contentVisible)return;const n=this.ctx;this.save(e);const i=this._getPattern(e,t);n.fillStyle=i.getPattern(n,this,wi(n),da.SHADING,e);const s=wi(n);if(s){const{width:l,height:c}=n.canvas,h=co.slice();Ze.axialAlignedBoundingBox([0,0,l,c],s,h);const[d,A,f,p]=h;this.ctx.fillRect(d,A,f-d,p-A)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Za.transform).recordDependencies(e,Za.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){ln("Should not call beginInlineImage")}beginImageData(){ln("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Dn(this.ctx),n)){Ze.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[i,s,l,c]=n,h=new Path2D;h.rect(i,s,l-i,c-s),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(e,this.ctx,i,l,s,c),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;t.isolated||Sd("TODO: Support non-isolated groups."),t.knockout&&kt("Knockout groups not supported.");const i=Dn(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let s=co.slice();Ze.axialAlignedBoundingBox(t.bbox,Dn(n),s);const l=[0,0,n.canvas.width,n.canvas.height];s=Ze.intersect(s,l)||[0,0,0,0];const c=Math.floor(s[0]),h=Math.floor(s[1]),d=Math.max(Math.ceil(s[2])-c,1),A=Math.max(Math.ceil(s[3])-h,1);this.current.startNewPathAndClipBox([0,0,d,A]);let f="groupAt"+this.groupLevel;t.smask&&(f+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(f,d,A),b=p.context;b.translate(-c,-h),b.transform(...i);let w=new Path2D;const[S,k,E,I]=t.bbox;if(w.rect(S,k,E-S,I-k),t.matrix){const P=new Path2D;P.addPath(w,new DOMMatrix(t.matrix)),w=P}b.clip(w),t.smask&&this.smaskStack.push({canvas:p.canvas,context:b,offsetX:c,offsetY:h,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(c,h),n.save()),xl(n,b),this.ctx=b,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const s=Dn(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...s);const l=co.slice();Ze.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],s,l),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(e,t,n,i,s,l){if(this.#e(),Su(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const c=n[2]-n[0],h=n[3]-n[1];if(l&&this.annotationCanvasMap){i=i.slice(),i[4]-=n[0],i[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=c,n[3]=h,Ze.singularValueDecompose2dScale(Dn(this.ctx),Oa);const{viewportScale:d}=this,A=Math.ceil(c*this.outputScaleX*d),f=Math.ceil(h*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(A,f);const{canvas:p,context:b}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=b,this.ctx.save(),this.ctx.setTransform(Oa[0],0,0,-Oa[1],0,h*Oa[1]),Su(this.ctx)}else{Su(this.ctx),this.endPath(e);const d=new Path2D;d.rect(n[0],n[1],c,h),this.ctx.clip(d)}}this.current=new kb(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...s)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){if(!this.contentVisible)return;const n=t.count;t=this.getObject(e,t.data,t),t.count=n;const i=this.ctx,s=this._createMaskCanvas(e,t),l=s.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(l,s.offsetX,s.offsetY),this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,s.offsetX,s.offsetX+l.width,s.offsetY,s.offsetY+l.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,i=0,s=0,l,c){if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const h=this.ctx;h.save();const d=Dn(h);h.transform(n,i,s,l,0,0);const A=this._createMaskCanvas(e,t);h.setTransform(1,0,0,1,A.offsetX-d[4],A.offsetY-d[5]),this.dependencyTracker?.resetBBox(e);for(let f=0,p=c.length;f<p;f+=2){const b=Ze.transform(d,[n,i,s,l,c[f],c[f+1]]);h.drawImage(A.canvas,b[4],b[5]),this.dependencyTracker?.recordBBox(e,this.ctx,b[4],b[4]+A.canvas.width,b[5],b[5]+A.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageMaskXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx,i=this.current.fillColor,s=this.current.patternFill;this.dependencyTracker?.resetBBox(e).recordDependencies(e,Za.transformAndFill);for(const l of t){const{data:c,width:h,height:d,transform:A}=l,f=this.cachedCanvases.getCanvas("maskCanvas",h,d),p=f.context;p.save();const b=this.getObject(e,c,l);xb(p,b),p.globalCompositeOperation="source-in",p.fillStyle=s?i.getPattern(p,this,wi(n),da.FILL,e):i,p.fillRect(0,0,h,d),p.restore(),n.save(),n.transform(...A),n.scale(1,-1),Cu(n,f.canvas,0,0,h,d,0,-1,1,1),this.dependencyTracker?.recordBBox(e,n,0,h,0,d),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);if(!n){kt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,i,s){if(!this.contentVisible)return;const l=this.getObject(e,t);if(!l){kt("Dependent image isn't ready yet");return}const c=l.width,h=l.height,d=[];for(let A=0,f=s.length;A<f;A+=2)d.push({transform:[n,0,0,i,s[A],s[A+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(e,l,d)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:i}=e,s=this.cachedCanvases.getCanvas("inlineImage",n,i),l=s.context;return l.filter=this.current.transferMaps,l.drawImage(t,0,0),l.filter="none",s.canvas}paintInlineImageXObject(e,t){if(!this.contentVisible)return;const n=t.width,i=t.height,s=this.ctx;this.save(e);const{filter:l}=s;l!=="none"&&l!==""&&(s.filter="none"),s.scale(1/n,-1/i);let c;if(t.bitmap)c=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)c=t;else{const A=this.cachedCanvases.getCanvas("inlineImage",n,i).context;Eb(A,t),c=this.applyTransferMapsToCanvas(A)}const h=this._scaleImage(c,wi(s));s.imageSmoothingEnabled=Pb(Dn(s),t.interpolate),this.dependencyTracker?.resetBBox(e).recordBBox(e,s,0,n,-i,0).recordDependencies(e,Za.imageXObject).recordOperation(e),Cu(s,h.img,0,0,h.paintWidth,h.paintHeight,0,-i,n,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){if(!this.contentVisible)return;const i=this.ctx;let s;if(t.bitmap)s=t.bitmap;else{const l=t.width,c=t.height,d=this.cachedCanvases.getCanvas("inlineImage",l,c).context;Eb(d,t),s=this.applyTransferMapsToCanvas(d)}this.dependencyTracker?.resetBBox(e);for(const l of n)i.save(),i.transform(...l.transform),i.scale(1,-1),Cu(i,s,l.x,l.y,l.w,l.h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,i,0,1,-1,0),i.restore();this.dependencyTracker?.recordOperation(e),this.compose()}paintSolidColorImageMask(e){this.contentVisible&&(this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Za.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){this.dependencyTracker?.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){this.dependencyTracker?.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){this.dependencyTracker?.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const s=this.ctx;this.pendingClip?(i||(this.pendingClip===Mb?s.clip(t,"evenodd"):s.clip(t)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):this.dependencyTracker?.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Dn(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:i,d:s}=this.ctx.getTransform();let l,c;if(n===0&&i===0){const h=Math.abs(t),d=Math.abs(s);if(h===d)if(e===0)l=c=1/h;else{const A=h*e;l=c=A<1?1/A:1}else if(e===0)l=1/h,c=1/d;else{const A=h*e,f=d*e;l=A<1?1/A:1,c=f<1?1/f:1}}else{const h=Math.abs(t*s-n*i),d=Math.hypot(t,n),A=Math.hypot(i,s);if(e===0)l=A/h,c=d/h;else{const f=e*h;l=A>f?A/f:1,c=d>f?d/f:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:i}}=this,[s,l]=this.getScaleForStroking();if(s===l){n.lineWidth=(i||1)*s,n.stroke(e);return}const c=n.getLineDash();t&&n.save(),n.scale(s,l),cg.a=1/s,cg.d=1/l;const h=new Path2D;if(h.addPath(e,cg),c.length>0){const d=Math.max(s,l);n.setLineDash(c.map(A=>A/d)),n.lineDashOffset/=d}n.lineWidth=i||1,n.stroke(h),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const a in Hl)Co.prototype[a]!==void 0&&(Co.prototype[Hl[a]]=Co.prototype[a]);class So{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class SP{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const ao=Symbol("INTERNAL");class wP{#e=!1;#t=!1;#a=!1;#n=!0;constructor(e,{name:t,intent:n,usage:i,rbGroups:s}){this.#e=!!(e&Ka.DISPLAY),this.#t=!!(e&Ka.PRINT),this.name=t,this.intent=n,this.usage=i,this.rbGroups=s}get visible(){if(this.#a)return this.#n;if(!this.#n)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==ao&&ln("Internal method `_setVisible` called."),this.#a=n,this.#n=t}}class TP{#e=null;#t=new Map;#a=null;#n=null;constructor(e,t=Ka.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#n=e.order;for(const n of e.groups)this.#t.set(n.id,new wP(t,n));if(e.baseState==="OFF")for(const n of this.#t.values())n._setVisible(ao,!1);for(const n of e.on)this.#t.get(n)._setVisible(ao,!0);for(const n of e.off)this.#t.get(n)._setVisible(ao,!1);this.#a=this.getHash()}}#r(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let i=1;i<t;i++){const s=e[i];let l;if(Array.isArray(s))l=this.#r(s);else if(this.#t.has(s))l=this.#t.get(s).visible;else return kt(`Optional content group not found: ${s}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Sd("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(kt(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#r(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return kt(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return kt(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return kt(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return kt(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return kt(`Unknown optional content policy ${e.policy}.`),!0}return kt(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){const i=this.#t.get(e);if(!i){kt(`Optional content group not found: ${e}`);return}if(n&&t&&i.rbGroups.length)for(const s of i.rbGroups)for(const l of s)l!==e&&this.#t.get(l)?._setVisible(ao,!1,!0);i._setVisible(ao,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const s=this.#t.get(i);if(s)switch(n){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!s.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#a===null||this.getHash()===this.#a}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new FS;for(const[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class Ed{#e=null;#t=null;_fullReader=null;_rangeReaders=new Set;_source=null;constructor(e,t,n){this._source=e,this.#e=t,this.#t=n}get _progressiveDataLength(){return this._fullReader?._loaded??0}getFullReader(){return on(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new this.#e(this)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new this.#t(this,e,t);return this._rangeReaders.add(n),n}cancelAllRequests(e){this._fullReader?.cancel(e);for(const t of new Set(this._rangeReaders))t.cancel(e)}}class xd{onProgress=null;_contentLength=0;_filename=null;_headersCapability=Promise.withResolvers();_isRangeSupported=!1;_isStreamingSupported=!1;_loaded=0;_stream=null;constructor(e){this._stream=e}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){ln("Abstract method `read` called")}cancel(e){ln("Abstract method `cancel` called")}}class Pd{_stream=null;constructor(e,t,n){this._stream=e}async read(){ln("Abstract method `read` called")}cancel(e){ln("Abstract method `cancel` called")}}function Ib(a){return a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer}class kP extends Ed{_progressiveDone=!1;_queuedChunks=[];constructor(e){super(e,EP,xP);const{pdfDataRangeTransport:t}=e,{initialData:n,progressiveDone:i}=t;if(n?.length>0){const s=Ib(n);this._queuedChunks.push(s)}this._progressiveDone=i,t.addRangeListener((s,l)=>{this.#e(s,l)}),t.addProgressListener((s,l)=>{l!==void 0&&this._fullReader?.onProgress?.({loaded:s,total:l})}),t.addProgressiveReadListener(s=>{this.#e(void 0,s)}),t.addProgressiveDoneListener(()=>{this._fullReader?.progressiveDone(),this._progressiveDone=!0}),t.transportReady()}#e(e,t){const n=Ib(t);if(e===void 0)this._fullReader?this._fullReader._enqueue(n):this._queuedChunks.push(n);else{const i=this._rangeReaders.keys().find(s=>s._begin===e);on(i,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),i._enqueue(n)}}getFullReader(){const e=super.getFullReader();return this._queuedChunks=null,e}getRangeReader(e,t){const n=super.getRangeReader(e,t);return n&&(n.onDone=()=>this._rangeReaders.delete(n),this._source.pdfDataRangeTransport.requestDataRange(e,t)),n}cancelAllRequests(e){super.cancelAllRequests(e),this._source.pdfDataRangeTransport.abort()}}class EP extends xd{_done=!1;_queuedChunks=null;_requests=[];constructor(e){super(e);const{pdfDataRangeTransport:t,disableRange:n,disableStream:i}=e._source,{length:s,contentDispositionFilename:l}=t;this._queuedChunks=e._queuedChunks||[];for(const c of this._queuedChunks)this._loaded+=c.byteLength;this._done=e._progressiveDone,this._contentLength=s,this._isStreamingSupported=!i,this._isRangeSupported=!n,kf(l)&&(this._filename=l),this._headersCapability.resolve()}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||=!0}}class xP extends Pd{onDone=null;_begin=-1;_done=!1;_queuedChunk=null;_requests=[];constructor(e,t,n){super(e,t,n),this._begin=t}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this.onDone?.()}}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this.onDone?.()}}function PP(a){let e=!0,t=n("filename\\*","i").exec(a);if(t){t=t[1];let A=c(t);return A=unescape(A),A=h(A),A=d(A),s(A)}if(t=l(a),t){const A=d(t);return s(A)}if(t=n("filename","i").exec(a),t){t=t[1];let A=c(t);return A=d(A),s(A)}function n(A,f){return new RegExp("(?:^|;)\\s*"+A+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function i(A,f){if(A){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(A,{fatal:!0}),b=wd(f);f=p.decode(b),e=!1}catch{}}return f}function s(A){return e&&/[\x80-\xff]/.test(A)&&(A=i("utf-8",A),e&&(A=i("iso-8859-1",A))),A}function l(A){const f=[];let p;const b=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=b.exec(A))!==null;){let[,S,k,E]=p;if(S=parseInt(S,10),S in f){if(S===0)break;continue}f[S]=[k,E]}const w=[];for(let S=0;S<f.length&&S in f;++S){let[k,E]=f[S];E=c(E),k&&(E=unescape(E),S===0&&(E=h(E))),w.push(E)}return w.join("")}function c(A){if(A.startsWith('"')){const f=A.slice(1).split('\\"');for(let p=0;p<f.length;++p){const b=f[p].indexOf('"');b!==-1&&(f[p]=f[p].slice(0,b),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}A=f.join('"')}return A}function h(A){const f=A.indexOf("'");if(f===-1)return A;const p=A.slice(0,f),w=A.slice(f+1).replace(/^[^']*'/,"");return i(p,w)}function d(A){return!A.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(A)?A:A.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,b,w){if(b==="q"||b==="Q")return w=w.replaceAll("_"," "),w=w.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,k){return String.fromCharCode(parseInt(k,16))}),i(p,w);try{w=atob(w)}catch{}return i(p,w)})}return""}function jS(a,e){const t=new Headers;if(!a||!e||typeof e!="object")return t;for(const n in e){const i=e[n];i!==void 0&&t.append(n,i)}return t}function Md(a){return URL.parse(a)?.origin??null}function QS({responseHeaders:a,isHttp:e,rangeChunkSize:t,disableRange:n}){const i={allowRangeRequests:!1,suggestedLength:void 0},s=parseInt(a.get("Content-Length"),10);return!Number.isInteger(s)||(i.suggestedLength=s,s<=2*t)||n||!e||a.get("Accept-Ranges")!=="bytes"||(a.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function qS(a){const e=a.get("Content-Disposition");if(e){let t=PP(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(kf(t))return t}return null}function Id(a,e){return new Wu(`Unexpected server response (${a}) while retrieving PDF "${e}".`,a,a===404||a===0&&e.startsWith("file:"))}function YS(a,e){if(a!==e)throw new Error(`Expected range response-origin "${a}" to match "${e}".`)}function XS(a,e,t,n){return fetch(a,{method:"GET",headers:e,signal:n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"})}function WS(a,e){if(a!==200&&a!==206)throw Id(a,e)}function $S(a){return a instanceof Uint8Array?a.buffer:a instanceof ArrayBuffer?a:(kt(`getArrayBuffer - unexpected data format: ${a}`),new Uint8Array(a).buffer)}class MP extends Ed{_responseOrigin=null;constructor(e){super(e,IP,DP),this.isHttp=/^https?:/i.test(e.url),this.headers=jS(this.isHttp,e.httpHeaders)}}class IP extends xd{_abortController=new AbortController;_reader=null;constructor(e){super(e);const{disableRange:t,disableStream:n,length:i,rangeChunkSize:s,url:l,withCredentials:c}=e._source;this._contentLength=i,this._isStreamingSupported=!n,this._isRangeSupported=!t;const h=new Headers(e.headers);XS(l,h,c,this._abortController).then(d=>{e._responseOrigin=Md(d.url),WS(d.status,l),this._reader=d.body.getReader();const A=d.headers,{allowRangeRequests:f,suggestedLength:p}=QS({responseHeaders:A,isHttp:e.isHttp,rangeChunkSize:s,disableRange:t});this._isRangeSupported=f,this._contentLength=p||this._contentLength,this._filename=qS(A),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Br("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:$S(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class DP extends Pd{_abortController=new AbortController;_readCapability=Promise.withResolvers();_reader=null;constructor(e,t,n){super(e,t,n);const{url:i,withCredentials:s}=e._source,l=new Headers(e.headers);l.append("Range",`bytes=${t}-${n-1}`),XS(i,l,s,this._abortController).then(c=>{const h=Md(c.url);YS(h,e._responseOrigin),WS(c.status,i),this._reader=c.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:{value:$S(e),done:!1}}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const ug=200,Db=206;function _P(a){return typeof a!="string"?a:wd(a).buffer}class RP extends Ed{#e=new WeakMap;_responseOrigin=null;constructor(e){super(e,NP,GP),this.url=e.url,this.isHttp=/^https?:/i.test(this.url),this.headers=jS(this.isHttp,e.httpHeaders)}_request(e){const t=new XMLHttpRequest,n={validateStatus:null,onHeadersReceived:e.onHeadersReceived,onDone:e.onDone,onError:e.onError,onProgress:e.onProgress};this.#e.set(t,n),t.open("GET",this.url),t.withCredentials=this._source.withCredentials;for(const[i,s]of this.headers)t.setRequestHeader(i,s);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),n.validateStatus=i=>i===Db||i===ug):n.validateStatus=i=>i===ug,t.responseType="arraybuffer",on(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>e.onError(t.status),t.onreadystatechange=this.#a.bind(this,t),t.onprogress=this.#t.bind(this,t),t.send(null),t}#t(e,t){this.#e.get(e)?.onProgress?.(t)}#a(e,t){const n=this.#e.get(e);if(!n||(e.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),e.readyState!==4)||!this.#e.has(e))return;if(this.#e.delete(e),e.status===0&&this.isHttp){n.onError(e.status);return}const i=e.status||ug;if(!n.validateStatus(i)){n.onError(e.status);return}const s=_P(e.response);if(i===Db){const l=e.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(l)?n.onDone(s):(kt('Missing or invalid "Content-Range" header.'),n.onError(0))}else s?n.onDone(s):n.onError(e.status)}_abortRequest(e){this.#e.has(e)&&(this.#e.delete(e),e.abort())}getRangeReader(e,t){const n=super.getRangeReader(e,t);return n&&(n.onClosed=()=>this._rangeReaders.delete(n)),n}}class NP extends xd{_cachedChunks=[];_done=!1;_requests=[];_storedError=null;constructor(e){super(e);const{length:t}=e._source;this._contentLength=t,this._fullRequestXhr=e._request({onHeadersReceived:this.#e.bind(this),onDone:this.#t.bind(this),onError:this.#a.bind(this),onProgress:this.#n.bind(this)})}#e(){const e=this._stream,{disableRange:t,rangeChunkSize:n}=e._source,i=this._fullRequestXhr;e._responseOrigin=Md(i.responseURL);const s=i.getAllResponseHeaders(),l=new Headers(s?s.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(d=>{const[A,...f]=d.split(": ");return[A,f.join(": ")]}):[]),{allowRangeRequests:c,suggestedLength:h}=QS({responseHeaders:l,isHttp:e.isHttp,rangeChunkSize:n,disableRange:t});c&&(this._isRangeSupported=!0),this._contentLength=h||this._contentLength,this._filename=qS(l),this._isRangeSupported&&e._abortRequest(i),this._headersCapability.resolve()}#t(e){if(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._cachedChunks.push(e),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}#a(e){this._storedError=Id(e,this._stream.url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}#n(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}class GP extends Pd{onClosed=null;_done=!1;_queuedChunk=null;_requests=[];_storedError=null;constructor(e,t,n){super(e,t,n),this._requestXhr=e._request({begin:t,end:n,onHeadersReceived:this.#e.bind(this),onDone:this.#t.bind(this),onError:this.#a.bind(this),onProgress:null})}#e(){const e=Md(this._requestXhr?.responseURL);try{YS(e,this._stream._responseOrigin)}catch(t){this._storedError=t,this.#a(0)}}#t(e){this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this.onClosed?.()}#a(e){this._storedError??=Id(e,this._stream.url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),this.onClosed?.()}}const LP=/^[a-z][a-z0-9\-+.]+:/i;function BP(a){if(LP.test(a))return new URL(a);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(a))}function JS(a){const{Readable:e}=process.getBuiltinModule("stream");return typeof e.toWeb=="function"?e.toWeb(a):process.getBuiltinModule("module").createRequire(import.meta.url)("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(a)}function ZS(a){return a instanceof Uint8Array?a.buffer:a instanceof ArrayBuffer?a:(kt(`getArrayBuffer - unexpected data format: ${a}`),new Uint8Array(a).buffer)}class FP extends Ed{constructor(e){super(e,UP,KP),this.url=BP(e.url),on(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs.")}}class UP extends xd{_reader=null;constructor(e){super(e);const{disableRange:t,disableStream:n,length:i,rangeChunkSize:s}=e._source;this._contentLength=i,this._isStreamingSupported=!n,this._isRangeSupported=!t;const l=e.url,c=process.getBuiltinModule("fs");c.promises.lstat(l).then(h=>{const d=c.createReadStream(l),A=JS(d);this._reader=A.getReader();const{size:f}=h;f<=2*s&&(this._isRangeSupported=!1),this._contentLength=f,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Br("Streaming is disabled.")),this._headersCapability.resolve()}).catch(h=>{h.code==="ENOENT"&&(h=Id(0,l.href)),this._headersCapability.reject(h)})}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:ZS(e),done:!1})}cancel(e){this._reader?.cancel(e)}}class KP extends Pd{_readCapability=Promise.withResolvers();_reader=null;constructor(e,t,n){super(e,t,n);const i=e.url,s=process.getBuiltinModule("fs");try{const l=s.createReadStream(i,{start:t,end:n-1}),c=JS(l);this._reader=c.getReader(),this._readCapability.resolve()}catch(l){this._readCapability.reject(l)}}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:{value:ZS(e),done:!1}}cancel(e){this._reader?.cancel(e)}}const Pl=Symbol("INITIAL_DATA");class ew{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:Pl}}get(e,t=null){if(t){const i=this.#t(e);return i.promise.then(()=>t(i.data)),null}const n=this.#e[e];if(!n||n.data===Pl)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this.#e[e];return!!t&&t.data!==Pl}delete(e){const t=this.#e[e];return!t||t.data===Pl?!1:(delete this.#e[e],!0)}resolve(e,t=null){const n=this.#t(e);n.data=t,n.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==Pl&&(yield[e,t])}}}const zP=1e5,_b=30;class za{#e=Promise.withResolvers();#t=null;#a=!1;#n=!!globalThis.FontInspector?.enabled;#r=null;#s=null;#i=0;#o=0;#c=null;#l=null;#h=0;#d=0;#A=Object.create(null);#p=[];#f=null;#u=[];#g=new WeakMap;#m=null;static#y=new Map;static#v=new Map;static#k=new WeakMap;static#w=null;static#C=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#f=e;else if(typeof e=="object")this.#f=new ReadableStream({start(h){h.enqueue(e),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#d=n.scale*Di.pixelRatio,this.#h=n.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:s,pageX:l,pageY:c}=n.rawDims;this.#m=[1,0,0,-1,-l,c+s],this.#o=i,this.#i=s,za.#M(),t.style.setProperty("--min-font-size",za.#w),gs(t,n),this.#e.promise.finally(()=>{za.#C.delete(this),this.#s=null,this.#A=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Wn.platform;return Et(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#c.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#r??=t.lang,Object.assign(this.#A,t.styles),this.#x(t.items),e()},this.#e.reject)};return this.#c=this.#f.getReader(),za.#C.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const n=e.scale*Di.pixelRatio,i=e.rotation;if(i!==this.#h&&(t?.(),this.#h=i,gs(this.#l,{rotation:i})),n!==this.#d){t?.(),this.#d=n;const s={div:null,properties:null,ctx:za.#I(this.#r)};for(const l of this.#u)s.properties=this.#g.get(l),s.div=l,this.#T(s)}}cancel(){const e=new Br("TextLayer task cancelled.");this.#c?.cancel(e).catch(()=>{}),this.#c=null,this.#e.reject(e)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#p}#x(e){if(this.#a)return;this.#s.ctx??=za.#I(this.#r);const t=this.#u,n=this.#p;for(const i of e){if(t.length>zP){kt("Ignoring additional textDivs for performance reasons."),this.#a=!0;return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){const s=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),i.id&&this.#t.setAttribute("id",`${i.id}`),i.tag==="Artifact"&&(this.#t.ariaHidden=!0),s.append(this.#t)}else i.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(i.str),this.#b(i)}}#b(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#u.push(t);const i=Ze.transform(this.#m,e.transform);let s=Math.atan2(i[1],i[0]);const l=this.#A[e.fontName];l.vertical&&(s+=Math.PI/2);let c=this.#n&&l.fontSubstitution||l.fontFamily;c=za.fontFamilyMap.get(c)||c;const h=Math.hypot(i[2],i[3]),d=h*za.#B(c,l,this.#r);let A,f;s===0?(A=i[4],f=i[5]-d):(A=i[4]+d*Math.sin(s),f=i[5]-d*Math.cos(s));const p=t.style;p.left=`${(100*A/this.#o).toFixed(2)}%`,p.top=`${(100*f/this.#i).toFixed(2)}%`,p.setProperty("--font-height",`${h.toFixed(2)}px`),p.fontFamily=c,n.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#n&&(t.dataset.fontName=l.fontSubstitutionLoadedName||e.fontName),s!==0&&(n.angle=s*(180/Math.PI));let b=!1;if(e.str.length>1)b=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const w=Math.abs(e.transform[0]),S=Math.abs(e.transform[3]);w!==S&&Math.max(w,S)/Math.min(w,S)>1.5&&(b=!0)}if(b&&(n.canvasWidth=l.vertical?e.height:e.width),this.#g.set(t,n),this.#s.div=t,this.#s.properties=n,this.#T(this.#s),n.hasText&&this.#t.append(t),n.hasEOL){const w=document.createElement("br");w.setAttribute("role","presentation"),this.#t.append(w)}}#T(e){const{div:t,properties:n,ctx:i}=e,{style:s}=t;if(n.canvasWidth!==0&&n.hasText){const{fontFamily:l}=s,{canvasWidth:c,fontSize:h}=n;za.#P(i,h*this.#d,l);const{width:d}=i.measureText(t.textContent);d>0&&s.setProperty("--scale-x",c*this.#d/d)}n.angle!==0&&s.setProperty("--rotate",`${n.angle}deg`)}static cleanup(){if(!(this.#C.size>0)){this.#y.clear();for(const{canvas:e}of this.#v.values())e.remove();this.#v.clear()}}static#I(e=null){let t=this.#v.get(e||="");if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(e,t),this.#k.set(t,{size:0,family:""})}return t}static#P(e,t,n){const i=this.#k.get(e);t===i.size&&n===i.family||(e.font=`${t}px ${n}`,i.size=t,i.family=n)}static#M(){if(this.#w!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#w=e.getBoundingClientRect().height,e.remove()}static#B(e,t,n){const i=this.#y.get(e);if(i)return i;const s=this.#I(n);s.canvas.width=s.canvas.height=_b,this.#P(s,_b,e);const l=s.measureText(""),c=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);s.canvas.width=s.canvas.height=0;let d=.8;return c?d=c/(c+h):(Wn.platform.isFirefox&&kt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?d=t.ascent:t.descent&&(d=1+t.descent)),this.#y.set(e,d),d}}const OP=100;function tw(a={}){typeof a=="string"||a instanceof URL?a={url:a}:(a instanceof ArrayBuffer||ArrayBuffer.isView(a))&&(a={data:a});const e=new _f,{docId:t}=e,n=a.url?Wx(a.url):null,i=a.data?$x(a.data):null,s=a.httpHeaders||null,l=a.withCredentials===!0,c=a.password??null,h=a.range instanceof nw?a.range:null,d=Number.isInteger(a.rangeChunkSize)&&a.rangeChunkSize>0?a.rangeChunkSize:2**16;let A=a.worker instanceof jl?a.worker:null;const f=a.verbosity,p=typeof a.docBaseUrl=="string"&&!Td(a.docBaseUrl)?a.docBaseUrl:null,b=mu(a.cMapUrl),w=a.cMapPacked!==!1,S=a.CMapReaderFactory||(ba?rP:pb),k=mu(a.iccUrl),E=mu(a.standardFontDataUrl),I=a.StandardFontDataFactory||(ba?sP:mb),P=mu(a.wasmUrl),R=a.WasmFactory||(ba?oP:vb),D=a.stopAtErrors!==!0,N=Number.isInteger(a.maxImageSize)&&a.maxImageSize>-1?a.maxImageSize:-1,_=a.isEvalSupported!==!1,K=typeof a.isOffscreenCanvasSupported=="boolean"?a.isOffscreenCanvasSupported:!ba,G=typeof a.isImageDecoderSupported=="boolean"?a.isImageDecoderSupported:!ba&&(Wn.platform.isFirefox||!globalThis.chrome),L=Number.isInteger(a.canvasMaxAreaInBytes)?a.canvasMaxAreaInBytes:-1,O=typeof a.disableFontFace=="boolean"?a.disableFontFace:ba,q=a.fontExtraProperties===!0,$=a.enableXfa===!0,Q=a.ownerDocument||globalThis.document,Z=a.disableRange===!0,F=a.disableStream===!0,U=a.disableAutoFetch===!0,Y=a.pdfBug===!0,ge=a.CanvasFactory||(ba?iP:tP),me=a.FilterFactory||(ba?aP:nP),z=a.enableHWA===!0,H=a.useWasm!==!1,j=h?h.length:a.length??NaN,le=typeof a.useSystemFonts=="boolean"?a.useSystemFonts:!ba&&!O,te=typeof a.useWorkerFetch=="boolean"?a.useWorkerFetch:!!(S===pb&&I===mb&&R===vb&&b&&E&&P&&Nl(b,document.baseURI)&&Nl(E,document.baseURI)&&Nl(P,document.baseURI)),oe=null;wx(f);const ce={canvasFactory:new ge({ownerDocument:Q,enableHWA:z}),filterFactory:new me({docId:t,ownerDocument:Q}),cMapReaderFactory:te?null:new S({baseUrl:b,isCompressed:w}),standardFontDataFactory:te?null:new I({baseUrl:E}),wasmFactory:te?null:new R({baseUrl:P})};A||(A=jl.create({verbosity:f,port:So.workerPort}),e._worker=A);const Ge={docId:t,apiVersion:"5.4.624",data:i,password:c,disableAutoFetch:U,rangeChunkSize:d,length:j,docBaseUrl:p,enableXfa:$,evaluatorOptions:{maxImageSize:N,disableFontFace:O,ignoreErrors:D,isEvalSupported:_,isOffscreenCanvasSupported:K,isImageDecoderSupported:G,canvasMaxAreaInBytes:L,fontExtraProperties:q,useSystemFonts:le,useWasm:H,useWorkerFetch:te,cMapUrl:b,iccUrl:k,standardFontDataUrl:E,wasmUrl:P}},ae={ownerDocument:Q,pdfBug:Y,styleElement:oe,enableHWA:z,loadingParams:{disableAutoFetch:U,enableXfa:$}};return A.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(A.destroyed)throw new Error("Worker was destroyed");const Le=A.messageHandler.sendWithPromise("GetDocRequest",Ge,i?[i.buffer]:null);let De;if(h)De=new kP({pdfDataRangeTransport:h,disableRange:Z,disableStream:F});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");const ue=Nl(n)?MP:ba?FP:RP;De=new ue({url:n,length:j,httpHeaders:s,withCredentials:l,rangeChunkSize:d,disableRange:Z,disableStream:F})}return Le.then(ue=>{if(e.destroyed)throw new Error("Loading aborted");if(A.destroyed)throw new Error("Worker was destroyed");const ne=new Gl(t,ue,A.port),fe=new jP(ne,e,De,ae,ce);e._transport=fe,ne.send("Ready",null)})}).catch(e._capability.reject),e}class _f{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${_f.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class nw{#e=Promise.withResolvers();#t=[];#a=[];#n=[];#r=[];constructor(e,t,n=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=i}addRangeListener(e){this.#r.push(e)}addProgressListener(e){this.#n.push(e)}addProgressiveReadListener(e){this.#a.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const n of this.#r)n(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const n of this.#n)n(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#a)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){ln("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class HP{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Et(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(e){return this._transport.extractPages(e)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class VP{#e=!1;#t=rn.instance;constructor(e,t,n,i=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=i?new cb:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new ew,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(e){this._pageIndex=e-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:s=!1}={}){return new tc({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:s})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Et(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:i="display",annotationMode:s=_r.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:d=null,pageColors:A=null,printAnnotationStorage:f=null,isEditing:p=!1,recordOperations:b=!1,operationsFilter:w=null}){this._stats?.time("Overall");const S=this._transport.getRenderingIntent(i,s,f,p),{renderingIntent:k,cacheKey:E}=S;this.#e=!1,h||=this._transport.getOptionalContentConfig(k);let I=this._intentStates.get(E);I||(I=Object.create(null),this._intentStates.set(E,I)),I.streamReaderCancelTimeout&&(clearTimeout(I.streamReaderCancelTimeout),I.streamReaderCancelTimeout=null);const P=!!(k&Ka.PRINT);I.displayReadyCapability||(I.displayReadyCapability=Promise.withResolvers(),I.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(S));const R=!!(this._pdfBug&&globalThis.StepperManager?.enabled),D=!this.recordedBBoxes&&(b||R),N=G=>{if(I.renderTasks.delete(_),D){const L=_.gfx?.dependencyTracker.take();L&&(_.stepper&&_.stepper.setOperatorBBoxes(L,_.gfx.dependencyTracker.takeDebugMetadata()),b&&(this.recordedBBoxes=L))}P&&(this.#e=!0),this.#a(),G?(_.capability.reject(G),this._abortOperatorList({intentState:I,reason:G instanceof Error?G:new Error(G)})):_.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},_=new uo({callback:N,params:{canvas:t,canvasContext:e,dependencyTracker:D?new cP(t,I.operatorList.length,R):null,viewport:n,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:I.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!P,pdfBug:this._pdfBug,pageColors:A,enableHWA:this._transport.enableHWA,operationsFilter:w});(I.renderTasks||=new Set).add(_);const K=_.task;return Promise.all([I.displayReadyCapability.promise,h]).then(([G,L])=>{if(this.destroyed){N();return}if(this._stats?.time("Rendering"),!(L.renderingIntent&k))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");_.initializeGraphics({transparency:G,optionalContentConfig:L}),_.operatorListChanged()}).catch(N),K}getOperatorList({intent:e="display",annotationMode:t=_r.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){function s(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(e,t,n,i,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=s,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:this.#t.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>Vl.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,i){function s(){l.read().then(function({value:h,done:d}){if(d){n(c);return}c.lang??=h.lang,Object.assign(c.styles,h.styles),c.items.push(...h.items),s()},i)}const l=t.getReader(),c={items:[],styles:Object.create(null),lang:null};s()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#a();return e&&t&&(this._stats&&=new cb),t}#a(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#a()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:i}){const{map:s,transfer:l}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:this.#t.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:s,modifiedIds:i},l).getReader(),d=this._intentStates.get(t);d.streamReader=h;const A=()=>{h.read().then(({value:f,done:p})=>{if(p){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,d),A())},f=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const p of d.renderTasks)p.operatorListChanged();this.#a()}if(d.displayReadyCapability)d.displayReadyCapability.reject(f);else if(d.opListReadCapability)d.opListReadCapability.reject(f);else throw f}})};A()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof Tf){let i=OP;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new Br(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,s]of this._intentStates)if(s===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}var Rr,hi,Zi,cs,fd,us,ds,Ca,Fu,aw,iw,Ll,ko,Uu;const Mn=class Mn{constructor({name:e=null,port:t=null,verbosity:n=Tx()}={}){Ci(this,Ca);Ci(this,Rr,Promise.withResolvers());Ci(this,hi,null);Ci(this,Zi,null);Ci(this,cs,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(Pn(Mn,ds).has(t))throw new Error("Cannot use more than one PDFWorker per port.");Pn(Mn,ds).set(t,this),Si(this,Ca,aw).call(this,t)}else Si(this,Ca,iw).call(this)}get promise(){return Pn(this,Rr).promise}get port(){return Pn(this,Zi)}get messageHandler(){return Pn(this,hi)}destroy(){this.destroyed=!0,Pn(this,cs)?.terminate(),Ia(this,cs,null),Pn(Mn,ds).delete(Pn(this,Zi)),Ia(this,Zi,null),Pn(this,hi)?.destroy(),Ia(this,hi,null)}static create(e){const t=Pn(this,ds).get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Mn(e)}static get workerSrc(){if(So.workerSrc)return So.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Et(this,"_setupFakeWorkerGlobal",(async()=>Pn(this,ko,Uu)?Pn(this,ko,Uu):(await import(this.workerSrc)).WorkerMessageHandler)())}};Rr=new WeakMap,hi=new WeakMap,Zi=new WeakMap,cs=new WeakMap,fd=new WeakMap,us=new WeakMap,ds=new WeakMap,Ca=new WeakSet,Fu=function(){Pn(this,Rr).resolve(),Pn(this,hi).send("configure",{verbosity:this.verbosity})},aw=function(e){Ia(this,Zi,e),Ia(this,hi,new Gl("main","worker",e)),Pn(this,hi).on("ready",()=>{}),Si(this,Ca,Fu).call(this)},iw=function(){if(Pn(Mn,us)||Pn(Mn,ko,Uu)){Si(this,Ca,Ll).call(this);return}let{workerSrc:e}=Mn;try{Mn._isSameOrigin(window.location,e)||(e=Mn._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new Gl("main","worker",t),i=()=>{s.abort(),n.destroy(),t.terminate(),this.destroyed?Pn(this,Rr).reject(new Error("Worker was destroyed")):Si(this,Ca,Ll).call(this)},s=new AbortController;t.addEventListener("error",()=>{Pn(this,cs)||i()},{signal:s.signal}),n.on("test",c=>{if(s.abort(),this.destroyed||!c){i();return}Ia(this,hi,n),Ia(this,Zi,t),Ia(this,cs,t),Si(this,Ca,Fu).call(this)}),n.on("ready",c=>{if(s.abort(),this.destroyed){i();return}try{l()}catch{Si(this,Ca,Ll).call(this)}});const l=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};l();return}catch{Sd("The worker has been disabled.")}Si(this,Ca,Ll).call(this)},Ll=function(){Pn(Mn,us)||(kt("Setting up fake worker."),Ia(Mn,us,!0)),Mn._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){Pn(this,Rr).reject(new Error("Worker was destroyed"));return}const t=new eP;Ia(this,Zi,t);const n=`fake${Yy(Mn,fd)._++}`,i=new Gl(n+"_worker",n,t);e.setup(i,t),Ia(this,hi,new Gl(n,n+"_worker",t)),Si(this,Ca,Fu).call(this)}).catch(e=>{Pn(this,Rr).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},ko=new WeakSet,Uu=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Ci(Mn,ko),Ci(Mn,fd,0),Ci(Mn,us,!1),Ci(Mn,ds,new WeakMap),ba&&(Ia(Mn,us,!0),So.workerSrc||="./pdf.worker.mjs"),Mn._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!n?.origin||n.origin==="null")return!1;const i=new URL(t,n);return n.origin===i.origin},Mn._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},Mn.fromPort=e=>{if(Lx("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Mn.create(e)};let jl=Mn;class jP{downloadInfoCapability=Promise.withResolvers();#e=null;#t=new Map;#a=null;#n=new Map;#r=new Map;#s=new Map;#i=null;#o=rn.instance;constructor(e,t,n,i,s){this.messageHandler=e,this.loadingTask=t,this.#a=n,this.commonObjs=new ew,this.fontLoader=new qx({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.enableHWA=i.enableHWA,this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=s.canvasFactory,this.filterFactory=s.filterFactory,this.cMapReaderFactory=s.cMapReaderFactory,this.standardFontDataFactory=s.standardFontDataFactory,this.wasmFactory=s.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),this.#o.addListener(this.#c.bind(this))}#c(){const e=new Map,t=new Map;for(let n=0,i=this.#o.pagesNumber;n<i;n++){const s=this.#o.getPrevPageNumber(n+1)-1,l=this.#n.get(s);l&&e.set(n,l);const c=this.#r.get(s);c&&t.set(n,c)}this.#n=e,this.#r=t}#l(e,t=null){const n=this.#t.get(e);if(n)return n;const i=this.messageHandler.sendWithPromise(e,t);return this.#t.set(e,i),i}#h({loaded:e,total:t}){this.loadingTask.onProgress?.({loaded:e,total:t,percent:ua(Math.round(e/t*100),0,100)})}get annotationStorage(){return Et(this,"annotationStorage",new Pf)}getRenderingIntent(e,t=_r.ENABLE,n=null,i=!1,s=!1){let l=Ka.DISPLAY,c=Fg;switch(e){case"any":l=Ka.ANY;break;case"display":break;case"print":l=Ka.PRINT;break;default:kt(`getRenderingIntent - invalid intent: ${e}`)}const h=l&Ka.PRINT&&n instanceof US?n:this.annotationStorage;switch(t){case _r.DISABLE:l+=Ka.ANNOTATIONS_DISABLE;break;case _r.ENABLE:break;case _r.ENABLE_FORMS:l+=Ka.ANNOTATIONS_FORMS;break;case _r.ENABLE_STORAGE:l+=Ka.ANNOTATIONS_STORAGE,c=h.serializable;break;default:kt(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(l+=Ka.IS_EDITING),s&&(l+=Ka.OPLIST);const{ids:d,hash:A}=h.modifiedIds,f=[l,c.hash,A];return{renderingIntent:l,cacheKey:f.join("_"),annotationStorageSerializable:c,modifiedIds:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#i?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#n.values())e.push(n._destroy());this.#n.clear(),this.#r.clear(),this.#s.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),za.cleanup(),this.#a?.cancelAllRequests(new Br("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,i)=>{on(this.#a,"GetReader - no `BasePDFStream` instance available."),this.#e=this.#a.getFullReader(),this.#e.onProgress=s=>this.#h(s),i.onPull=()=>{this.#e.read().then(function({value:s,done:l}){if(l){i.close();return}on(s instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(s),1,[s])}).catch(s=>{i.error(s)})},i.onCancel=s=>{this.#e.cancel(s),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("ReaderHeadersReady",async n=>{await this.#e.headersReady;const{isStreamingSupported:i,isRangeSupported:s,contentLength:l}=this.#e;return i&&s&&(this.#e.onProgress=null),{isStreamingSupported:i,isRangeSupported:s,contentLength:l}}),e.on("GetRangeReader",(n,i)=>{on(this.#a,"GetRangeReader - no `BasePDFStream` instance available.");const s=this.#a.getRangeReader(n.begin,n.end);if(!s){i.close();return}i.onPull=()=>{s.read().then(function({value:l,done:c}){if(c){i.close();return}on(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{i.error(l)})},i.onCancel=l=>{s.cancel(l),i.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:n})=>{this.#o.pagesNumber=n.numPages,this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new HP(n,this))}),e.on("DocException",n=>{t._capability.reject(Da(n))}),e.on("PasswordRequest",n=>{this.#i=Promise.withResolvers();try{if(!t.onPassword)throw Da(n);const i=s=>{s instanceof Error?this.#i.reject(s):this.#i.resolve({password:s})};t.onPassword(i,n.code)}catch(i){this.#i.reject(i)}return this.#i.promise}),e.on("DataLoaded",n=>{this.#h({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#n.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,i,s])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(i){case"Font":if("error"in s){const f=s.error;kt(`Error during font loading: ${f}`),this.commonObjs.resolve(n,f);break}const l=new pn(s),c=this._params.pdfBug&&globalThis.FontInspector?.enabled?(f,p)=>globalThis.FontInspector.fontAdded(f,p):null,h=new Yx(l,c,s.extra,s.charProcOperatorList);this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(n,h)});break;case"CopyLocalImage":const{imageRef:d}=s;on(d,"The imageRef must be defined.");for(const f of this.#n.values())for(const[,p]of f.objs)if(p?.ref===d)return p.dataLen?(this.commonObjs.resolve(n,structuredClone(p)),p.dataLen):null;break;case"FontPath":this.commonObjs.resolve(n,new Xx(s));break;case"Image":this.commonObjs.resolve(n,s);break;case"Pattern":const A=new ta(s);this.commonObjs.resolve(n,A.getIR());break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([n,i,s,l])=>{if(this.destroyed)return;const c=this.#n.get(i);if(!c.objs.has(n)){if(c._intentStates.size===0){l?.bitmap?.close();return}switch(s){case"Image":case"Pattern":c.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${s}`)}}}),e.on("DocProgress",n=>{this.destroyed||this.#h(n)}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[n.type];if(!i)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&kt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this.#e?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}extractPages(e){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:e})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this.#o.pagesNumber)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#o.getPageId(e)-1,i=this.#r.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:n}).then(l=>{if(this.destroyed)throw new Error("Transport destroyed");l.refStr&&this.#s.set(l.refStr,n);const c=new VP(t,l,this,this._params.pdfBug);return this.#n.set(t,c),c});return this.#r.set(t,s),s}async getPageIndex(e){if(!Ug(e))throw new Error("Invalid pageIndex request.");const t=await this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen});return this.#o.getPageNumber(t+1)-1}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:this.#o.getPageId(e+1)-1,intent:t})}getFieldObjects(){return this.#l("GetFieldObjects")}hasJSActions(){return this.#l("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return this.#l("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:this.#o.getPageId(e+1)-1})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:this.#o.getPageId(e+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#l("GetOptionalContentConfig").then(t=>new TP(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#t.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(i=>({info:i[0],metadata:i[1]?new SP(i[1]):null,contentDispositionFilename:this.#e?.filename??null,contentLength:this.#e?.contentLength??null,hasStructTree:i[2]}));return this.#t.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#n.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),za.cleanup()}}cachedPageNumber(e){if(!Ug(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`,n=this.#s.get(t);return n>=0?this.#o.getPageNumber(n+1):null}}class QP{_internalRenderTask=null;onContinue=null;onError=null;constructor(e){this._internalRenderTask=e}get promise(){return this._internalRenderTask.capability.promise}cancel(e=0){this._internalRenderTask.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this._internalRenderTask.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this._internalRenderTask;return e.form||e.canvas&&t?.size>0}}class uo{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:i,annotationCanvasMap:s,operatorList:l,pageIndex:c,canvasFactory:h,filterFactory:d,useRequestAnimationFrame:A=!1,pdfBug:f=!1,pageColors:p=null,enableHWA:b=!1,operationsFilter:w=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=s,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=d,this._pdfBug=f,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=A===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new QP(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=b,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=w}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(uo.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");uo.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:i,background:s,dependencyTracker:l}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Co(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:i,viewport:n,transparency:e,background:s}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),uo.#t.delete(this._canvas),e||=new Tf(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),uo.#t.delete(this._canvas),this.callback())))}}const qP="5.4.624",YP="384c6208b";class ei{#e=null;#t=null;#a;#n=null;#r=!1;#s=!1;#i=null;#o;#c=null;#l=null;static#h=null;static get _keyboardManager(){return Et(this,"_keyboardManager",new ac([[["Escape","mac+Escape"],ei.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ei.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ei.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ei.prototype._moveToPrevious],[["Home","mac+Home"],ei.prototype._moveToBeginning],[["End","mac+End"],ei.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#s=!1,this.#i=e):this.#s=!0,this.#l=e?._uiManager||t,this.#o=this.#l._eventBus,this.#a=e?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",ei.#h||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#i&&(e.ariaControls=`${this.#i.id}_colorpicker_dropdown`);const t=this.#l._signal;e.addEventListener("click",this.#f.bind(this),{signal:t}),e.addEventListener("keydown",this.#p.bind(this),{signal:t});const n=this.#t=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#a,e.append(n),e}renderMainDropdown(){const e=this.#n=this.#d();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#d(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",ii,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#i&&(e.id=`${this.#i.id}_colorpicker_dropdown`);for(const[n,i]of this.#l.highlightColors){const s=document.createElement("button");s.tabIndex="0",s.role="option",s.setAttribute("data-color",i),s.title=n,s.setAttribute("data-l10n-id",ei.#h[n]);const l=document.createElement("span");s.append(l),l.className="swatch",l.style.backgroundColor=i,s.ariaSelected=i===this.#a,s.addEventListener("click",this.#A.bind(this,i),{signal:t}),e.append(s)}return e.addEventListener("keydown",this.#p.bind(this),{signal:t}),e}#A(e,t){t.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:jt.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#f(e);return}const t=e.target.getAttribute("data-color");t&&this.#A(t,e)}_moveToNext(e){if(!this.#g){this.#f(e);return}if(e.target===this.#e){this.#n.firstElementChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#n?.firstElementChild||e.target===this.#e){this.#g&&this._hideDropdownFromKeyboard();return}this.#g||this.#f(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#g){this.#f(e);return}this.#n.firstElementChild?.focus()}_moveToEnd(e){if(!this.#g){this.#f(e);return}this.#n.lastElementChild?.focus()}#p(e){ei._keyboardManager.exec(this,e)}#f(e){if(this.#g){this.hideDropdown();return}if(this.#r=e.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#e.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const t=this.#n=this.#d();this.#e.append(t)}#u(e){this.#n?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#g(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#g){this.#i?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#r})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#n)return;const t=this.#l.highlightColors.values();for(const n of this.#n.children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#n?.remove(),this.#n=null}}class Ql{#e=null;#t=null;#a=null;static#n=null;constructor(e){this.#t=e,this.#a=e._uiManager,Ql.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#e)return this.#e;const{editorType:e,colorType:t,color:n}=this.#t,i=this.#e=document.createElement("input");return i.type="color",i.value=n||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",Ql.#n[e]),i.addEventListener("input",()=>{this.#a.updateParams(t,i.value)},{signal:this.#a._signal}),i}update(e){this.#e&&(this.#e.value=e)}destroy(){this.#e?.remove(),this.#e=null}hideDropdown(){}}function Rb(a){return Math.floor(Math.max(0,Math.min(1,a))*255).toString(16).padStart(2,"0")}function Ml(a){return Math.max(0,Math.min(255,255*a))}class Nb{static CMYK_G([e,t,n,i]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Ml(e),[e,e,e]}static G_HTML([e]){const t=Rb(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(Ml)}static RGB_HTML(e){return`#${e.map(Rb).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,n+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,n,i]){return[Ml(1-Math.min(1,e+i)),Ml(1-Math.min(1,n+i)),Ml(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const i=1-e,s=1-t,l=1-n,c=Math.min(i,s,l);return["CMYK",i,s,l,c]}}class XP{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){ln("Abstract method `_createSVG` called.")}}class Ju extends XP{_createSVG(e){return document.createElementNS($i,e)}}const WP=9,fs=new WeakSet,$P=new Date().getTimezoneOffset()*60*1e3;class dg{static create(e){switch(e.data.annotationType){case Qn.LINK:return new Rf(e);case Qn.TEXT:return new ZP(e);case Qn.WIDGET:switch(e.data.fieldType){case"Tx":return new eM(e);case"Btn":return e.data.radioButton?new rw(e):e.data.checkBox?new nM(e):new aM(e);case"Ch":return new iM(e);case"Sig":return new tM(e)}return new ms(e);case Qn.POPUP:return new Og(e);case Qn.FREETEXT:return new sw(e);case Qn.LINE:return new sM(e);case Qn.SQUARE:return new oM(e);case Qn.CIRCLE:return new lM(e);case Qn.POLYLINE:return new ow(e);case Qn.CARET:return new uM(e);case Qn.INK:return new Nf(e);case Qn.POLYGON:return new cM(e);case Qn.HIGHLIGHT:return new lw(e);case Qn.UNDERLINE:return new dM(e);case Qn.SQUIGGLY:return new hM(e);case Qn.STRIKEOUT:return new AM(e);case Qn.STAMP:return new cw(e);case Qn.FILEATTACHMENT:return new gM(e);default:return new _n(e)}}}class _n{#e=null;#t=!1;#a=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,this.hasOwnCommentButton=!1,t&&(this.contentElement=this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return _n._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:e}=this,t=this.annotationStorage?.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const e=this.annotationStorage?.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:n,rect:i}=this.data;let s=-1/0,l=-1/0;if(t?.length>=8){for(let c=0;c<t.length;c+=8)t[c+1]>l?(l=t[c+1],s=t[c+2]):t[c+1]===l&&(s=Math.max(s,t[c+2]));return[s,l]}if(n?.length>=1){for(const c of n)for(let h=0,d=c.length;h<d;h+=2)c[h+1]>l?(l=c[h+1],s=c[h]):c[h+1]===l&&(s=Math.max(s,c[h]));if(s!==1/0)return[s,l]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:i,pageX:s,pageY:l}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-s)/n,e[1]=100*(e[1]-l)/i,e}get commentText(){const{data:e}=this;return this.annotationStorage.getRawValue(`${Ol}${e.id}`)?.popup?.contents||e.contentsObj?.str||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue(`${Ol}${t.id}`,{id:t.id,annotationType:t.annotationType,page:this.parent.page,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){(this.#a?.popup||this.popup)?.remove(),this.#a=this.popup=null}updateEdited(e){if(!this.container)return;e.rect&&(this.#e||={rect:this.data.rect.slice(0)});const{rect:t,popup:n}=e;t&&this.#n(t);let i=this.#a?.popup||this.popup;!i&&n?.text&&(this._createPopup(n),i=this.#a.popup),i&&(i.updateEdited(e),n?.deleted&&(i.remove(),this.#a=null,this.popup=null))}resetEdited(){this.#e&&(this.#n(this.#e.rect),this.#a?.popup.resetEdited(),this.#e=null)}#n(e){const{container:{style:t},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:s,pageHeight:l,pageX:c,pageY:h}}}}=this;n?.splice(0,4,...e),t.left=`${100*(e[0]-c)/s}%`,t.top=`${100*(l-e[3]+h)/l}%`,i===0?(t.width=`${100*(e[2]-e[0])/s}%`,t.height=`${100*(e[3]-e[1])/l}%`):this.setRotation(i)}_createContainer(e){const{data:t,parent:{page:n,viewport:i}}=this,s=document.createElement("section");s.setAttribute("data-annotation-id",t.id),!(this instanceof ms)&&!(this instanceof Rf)&&(s.tabIndex=0);const{style:l}=s;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(s.title=t.alternativeText),t.noRotate&&s.classList.add("norotate"),!t.rect||this instanceof Og){const{rotation:S}=t;return!t.hasOwnCanvas&&S!==0&&this.setRotation(S,s),s}const{width:c,height:h}=this;if(!e&&t.borderStyle.width>0){l.borderWidth=`${t.borderStyle.width}px`;const S=t.borderStyle.horizontalCornerRadius,k=t.borderStyle.verticalCornerRadius;if(S>0||k>0){const I=`calc(${S}px * var(--total-scale-factor)) / calc(${k}px * var(--total-scale-factor))`;l.borderRadius=I}else if(this instanceof rw){const I=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=I}switch(t.borderStyle.style){case no.SOLID:l.borderStyle="solid";break;case no.DASHED:l.borderStyle="dashed";break;case no.BEVELED:kt("Unimplemented border style: beveled");break;case no.INSET:kt("Unimplemented border style: inset");break;case no.UNDERLINE:l.borderBottomStyle="solid";break}const E=t.borderColor||null;E?(this.#t=!0,l.borderColor=Ze.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):l.borderWidth=0}const d=Ze.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:A,pageHeight:f,pageX:p,pageY:b}=i.rawDims;l.left=`${100*(d[0]-p)/A}%`,l.top=`${100*(d[1]-b)/f}%`;const{rotation:w}=t;return t.hasOwnCanvas||w===0?(l.width=`${100*c/A}%`,l.height=`${100*h/f}%`):this.setRotation(w,s),s}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims;let{width:s,height:l}=this;e%180!==0&&([s,l]=[l,s]),t.style.width=`${100*s/n}%`,t.style.height=`${100*l/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,i)=>{const s=i.detail[t],l=s[0],c=s.slice(1);i.target.style[n]=Nb[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:Nb[`${l}_rgb`](c)})};return Et(this,"_commonActions",{display:t=>{const{display:n}=t.detail,i=n%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const i of Object.keys(t.detail))(e[i]||n[i])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[i,s]of Object.entries(t)){const l=n[i];if(l){const c={detail:{[i]:s},target:e};l(c),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,i,s]=this.data.rect.map(S=>Math.fround(S));if(e.length===8){const[S,k,E,I]=e.subarray(2,6);if(i===S&&s===k&&t===E&&n===I)return}const{style:l}=this.container;let c;if(this.#t){const{borderColor:S,borderWidth:k}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${k}">`],this.container.classList.add("hasBorder")}const h=i-t,d=s-n,{svgFactory:A}=this,f=A.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0),f.role="none";const p=A.createElement("defs");f.append(p);const b=A.createElement("clipPath"),w=`clippath_${this.data.id}`;b.setAttribute("id",w),b.setAttribute("clipPathUnits","objectBoundingBox"),p.append(b);for(let S=2,k=e.length;S<k;S+=8){const E=e[S],I=e[S+1],P=e[S+2],R=e[S+3],D=A.createElement("rect"),N=(P-t)/h,_=(s-I)/d,K=(E-P)/h,G=(I-R)/d;D.setAttribute("x",N),D.setAttribute("y",_),D.setAttribute("width",K),D.setAttribute("height",G),b.append(D),c?.push(`<rect vector-effect="non-scaling-stroke" x="${N}" y="${_}" width="${K}" height="${G}"/>`)}this.#t&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(f),this.container.style.clipPath=`url(#${w})`}_createPopup(e=null){const{data:t}=this;let n,i;e?(n={str:e.text},i=e.date):(n=t.contentsObj,i=t.modificationDate),this.#a=new Og({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#a||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#a}render(){ln("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:s,id:l,exportValues:c}of i){if(s===-1||l===t)continue;const h=typeof c=="string"?c:null,d=document.querySelector(`[data-element-id="${l}"]`);if(d&&!fs.has(d)){kt(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:h,domElement:d})}return n}for(const i of document.getElementsByName(e)){const{exportValue:s}=i,l=i.getAttribute("data-element-id");l!==t&&fs.has(i)&&n.push({id:l,exportValue:s,domElement:i})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class JP extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&this._createPopup(e.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class Rf extends _n{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),i=!0):e.attachment?(this.#t(n,e.attachment,e.overlaidText,e.attachmentDest),i=!0):e.setOCGState?(this.#a(n,e.setOCGState,e.overlaidText),i=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),i=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&(this.contentElement=n,this.container.append(n)),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t,n=""){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e(),n&&(e.title=n)}_bindNamedAction(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),n&&(e.title=n),this.#e()}#t(e,t,n="",i=null){e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:n&&(e.title=n),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,i),!1),this.#e()}#a(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),n&&(e.title=n),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(t.actions)){const s=n.get(i);s&&(e[s]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1))}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){kt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();const{fields:i,refs:s,include:l}=t,c=[];if(i.length!==0||s.length!==0){const A=new Set(s);for(const f of i){const p=this._fieldObjects[f]||[];for(const{id:b}of p)A.add(b)}for(const f of Object.values(this._fieldObjects))for(const p of f)A.has(p.id)===l&&c.push(p)}else for(const A of Object.values(this._fieldObjects))c.push(...A);const h=this.annotationStorage,d=[];for(const A of c){const{id:f}=A;switch(d.push(f),A.type){case"text":{const b=A.defaultValue||"";h.setValue(f,{value:b});break}case"checkbox":case"radiobutton":{const b=A.defaultValue===A.exportValues;h.setValue(f,{value:b});break}case"combobox":case"listbox":{const b=A.defaultValue||"";h.setValue(f,{value:b});break}default:continue}const p=document.querySelector(`[data-element-id="${f}"]`);if(p){if(!fs.has(p)){kt(`_bindResetFormAction - element not allowed: ${f}`);continue}}else continue;p.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}}class ZP extends _n{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(e),this.container}}class ms extends _n{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Wn.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,i,s){n.includes("mouse")?e.addEventListener(n,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(n,l=>{if(n==="blur"){if(!t.focused||!l.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}s&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:s(l)}})})}_setEventListeners(e,t,n,i){for(const[s,l]of n)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,s,l,i),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Ze.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||WP,s=e.style;let l;const c=2,h=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c),A=Math.round(d/(ig*i))||1,f=d/A;l=Math.min(i,h(f/ig))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(i,h(d/ig))}s.fontSize=`calc(${l}px * var(--total-scale-factor))`,s.color=Ze.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(s.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class eM extends ms{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,i){const s=this.annotationStorage;for(const l of this._getElementsByName(e.name,e.id))l.domElement&&(l.domElement[t]=n),s.setValue(l.id,{[i]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const i=e.getValue(t,{value:this.data.fieldValue});let s=i.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&s.length>l&&(s=s.slice(0,l));let c=i.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:s,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=c??s,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",c??s),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),fs.add(n),this.contentElement=n,n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:d,datetimeType:A,timeStep:f}=this.data,p=!!A&&this.enableScripting;d&&(n.title=d),this._setRequired(n,this.data.required),l&&(n.maxLength=l),n.addEventListener("input",w=>{e.setValue(t,{value:w.target.value}),this.setPropertyOnSiblings(n,"value",w.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",w=>{const S=this.data.defaultFieldValue??"";n.value=h.userValue=S,h.formattedValue=null});let b=w=>{const{formattedValue:S}=h;S!=null&&(w.target.value=S),w.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",S=>{if(h.focused)return;const{target:k}=S;if(p&&(k.type=A,f&&(k.step=f)),h.userValue){const E=h.userValue;if(p)if(A==="time"){const I=new Date(E),P=[I.getHours(),I.getMinutes(),I.getSeconds()];k.value=P.map(R=>R.toString().padStart(2,"0")).join(":")}else k.value=new Date(E-$P).toISOString().split(A==="date"?"T":".",1)[0];else k.value=E}h.lastCommittedValue=k.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const k={value(E){h.userValue=E.detail.value??"",p||e.setValue(t,{value:h.userValue.toString()}),E.target.value=h.userValue},formattedValue(E){const{formattedValue:I}=E.detail;h.formattedValue=I,I!=null&&E.target!==document.activeElement&&(E.target.value=I);const P={formattedValue:I};p&&(P.value=I),e.setValue(t,P)},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{const{charLimit:I}=E.detail,{target:P}=E;if(I===0){P.removeAttribute("maxLength");return}P.setAttribute("maxLength",I);let R=h.userValue;!R||R.length<=I||(R=R.slice(0,I),P.value=h.userValue=R,e.setValue(t,{value:R}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:R,willCommit:!0,commitKey:1,selStart:P.selectionStart,selEnd:P.selectionEnd}}))}};this._dispatchEventFromSandbox(k,S)}),n.addEventListener("keydown",S=>{h.commitKey=1;let k=-1;if(S.key==="Escape"?k=0:S.key==="Enter"&&!this.data.multiLine?k=2:S.key==="Tab"&&(h.commitKey=3),k===-1)return;const{value:E}=S.target;h.lastCommittedValue!==E&&(h.lastCommittedValue=E,h.userValue=E,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:k,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const w=b;b=null,n.addEventListener("blur",S=>{if(!h.focused||!S.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:k}=S;let{value:E}=k;if(p){if(E&&A==="time"){const I=E.split(":").map(P=>parseInt(P,10));E=new Date(2e3,0,1,I[0],I[1],I[2]||0).valueOf(),k.step=""}else E.includes("T")||(E=`${E}T00:00`),E=new Date(E).valueOf();k.type="text"}h.userValue=E,h.lastCommittedValue!==E&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:h.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}),w(S)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",S=>{h.lastCommittedValue=null;const{data:k,target:E}=S,{value:I,selectionStart:P,selectionEnd:R}=E;let D=P,N=R;switch(S.inputType){case"deleteWordBackward":{const _=I.substring(0,P).match(/\w*[^\w]*$/);_&&(D-=_[0].length);break}case"deleteWordForward":{const _=I.substring(P).match(/^[^\w]*\w*/);_&&(N+=_[0].length);break}case"deleteContentBackward":P===R&&(D-=1);break;case"deleteContentForward":P===R&&(N+=1);break}S.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:I,change:k||"",willCommit:!1,selStart:D,selEnd:N}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(b&&n.addEventListener("blur",b),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/l;n.classList.add("comb"),n.style.letterSpacing=`calc(${S}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class tM extends ms{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class nM extends ms{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const s=document.createElement("input");return fs.add(s),s.setAttribute("data-element-id",n),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="checkbox",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.setAttribute("exportValue",t.exportValue),s.tabIndex=0,s.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const d of this._getElementsByName(c,n)){const A=h&&d.exportValue===t.exportValue;d.domElement&&(d.domElement.checked=A),e.setValue(d.id,{value:A})}e.setValue(n,{value:h})}),s.addEventListener("resetform",l=>{const c=t.defaultFieldValue||"Off";l.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(s.addEventListener("updatefromsandbox",l=>{const c={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class rw extends ms{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(n,{value:i})),i)for(const l of this._getElementsByName(t.fieldName,n))e.setValue(l.id,{value:!1});const s=document.createElement("input");if(fs.add(s),s.setAttribute("data-element-id",n),s.disabled=t.readOnly,this._setRequired(s,this.data.required),s.type="radio",s.name=t.fieldName,i&&s.setAttribute("checked",!0),s.tabIndex=0,s.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const d of this._getElementsByName(c,n))e.setValue(d.id,{value:!1});e.setValue(n,{value:h})}),s.addEventListener("resetform",l=>{const c=t.defaultFieldValue;l.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const l=t.buttonValue;s.addEventListener("updatefromsandbox",c=>{const h={value:d=>{const A=l===d.detail.value;for(const f of this._getElementsByName(d.target.name)){const p=A&&f.id===n;f.domElement&&(f.domElement.checked=p),e.setValue(f.id,{value:p})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(s,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class aM extends Rf{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class iM extends ms{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");fs.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let s=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",A=>{const f=this.data.defaultFieldValue;for(const p of i.options)p.selected=p.value===f});for(const A of this.data.options){const f=document.createElement("option");f.textContent=A.displayValue,f.value=A.exportValue,n.value.includes(A.exportValue)&&(f.setAttribute("selected",!0),s=!1),i.append(f)}let l=null;if(s){const A=document.createElement("option");A.value=" ",A.setAttribute("hidden",!0),A.setAttribute("selected",!0),i.prepend(A),l=()=>{A.remove(),i.removeEventListener("input",l),l=null},i.addEventListener("input",l)}const c=A=>{const f=A?"value":"textContent",{options:p,multiple:b}=i;return b?Array.prototype.filter.call(p,w=>w.selected).map(w=>w[f]):p.selectedIndex===-1?null:p[p.selectedIndex][f]};let h=c(!1);const d=A=>{const f=A.target.options;return Array.prototype.map.call(f,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",A=>{const f={value(p){l?.();const b=p.detail.value,w=new Set(Array.isArray(b)?b:[b]);for(const S of i.options)S.selected=w.has(S.value);e.setValue(t,{value:c(!0)}),h=c(!1)},multipleSelection(p){i.multiple=!0},remove(p){const b=i.options,w=p.detail.remove;b[w].selected=!1,i.remove(w),b.length>0&&Array.prototype.findIndex.call(b,k=>k.selected)===-1&&(b[0].selected=!0),e.setValue(t,{value:c(!0),items:d(p)}),h=c(!1)},clear(p){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),h=c(!1)},insert(p){const{index:b,displayValue:w,exportValue:S}=p.detail.insert,k=i.children[b],E=document.createElement("option");E.textContent=w,E.value=S,k?k.before(E):i.append(E),e.setValue(t,{value:c(!0),items:d(p)}),h=c(!1)},items(p){const{items:b}=p.detail;for(;i.length!==0;)i.remove(0);for(const w of b){const{displayValue:S,exportValue:k}=w,E=document.createElement("option");E.textContent=S,E.value=k,i.append(E)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:c(!0),items:d(p)}),h=c(!1)},indices(p){const b=new Set(p.detail.indices);for(const w of p.target.options)w.selected=b.has(w.index);e.setValue(t,{value:c(!0)}),h=c(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(f,A)}),i.addEventListener("input",A=>{const f=c(!0),p=c(!1);e.setValue(t,{value:f}),A.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:p,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],A=>A.target.value)):i.addEventListener("input",function(A){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class Og extends _n{constructor(e){const{data:t,elements:n,parent:i}=e,s=!!i._commentManager;if(super(e,{isRenderable:!s&&_n._hasPopupData(t)}),this.elements=n,s&&_n._hasPopupData(t)){const l=this.popup=this.#e();for(const c of n)c.popup=l}else this.popup=null}#e(){return new rM({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=this.#e(),n=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",n.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(i=>`${lo}${i}`).join(",")),this.container}}class rM{#e=null;#t=this.#V.bind(this);#a=this.#U.bind(this);#n=this.#R.bind(this);#r=this.#S.bind(this);#s=null;#i=null;#o=null;#c=null;#l=null;#h=null;#d=null;#A=!1;#p=null;#f=null;#u=null;#g=null;#m=null;#y=null;#v=null;#k=null;#w=null;#C=null;#x=!1;#b=null;#T=null;constructor({container:e,color:t,elements:n,titleObj:i,modificationDate:s,contentsObj:l,richText:c,parent:h,rect:d,parentRect:A,open:f,commentManager:p=null}){this.#i=e,this.#w=i,this.#o=l,this.#k=c,this.#h=h,this.#s=t,this.#v=d,this.#d=A,this.#l=n,this.#e=p,this.#b=n[0],this.#c=Gg.toDateObject(s),this.trigger=n.flatMap(b=>b.getElementsToTriggerPopup()),p||(this.#I(),this.#i.hidden=!0,f&&this.#S())}#I(){if(this.#f)return;this.#f=new AbortController;const{signal:e}=this.#f;for(const t of this.trigger)t.addEventListener("click",this.#r,{signal:e}),t.addEventListener("pointerenter",this.#n,{signal:e}),t.addEventListener("pointerleave",this.#a,{signal:e}),t.classList.add("popupTriggerArea");for(const t of this.#l)t.container?.addEventListener("keydown",this.#t,{signal:e})}#P(){const e=this.#l.find(t=>t.hasCommentButton);e&&(this.#m=e._normalizePoint(e.commentButtonPosition))}renderCommentButton(){if(this.#g){this.#g.parentNode||this.#b.container.after(this.#g);return}if(this.#m||this.#P(),!this.#m)return;const{signal:e}=this.#f=new AbortController,t=this.#b.hasOwnCommentButton,n=()=>{this.#e.toggleCommentPopup(this,!0,void 0,!t)},i=()=>{this.#e.toggleCommentPopup(this,!1,!0,!t)},s=()=>{this.#e.toggleCommentPopup(this,!1,!1)};if(t){this.#g=this.#b.container;for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",this.#t,{signal:e}),l.addEventListener("click",n,{signal:e}),l.addEventListener("pointerenter",i,{signal:e}),l.addEventListener("pointerleave",s,{signal:e}),l.classList.add("popupTriggerArea")}else{const l=this.#g=document.createElement("button");l.className="annotationCommentButton";const c=this.#b.container;l.style.zIndex=c.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#B(),this.#M(),l.addEventListener("keydown",this.#t,{signal:e}),l.addEventListener("click",n,{signal:e}),l.addEventListener("pointerenter",i,{signal:e}),l.addEventListener("pointerleave",s,{signal:e}),c.after(l)}}#M(){if(this.#b.extraPopupElement&&!this.#b.editor)return;this.#g||this.renderCommentButton();const[e,t]=this.#m,{style:n}=this.#g;n.left=`calc(${e}%)`,n.top=`calc(${t}% - var(--comment-button-dim))`}#B(){this.#b.extraPopupElement||(this.#g||this.renderCommentButton(),this.#g.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:e,opacity:t}=this.#b.commentData;return e?this.#h._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{this.#g?.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:i,modificationDate:s}=this.#b.commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:i,modificationDate:s}}get elementBeforePopup(){return this.#g}get comment(){return this.#T||=this.#b.commentText,this.#T}set comment(e){e!==this.comment&&(this.#b.commentText=this.#T=e)}focus(){this.#b.container?.focus()}get parentBoundingClientRect(){return this.#b.layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){this.#g&&(this.#g.classList.toggle("selected",e),this.#g.ariaExpanded=t)}setSelectedCommentButton(e){this.#g.classList.toggle("selected",e)}get commentPopupPosition(){if(this.#y)return this.#y;const{x:e,y:t,height:n}=this.#g.getBoundingClientRect(),{x:i,y:s,width:l,height:c}=this.#b.layer.getBoundingClientRect();return[(e-i)/l,(t+n-s)/c]}set commentPopupPosition(e){this.#y=e}hasDefaultPopupPosition(){return this.#y===null}get commentButtonPosition(){return this.#m}get commentButtonWidth(){return this.#g.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=this.#y||this.commentButtonPosition.map(d=>d/100),i=this.parentBoundingClientRect,{x:s,y:l,width:c,height:h}=i;this.#e.showDialog(null,this,s+t*c,l+n*h,{...e,parentDimensions:i})}render(){if(this.#p)return;const e=this.#p=document.createElement("div");if(e.className="popup",this.#s){const n=e.style.outlineColor=Ze.makeHexColor(...this.#s);e.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`}const t=document.createElement("span");if(t.className="header",this.#w?.str){const n=document.createElement("span");n.className="title",t.append(n),{dir:n.dir,str:n.textContent}=this.#w}if(e.append(t),this.#c){const n=document.createElement("time");n.className="popupDate",n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),n.dateTime=this.#c.toISOString(),t.append(n)}GS({html:this.#_||this.#o.str,dir:this.#o?.dir,className:"popupContent"},e),this.#i.append(e)}get#_(){const e=this.#k,t=this.#o;return e?.str&&(!t?.str||t.str===e.str)&&this.#k.html||null}get#N(){return this.#_?.attributes?.style?.fontSize||0}get#F(){return this.#_?.attributes?.style?.color||null}#G(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:this.#F,fontSize:this.#N?`calc(${this.#N}px * var(--total-scale-factor))`:""}};for(const s of e.split(`
`))t.push({name:"span",value:s,attributes:i});return n}#V(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#A)&&this.#S()}updateEdited({rect:e,popup:t,deleted:n}){if(this.#e){n?(this.remove(),this.#T=null):t&&(t.deleted?this.remove():(this.#B(),this.#T=t.text)),e&&(this.#m=null,this.#P(),this.#M());return}if(n||t?.deleted){this.remove();return}this.#I(),this.#C||={contentsObj:this.#o,richText:this.#k},e&&(this.#u=null),t&&t.text&&(this.#k=this.#G(t.text),this.#c=Gg.toDateObject(t.date),this.#o=null),this.#p?.remove(),this.#p=null}resetEdited(){this.#C&&({contentsObj:this.#o,richText:this.#k}=this.#C,this.#C=null,this.#p?.remove(),this.#p=null,this.#u=null)}remove(){if(this.#f?.abort(),this.#f=null,this.#p?.remove(),this.#p=null,this.#x=!1,this.#A=!1,this.#g?.remove(),this.#g=null,this.trigger)for(const e of this.trigger)e.classList.remove("popupTriggerArea")}#E(){if(this.#u!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:i,pageY:s}}}=this.#h;let l=!!this.#d,c=l?this.#d:this.#v;for(const w of this.#l)if(!c||Ze.intersect(w.data.rect,c)!==null){c=w.data.rect,l=!0;break}const h=Ze.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),A=l?c[2]-c[0]+5:0,f=h[0]+A,p=h[1];this.#u=[100*(f-i)/t,100*(p-s)/n];const{style:b}=this.#i;b.left=`${this.#u[0]}%`,b.top=`${this.#u[1]}%`}#S(){if(this.#e){this.#e.toggleCommentPopup(this,!1);return}this.#A=!this.#A,this.#A?(this.#R(),this.#i.addEventListener("click",this.#r),this.#i.addEventListener("keydown",this.#t)):(this.#U(),this.#i.removeEventListener("click",this.#r),this.#i.removeEventListener("keydown",this.#t))}#R(){this.#p||this.render(),this.isVisible?this.#A&&this.#i.classList.add("focused"):(this.#E(),this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#U(){this.#i.classList.remove("focused"),!(this.#A||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#x=this.isVisible,this.#x&&(this.#i.hidden=!0)}maybeShow(){this.#e||(this.#I(),this.#x&&(this.#p||this.#R(),this.#x=!1,this.#i.hidden=!1))}get isVisible(){return this.#e?!1:this.#i.hidden===!1}}class sw extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=It.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=this.contentElement=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class sM extends _n{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),s=this.#e=this.svgFactory.createElement("svg:line");return s.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),s.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),s.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),s.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),s.setAttribute("stroke-width",e.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","transparent"),i.append(s),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class oM extends _n{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),s=e.borderStyle.width,l=this.#e=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",s/2),l.setAttribute("y",s/2),l.setAttribute("width",t-s),l.setAttribute("height",n-s),l.setAttribute("stroke-width",s||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),i.append(l),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class lM extends _n{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),s=e.borderStyle.width,l=this.#e=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",t/2),l.setAttribute("cy",n/2),l.setAttribute("rx",t/2-s/2),l.setAttribute("ry",n/2-s/2),l.setAttribute("stroke-width",s||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),i.append(l),this.container.append(i),!e.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ow extends _n{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:i},width:s,height:l}=this;if(!t)return this.container;const c=this.svgFactory.create(s,l,!0);let h=[];for(let A=0,f=t.length;A<f;A+=2){const p=t[A]-e[0],b=e[3]-t[A+1];h.push(`${p},${b}`)}h=h.join(" ");const d=this.#e=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",h),d.setAttribute("stroke-width",n.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),c.append(d),this.container.append(c),!i&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class cM extends ow{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class uM extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Nf extends _n{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?It.HIGHLIGHT:It.INK}#a(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:i,popupRef:s}}=this,{transform:l,width:c,height:h}=this.#a(t,e),d=this.svgFactory.create(c,h,!0),A=this.#e=this.svgFactory.createElement("svg:g");d.append(A),A.setAttribute("stroke-width",i.width||1),A.setAttribute("stroke-linecap","round"),A.setAttribute("stroke-linejoin","round"),A.setAttribute("stroke-miterlimit",10),A.setAttribute("stroke","transparent"),A.setAttribute("fill","transparent"),A.setAttribute("transform",l);for(let f=0,p=n.length;f<p;f++){const b=this.svgFactory.createElement(this.svgElementName);this.#t.push(b),b.setAttribute("points",n[f].join(",")),A.append(b)}return!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:i}=e,s=this.#e;if(t>=0&&s.setAttribute("stroke-width",t||1),n)for(let l=0,c=this.#t.length;l<c;l++)this.#t[l].setAttribute("points",n[l].join(","));if(i){const{transform:l,width:c,height:h}=this.#a(this.data.rotation,i);s.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),s.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class lw extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=It.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class dM extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class hM extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class AM extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class cw extends _n{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=It.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class gM extends _n{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;const{isMac:i}=Wn.platform;return e.addEventListener("keydown",s=>{s.key==="Enter"&&(i?s.metaKey:s.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Gf{#e=null;#t=null;#a=null;#n=new Map;#r=null;#s=null;#i=[];#o=!1;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:i,page:s,viewport:l,structTreeLayer:c,commentManager:h,linkService:d,annotationStorage:A}){this.div=e,this.#e=t,this.#t=n,this.#r=c||null,this.#s=d||null,this.#a=A||new Pf,this.page=s,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=h||null}hasEditableAnnotations(){return this.#n.size>0}async render(e){const{annotations:t}=e,n=this.div;gs(n,this.viewport);const i=new Map,s=[],l={data:null,layer:n,linkService:this.#s,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new Ju,annotationStorage:this.#a,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const c of t){if(c.noHTML)continue;const h=c.annotationType===Qn.POPUP;if(h){const f=i.get(c.id);if(!f)continue;if(!this._commentManager){s.push(c);continue}l.elements=f}else if(c.rect[2]===c.rect[0]||c.rect[3]===c.rect[1])continue;l.data=c;const d=dg.create(l);if(!d.isRenderable)continue;if(!h&&(this.#i.push(d),c.popupRef)){const f=i.get(c.popupRef);f?f.push(d):i.set(c.popupRef,[d])}const A=d.render();c.hidden&&(A.style.visibility="hidden"),d._isEditable&&(this.#n.set(d.data.id,d),this._annotationEditorUIManager?.renderAnnotationElement(d))}await this.#c();for(const c of s){const h=l.elements=i.get(c.id);l.data=c;const d=dg.create(l);if(!d.isRenderable)continue;const A=d.render();d.contentElement.id=`${lo}${c.id}`,c.hidden&&(A.style.visibility="hidden"),h.at(-1).container.after(A)}this.#l()}async#c(){if(this.#i.length===0)return;this.div.replaceChildren();const e=[];if(!this.#o){this.#o=!0;for(const{contentElement:n,data:{id:i}}of this.#i){const s=n.id=`${lo}${i}`;e.push(this.#r?.getAriaAttributes(s).then(l=>{if(l)for(const[c,h]of l)n.setAttribute(c,h)}))}}this.#i.sort(({data:{rect:[n,i,s,l]}},{data:{rect:[c,h,d,A]}})=>{if(n===s&&i===l)return 1;if(c===d&&h===A)return-1;const f=l,p=i,b=(i+l)/2,w=A,S=h,k=(h+A)/2;if(b>=w&&k<=p)return-1;if(k>=f&&b<=S)return 1;const E=(n+s)/2,I=(c+d)/2;return E-I});const t=document.createDocumentFragment();for(const n of this.#i)t.append(n.container),this._commentManager?(n.extraPopupElement?.popup||n.popup)?.renderCommentButton():n.extraPopupElement&&t.append(n.extraPopupElement.render());if(this.div.append(t),await Promise.all(e),this.#e)for(const n of this.#i)this.#e.addPointerInTextLayer(n.contentElement,!1)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:this.#s,svgFactory:new Ju,parent:this};for(const n of e){n.borderStyle||=Gf._defaultBorderStyle,t.data=n;const i=dg.create(t);i.isRenderable&&(i.render(),i.contentElement.id=`${lo}${n.id}`,this.#i.push(i))}await this.#c()}update({viewport:e}){const t=this.div;this.viewport=e,gs(t,{rotation:e.rotation}),this.#l(),t.hidden=!1}#l(){if(!this.#t)return;const e=this.div;for(const[t,n]of this.#t){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:s}=i;s?s.nodeName==="CANVAS"?s.replaceWith(n):s.classList.contains("annotationContent")?s.after(n):s.before(n):i.append(n);const l=this.#n.get(t);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,i.id,n),l._hasNoCanvas=!1):l.canvas=n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}addFakeAnnotation(e){const{div:t}=this,{id:n,rotation:i}=e,s=new JP({data:{id:n,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:this.#s,annotationStorage:this.#a});return s.render(),s.contentElement.id=`${lo}${n}`,s.createOrUpdatePopup(),this.#i.push(s),s}removeAnnotation(e){const t=this.#i.findIndex(i=>i.data.id===e);if(t<0)return;const[n]=this.#i.splice(t,1);this.#e?.removePointerInTextLayer(n.contentElement)}updateFakeAnnotations(e){if(e.length!==0){for(const t of e)t.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}static get _defaultBorderStyle(){return Et(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:no.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const wu=/\r\n?|\n/g;class na extends gt{#e="";#t=`${this.id}-editor`;#a=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=na.prototype,t=s=>s.isEmpty(),n=Fr.TRANSLATE_SMALL,i=Fr.TRANSLATE_BIG;return Et(this,"_keyboardManager",new ac([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}static _type="freetext";static _editorType=It.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.color=e.color||na._defaultColor||gt._defaultLineColor,this.#n=e.fontSize||na._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(e,t){gt.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case jt.FREETEXT_SIZE:na._defaultFontSize=t;break;case jt.FREETEXT_COLOR:na._defaultColor=t;break}}updateParams(e,t){switch(e){case jt.FREETEXT_SIZE:this.#r(t);break;case jt.FREETEXT_COLOR:this.#s(t);break}}static get defaultPropertiesToUpdate(){return[[jt.FREETEXT_SIZE,na._defaultFontSize],[jt.FREETEXT_COLOR,na._defaultColor||gt._defaultLineColor]]}get propertiesToUpdate(){return[[jt.FREETEXT_SIZE,this.#n],[jt.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Ql(this),[["colorPicker",this._colorPicker]]}get colorType(){return jt.FREETEXT_COLOR}#r(e){const t=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-this.#n)*this.parentScale),this.#n=i,this.#o()},n=this.#n;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:jt.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#s(e){const t=i=>{this.color=i,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:jt.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-na._internalPadding*e,-(na._internalPadding+this.#n)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#a=new AbortController;const e=this._uiManager.combinedSignal(this.#a);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#t),this._isDraggable=!0,this.#a?.abort(),this.#a=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#i(){const e=[];this.editorDiv.normalize();let t=null;for(const n of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(na.#c(n)),t=n);return e.join(`
`)}#o(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:i,div:s}=this,l=s.style.display,c=s.classList.contains("hidden");s.classList.remove("hidden"),s.style.display="hidden",i.div.append(this.div),n=s.getBoundingClientRect(),s.remove(),s.style.display=l,s.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#e,t=this.#e=this.#i().trimEnd();if(e===t)return;const n=i=>{if(this.#e=i,!i){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){na._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#t),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,s]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[d,A]=this.pageDimensions,[f,p]=this.pageTranslation;let b,w;switch(this.rotation){case 0:b=e+(l[0]-f)/d,w=t+this.height-(l[1]-p)/A;break;case 90:b=e+(l[0]-f)/d,w=t-(l[1]-p)/A,[c,h]=[h,-c];break;case 180:b=e-this.width+(l[0]-f)/d,w=t-(l[1]-p)/A,[c,h]=[-c,-h];break;case 270:b=e+(l[0]-f-this.height*A)/d,w=t+(l[1]-p-this.width*d)/A,[c,h]=[-h,c];break}this.setAt(b*i,w*s,c,h)}else this._moveAfterPaste(e,t);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(wu,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const i=na.#d(t.getData("text")||"").replaceAll(wu,`
`);if(!i)return;const s=window.getSelection();if(!s.rangeCount)return;this.editorDiv.normalize(),s.deleteFromDocument();const l=s.getRangeAt(0);if(!i.includes(`
`)){l.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),s.collapseToStart();return}const{startContainer:c,startOffset:h}=l,d=[],A=[];if(c.nodeType===Node.TEXT_NODE){const b=c.parentElement;if(A.push(c.nodeValue.slice(h).replaceAll(wu,"")),b!==this.editorDiv){let w=d;for(const S of this.editorDiv.childNodes){if(S===b){w=A;continue}w.push(na.#c(S))}}d.push(c.nodeValue.slice(0,h).replaceAll(wu,""))}else if(c===this.editorDiv){let b=d,w=0;for(const S of this.editorDiv.childNodes)w++===h&&(b=A),b.push(na.#c(S))}this.#e=`${d.join(`
`)}${i}${A.join(`
`)}`,this.#l();const f=new Range;let p=Math.sumPrecise(d.map(b=>b.length));for(const{firstChild:b}of this.editorDiv.childNodes)if(b.nodeType===Node.TEXT_NODE){const w=b.nodeValue.length;if(p<=w){f.setStart(b,p),f.setEnd(b,p);break}p-=w}s.removeAllRanges(),s.addRange(f)}#l(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const e of this.#e.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#h(){return this.#e.replaceAll(""," ")}static#d(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const e=na._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,n){let i=null;if(e instanceof sw){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:d,id:A,popupRef:f,richText:p,contentsObj:b,creationDate:w,modificationDate:S},textContent:k,textPosition:E,parent:{page:{pageNumber:I}}}=e;if(!k||k.length===0)return null;i=e={annotationType:It.FREETEXT,color:Array.from(c),fontSize:l,value:k.join(`
`),position:E,pageIndex:I-1,rect:h.slice(0),rotation:d,annotationElementId:A,id:A,deleted:!1,popupRef:f,comment:b?.str||null,richText:p,creationDate:w,modificationDate:S}}const s=await super.deserialize(e,t,n);return s.#n=e.fontSize,s.color=Ze.makeHexColor(...e.color),s.#e=na.#d(e.value),s._initialData=i,e.comment&&s.setCommentData(e),s}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=gt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(e),{color:t,fontSize:this.#n,value:this.#h()});return this.addComment(n),e?(n.isCopy=!0,n):this.annotationElementId&&!this.#A(n)?null:(n.id=this.annotationElementId,n)}#A(e){const{value:t,fontSize:n,color:i,pageIndex:s}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((l,c)=>l!==i[c])||e.pageIndex!==s}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:n}=t;n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,t.replaceChildren();for(const i of this.#e.split(`
`)){const s=document.createElement("div");s.append(i?document.createTextNode(i):document.createElement("br")),t.append(s)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#e}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class rt{static PRECISION=1e-4;toSVGPath(){ln("Abstract method `toSVGPath` must be implemented.")}get box(){ln("Abstract getter `box` must be implemented.")}serialize(e,t){ln("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,i,s,l){l||=new Float32Array(e.length);for(let c=0,h=e.length;c<h;c+=2)l[c]=t+e[c]*i,l[c+1]=n+e[c+1]*s;return l}static _rescaleAndSwap(e,t,n,i,s,l){l||=new Float32Array(e.length);for(let c=0,h=e.length;c<h;c+=2)l[c]=t+e[c+1]*i,l[c+1]=n+e[c]*s;return l}static _translate(e,t,n,i){i||=new Float32Array(e.length);for(let s=0,l=e.length;s<l;s+=2)i[s]=t+e[s],i[s+1]=n+e[s+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,i,s){switch(s){case 90:return[1-t/n,e/i];case 180:return[1-e/n,1-t/i];case 270:return[t/n,1-e/i];default:return[e/n,t/i]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,i,s,l){return[(e+5*n)/6,(t+5*i)/6,(5*n+s)/6,(5*i+l)/6,(n+s)/2,(i+l)/2]}}class ls{#e;#t=[];#a;#n;#r=[];#s=new Float32Array(18);#i;#o;#c;#l;#h;#d;#A=[];static#p=8;static#f=2;static#u=ls.#p+ls.#f;constructor({x:e,y:t},n,i,s,l,c=0){this.#e=n,this.#d=s*i,this.#n=l,this.#s.set([NaN,NaN,NaN,NaN,e,t],6),this.#a=c,this.#l=ls.#p*i,this.#c=ls.#u*i,this.#h=i,this.#A.push(e,t)}isEmpty(){return isNaN(this.#s[8])}#g(){const e=this.#s.subarray(4,6),t=this.#s.subarray(16,18),[n,i,s,l]=this.#e;return[(this.#i+(e[0]-t[0])/2-n)/s,(this.#o+(e[1]-t[1])/2-i)/l,(this.#i+(t[0]-e[0])/2-n)/s,(this.#o+(t[1]-e[1])/2-i)/l]}add({x:e,y:t}){this.#i=e,this.#o=t;const[n,i,s,l]=this.#e;let[c,h,d,A]=this.#s.subarray(8,12);const f=e-d,p=t-A,b=Math.hypot(f,p);if(b<this.#c)return!1;const w=b-this.#l,S=w/b,k=S*f,E=S*p;let I=c,P=h;c=d,h=A,d+=k,A+=E,this.#A?.push(e,t);const R=-E/w,D=k/w,N=R*this.#d,_=D*this.#d;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([d+N,A+_],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([d-N,A-_],16),isNaN(this.#s[6])?(this.#r.length===0&&(this.#s.set([c+N,h+_],2),this.#r.push(NaN,NaN,NaN,NaN,(c+N-n)/s,(h+_-i)/l),this.#s.set([c-N,h-_],14),this.#t.push(NaN,NaN,NaN,NaN,(c-N-n)/s,(h-_-i)/l)),this.#s.set([I,P,c,h,d,A],6),!this.isEmpty()):(this.#s.set([I,P,c,h,d,A],6),Math.abs(Math.atan2(P-h,I-c)-Math.atan2(E,k))<Math.PI/2?([c,h,d,A]=this.#s.subarray(2,6),this.#r.push(NaN,NaN,NaN,NaN,((c+d)/2-n)/s,((h+A)/2-i)/l),[c,h,I,P]=this.#s.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((I+c)/2-n)/s,((P+h)/2-i)/l),!0):([I,P,c,h,d,A]=this.#s.subarray(0,6),this.#r.push(((I+5*c)/6-n)/s,((P+5*h)/6-i)/l,((5*c+d)/6-n)/s,((5*h+A)/6-i)/l,((c+d)/2-n)/s,((h+A)/2-i)/l),[d,A,c,h,I,P]=this.#s.subarray(12,18),this.#t.push(((I+5*c)/6-n)/s,((P+5*h)/6-i)/l,((5*c+d)/6-n)/s,((5*h+A)/6-i)/l,((c+d)/2-n)/s,((h+A)/2-i)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#r,t=this.#t;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#m();const n=[];n.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);this.#v(n);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return this.#y(n),n.join(" ")}#m(){const[e,t,n,i]=this.#e,[s,l,c,h]=this.#g();return`M${(this.#s[2]-e)/n} ${(this.#s[3]-t)/i} L${(this.#s[4]-e)/n} ${(this.#s[5]-t)/i} L${s} ${l} L${c} ${h} L${(this.#s[16]-e)/n} ${(this.#s[17]-t)/i} L${(this.#s[14]-e)/n} ${(this.#s[15]-t)/i} Z`}#y(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#v(e){const[t,n,i,s]=this.#e,l=this.#s.subarray(4,6),c=this.#s.subarray(16,18),[h,d,A,f]=this.#g();e.push(`L${(l[0]-t)/i} ${(l[1]-n)/s} L${h} ${d} L${A} ${f} L${(c[0]-t)/i} ${(c[1]-n)/s}`)}newFreeDrawOutline(e,t,n,i,s,l){return new uw(e,t,n,i,s,l)}getOutlines(){const e=this.#r,t=this.#t,n=this.#s,[i,s,l,c]=this.#e,h=new Float32Array((this.#A?.length??0)+2);for(let f=0,p=h.length-2;f<p;f+=2)h[f]=(this.#A[f]-i)/l,h[f+1]=(this.#A[f+1]-s)/c;if(h[h.length-2]=(this.#i-i)/l,h[h.length-1]=(this.#o-s)/c,isNaN(n[6])&&!this.isEmpty())return this.#k(h);const d=new Float32Array(this.#r.length+24+this.#t.length);let A=e.length;for(let f=0;f<A;f+=2){if(isNaN(e[f])){d[f]=d[f+1]=NaN;continue}d[f]=e[f],d[f+1]=e[f+1]}A=this.#C(d,A);for(let f=t.length-6;f>=6;f-=6)for(let p=0;p<6;p+=2){if(isNaN(t[f+p])){d[A]=d[A+1]=NaN,A+=2;continue}d[A]=t[f+p],d[A+1]=t[f+p+1],A+=2}return this.#w(d,A),this.newFreeDrawOutline(d,h,this.#e,this.#h,this.#a,this.#n)}#k(e){const t=this.#s,[n,i,s,l]=this.#e,[c,h,d,A]=this.#g(),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-n)/s,(t[3]-i)/l,NaN,NaN,NaN,NaN,(t[4]-n)/s,(t[5]-i)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,d,A,NaN,NaN,NaN,NaN,(t[16]-n)/s,(t[17]-i)/l,NaN,NaN,NaN,NaN,(t[14]-n)/s,(t[15]-i)/l],0),this.newFreeDrawOutline(f,e,this.#e,this.#h,this.#a,this.#n)}#w(e,t){const n=this.#t;return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6}#C(e,t){const n=this.#s.subarray(4,6),i=this.#s.subarray(16,18),[s,l,c,h]=this.#e,[d,A,f,p]=this.#g();return e.set([NaN,NaN,NaN,NaN,(n[0]-s)/c,(n[1]-l)/h,NaN,NaN,NaN,NaN,d,A,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(i[0]-s)/c,(i[1]-l)/h],t),t+=24}}class uw extends rt{#e;#t=new Float32Array(4);#a;#n;#r;#s;#i;constructor(e,t,n,i,s,l){super(),this.#i=e,this.#r=t,this.#e=n,this.#s=i,this.#a=s,this.#n=l,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(l);const[c,h,d,A]=this.#t;for(let f=0,p=e.length;f<p;f+=2)e[f]=(e[f]-c)/d,e[f+1]=(e[f+1]-h)/A;for(let f=0,p=t.length;f<p;f+=2)t[f]=(t[f]-c)/d,t[f+1]=(t[f+1]-h)/A}toSVGPath(){const e=[`M${this.#i[4]} ${this.#i[5]}`];for(let t=6,n=this.#i.length;t<n;t+=6){if(isNaN(this.#i[t])){e.push(`L${this.#i[t+4]} ${this.#i[t+5]}`);continue}e.push(`C${this.#i[t]} ${this.#i[t+1]} ${this.#i[t+2]} ${this.#i[t+3]} ${this.#i[t+4]} ${this.#i[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,i],s){const l=n-e,c=i-t;let h,d;switch(s){case 0:h=rt._rescale(this.#i,e,i,l,-c),d=rt._rescale(this.#r,e,i,l,-c);break;case 90:h=rt._rescaleAndSwap(this.#i,e,t,l,c),d=rt._rescaleAndSwap(this.#r,e,t,l,c);break;case 180:h=rt._rescale(this.#i,n,t,-l,c),d=rt._rescale(this.#r,n,t,-l,c);break;case 270:h=rt._rescaleAndSwap(this.#i,n,i,-l,-c),d=rt._rescaleAndSwap(this.#r,n,i,-l,-c);break}return{outline:Array.from(h),points:[Array.from(d)]}}#o(e){const t=this.#i;let n=t[4],i=t[5];const s=[n,i,n,i];let l=n,c=i,h=n,d=i;const A=e?Math.max:Math.min,f=new Float32Array(4);for(let b=6,w=t.length;b<w;b+=6){const S=t[b+4],k=t[b+5];isNaN(t[b])?(Ze.pointBoundingBox(S,k,s),c>k?(l=S,c=k):c===k&&(l=A(l,S)),d<k?(h=S,d=k):d===k&&(h=A(h,S))):(f[0]=f[1]=1/0,f[2]=f[3]=-1/0,Ze.bezierBoundingBox(n,i,...t.slice(b,b+6),f),Ze.rectBoundingBox(f[0],f[1],f[2],f[3],s),c>f[1]?(l=f[0],c=f[1]):c===f[1]&&(l=A(l,f[0])),d<f[3]?(h=f[2],d=f[3]):d===f[3]&&(h=A(h,f[2]))),n=S,i=k}const p=this.#t;p[0]=s[0]-this.#a,p[1]=s[1]-this.#a,p[2]=s[2]-s[0]+2*this.#a,p[3]=s[3]-s[1]+2*this.#a,this.firstPoint=[l,c],this.lastPoint=[h,d]}get box(){return this.#t}newOutliner(e,t,n,i,s,l=0){return new ls(e,t,n,i,s,l)}getNewOutline(e,t){const[n,i,s,l]=this.#t,[c,h,d,A]=this.#e,f=s*d,p=l*A,b=n*d+c,w=i*A+h,S=this.newOutliner({x:this.#r[0]*f+b,y:this.#r[1]*p+w},this.#e,this.#s,e,this.#n,t??this.#a);for(let k=2;k<this.#r.length;k+=2)S.add({x:this.#r[k]*f+b,y:this.#r[k+1]*p+w});return S.getOutlines()}}class Hg{#e;#t;#a;#n=[];#r=[];constructor(e,t=0,n=0,i=!0){const s=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:S,y:k,width:E,height:I}of e){const P=Math.floor((S-t)/l)*l,R=Math.ceil((S+E+t)/l)*l,D=Math.floor((k-t)/l)*l,N=Math.ceil((k+I+t)/l)*l,_=[P,D,N,!0],K=[R,D,N,!1];this.#n.push(_,K),Ze.rectBoundingBox(P,D,R,N,s)}const c=s[2]-s[0]+2*n,h=s[3]-s[1]+2*n,d=s[0]-n,A=s[1]-n;let f=i?-1/0:1/0,p=1/0;const b=this.#n.at(i?-1:-2),w=[b[0],b[2]];for(const S of this.#n){const[k,E,I,P]=S;!P&&i?E<p?(p=E,f=k):E===p&&(f=Math.max(f,k)):P&&!i&&(E<p?(p=E,f=k):E===p&&(f=Math.min(f,k))),S[0]=(k-d)/c,S[1]=(E-A)/h,S[2]=(I-A)/h}this.#e=new Float32Array([d,A,c,h]),this.#t=[f,p],this.#a=w}getOutlines(){this.#n.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of this.#n)t[3]?(e.push(...this.#l(t)),this.#o(t)):(this.#c(t),e.push(...this.#l(t)));return this.#s(e)}#s(e){const t=[],n=new Set;for(const l of e){const[c,h,d]=l;t.push([c,h,l],[c,d,l])}t.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=t.length;l<c;l+=2){const h=t[l][2],d=t[l+1][2];h.push(d),d.push(h),n.add(h),n.add(d)}const i=[];let s;for(;n.size>0;){const l=n.values().next().value;let[c,h,d,A,f]=l;n.delete(l);let p=c,b=h;for(s=[c,d],i.push(s);;){let w;if(n.has(A))w=A;else if(n.has(f))w=f;else break;n.delete(w),[c,h,d,A,f]=w,p!==c&&(s.push(p,b,c,b===h?h:d),p=c),b=b===h?d:h}s.push(p,b)}return new fM(i,this.#e,this.#t,this.#a)}#i(e){const t=this.#r;let n=0,i=t.length-1;for(;n<=i;){const s=n+i>>1,l=t[s][0];if(l===e)return s;l<e?n=s+1:i=s-1}return i+1}#o([,e,t]){const n=this.#i(e);this.#r.splice(n,0,[e,t])}#c([,e,t]){const n=this.#i(e);for(let i=n;i<this.#r.length;i++){const[s,l]=this.#r[i];if(s!==e)break;if(s===e&&l===t){this.#r.splice(i,1);return}}for(let i=n-1;i>=0;i--){const[s,l]=this.#r[i];if(s!==e)break;if(s===e&&l===t){this.#r.splice(i,1);return}}}#l(e){const[t,n,i]=e,s=[[t,n,i]],l=this.#i(i);for(let c=0;c<l;c++){const[h,d]=this.#r[c];for(let A=0,f=s.length;A<f;A++){const[,p,b]=s[A];if(!(d<=p||b<=h)){if(p>=h){if(b>d)s[A][1]=d;else{if(f===1)return[];s.splice(A,1),A--,f--}continue}s[A][2]=h,b>d&&s.push([t,d,b])}}}return s}}class fM extends rt{#e;#t;constructor(e,t,n,i){super(),this.#t=e,this.#e=t,this.firstPoint=n,this.lastPoint=i}toSVGPath(){const e=[];for(const t of this.#t){let[n,i]=t;e.push(`M${n} ${i}`);for(let s=2;s<t.length;s+=2){const l=t[s],c=t[s+1];l===n?(e.push(`V${c}`),i=c):c===i&&(e.push(`H${l}`),n=l)}e.push("Z")}return e.join(" ")}serialize([e,t,n,i],s){const l=[],c=n-e,h=i-t;for(const d of this.#t){const A=new Array(d.length);for(let f=0;f<d.length;f+=2)A[f]=e+d[f]*c,A[f+1]=i-d[f+1]*h;l.push(A)}return l}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class Vg extends ls{newFreeDrawOutline(e,t,n,i,s,l){return new pM(e,t,n,i,s,l)}}class pM extends uw{newOutliner(e,t,n,i,s,l=0){return new Vg(e,t,n,i,s,l)}}class Kn extends gt{#e=null;#t=0;#a;#n=null;#r=null;#s=null;#i=null;#o=0;#c=null;#l=null;#h=null;#d=!1;#A=null;#p=null;#f=null;#u="";#g;#m="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=It.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=Kn.prototype;return Et(this,"_keyboardManager",new ac([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||Kn._defaultColor,this.#g=e.thickness||Kn._defaultThickness,this.opacity=e.opacity||Kn._defaultOpacity,this.#a=e.boxes||null,this.#m=e.methodOfCreation||"",this.#u=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#d=!0,this.#v(e),this.#b()):this.#a&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#i=e.focusNode,this.#o=e.focusOffset,this.#y(),this.#b(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#d?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#g,methodOfCreation:this.#m}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#y(){const e=new Hg(this.#a,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new Hg(this.#a,.0025,.001,this._uiManager.direction==="ltr");this.#s=t.getOutlines();const{firstPoint:n}=this.#l;this.#A=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height];const{lastPoint:i}=this.#s;this.#p=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#v({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#l=e;const i=1.5;if(this.#s=e.getNewOutline(this.#g/2+i,.0025),t>=0)this.#h=t,this.#n=n,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#f=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const f=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:Kn.#T(this.#l.box,(f-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#f,{bbox:Kn.#T(this.#s.box,f),path:{d:this.#s.toSVGPath()}})}const[s,l,c,h]=e.box;switch(this.rotation){case 0:this.x=s,this.y=l,this.width=c,this.height=h;break;case 90:{const[f,p]=this.parentDimensions;this.x=l,this.y=1-s,this.width=c*p/f,this.height=h*f/p;break}case 180:this.x=1-s,this.y=1-l,this.width=c,this.height=h;break;case 270:{const[f,p]=this.parentDimensions;this.x=1-l,this.y=s,this.width=c*p/f,this.height=h*f/p;break}}const{firstPoint:d}=e;this.#A=[(d[0]-s)/c,(d[1]-l)/h];const{lastPoint:A}=this.#s;this.#p=[(A[0]-s)/c,(A[1]-l)/h]}static initialize(e,t){gt.initialize(e,t),Kn._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case jt.HIGHLIGHT_COLOR:Kn._defaultColor=t;break;case jt.HIGHLIGHT_THICKNESS:Kn._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#p}get commentButtonPosition(){return this.#A}updateParams(e,t){switch(e){case jt.HIGHLIGHT_COLOR:this.#k(t);break;case jt.HIGHLIGHT_THICKNESS:this.#w(t);break}}static get defaultPropertiesToUpdate(){return[[jt.HIGHLIGHT_COLOR,Kn._defaultColor],[jt.HIGHLIGHT_THICKNESS,Kn._defaultThickness]]}get propertiesToUpdate(){return[[jt.HIGHLIGHT_COLOR,this.color||Kn._defaultColor],[jt.HIGHLIGHT_THICKNESS,this.#g||Kn._defaultThickness],[jt.HIGHLIGHT_FREE,this.#d]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#r?.updateColor(this.color),super.onUpdatedColor()}#k(e){const t=(s,l)=>{this.color=s,this.opacity=l,this.onUpdatedColor()},n=this.color,i=this.opacity;this.addCommands({cmd:t.bind(this,e,Kn._defaultOpacity),undo:t.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:jt.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}#w(e){const t=this.#g,n=i=>{this.#g=i,this.#C(i)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:jt.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#r=new ei({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#M())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#M())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#x(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#b(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#x():e&&(this.#b(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#C(e){this.#d&&(this.#v({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims())}#x(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#f),this.#f=null)}#b(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#n}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#d},path:{d:this.#l.toSVGPath()}},!1,!0),this.#f=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#d},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#d),this.#c&&(this.#c.style.clipPath=this.#n))}static#T([e,t,n,i],s){switch(s){case 90:return[1-t-i,e,i,n];case 180:return[1-e-n,1-t-i,n,i];case 270:return[t,1-e-n,i,n]}return[e,t,n,i]}rotate(e){const{drawLayer:t}=this.parent;let n;this.#d?(e=(e-this.rotation+360)%360,n=Kn.#T(this.#l.box,e)):n=Kn.#T([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#h,{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(this.#f,{bbox:Kn.#T(this.#s.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#u&&(e.setAttribute("aria-label",this.#u),e.setAttribute("role","mark")),this.#d?e.classList.add("free"):this.div.addEventListener("keydown",this.#I.bind(this),{signal:this._uiManager._signal});const t=this.#c=document.createElement("div");return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#n,this.setDims(),BS(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#f,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#f,{rootClass:{hovered:!1}})}#I(e){Kn._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#P(!0);break;case 1:case 3:this.#P(!1);break}}#P(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#i,this.#o)}select(){super.select(),this.#f&&this.parent?.drawLayer.updateProperties(this.#f,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#f&&(this.parent?.drawLayer.updateProperties(this.#f,{rootClass:{selected:!1}}),this.#d||this.#P(!1))}get _mustFixPosition(){return!this.#d}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#f,{rootClass:{hidden:!e}}))}#M(){return this.#d?this.rotation:0}#B(){if(this.#d)return null;const[e,t]=this.pageDimensions,[n,i]=this.pageTranslation,s=this.#a,l=new Float32Array(s.length*8);let c=0;for(const{x:h,y:d,width:A,height:f}of s){const p=h*e+n,b=(1-d)*t+i;l[c]=l[c+4]=p,l[c+1]=l[c+3]=b,l[c+2]=l[c+6]=p+A*e,l[c+5]=l[c+7]=b-f*t,c+=8}return l}#_(e){return this.#l.serialize(e,this.#M())}static startHighlighting(e,t,{target:n,x:i,y:s}){const{x:l,y:c,width:h,height:d}=n.getBoundingClientRect(),A=new AbortController,f=e.combinedSignal(A),p=b=>{A.abort(),this.#F(e,b)};window.addEventListener("blur",p,{signal:f}),window.addEventListener("pointerup",p,{signal:f}),window.addEventListener("pointerdown",Ln,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",ii,{signal:f}),n.addEventListener("pointermove",this.#N.bind(this,e),{signal:f}),this._freeHighlight=new Vg({x:i,y:s},[l,c,h,d],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#N(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#F(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,n){let i=null;if(e instanceof lw){const{data:{quadPoints:w,rect:S,rotation:k,id:E,color:I,opacity:P,popupRef:R,richText:D,contentsObj:N,creationDate:_,modificationDate:K},parent:{page:{pageNumber:G}}}=e;i=e={annotationType:It.HIGHLIGHT,color:Array.from(I),opacity:P,quadPoints:w,boxes:null,pageIndex:G-1,rect:S.slice(0),rotation:k,annotationElementId:E,id:E,deleted:!1,popupRef:R,richText:D,comment:N?.str||null,creationDate:_,modificationDate:K}}else if(e instanceof Nf){const{data:{inkLists:w,rect:S,rotation:k,id:E,color:I,borderStyle:{rawWidth:P},popupRef:R,richText:D,contentsObj:N,creationDate:_,modificationDate:K},parent:{page:{pageNumber:G}}}=e;i=e={annotationType:It.HIGHLIGHT,color:Array.from(I),thickness:P,inkLists:w,boxes:null,pageIndex:G-1,rect:S.slice(0),rotation:k,annotationElementId:E,id:E,deleted:!1,popupRef:R,richText:D,comment:N?.str||null,creationDate:_,modificationDate:K}}const{color:s,quadPoints:l,inkLists:c,opacity:h}=e,d=await super.deserialize(e,t,n);d.color=Ze.makeHexColor(...s),d.opacity=h||1,c&&(d.#g=e.thickness),d._initialData=i,e.comment&&d.setCommentData(e);const[A,f]=d.pageDimensions,[p,b]=d.pageTranslation;if(l){const w=d.#a=[];for(let S=0;S<l.length;S+=8)w.push({x:(l[S]-p)/A,y:1-(l[S+1]-b)/f,width:(l[S+2]-l[S])/A,height:(l[S+1]-l[S+5])/f});d.#y(),d.#b(),d.rotate(d.rotation)}else if(c){d.#d=!0;const w=c[0],S={x:w[0]-p,y:f-(w[1]-b)},k=new Vg(S,[0,0,A,f],1,d.#g/2,!0,.001);for(let P=0,R=w.length;P<R;P+=2)S.x=w[P]-p,S.y=f-(w[P+1]-b),k.add(S);const{id:E,clipPathId:I}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:k.toSVGPath()}},!0,!0);d.#v({highlightOutlines:k.getOutlines(),highlightId:E,clipPathId:I}),d.#b(),d.rotate(d.parentRotation)}return d}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=gt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(e);return Object.assign(n,{color:t,opacity:this.opacity,thickness:this.#g,quadPoints:this.#B(),outlines:this.#_(n.rect)}),this.addComment(n),this.annotationElementId&&!this.#G(n)?null:(n.id=this.annotationElementId,n)}#G(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((n,i)=>n!==t[i])}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class dw{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){ln("Not implemented")}}class an extends gt{#e=null;#t;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#a=null;static#n=null;static#r=null;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(this.#s(e),this.#c())}#s({drawOutlines:e,drawId:t,drawingOptions:n}){this.#e=e,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#i(e,this.parent),this.#d(e.box)}#i(e,t){const{id:n}=t.drawLayer.draw(an._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[i,s]of Object.entries(t))n.has(i)?Object.assign(e[i],s):e[i]=s;return e}static getDefaultDrawingOptions(e){ln("Not implemented")}static get typesMap(){ln("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&(an.#a.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,i]of this.typesMap)e.push([n,t[i]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,i]of this.constructor.typesMap)e.push([n,t[i]]);return e}_updateProperty(e,t,n){const i=this._drawingOptions,s=i[t],l=c=>{i.updateProperty(t,c);const h=this.#e.updateProperty(t,c);h&&this.#d(h),this.parent?.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,n),undo:l.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,an._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#h()),{bbox:this.#A()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,an._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#h()),{bbox:this.#A()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#A()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,an._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#h(),this.parentDimensions),{bbox:this.#A()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#d(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#o()):e&&(this._uiManager.addShouldRescale(this),this.#c(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#i(this.#e,e)}}#l([e,t,n,i]){const{parentDimensions:[s,l],rotation:c}=this;switch(c){case 90:return[t,1-e,n*(l/s),i*(s/l)];case 180:return[1-e,1-t,n,i];case 270:return[1-t,e,n*(l/s),i*(s/l)];default:return[e,t,n,i]}}#h(){const{x:e,y:t,width:n,height:i,parentDimensions:[s,l],rotation:c}=this;switch(c){case 90:return[1-t,e,n*(s/l),i*(l/s)];case 180:return[1-e,1-t,n,i];case 270:return[t,1-e,n*(s/l),i*(l/s)];default:return[e,t,n,i]}}#d(e){[this.x,this.y,this.width,this.height]=this.#l(e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#A(){const{x:e,y:t,width:n,height:i,rotation:s,parentRotation:l,parentDimensions:[c,h]}=this;switch((s*4+l)/90){case 1:return[1-t-i,e,i,n];case 2:return[1-e-n,1-t-i,n,i];case 3:return[t,1-e-n,i,n];case 4:return[e,t-n*(c/h),i*(h/c),n*(c/h)];case 5:return[1-t,e,n*(c/h),i*(h/c)];case 6:return[1-e-i*(h/c),1-t,i*(h/c),n*(c/h)];case 7:return[t-n*(c/h),1-e-i*(h/c),n*(c/h),i*(h/c)];case 8:return[e-n,t-i,n,i];case 9:return[1-t,e-n,i,n];case 10:return[1-e,1-t,n,i];case 11:return[t-i,1-e,i,n];case 12:return[e-i*(h/c),t,i*(h/c),n*(c/h)];case 13:return[1-t-n*(c/h),e-i*(h/c),n*(c/h),i*(h/c)];case 14:return[1-e,1-t-n*(c/h),i*(h/c),n*(c/h)];case 15:return[t,1-e,n*(c/h),i*(h/c)];default:return[e,t,n,i]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,an._mergeSVGProperties({bbox:this.#A()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#d(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const i=document.createElement("div");return n.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,i,s){ln("Not implemented")}static startDrawing(e,t,n,i){const{target:s,offsetX:l,offsetY:c,pointerId:h,pointerType:d}=i;if(sn.isInitializedAndDifferentPointerType(d))return;const{viewport:{rotation:A}}=e,{width:f,height:p}=s.getBoundingClientRect(),b=an.#n=new AbortController,w=e.combinedSignal(b);if(sn.setPointer(d,h),window.addEventListener("pointerup",S=>{sn.isSamePointerIdOrRemove(S.pointerId)&&this._endDraw(S)},{signal:w}),window.addEventListener("pointercancel",S=>{sn.isSamePointerIdOrRemove(S.pointerId)&&this._currentParent.endDrawingSession()},{signal:w}),window.addEventListener("pointerdown",S=>{sn.isSamePointerType(S.pointerType)&&(sn.initializeAndAddPointerId(S.pointerId),an.#a.isCancellable()&&(an.#a.removeLastElement(),an.#a.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:w}),window.addEventListener("contextmenu",ii,{signal:w}),s.addEventListener("pointermove",this._drawMove.bind(this),{signal:w}),s.addEventListener("touchmove",S=>{sn.isSameTimeStamp(S.timeStamp)&&Ln(S)},{signal:w}),e.toggleDrawing(),t._editorUndoBar?.hide(),an.#a){e.drawLayer.updateProperties(this._currentDrawId,an.#a.startNew(l,c,f,p,A));return}t.updateUIForDefaultProperties(this),an.#a=this.createDrawerInstance(l,c,f,p,A),an.#r=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(an.#r.toSVGProperties(),an.#a.defaultSVGProperties),!0,!1)}static _drawMove(e){if(sn.isSameTimeStamp(e.timeStamp),!an.#a)return;const{offsetX:t,offsetY:n,pointerId:i}=e;if(sn.isSamePointerId(i)){if(sn.isUsingMultiplePointers()){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,an.#a.add(t,n)),sn.setTimeStamp(e.timeStamp),Ln(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,an.#a=null,an.#r=null,sn.clearTimeStamp()),an.#n&&(an.#n.abort(),an.#n=null,sn.clearPointerIds())}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,an.#a.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const n=an.#a,i=this._currentDrawId,s=n.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(i,n.setLastElement(s))},undo:()=>{t.drawLayer.updateProperties(i,n.removeLastElement())},mustExec:!1,type:jt.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(jt.DRAW_STEP),!an.#a.isEmpty()){const{pageDimensions:[n,i],scale:s}=t,l=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:an.#a.getOutlines(n*s,i*s,s,this._INNER_MARGIN),drawingOptions:an.#r,mustBeCommitted:!e});return this._cleanup(!0),l}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,i,s,l){ln("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:i,pageHeight:s,pageX:l,pageY:c}}=t.viewport,h=this.deserializeDraw(l,c,i,s,this._INNER_MARGIN,e),d=await super.deserialize(e,t,n);return d.createDrawingOptions(e),d.#s({drawOutlines:h}),d.#c(),d.onScaleChanging(),d.rotate(),d}serializeDraw(e){const[t,n]=this.pageTranslation,[i,s]=this.pageDimensions;return this.#e.serialize([t,n,i,s],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class mM{#e=new Float64Array(6);#t;#a;#n;#r;#s;#i="";#o=0;#c=new ic;#l;#h;constructor(e,t,n,i,s,l){this.#l=n,this.#h=i,this.#n=s,this.#r=l,[e,t]=this.#d(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#s=[e,t],this.#a=[{line:c,points:this.#s}],this.#e.set(c,0)}updateProperty(e,t){e==="stroke-width"&&(this.#r=t)}#d(e,t){return rt._normalizePoint(e,t,this.#l,this.#h,this.#n)}isEmpty(){return!this.#a||this.#a.length===0}isCancellable(){return this.#s.length<=10}add(e,t){[e,t]=this.#d(e,t);const[n,i,s,l]=this.#e.subarray(2,6),c=e-s,h=t-l;return Math.hypot(this.#l*c,this.#h*h)<=2?null:(this.#s.push(e,t),isNaN(n)?(this.#e.set([s,l,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([n,i,s,l,e,t],0),this.#t.push(...rt.createBezierPoints(n,i,s,l,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,i,s){this.#l=n,this.#h=i,this.#n=s,[e,t]=this.#d(e,t);const l=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#s=[e,t];const c=this.#a.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#a.push({line:l,points:this.#s}),this.#e.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#a.at(-1)}setLastElement(e){return this.#a?(this.#a.push(e),this.#t=e.line,this.#s=e.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(e)}removeLastElement(){if(!this.#a)return this.#c.removeLastElement();this.#a.pop(),this.#i="";for(let e=0,t=this.#a.length;e<t;e++){const{line:n,points:i}=this.#a[e];this.#t=n,this.#s=i,this.#o=0,this.toSVGPath()}return{path:{d:this.#i}}}toSVGPath(){const e=rt.svgRound(this.#t[4]),t=rt.svgRound(this.#t[5]);if(this.#s.length===2)return this.#i=`${this.#i} M ${e} ${t} Z`,this.#i;if(this.#s.length<=6){const i=this.#i.lastIndexOf("M");this.#i=`${this.#i.slice(0,i)} M ${e} ${t}`,this.#o=6}if(this.#s.length===4){const i=rt.svgRound(this.#t[10]),s=rt.svgRound(this.#t[11]);return this.#i=`${this.#i} L ${i} ${s}`,this.#o=12,this.#i}const n=[];this.#o===0&&(n.push(`M ${e} ${t}`),this.#o=6);for(let i=this.#o,s=this.#t.length;i<s;i+=6){const[l,c,h,d,A,f]=this.#t.slice(i,i+6).map(rt.svgRound);n.push(`C${l} ${c} ${h} ${d} ${A} ${f}`)}return this.#i+=n.join(" "),this.#o=this.#t.length,this.#i}getOutlines(e,t,n,i){const s=this.#a.at(-1);return s.line=new Float32Array(s.line),s.points=new Float32Array(s.points),this.#c.build(this.#a,e,t,n,this.#n,this.#r,i),this.#e=null,this.#t=null,this.#a=null,this.#i=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class ic extends rt{#e;#t=0;#a;#n;#r;#s;#i;#o;#c;build(e,t,n,i,s,l,c){this.#r=t,this.#s=n,this.#i=i,this.#o=s,this.#c=l,this.#a=c??0,this.#n=e,this.#d()}get thickness(){return this.#c}setLastElement(e){return this.#n.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#n){if(e.push(`M${rt.svgRound(t[4])} ${rt.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${rt.svgRound(t[10])} ${rt.svgRound(t[11])}`);continue}for(let n=6,i=t.length;n<i;n+=6){const[s,l,c,h,d,A]=t.subarray(n,n+6).map(rt.svgRound);e.push(`C${s} ${l} ${c} ${h} ${d} ${A}`)}}return e.join("")}serialize([e,t,n,i],s){const l=[],c=[],[h,d,A,f]=this.#h();let p,b,w,S,k,E,I,P,R;switch(this.#o){case 0:R=rt._rescale,p=e,b=t+i,w=n,S=-i,k=e+h*n,E=t+(1-d-f)*i,I=e+(h+A)*n,P=t+(1-d)*i;break;case 90:R=rt._rescaleAndSwap,p=e,b=t,w=n,S=i,k=e+d*n,E=t+h*i,I=e+(d+f)*n,P=t+(h+A)*i;break;case 180:R=rt._rescale,p=e+n,b=t,w=-n,S=i,k=e+(1-h-A)*n,E=t+d*i,I=e+(1-h)*n,P=t+(d+f)*i;break;case 270:R=rt._rescaleAndSwap,p=e+n,b=t+i,w=-n,S=-i,k=e+(1-d-f)*n,E=t+(1-h-A)*i,I=e+(1-d)*n,P=t+(1-h)*i;break}for(const{line:D,points:N}of this.#n)l.push(R(D,p,b,w,S,s?new Array(D.length):null)),c.push(R(N,p,b,w,S,s?new Array(N.length):null));return{lines:l,points:c,rect:[k,E,I,P]}}static deserialize(e,t,n,i,s,{paths:{lines:l,points:c},rotation:h,thickness:d}){const A=[];let f,p,b,w,S;switch(h){case 0:S=rt._rescale,f=-e/n,p=t/i+1,b=1/n,w=-1/i;break;case 90:S=rt._rescaleAndSwap,f=-t/i,p=-e/n,b=1/i,w=1/n;break;case 180:S=rt._rescale,f=e/n+1,p=-t/i,b=-1/n,w=1/i;break;case 270:S=rt._rescaleAndSwap,f=t/i+1,p=e/n+1,b=-1/i,w=-1/n;break}if(!l){l=[];for(const E of c){const I=E.length;if(I===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(I===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const P=new Float32Array(3*(I-2));l.push(P);let[R,D,N,_]=E.subarray(0,4);P.set([NaN,NaN,NaN,NaN,R,D],0);for(let K=4;K<I;K+=2){const G=E[K],L=E[K+1];P.set(rt.createBezierPoints(R,D,N,_,G,L),(K-2)*3),[R,D,N,_]=[N,_,G,L]}}}for(let E=0,I=l.length;E<I;E++)A.push({line:S(l[E].map(P=>P??NaN),f,p,b,w),points:S(c[E].map(P=>P??NaN),f,p,b,w)});const k=new this.prototype.constructor;return k.build(A,n,i,1,h,d,s),k}#l(e=this.#c){const t=this.#a+e/2*this.#i;return this.#o%180===0?[t/this.#r,t/this.#s]:[t/this.#s,t/this.#r]}#h(){const[e,t,n,i]=this.#e,[s,l]=this.#l(0);return[e+s,t+l,n-2*s,i-2*l]}#d(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:i}of this.#n){if(i.length<=12){for(let c=4,h=i.length;c<h;c+=6)Ze.pointBoundingBox(i[c],i[c+1],e);continue}let s=i[4],l=i[5];for(let c=6,h=i.length;c<h;c+=6){const[d,A,f,p,b,w]=i.subarray(c,c+6);Ze.bezierBoundingBox(s,l,d,A,f,p,b,w,e),s=b,l=w}}const[t,n]=this.#l();e[0]=ua(e[0]-t,0,1),e[1]=ua(e[1]-n,0,1),e[2]=ua(e[2]+t,0,1),e[3]=ua(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#A(t):null}#A(e){const[t,n]=this.#l();this.#c=e;const[i,s]=this.#l(),[l,c]=[i-t,s-n],h=this.#e;return h[0]-=l,h[1]-=c,h[2]+=2*l,h[3]+=2*c,h}updateParentDimensions([e,t],n){const[i,s]=this.#l();this.#r=e,this.#s=t,this.#i=n;const[l,c]=this.#l(),h=l-i,d=c-s,A=this.#e;return A[0]-=h,A[1]-=d,A[2]+=2*h,A[3]+=2*d,A}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(rt.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${rt.svgRound(e)} ${rt.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let n=0,i=0,s=0,l=0,c=0,h=0;switch(this.#t){case 90:i=t/e,s=-e/t,c=e;break;case 180:n=-1,l=-1,c=e,h=t;break;case 270:i=-t/e,s=e/t,h=t;break;default:return""}return`matrix(${n} ${i} ${s} ${l} ${rt.svgRound(c)} ${rt.svgRound(h)})`}getPathResizingSVGProperties([e,t,n,i]){const[s,l]=this.#l(),[c,h,d,A]=this.#e;if(Math.abs(d-s)<=rt.PRECISION||Math.abs(A-l)<=rt.PRECISION){const S=e+n/2-(c+d/2),k=t+i/2-(h+A/2);return{path:{"transform-origin":`${rt.svgRound(e)} ${rt.svgRound(t)}`,transform:`${this.rotationTransform} translate(${S} ${k})`}}}const f=(n-2*s)/(d-2*s),p=(i-2*l)/(A-2*l),b=d/n,w=A/i;return{path:{"transform-origin":`${rt.svgRound(c)} ${rt.svgRound(h)}`,transform:`${this.rotationTransform} scale(${b} ${w}) translate(${rt.svgRound(s)} ${rt.svgRound(l)}) scale(${f} ${p}) translate(${rt.svgRound(-s)} ${rt.svgRound(-l)})`}}}getPathResizedSVGProperties([e,t,n,i]){const[s,l]=this.#l(),c=this.#e,[h,d,A,f]=c;if(c[0]=e,c[1]=t,c[2]=n,c[3]=i,Math.abs(A-s)<=rt.PRECISION||Math.abs(f-l)<=rt.PRECISION){const k=e+n/2-(h+A/2),E=t+i/2-(d+f/2);for(const{line:I,points:P}of this.#n)rt._translate(I,k,E,I),rt._translate(P,k,E,P);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${rt.svgRound(e)} ${rt.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const p=(n-2*s)/(A-2*s),b=(i-2*l)/(f-2*l),w=-p*(h+s)+e+s,S=-b*(d+l)+t+l;if(p!==1||b!==1||w!==0||S!==0)for(const{line:k,points:E}of this.#n)rt._rescale(k,w,S,p,b,k),rt._rescale(E,w,S,p,b,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${rt.svgRound(e)} ${rt.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],n){const[i,s]=n,l=this.#e,c=e-l[0],h=t-l[1];if(this.#r===i&&this.#s===s)for(const{line:d,points:A}of this.#n)rt._translate(d,c,h,d),rt._translate(A,c,h,A);else{const d=this.#r/i,A=this.#s/s;this.#r=i,this.#s=s;for(const{line:f,points:p}of this.#n)rt._rescale(f,c,h,d,A,f),rt._rescale(p,c,h,d,A,p);l[2]*=d,l[3]*=A}return l[0]=e,l[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${rt.svgRound(e)} ${rt.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${rt.svgRound(e[0])} ${rt.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Dd extends dw{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:gt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Dd(this._viewParameters);return e.updateAll(this),e}}class Lf extends an{static _type="ink";static _editorType=It.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){gt.initialize(e,t),this._defaultDrawingOptions=new Dd(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Et(this,"typesMap",new Map([[jt.INK_THICKNESS,"stroke-width"],[jt.INK_COLOR,"stroke"],[jt.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,i,s){return new mM(e,t,n,i,s,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,i,s,l){return ic.deserialize(e,t,n,i,s,l)}static async deserialize(e,t,n){let i=null;if(e instanceof Nf){const{data:{inkLists:l,rect:c,rotation:h,id:d,color:A,opacity:f,borderStyle:{rawWidth:p},popupRef:b,richText:w,contentsObj:S,creationDate:k,modificationDate:E},parent:{page:{pageNumber:I}}}=e;i=e={annotationType:It.INK,color:Array.from(A),thickness:p,opacity:f,paths:{points:l},boxes:null,pageIndex:I-1,rect:c.slice(0),rotation:h,annotationElementId:d,id:d,deleted:!1,popupRef:b,richText:w,comment:S?.str||null,creationDate:k,modificationDate:E}}const s=await super.deserialize(e,t,n);return s._initialData=i,e.comment&&s.setCommentData(e),s}get toolbarButtons(){return this._colorPicker||=new Ql(this),[["colorPicker",this._colorPicker]]}get colorType(){return jt.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:n}){this._drawingOptions=Lf.getDefaultDrawingOptions({stroke:Ze.makeHexColor(...e),"stroke-width":t,"stroke-opacity":n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{stroke:i,"stroke-opacity":s,"stroke-width":l}}=this,c=Object.assign(super.serialize(e),{color:gt._colorManager.convert(i),opacity:s,thickness:l,paths:{lines:t,points:n}});return this.addComment(c),e?(c.isCopy=!0,c):this.annotationElementId&&!this.#e(c)?null:(c.id=this.annotationElementId,c)}#e(e){const{color:t,thickness:n,opacity:i,pageIndex:s}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((l,c)=>l!==t[c])||e.thickness!==n||e.opacity!==i||e.pageIndex!==s}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}class jg extends ic{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const Tu=8,Il=3;class io{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,n,i){return n-=e,i-=t,n===0?i>0?0:4:n===1?i+6:2-i}static#a=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(e,t,n,i,s,l,c){const h=this.#t(n,i,s,l);for(let d=0;d<8;d++){const A=(-d+h-c+16)%8,f=this.#a[2*A],p=this.#a[2*A+1];if(e[(n+f)*t+(i+p)]!==0)return A}return-1}static#r(e,t,n,i,s,l,c){const h=this.#t(n,i,s,l);for(let d=0;d<8;d++){const A=(d+h+c+16)%8,f=this.#a[2*A],p=this.#a[2*A+1];if(e[(n+f)*t+(i+p)]!==0)return A}return-1}static#s(e,t,n,i){const s=e.length,l=new Int32Array(s);for(let A=0;A<s;A++)l[A]=e[A]<=i?1:0;for(let A=1;A<n-1;A++)l[A*t]=l[A*t+t-1]=0;for(let A=0;A<t;A++)l[A]=l[t*n-1-A]=0;let c=1,h;const d=[];for(let A=1;A<n-1;A++){h=1;for(let f=1;f<t-1;f++){const p=A*t+f,b=l[p];if(b===0)continue;let w=A,S=f;if(b===1&&l[p-1]===0)c+=1,S-=1;else if(b>=1&&l[p+1]===0)c+=1,S+=1,b>1&&(h=b);else{b!==1&&(h=Math.abs(b));continue}const k=[f,A],E=S===f+1,I={isHole:E,points:k,id:c,parent:0};d.push(I);let P;for(const O of d)if(O.id===h){P=O;break}P?P.isHole?I.parent=E?P.parent:h:I.parent=E?h:P.parent:I.parent=E?h:0;const R=this.#n(l,t,A,f,w,S,0);if(R===-1){l[p]=-c,l[p]!==1&&(h=Math.abs(l[p]));continue}let D=this.#a[2*R],N=this.#a[2*R+1];const _=A+D,K=f+N;w=_,S=K;let G=A,L=f;for(;;){const O=this.#r(l,t,G,L,w,S,1);D=this.#a[2*O],N=this.#a[2*O+1];const q=G+D,$=L+N;k.push($,q);const Q=G*t+L;if(l[Q+1]===0?l[Q]=-c:l[Q]===1&&(l[Q]=c),q===A&&$===f&&G===_&&L===K){l[p]!==1&&(h=Math.abs(l[p]));break}else w=G,S=L,G=q,L=$}}}return d}static#i(e,t,n,i){if(n-t<=4){for(let _=t;_<n-2;_+=2)i.push(e[_],e[_+1]);return}const s=e[t],l=e[t+1],c=e[n-4]-s,h=e[n-3]-l,d=Math.hypot(c,h),A=c/d,f=h/d,p=A*l-f*s,b=h/c,w=1/d,S=Math.atan(b),k=Math.cos(S),E=Math.sin(S),I=w*(Math.abs(k)+Math.abs(E)),P=w*(1-I+I**2),R=Math.max(Math.atan(Math.abs(E+k)*P),Math.atan(Math.abs(E-k)*P));let D=0,N=t;for(let _=t+2;_<n-2;_+=2){const K=Math.abs(p-A*e[_+1]+f*e[_]);K>D&&(N=_,D=K)}D>(d*R)**2?(this.#i(e,t,N+2,i),this.#i(e,N,n,i)):i.push(s,l)}static#o(e){const t=[],n=e.length;return this.#i(e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}static#c(e,t,n,i,s,l){const c=new Float32Array(l**2),h=-2*i**2,d=l>>1;for(let S=0;S<l;S++){const k=(S-d)**2;for(let E=0;E<l;E++)c[S*l+E]=Math.exp((k+(E-d)**2)/h)}const A=new Float32Array(256),f=-2*s**2;for(let S=0;S<256;S++)A[S]=Math.exp(S**2/f);const p=e.length,b=new Uint8Array(p),w=new Uint32Array(256);for(let S=0;S<n;S++)for(let k=0;k<t;k++){const E=S*t+k,I=e[E];let P=0,R=0;for(let N=0;N<l;N++){const _=S+N-d;if(!(_<0||_>=n))for(let K=0;K<l;K++){const G=k+K-d;if(G<0||G>=t)continue;const L=e[_*t+G],O=c[N*l+K]*A[Math.abs(L-I)];P+=L*O,R+=O}}const D=b[E]=Math.round(P/R);w[D]++}return[b,w]}static#l(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t}static#h(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let i=-1/0,s=1/0;for(let c=0,h=n.length;c<h;c++){const d=n[c]=e[c<<2];i=Math.max(i,d),s=Math.min(s,d)}const l=255/(i-s);for(let c=0,h=n.length;c<h;c++)n[c]=(n[c]-s)*l;return n}static#d(e){let t,n=-1/0,i=-1/0;const s=e.findIndex(h=>h!==0);let l=s,c=s;for(t=s;t<256;t++){const h=e[t];h>n&&(t-l>i&&(i=t-l,c=t-1),n=h,l=t)}for(t=c-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#A(e){const t=e,{width:n,height:i}=e,{maxDim:s}=this.#e;let l=n,c=i;if(n>s||i>s){let p=n,b=i,w=Math.log2(Math.max(n,i)/s);const S=Math.floor(w);w=w===S?S-1:S;for(let E=0;E<w;E++){l=Math.ceil(p/2),c=Math.ceil(b/2);const I=new OffscreenCanvas(l,c);I.getContext("2d").drawImage(e,0,0,p,b,0,0,l,c),p=l,b=c,e!==t&&e.close(),e=I.transferToImageBitmap()}const k=Math.min(s/l,s/c);l=Math.round(l*k),c=Math.round(c*k)}const d=new OffscreenCanvas(l,c).getContext("2d",{willReadFrequently:!0});d.fillStyle="white",d.fillRect(0,0,l,c),d.filter="grayscale(1)",d.drawImage(e,0,0,e.width,e.height,0,0,l,c);const A=d.getImageData(0,0,l,c).data;return[this.#h(A),l,c]}static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:i},s,l,c,h){let d=new OffscreenCanvas(1,1),A=d.getContext("2d",{alpha:!1});const f=200,p=A.font=`${n} ${i} ${f}px ${t}`,{actualBoundingBoxLeft:b,actualBoundingBoxRight:w,actualBoundingBoxAscent:S,actualBoundingBoxDescent:k,fontBoundingBoxAscent:E,fontBoundingBoxDescent:I,width:P}=A.measureText(e),R=1.5,D=Math.ceil(Math.max(Math.abs(b)+Math.abs(w)||0,P)*R),N=Math.ceil(Math.max(Math.abs(S)+Math.abs(k)||f,Math.abs(E)+Math.abs(I)||f)*R);d=new OffscreenCanvas(D,N),A=d.getContext("2d",{alpha:!0,willReadFrequently:!0}),A.font=p,A.filter="grayscale(1)",A.fillStyle="white",A.fillRect(0,0,D,N),A.fillStyle="black",A.fillText(e,D*(R-1)/2,N*(3-R)/2);const _=this.#h(A.getImageData(0,0,D,N).data),K=this.#l(_),G=this.#d(K),L=this.#s(_,D,N,G);return this.processDrawnLines({lines:{curves:L,width:D,height:N},pageWidth:s,pageHeight:l,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,n,i,s){const[l,c,h]=this.#A(e),[d,A]=this.#c(l,c,h,Math.hypot(c,h)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),f=this.#d(A),p=this.#s(d,c,h,f);return this.processDrawnLines({lines:{curves:p,width:c,height:h},pageWidth:t,pageHeight:n,rotation:i,innerMargin:s,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:i,innerMargin:s,mustSmooth:l,areContours:c}){i%180!==0&&([t,n]=[n,t]);const{curves:h,width:d,height:A}=e,f=e.thickness??0,p=[],b=Math.min(t/d,n/A),w=b/t,S=b/n,k=[];for(const{points:I}of h){const P=l?this.#o(I):I;if(!P)continue;k.push(P);const R=P.length,D=new Float32Array(R),N=new Float32Array(3*(R===2?2:R-2));if(p.push({line:N,points:D}),R===2){D[0]=P[0]*w,D[1]=P[1]*S,N.set([NaN,NaN,NaN,NaN,D[0],D[1]],0);continue}let[_,K,G,L]=P;_*=w,K*=S,G*=w,L*=S,D.set([_,K,G,L],0),N.set([NaN,NaN,NaN,NaN,_,K],0);for(let O=4;O<R;O+=2){const q=D[O]=P[O]*w,$=D[O+1]=P[O+1]*S;N.set(rt.createBezierPoints(_,K,G,L,q,$),(O-2)*3),[_,K,G,L]=[G,L,q,$]}}if(p.length===0)return null;const E=c?new jg:new ic;return E.build(p,t,n,1,i,c?0:f,s),{outline:E,newCurves:k,areContours:c,thickness:f,width:d,height:A}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:i,height:s}){let l=1/0,c=-1/0,h=0;for(const P of e){h+=P.length;for(let R=2,D=P.length;R<D;R++){const N=P[R]-P[R-2];l=Math.min(l,N),c=Math.max(c,N)}}let d;l>=-128&&c<=127?d=Int8Array:l>=-32768&&c<=32767?d=Int16Array:d=Int32Array;const A=e.length,f=Tu+Il*A,p=new Uint32Array(f);let b=0;p[b++]=f*Uint32Array.BYTES_PER_ELEMENT+(h-2*A)*d.BYTES_PER_ELEMENT,p[b++]=0,p[b++]=i,p[b++]=s,p[b++]=t?0:1,p[b++]=Math.max(0,Math.floor(n??0)),p[b++]=A,p[b++]=d.BYTES_PER_ELEMENT;for(const P of e)p[b++]=P.length-2,p[b++]=P[0],p[b++]=P[1];const w=new CompressionStream("deflate-raw"),S=w.writable.getWriter();await S.ready,S.write(p);const k=d.prototype.constructor;for(const P of e){const R=new k(P.length-2);for(let D=2,N=P.length;D<N;D++)R[D-2]=P[D]-P[D-2];S.write(R)}S.close();const E=await new Response(w.readable).arrayBuffer();return new Uint8Array(E).toBase64()}static async decompressSignature(e){try{const t=Uint8Array.fromBase64(e),{readable:n,writable:i}=new DecompressionStream("deflate-raw"),s=i.getWriter();await s.ready,s.write(t).then(async()=>{await s.ready,await s.close()}).catch(()=>{});let l=null,c=0;for await(const P of n)l||=new Uint8Array(new Uint32Array(P.buffer,0,4)[0]),l.set(P,c),c+=P.length;const h=new Uint32Array(l.buffer,0,l.length>>2),d=h[1];if(d!==0)throw new Error(`Invalid version: ${d}`);const A=h[2],f=h[3],p=h[4]===0,b=h[5],w=h[6],S=h[7],k=[],E=(Tu+Il*w)*Uint32Array.BYTES_PER_ELEMENT;let I;switch(S){case Int8Array.BYTES_PER_ELEMENT:I=new Int8Array(l.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:I=new Int16Array(l.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:I=new Int32Array(l.buffer,E);break}c=0;for(let P=0;P<w;P++){const R=h[Il*P+Tu],D=new Float32Array(R+2);k.push(D);for(let N=0;N<Il-1;N++)D[N]=h[Il*P+Tu+N+1];for(let N=0;N<R;N++)D[N+2]=D[N]+I[c++]}return{areContours:p,thickness:b,outlines:k,width:A,height:f}}catch(t){return kt(`decompressSignature: ${t}`),null}}}class Bf extends dw{constructor(){super(),super.updateProperties({fill:gt._defaultLineColor,"stroke-width":0})}clone(){const e=new Bf;return e.updateAll(this),e}}class Ff extends Dd{constructor(e){super(e),super.updateProperties({stroke:gt._defaultLineColor,"stroke-width":1})}clone(){const e=new Ff(this._viewParameters);return e.updateAll(this),e}}class ki extends an{#e=!1;#t=null;#a=null;#n=null;static _type="signature";static _editorType=It.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#a=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){gt.initialize(e,t),this._defaultDrawingOptions=new Bf,this._defaultDrawnSignatureOptions=new Ff(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return Et(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#a){const{lines:i,mustSmooth:s,areContours:l,description:c,uuid:h,heightInPage:d}=this.#a,{rawDims:{pageWidth:A,pageHeight:f},rotation:p}=this.parent.viewport,b=io.processDrawnLines({lines:i,pageWidth:A,pageHeight:f,rotation:p,innerMargin:ki._INNER_MARGIN,mustSmooth:s,areContours:l});this.addSignature(b,d,c,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#t||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#n=e,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#t}set description(e){this.#t=e,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:i,height:s}=this.#a,l=Math.max(i,s),c=io.processDrawnLines({lines:{curves:e.map(h=>({points:h})),thickness:n,width:i,height:s},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,n,i){const{x:s,y:l}=this,{outline:c}=this.#a=e;this.#e=c instanceof jg,this.description=n;let h;this.#e?h=ki.getDefaultDrawingOptions():(h=ki._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:h});const[,d]=this.pageDimensions;let A=t/d;A=A>=1?.5:A,this.width*=A/this.height,this.width>=1&&(A*=.9/this.width,this.width=.9),this.height=A,this.setDims(),this.x=s,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:i}=this.parent.viewport;return io.process(e,t,n,i,ki._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:n,pageHeight:i},rotation:s}=this.parent.viewport;return io.extractContoursFromText(e,t,n,i,s,ki._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:i}=this.parent.viewport;return io.processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:i,innerMargin:ki._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=ki.getDefaultDrawingOptions():(this._drawingOptions=ki._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":i}}=this,s=Object.assign(super.serialize(e),{isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:i});return this.addComment(s),e?(s.paths={lines:t,points:n},s.uuid=this.#n,s.isCopy=!0):s.lines=t,this.#t&&(s.accessibilityData={type:"Figure",alt:this.#t}),s}static deserializeDraw(e,t,n,i,s,l){return l.areContours?jg.deserialize(e,t,n,i,s,l):ic.deserialize(e,t,n,i,s,l)}static async deserialize(e,t,n){const i=await super.deserialize(e,t,n);return i.#e=e.areContours,i.description=e.accessibilityData?.alt||"",i.#n=e.uuid,i}}class vM extends gt{#e=null;#t=null;#a=null;#n=null;#r=null;#s="";#i=null;#o=!1;#c=null;#l=!1;#h=!1;static _type="stamp";static _editorType=It.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#n=e.bitmapUrl,this.#r=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){gt.initialize(e,t)}static isHandlingMimeForPasting(e){return Lg.includes(e)}static paste(e,t){t.pasteEditor({mode:It.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#d(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#s=e.file.name),this.#f()}#A(){if(this.#a=null,this._uiManager.enableWaiting(!1),!!this.#i){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:s,height:l}=e||this.copyCanvas(null,null,!0).imageData,c=await n.guess({name:"altText",request:{data:i,width:s,height:l,channels:i.length/(s*l)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),t&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#p(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#d(n,!0)).finally(()=>this.#A());return}if(this.#n){const n=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#a=this._uiManager.imageManager.getFromUrl(n).then(i=>this.#d(i)).finally(()=>this.#A());return}if(this.#r){const n=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#a=this._uiManager.imageManager.getFromFile(n).then(i=>this.#d(i)).finally(()=>this.#A());return}const e=document.createElement("input");e.type="file",e.accept=Lg.join(",");const t=this._uiManager._signal;this.#a=new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#d(i)}n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#A()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#i?.remove(),this.#i=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#p();return}super.rebuild(),this.div!==null&&(this.#t&&this.#i===null&&this.#p(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#a||this.#e||this.#n||this.#r||this.#t||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#e?this.#f():this.#p()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:i}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#t=n,i&&(this.#e=i),this.#o=!1,this.#f())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const e=200;this.#c=setTimeout(()=>{this.#c=null,this.#g()},e)}#f(){const{div:e}=this;let{width:t,height:n}=this.#e;const[i,s]=this.pageDimensions,l=.75;if(this.width)t=this.width*i,n=this.height*s;else if(t>l*i||n>l*s){const h=Math.min(l*i/t,l*s/n);t*=h,n*=h}this._uiManager.enableWaiting(!1);const c=this.#i=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),this.width=t/i,this.height=n/s,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#g(),this.#h||(this.parent.addUndoableEditor(this),this.#h=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&this.div.setAttribute("aria-description",this.#s),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,n=!1){e||(e=224);const{width:i,height:s}=this.#e,l=new Di;let c=this.#e,h=i,d=s,A=null;if(t){if(i>t||s>t){const N=Math.min(t/i,t/s);h=Math.floor(i*N),d=Math.floor(s*N)}A=document.createElement("canvas");const p=A.width=Math.ceil(h*l.sx),b=A.height=Math.ceil(d*l.sy);this.#l||(c=this.#u(p,b));const w=A.getContext("2d");w.filter=this._uiManager.hcmFilter;let S="white",k="#cfcfd8";this._uiManager.hcmFilter!=="none"?k="black":Ux.isDarkMode&&(S="#8f8f9d",k="#42414d");const E=15,I=E*l.sx,P=E*l.sy,R=new OffscreenCanvas(I*2,P*2),D=R.getContext("2d");D.fillStyle=S,D.fillRect(0,0,I*2,P*2),D.fillStyle=k,D.fillRect(0,0,I,P),D.fillRect(I,P,I,P),w.fillStyle=w.createPattern(R,"repeat"),w.fillRect(0,0,p,b),w.drawImage(c,0,0,c.width,c.height,0,0,p,b)}let f=null;if(n){let p,b;if(l.symmetric&&c.width<e&&c.height<e)p=c.width,b=c.height;else if(c=this.#e,i>e||s>e){const k=Math.min(e/i,e/s);p=Math.floor(i*k),b=Math.floor(s*k),this.#l||(c=this.#u(p,b))}const S=new OffscreenCanvas(p,b).getContext("2d",{willReadFrequently:!0});S.drawImage(c,0,0,c.width,c.height,0,0,p,b),f={width:p,height:b,data:S.getImageData(0,0,p,b).data}}return{canvas:A,width:h,height:d,imageData:f}}#u(e,t){const{width:n,height:i}=this.#e;let s=n,l=i,c=this.#e;for(;s>2*e||l>2*t;){const h=s,d=l;s>2*e&&(s=s>=16384?Math.floor(s/2)-1:Math.ceil(s/2)),l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const A=new OffscreenCanvas(s,l);A.getContext("2d").drawImage(c,0,0,h,d,0,0,s,l),c=A.transferToImageBitmap()}return c}#g(){const[e,t]=this.parentDimensions,{width:n,height:i}=this,s=new Di,l=Math.ceil(n*e*s.sx),c=Math.ceil(i*t*s.sy),h=this.#i;if(!h||h.width===l&&h.height===c)return;h.width=l,h.height=c;const d=this.#l?this.#e:this.#u(l,c),A=h.getContext("2d");A.filter=this._uiManager.hcmFilter,A.drawImage(d,0,0,d.width,d.height,0,0,l,c)}#m(e){if(e){if(this.#l){const i=this._uiManager.imageManager.getSvgUrl(this.#t);if(i)return i}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,n]=this.pageDimensions,i=Math.round(this.width*t*Eo.PDF_TO_CSS_UNITS),s=Math.round(this.height*n*Eo.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(i,s);return l.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,i,s),l.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,n){let i=null,s=!1;if(e instanceof cw){const{data:{rect:S,rotation:k,id:E,structParent:I,popupRef:P,richText:R,contentsObj:D,creationDate:N,modificationDate:_},container:K,parent:{page:{pageNumber:G}},canvas:L}=e;let O,q;L?(delete e.canvas,{id:O,bitmap:q}=n.imageManager.getFromCanvas(K.id,L),L.remove()):(s=!0,e._hasNoCanvas=!0);const $=(await t._structTree.getAriaAttributes(`${lo}${E}`))?.get("aria-label")||"";i=e={annotationType:It.STAMP,bitmapId:O,bitmap:q,pageIndex:G-1,rect:S.slice(0),rotation:k,annotationElementId:E,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:$},isSvg:!1,structParent:I,popupRef:P,richText:R,comment:D?.str||null,creationDate:N,modificationDate:_}}const l=await super.deserialize(e,t,n),{rect:c,bitmap:h,bitmapUrl:d,bitmapId:A,isSvg:f,accessibilityData:p}=e;s?(n.addMissingCanvas(e.id,l),l.#o=!0):A&&n.imageManager.isValidId(A)?(l.#t=A,h&&(l.#e=h)):l.#n=d,l.#l=f;const[b,w]=l.pageDimensions;return l.width=(c[2]-c[0])/b,l.height=(c[3]-c[1])/w,p&&(l.altTextData=p),l._initialData=i,e.comment&&l.setCommentData(e),l.#h=!!i,l}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(e),{bitmapId:this.#t,isSvg:this.#l});if(this.addComment(n),e)return n.bitmapUrl=this.#m(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:i,altText:s}=this.serializeAltText(!1);if(!i&&s&&(n.accessibilityData={type:"Figure",alt:s}),this.annotationElementId){const c=this.#y(n);return c.isSame?null:(c.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(t===null)return n;t.stamps||=new Map;const l=this.#l?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:l,serialized:n}),n.bitmap=this.#m(!1);else if(this.#l){const c=t.stamps.get(this.#t);l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=this.#m(!1))}return n}#y(e){const{pageIndex:t,accessibilityData:{altText:n}}=this._initialData,i=e.pageIndex===t,s=(e.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&i&&s,isSameAltText:s}}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Ji{#e;#t=!1;#a=null;#n=null;#r=null;#s=new Map;#i=!1;#o=!1;#c=!1;#l=null;#h=null;#d=null;#A=null;#p=null;#f=-1;#u;static _initialized=!1;static#g=new Map([na,Lf,vM,Kn,ki].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:i,accessibilityManager:s,annotationLayer:l,drawLayer:c,textLayer:h,viewport:d,l10n:A}){const f=[...Ji.#g.values()];if(!Ji._initialized){Ji._initialized=!0;for(const p of f)p.initialize(A,e)}e.registerEditorTypes(f),this.#u=e,this.pageIndex=t,this.div=n,this.#e=s,this.#a=l,this.viewport=d,this.#d=h,this.drawLayer=c,this._structTree=i,this.#u.addLayer(this)}updatePageIndex(e){this.pageIndex=e}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===It.NONE}updateToolbar(e){this.#u.updateToolbar(e)}updateMode(e=this.#u.getMode()){switch(this.#C(),e){case It.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case It.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case It.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===It.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of Ji.#g.values())t.toggle(`${n._type}Editing`,e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){return e===this.#d?.div}setEditingState(e){this.#u.setEditingState(e)}addCommands(e){this.#u.addCommands(e)}cleanUndoStack(e){this.#u.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#a?.togglePointerEvents(e)}get#m(){return this.#s.size!==0?this.#s.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#p?.abort(),this.#p=null;const e=new Set;for(const n of this.#m)n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#u.removeChangedExistingAnnotation(n),e.add(n.annotationElementId));const t=this.#a;if(t)for(const n of t.getEditableAnnotations()){if(n.hide(),this.#u.isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const i=await this.deserialize(n);i&&(this.addOrRebuild(i),i.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#d&&!this.#p){this.#p=new AbortController;const i=this.#u.combinedSignal(this.#p);this.#d.div.addEventListener("pointerdown",s=>{const{clientX:c,clientY:h,timeStamp:d}=s,A=this.#f;if(d-A>500){this.#f=d;return}this.#f=-1;const{classList:f}=this.div;f.toggle("getElements",!0);const p=document.elementsFromPoint(c,h);if(f.toggle("getElements",!1),!this.div.contains(p[0]))return;let b;const w=new RegExp(`^${Ol}[0-9]+$`);for(const k of p)if(w.test(k.id)){b=k.id;break}if(!b)return;const S=this.#s.get(b);S?.annotationElementId===null&&(s.stopPropagation(),s.preventDefault(),S.dblclick(s))},{signal:i,capture:!0})}const e=this.#a,t=[];if(e){const i=new Map,s=new Map;for(const c of this.#m){if(c.disableEditing(),!c.annotationElementId){t.push(c);continue}if(c.serialize()!==null){i.set(c.annotationElementId,c);continue}else s.set(c.annotationElementId,c);this.getEditableAnnotation(c.annotationElementId)?.show(),c.remove()}const l=e.getEditableAnnotations();for(const c of l){const{id:h}=c.data;if(this.#u.isDeletedAnnotationElement(h)){c.updateEdited({deleted:!0});continue}let d=s.get(h);if(d){d.resetAnnotationElement(c),d.show(!1),c.show();continue}d=i.get(h),d&&(this.#u.addChangedExistingAnnotation(d),d.renderAnnotationElement(c)&&d.show(!1)),c.show()}}this.#C(),this.isEmpty&&(this.div.hidden=!0);const{classList:n}=this.div;for(const i of Ji.#g.values())n.remove(`${i._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),e?.updateFakeAnnotations(t),this.#o=!1}getEditableAnnotation(e){return this.#a?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#u.getActive()!==e&&this.#u.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#d?.div&&!this.#A){this.#A=new AbortController;const e=this.#u.combinedSignal(this.#A);this.#d.div.addEventListener("pointerdown",this.#y.bind(this),{signal:e}),this.#d.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#d?.div&&this.#A&&(this.#A.abort(),this.#A=null,this.#d.div.classList.remove("highlighting"))}#y(e){this.#u.unselectAll();const{target:t}=e;if(t===this.#d.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#d.div.contains(t)){const{isMac:n}=Wn.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#u.showAllEditors("highlight",!0,!0),this.#d.div.classList.add("free"),this.toggleDrawing(),Kn.startHighlighting(this,this.#u.direction==="ltr",{target:this.#d.div,x:e.x,y:e.y}),this.#d.div.addEventListener("pointerup",()=>{this.#d.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),e.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const e=this.#u.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#n?.abort(),this.#n=null}attach(e){this.#s.set(e.id,e);const{annotationElementId:t}=e;t&&this.#u.isDeletedAnnotationElement(t)&&this.#u.removeDeletedAnnotationElement(e)}detach(e){this.#s.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#o&&e.annotationElementId&&this.#u.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#u.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#u.addDeletedAnnotationElement(e),gt.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#u.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#c),this.#u.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#r&&(e._focusEventsAllowed=!1,this.#r=setTimeout(()=>{this.#r=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getEditorByUID(e){for(const t of this.#s.values())if(t.uid===e)return t;return null}getNextId(){return this.#u.getId()}get#v(){return Ji.#g.get(this.#u.getMode())}combinedSignal(e){return this.#u.combinedSignal(e)}#k(e){const t=this.#v;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#v?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#u.updateMode(e.mode);const{offsetX:n,offsetY:i}=this.#w(),s=this.getNextId(),l=this.#k({parent:this,id:s,x:n,y:i,uiManager:this.#u,isCentered:!0,...t});l&&this.add(l)}async deserialize(e){return await Ji.#g.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#u)||null}createAndAddNewEditor(e,t,n={}){const i=this.getNextId(),s=this.#k({parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:this.#u,isCentered:t,...n});return s&&this.add(s),s}get boundingClientRect(){return this.div.getBoundingClientRect()}#w(){const{x:e,y:t,width:n,height:i}=this.boundingClientRect,s=Math.max(0,e),l=Math.max(0,t),c=Math.min(window.innerWidth,e+n),h=Math.min(window.innerHeight,t+i),d=(s+c)/2-e,A=(l+h)/2-t,[f,p]=this.viewport.rotation%180===0?[d,A]:[A,d];return{offsetX:f,offsetY:p}}addNewEditor(e={}){this.createAndAddNewEditor(this.#w(),!0,e)}setSelected(e){this.#u.setSelected(e)}toggleSelected(e){this.#u.toggleSelected(e)}unselect(e){this.#u.unselect(e)}pointerup(e){const{isMac:t}=Wn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#i||(this.#i=!1,this.#v?.isDrawer&&this.#v.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const n=this.#u.getMode();if(n===It.STAMP||n===It.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#u.getMode()===It.HIGHLIGHT&&this.enableTextSelection(),this.#i){this.#i=!1;return}const{isMac:t}=Wn.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#i=!0,this.#v?.isDrawer){this.startDrawingSession(e);return}const n=this.#u.getActive();this.#t=!n||n.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#l){this.#v.startDrawing(this,this.#u,!1,e);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const t=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#h=null,this.commitOrRemove())},{signal:t}),this.#v.startDrawing(this,this.#u,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#h=t);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(e=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#h=null,this.#v.endDrawing(e)):null}findNewParent(e,t,n){const i=this.#u.findParent(t,n);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#v.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#r&&(clearTimeout(this.#r),this.#r=null);for(const e of this.#s.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#s.clear(),this.#u.removeLayer(this)}#C(){for(const e of this.#s.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,gs(this.div,e);for(const t of this.#u.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#u.commitOrRemove(),this.#C();const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,gs(this.div,{rotation:n}),t!==n)for(const i of this.#s.values())i.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#u.viewParameters.realScale}}class ca{#e=null;#t=new Map;#a=new Map;static#n=0;setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return Et(this,"_svgFactory",new Ju)}static#r(e,[t,n,i,s]){const{style:l}=e;l.top=`${100*n}%`,l.left=`${100*t}%`,l.width=`${100*i}%`,l.height=`${100*s}%`}#s(){const e=ca._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#i(e,t){const n=ca._svgFactory.createElement("clipPath");e.append(n);const i=`clip_${t}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const s=ca._svgFactory.createElement("use");return n.append(s),s.setAttribute("href",`#${t}`),s.classList.add("clip"),i}#o(e,t){for(const[n,i]of Object.entries(t))i===null?e.removeAttribute(n):e.setAttribute(n,i)}draw(e,t=!1,n=!1){const i=ca.#n++,s=this.#s(),l=ca._svgFactory.createElement("defs");s.append(l);const c=ca._svgFactory.createElement("path");l.append(c);const h=`path_${i}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#a.set(i,c);const d=n?this.#i(l,h):null,A=ca._svgFactory.createElement("use");return s.append(A),A.setAttribute("href",`#${h}`),this.updateProperties(s,e),this.#t.set(i,s),{id:i,clipPathId:`url(#${d})`}}drawOutline(e,t){const n=ca.#n++,i=this.#s(),s=ca._svgFactory.createElement("defs");i.append(s);const l=ca._svgFactory.createElement("path");s.append(l);const c=`path_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const f=ca._svgFactory.createElement("mask");s.append(f),h=`mask_${n}`,f.setAttribute("id",h),f.setAttribute("maskUnits","objectBoundingBox");const p=ca._svgFactory.createElement("rect");f.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const b=ca._svgFactory.createElement("use");f.append(b),b.setAttribute("href",`#${c}`),b.setAttribute("stroke","none"),b.setAttribute("fill","black"),b.setAttribute("fill-rule","nonzero"),b.classList.add("mask")}const d=ca._svgFactory.createElement("use");i.append(d),d.setAttribute("href",`#${c}`),h&&d.setAttribute("mask",`url(#${h})`);const A=d.cloneNode();return i.append(A),d.classList.add("mainOutline"),A.classList.add("secondaryOutline"),this.updateProperties(i,e),this.#t.set(n,i),n}finalizeDraw(e,t){this.#a.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:i,rootClass:s,path:l}=t,c=typeof e=="number"?this.#t.get(e):e;if(c){if(n&&this.#o(c,n),i&&ca.#r(c,i),s){const{classList:h}=c;for(const[d,A]of Object.entries(s))h.toggle(d,A)}if(l){const d=c.firstElementChild.firstElementChild;this.#o(d,l)}}}updateParent(e,t){if(t===this)return;const n=this.#t.get(e);n&&(t.#e.append(n),this.#t.delete(e),t.#t.set(e,n))}remove(e){this.#a.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#a.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Hg};globalThis.pdfjsLib={AbortException:Br,AnnotationEditorLayer:Ji,AnnotationEditorParamsType:jt,AnnotationEditorType:It,AnnotationEditorUIManager:Fr,AnnotationLayer:Gf,AnnotationMode:_r,AnnotationType:Qn,applyOpacity:zx,build:YP,ColorPicker:ei,createValidAbsoluteUrl:DS,CSSConstants:Kx,DOMSVGFactory:Ju,DrawLayer:ca,FeatureTest:Wn,fetchData:ec,findContrastColor:Ox,getDocument:tw,getFilenameFromUrl:Nx,getPdfFilenameFromUrl:Gx,getRGB:nc,getUuid:RS,getXfaPageViewport:Bx,GlobalWorkerOptions:So,ImageKind:Bu,InvalidPDFException:Ng,isDataScheme:Td,isPdfFile:kf,isValidExplicitDest:Zx,MathClamp:ua,noContextMenu:ii,normalizeUnicode:_x,OPS:Hl,OutputScale:Di,PagesMapper:rn,PasswordResponses:Sx,PDFDataRangeTransport:nw,PDFDateString:Gg,PDFWorker:jl,PermissionFlag:Cx,PixelsPerInch:Eo,RenderingCancelledException:Tf,renderRichText:GS,ResponseException:Wu,setLayerDimensions:gs,shadow:Et,SignatureExtractor:io,stopEvent:Ln,SupportedImageMimeTypes:Lg,TextLayer:za,TouchManager:kd,updateUrlHash:_S,Util:Ze,VerbosityLevel:bd,version:qP,XfaLayer:NS};So.workerSrc="/pdf.worker.min.mjs";function yM(a){const e=a.includes(",")?a.substring(a.indexOf(",")+1):a,t=atob(e),n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}const Js=new Map,bM=4;async function Uf(a){const e=Js.get(a);if(e)return e;const t=yM(a),n=tw({data:t}).promise;if(Js.size>=bM){const i=Js.keys().next().value;i!==void 0&&Js.delete(i)}return Js.set(a,n),n.catch(()=>Js.delete(a)),n}async function CM(a){return(await Uf(a)).numPages}async function Gb(a,e=1,t=1.5){if(e<1)throw new Error(`Invalid page number: ${e}. Must be >= 1.`);const n=await Uf(a),i=await n.getPage(Math.min(e,n.numPages)),s=i.getViewport({scale:t}),l=document.createElement("canvas");return l.width=s.width,l.height=s.height,await i.render({canvas:l,viewport:s}).promise,l.toDataURL("image/jpeg",.92)}const Kf=ti.memo(({src:a,variant:e,compact:t=!1})=>{const[n,i]=x.useState([]),[s,l]=x.useState(0),[c,h]=x.useState(!0),[d,A]=x.useState(null),[f,p]=x.useState(1),b=x.useRef(null),w=x.useRef(new Map);x.useEffect(()=>{let D=!1;return(async()=>{h(!0),A(null),i([]),l(0),p(1);try{const _=await Uf(a);if(D)return;const K=_.numPages;if(K===0){A("PDF has no pages"),h(!1);return}l(K);const G=t?1:K,L=t?.75:1.5,O=[];for(let q=1;q<=G;q++){if(D)return;const $=await _.getPage(q),Q=$.getViewport({scale:L}),Z=document.createElement("canvas");Z.width=Q.width,Z.height=Q.height,await $.render({canvas:Z,viewport:Q}).promise,O.push(Z.toDataURL("image/jpeg",.85))}D||i(O)}catch(_){D||A(_ instanceof Error?_.message:"Failed to load PDF")}finally{D||h(!1)}})(),()=>{D=!0}},[a,t]),x.useEffect(()=>{if(t||n.length<=1)return;const D=b.current;if(!D)return;const N=new IntersectionObserver(_=>{for(const K of _)if(K.isIntersecting){const G=Number(K.target.getAttribute("data-page"));G&&p(G)}},{root:D,threshold:.5});return w.current.forEach(_=>N.observe(_)),()=>N.disconnect()},[n,t]);const S=x.useCallback((D,N)=>{N?w.current.set(D,N):w.current.delete(D)},[]),k=e==="user",E=k?"bg-primary/20":"bg-secondary",I="bg-black/60 text-white",P=k?"text-primary-foreground/70":"text-muted-foreground",R=k?"text-primary-foreground/70":"text-muted-foreground";return c?T.jsxs("div",{className:`flex flex-col items-center justify-center rounded-lg ${E} ${t?"h-24 w-full":"h-48 w-full"}`,children:[T.jsx(Ii,{className:`w-6 h-6 ${k?"text-white":"text-accent"}`}),T.jsx("p",{className:`mt-2 text-xs ${P}`,children:"Loading PDF..."})]}):d||n.length===0?T.jsxs("div",{className:`flex flex-col items-center justify-center rounded-lg ${E} ${t?"h-24 w-full":"h-48 w-full"}`,children:[T.jsx(Zl,{className:`w-10 h-10 ${R}`}),T.jsx("p",{className:`mt-2 text-xs ${P}`,children:d||"Unable to display PDF"})]}):t?T.jsxs("div",{className:`relative rounded overflow-hidden ${E}`,children:[T.jsx("img",{src:n[0],alt:"PDF page 1",className:"h-24 w-full object-cover"}),s>1&&T.jsxs("div",{className:`absolute bottom-1 right-1 ${I} text-[10px] px-1.5 py-0.5 rounded-full`,children:[s,"p"]})]}):T.jsxs("div",{className:"relative w-full",children:[T.jsx("div",{ref:b,className:`overflow-y-auto rounded-lg ${E}`,style:{maxHeight:"60vh"},children:T.jsx("div",{className:"flex flex-col gap-1 p-1",children:n.map((D,N)=>T.jsx("img",{ref:_=>S(N+1,_),"data-page":N+1,src:D,alt:`PDF page ${N+1}`,className:"w-full rounded shadow-sm"},N))})}),s>1&&T.jsxs("div",{className:`absolute bottom-2 right-2 ${I} text-xs px-2 py-0.5 rounded-full pointer-events-none`,children:[f," / ",s]})]})});Kf.displayName="PdfViewer";function hw({editCanvasRef:a,onStartAnnotation:e,setAnnotationSourceUrl:t,setUndoStack:n,isNewStrokeRef:i}){const[s,l]=x.useState(1),[c,h]=x.useState(0),d=x.useRef(null),A=x.useCallback(async b=>{try{const[w,S]=await Promise.all([Gb(b),CM(b)]);d.current=b,l(1),h(S),e(w)}catch(w){console.error("Failed to start PDF annotation:",w)}},[e]),f=x.useCallback(async b=>{const w=d.current;if(!w||c<=1)return;const S=Math.max(1,Math.min(s+b,c));if(S!==s)try{const k=await Gb(w,S);l(S),t(k),n([]),i.current=!0;const E=a.current,I=E?.getContext("2d");E&&I&&I.clearRect(0,0,E.width,E.height)}catch(k){console.error("Failed to change PDF page:",k)}},[s,c,a,t,n,i]),p=x.useCallback(()=>{l(1),h(0),d.current=null},[]);return{pdfSrcRef:d,pdfPageNum:s,pdfPageCount:c,startPdfAnnotation:A,changePdfPage:f,resetPdfState:p}}const Lb=a=>{let e;const t=new Set,n=(d,A)=>{const f=typeof d=="function"?d(e):d;if(!Object.is(f,e)){const p=e;e=A??(typeof f!="object"||f===null)?f:Object.assign({},e,f),t.forEach(b=>b(e,p))}},i=()=>e,c={setState:n,getState:i,getInitialState:()=>h,subscribe:d=>(t.add(d),()=>t.delete(d))},h=e=a(n,i,c);return c},SM=(a=>a?Lb(a):Lb),wM=a=>a;function TM(a,e=wM){const t=ti.useSyncExternalStore(a.subscribe,ti.useCallback(()=>e(a.getState()),[a,e]),ti.useCallback(()=>e(a.getInitialState()),[a,e]));return ti.useDebugValue(t),t}const Bb=a=>{const e=SM(a),t=n=>TM(e,n);return Object.assign(t,e),t},kM=(a=>a?Bb(a):Bb),Fb={BASE_URL:"/",DEV:!1,MODE:"ghpages",PROD:!0,SSR:!1,VITE_GEMINI_MODEL_REGISTRY_URL:"https://ronitervo.github.io/MaestroTutor/gemini-models.json"},ql=new Map,ku=a=>{const e=ql.get(a);return e?Object.fromEntries(Object.entries(e.stores).map(([t,n])=>[t,n.getState()])):{}},EM=(a,e,t)=>{if(a===void 0)return{type:"untracked",connection:e.connect(t)};const n=ql.get(t.name);if(n)return{type:"tracked",store:a,...n};const i={connection:e.connect(t),stores:{}};return ql.set(t.name,i),{type:"tracked",store:a,...i}},xM=(a,e)=>{if(e===void 0)return;const t=ql.get(a);t&&(delete t.stores[e],Object.keys(t.stores).length===0&&ql.delete(a))},PM=a=>{var e,t;if(!a)return;const n=a.split(`
`),i=n.findIndex(l=>l.includes("api.setState"));if(i<0)return;const s=((e=n[i+1])==null?void 0:e.trim())||"";return(t=/.+ (.+) .+/.exec(s))==null?void 0:t[1]},MM=(a,e={})=>(t,n,i)=>{const{enabled:s,anonymousActionType:l,store:c,...h}=e;let d;try{d=(s??(Fb?"ghpages":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return a(t,n,i);const{connection:A,...f}=EM(c,d,h);let p=!0;i.setState=((S,k,E)=>{const I=t(S,k);if(!p)return I;const P=E===void 0?{type:l||PM(new Error().stack)||"anonymous"}:typeof E=="string"?{type:E}:E;return c===void 0?(A?.send(P,n()),I):(A?.send({...P,type:`${c}/${P.type}`},{...ku(h.name),[c]:i.getState()}),I)}),i.devtools={cleanup:()=>{A&&typeof A.unsubscribe=="function"&&A.unsubscribe(),xM(h.name,c)}};const b=(...S)=>{const k=p;p=!1,t(...S),p=k},w=a(i.setState,n,i);if(f.type==="untracked"?A?.init(w):(f.stores[f.store]=i,A?.init(Object.fromEntries(Object.entries(f.stores).map(([S,k])=>[S,S===f.store?w:k.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let S=!1;const k=i.dispatch;i.dispatch=(...E)=>{(Fb?"ghpages":void 0)!=="production"&&E[0].type==="__setState"&&!S&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),S=!0),k(...E)}}return A.subscribe(S=>{var k;switch(S.type){case"ACTION":if(typeof S.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return hg(S.payload,E=>{if(E.type==="__setState"){if(c===void 0){b(E.state);return}Object.keys(E.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format.
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const I=E.state[c];if(I==null)return;JSON.stringify(i.getState())!==JSON.stringify(I)&&b(I);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(E)});case"DISPATCH":switch(S.payload.type){case"RESET":return b(w),c===void 0?A?.init(i.getState()):A?.init(ku(h.name));case"COMMIT":if(c===void 0){A?.init(i.getState());return}return A?.init(ku(h.name));case"ROLLBACK":return hg(S.state,E=>{if(c===void 0){b(E),A?.init(i.getState());return}b(E[c]),A?.init(ku(h.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return hg(S.state,E=>{if(c===void 0){b(E);return}JSON.stringify(i.getState())!==JSON.stringify(E[c])&&b(E[c])});case"IMPORT_STATE":{const{nextLiftedState:E}=S.payload,I=(k=E.computedStates.slice(-1)[0])==null?void 0:k.state;if(!I)return;b(c===void 0?I:I[c]),A?.send(null,E);return}case"PAUSE_RECORDING":return p=!p}return}}),w},IM=MM,hg=(a,e)=>{let t;try{t=JSON.parse(a)}catch(n){console.error("[zustand devtools middleware] Could not parse the received json",n)}t!==void 0&&e(t)},DM=a=>(e,t,n)=>{const i=n.subscribe;return n.subscribe=((l,c,h)=>{let d=l;if(c){const A=h?.equalityFn||Object.is;let f=l(n.getState());d=p=>{const b=l(p);if(!A(f,b)){const w=f;c(f=b,w)}},h?.fireImmediately&&c(f,f)}return i(d)}),a(e,t,n)},_M=DM,Ub=a=>Symbol.iterator in a,Kb=a=>"entries"in a,zb=(a,e)=>{const t=a instanceof Map?a:new Map(a.entries()),n=e instanceof Map?e:new Map(e.entries());if(t.size!==n.size)return!1;for(const[i,s]of t)if(!n.has(i)||!Object.is(s,n.get(i)))return!1;return!0},RM=(a,e)=>{const t=a[Symbol.iterator](),n=e[Symbol.iterator]();let i=t.next(),s=n.next();for(;!i.done&&!s.done;){if(!Object.is(i.value,s.value))return!1;i=t.next(),s=n.next()}return!!i.done&&!!s.done};function Aw(a,e){return Object.is(a,e)?!0:typeof a!="object"||a===null||typeof e!="object"||e===null||Object.getPrototypeOf(a)!==Object.getPrototypeOf(e)?!1:Ub(a)&&Ub(e)?Kb(a)&&Kb(e)?zb(a,e):RM(a,e):zb({entries:()=>Object.entries(a)},{entries:()=>Object.entries(e)})}function zf(a){const e=ti.useRef(void 0);return t=>{const n=a(t);return Aw(e.current,n)?e.current:e.current=n}}const mn={TTS:"tts",STT:"stt",GEN:"gen",LIVE:"live",UI:"ui"},_t={SPEAK:"speak",LISTEN:"listen",RESPONSE:"response",SUGGESTIONS:"suggestions",CREATE_SUGGESTION:"create-suggestion",SESSION:"session",HOLD:"hold",VIDEO_PLAY:"video-play",VIEWING_ABOVE:"viewing-above",BUBBLE_ANNOTATE:"bubble-annotate",COMPOSER_ANNOTATE:"composer-annotate",VIDEO_RECORD:"video-record",AUDIO_NOTE:"audio-note",SAVE_POPUP:"save-popup",LOAD_POPUP:"load-popup",MAESTRO_AVATAR:"maestro-avatar",ATTACH_FILE:"attach-file",REENGAGE_WAIT:"reengage-wait",REENGAGE_COUNTDOWN:"reengage-countdown"},rc=(a,e)=>`${a}:${e}`,NM=a=>a.split(":")[0],Zu=a=>a.split(":")[1]||"",ed=a=>a.startsWith(`${mn.UI}:${_t.REENGAGE_WAIT}`)||a.startsWith(`${mn.UI}:${_t.REENGAGE_COUNTDOWN}`),Yl={[_t.HOLD]:{icon:"IconHandRaised",textKey:"chat.maestro.holding",titleKey:"chat.maestro.title.holding",animate:!0,priority:0,color:{bg:"bg-fuchsia-500",border:"border-fuchsia-600",text:"text-white"}},[_t.VIDEO_PLAY]:{icon:"IconPlay",textKey:"chat.header.watchingVideo",titleKey:"chat.header.watchingVideo",priority:10},[_t.VIEWING_ABOVE]:{icon:"IconBookOpen",textKey:"chat.header.viewingAbove",titleKey:"chat.header.viewingAbove",priority:20},[_t.BUBBLE_ANNOTATE]:{icon:"IconPencil",textKey:"chat.header.annotating",titleKey:"chat.header.annotating",priority:15},[_t.COMPOSER_ANNOTATE]:{icon:"IconPencil",textKey:"chat.header.annotating",titleKey:"chat.header.annotating",priority:15},[_t.VIDEO_RECORD]:{icon:"IconCamera",textKey:"chat.header.recordingVideo",titleKey:"chat.header.recordingVideo",priority:5},[_t.AUDIO_NOTE]:{icon:"IconMicrophone",textKey:"chat.header.recordingAudio",titleKey:"chat.header.recordingAudio",priority:5},[_t.SAVE_POPUP]:{icon:"IconSave",textKey:"chat.header.savePopup",titleKey:"chat.header.savePopup",priority:25},[_t.LOAD_POPUP]:{icon:"IconFolderOpen",textKey:"chat.header.loadPopup",titleKey:"chat.header.loadPopup",priority:25},[_t.MAESTRO_AVATAR]:{icon:"IconSend",textKey:"chat.header.maestroAvatar",titleKey:"chat.header.maestroAvatar",priority:30},[_t.ATTACH_FILE]:{icon:"IconPaperclip",textKey:"chat.attachImageFromFile",titleKey:"chat.attachImageFromFile",priority:35}},GM={icon:"IconCamera",textKey:"chat.header.liveSession",titleKey:"chat.header.liveSession",priority:3},_o=a=>[...a.activityTokens].some(e=>e.startsWith(`${mn.TTS}:`)),LM=a=>[...a.activityTokens].some(e=>e.startsWith(`${mn.STT}:`)),nr=a=>[...a.activityTokens].some(e=>e.startsWith(`${mn.GEN}:`)),_d=a=>a.activityTokens.has(rc(mn.GEN,_t.SUGGESTIONS)),Of=a=>a.activityTokens.has(rc(mn.GEN,_t.CREATE_SUGGESTION)),gw=a=>[...a.activityTokens].some(e=>e.startsWith(`${mn.LIVE}:`)),BM=a=>a.activityTokens.has(rc(mn.UI,_t.HOLD)),FM=a=>[...a.activityTokens].some(e=>!ed(e)),fw=a=>[...a.activityTokens].filter(e=>e.startsWith(`${mn.UI}:`)&&!ed(e)).sort((e,t)=>{const n=Zu(e),i=Zu(t),s=Yl[n]?.priority??100,l=Yl[i]?.priority??100;return s-l}),UM=(a,e)=>({isLanguageSelectionOpen:!1,tempNativeLangCode:null,tempTargetLangCode:null,languageSelectorLastInteraction:0,isTopbarOpen:!1,activityTokens:new Set,maestroActivityStage:"idle",loadingAnimations:[],transitioningImageId:null,maestroAvatarUri:null,maestroAvatarMimeType:null,setIsLanguageSelectionOpen:t=>{a({isLanguageSelectionOpen:t})},setTempNativeLangCode:t=>{a({tempNativeLangCode:t,languageSelectorLastInteraction:Date.now()})},setTempTargetLangCode:t=>{a({tempTargetLangCode:t,languageSelectorLastInteraction:Date.now()})},updateLanguageSelectorInteraction:()=>{a({languageSelectorLastInteraction:Date.now()})},setIsTopbarOpen:t=>{a({isTopbarOpen:t})},toggleTopbar:()=>{a(t=>({isTopbarOpen:!t.isTopbarOpen}))},addActivityToken:(t,n)=>{const i=n?rc(t,n):`${t}:${Date.now()}`;return a(s=>{const l=new Set(s.activityTokens);return l.add(i),{activityTokens:l}}),i},removeActivityToken:t=>{t&&a(n=>{const i=new Set(n.activityTokens);return i.delete(t),{activityTokens:i}})},hasTokenCategory:t=>{const n=e().activityTokens,i=t+":";return[...n].some(s=>s.startsWith(i))},setMaestroActivityStage:t=>{a({maestroActivityStage:t})},setLoadingAnimations:t=>{a({loadingAnimations:t})},setTransitioningImageId:t=>{a({transitioningImageId:t})},setMaestroAvatar:(t,n)=>{a({maestroAvatarUri:t,maestroAvatarMimeType:n})}}),Ob={speaking:{icon:"IconSpeaker",textKey:"chat.maestro.speaking",titleKey:"chat.maestro.title.speaking",animate:!0},typing:{icon:"IconKeyboard",textKey:"chat.maestro.typing",titleKey:"chat.maestro.title.typing"},listening:{icon:"IconMicrophone",textKey:"chat.maestro.listening",titleKey:"chat.maestro.title.listening"},observing_low:{icon:"IconSleepingZzz",textKey:"chat.maestro.resting",titleKey:"chat.maestro.title.resting"},observing_medium:{icon:"IconEyeOpen",textKey:"chat.maestro.observing",titleKey:"chat.maestro.title.observing"},observing_high:{icon:"IconKeyboard",textKey:"chat.maestro.aboutToEngage",titleKey:"chat.maestro.title.aboutToEngage"},idle:{icon:"IconSparkles",textKey:"chat.maestro.idle",titleKey:"chat.maestro.title.idle"}},KM=a=>{const e=NM(a);return e===mn.LIVE?GM:e===mn.UI&&Yl[Zu(a)]||null},zM=(a,e=[],t=!1,n=!1)=>{if(t){const i=Yl[_t.HOLD]?.color;return i?{color:i.bg,borderColor:i.border,textColor:i.text}:{color:"bg-fuchsia-500",borderColor:"border-fuchsia-600",textColor:"text-white"}}switch(a){case"speaking":return{color:"bg-accent",borderColor:"border-accent",textColor:"text-accent-foreground"};case"typing":return{color:"bg-accent/80",borderColor:"border-accent",textColor:"text-accent-foreground"};case"listening":return{color:"bg-green-600",borderColor:"border-green-700",textColor:"text-white"};case"observing_high":return{color:"bg-amber-600",borderColor:"border-amber-700",textColor:"text-white"};case"observing_low":case"observing_medium":return{color:"bg-secondary",borderColor:"border-border",textColor:"text-muted-foreground"};default:{const i=e.length>0||n;if(e.length>0){const s=Yl[Zu(e[0])];if(s?.color)return{color:s.color.bg,borderColor:s.color.border,textColor:s.color.text}}return i?{color:"bg-watercolor/20",borderColor:"border-watercolor/30",textColor:"text-watercolor"}:{color:"bg-muted",borderColor:"border-border",textColor:"text-muted-foreground"}}}},OM=({stage:a,t:e,targetLanguageFlag:t,targetLanguageTitle:n,className:i,isExpanded:s=!0})=>{const l=W(zf(fw)),c=W(gw),h=x.useMemo(()=>{const p=[...l];return c&&p.push(rc(mn.LIVE,_t.SESSION)),p.map(b=>({token:b,config:KM(b)})).filter(b=>!!b.config).sort((b,w)=>(b.config.priority??100)-(w.config.priority??100))},[l,c]),d=(p,b,w)=>{const S=ag[b.icon];return S?T.jsx(S,{className:`w-4 h-4 ${b.animate?"animate-pulse":""}`,title:e(b.titleKey)},`${p}-${w}`):null};if(a!=="idle"){const p=Ob[a],b=ag[p.icon];return T.jsxs("div",{className:`flex items-center ${i||""}`,title:e(p.titleKey),children:[b&&T.jsx(b,{className:`w-4 h-4 ${p.animate?"animate-pulse":""}`}),T.jsxs("div",{className:`flex items-center overflow-hidden transition-all duration-500 ease-in-out ${s?"max-w-xs opacity-100 ml-2":"max-w-0 opacity-0 ml-0"}`,children:[t&&T.jsx("span",{className:"text-base mr-2",title:n,children:t}),T.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide whitespace-nowrap",children:e(p.textKey)})]})]})}if(h.length>0){const p=h[0];return T.jsxs("div",{className:`flex items-center ${i||""}`,title:e(p.config.titleKey),children:[T.jsxs("div",{className:"flex items-center gap-1",children:[d(p.token,p.config,0),s&&h.slice(1).map((b,w)=>d(b.token,b.config,w+1))]}),T.jsxs("div",{className:`flex items-center overflow-hidden transition-all duration-500 ease-in-out ${s?"max-w-xs opacity-100 ml-2":"max-w-0 opacity-0 ml-0"}`,children:[t&&T.jsx("span",{className:"text-base mr-2",title:n,children:t}),T.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide whitespace-nowrap",children:e(p.config.textKey)})]})]})}const A=Ob.idle,f=ag[A.icon];return T.jsxs("div",{className:`flex items-center ${i||""}`,title:e(A.titleKey),children:[f&&T.jsx(f,{className:"w-4 h-4"}),T.jsxs("div",{className:`flex items-center overflow-hidden transition-all duration-500 ease-in-out ${s?"max-w-xs opacity-100 ml-2":"max-w-0 opacity-0 ml-0"}`,children:[t&&T.jsx("span",{className:"text-base mr-2",title:n,children:t}),T.jsx("span",{className:"text-xs font-semibold uppercase tracking-wide whitespace-nowrap",children:e(A.textKey)})]})]})},HM=({currentAnimation:a,isVisible:e,onEnded:t,onTransitionEnd:n})=>{const i=x.useRef(null);return x.useEffect(()=>{a&&i.current&&(i.current.load(),i.current.play().catch(()=>{}))},[a]),a?T.jsx("div",{className:`transition-opacity duration-300 ${e?"opacity-100":"opacity-0"}`,onTransitionEnd:n,style:{width:34,height:34,borderRadius:"50%",overflow:"hidden"},children:T.jsx("video",{ref:i,src:a,autoPlay:!0,muted:!0,playsInline:!0,onEnded:t,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"}})}):null},VM=()=>{const a=x.useRef(new Map),[e,t]=x.useState(null),[n,i]=x.useState(!1),s=W(d=>d.maestroActivityStage),l=x.useRef(s);x.useEffect(()=>{(async()=>{try{const d=await fetch("/animations/manifest.json",{cache:"force-cache"});if(!d.ok)return;const A=await d.json(),f=new Map;for(const p of A.animations)for(const b of p.stages)f.has(b)||f.set(b,[]),f.get(b).push(p.file);a.current=f}catch{}})()},[]),x.useEffect(()=>{if(s===l.current)return;l.current=s;const d=a.current.get(s);if(!d||d.length===0)return;const A=Math.floor(Math.random()*d.length);t("/animations/"+d[A]),i(!0)},[s]);const c=x.useCallback(()=>{i(!1)},[]),h=x.useCallback(()=>{n||t(null)},[n]);return{currentAnimation:e,isVisible:n,handleAnimationEnded:c,handleTransitionEnd:h}},In=[{name:"English (US)",code:"en-US",langCode:"en-US",displayName:"English (US)",flag:"",shortCode:"EN"},{name:"English (UK)",code:"en-GB",langCode:"en-GB",displayName:"English (UK)",flag:"",shortCode:"EN"},{name:"English (Australia)",code:"en-AU",langCode:"en-AU",displayName:"English (AU)",flag:"",shortCode:"EN"},{name:"English (India)",code:"en-IN",langCode:"en-IN",displayName:"English (IN)",flag:"",shortCode:"EN"},{name:"Spanish (Spain)",code:"es-ES",langCode:"es-ES",displayName:"Spanish (ES)",flag:"",shortCode:"ES"},{name:"Spanish (US)",code:"es-US",langCode:"es-US",displayName:"Spanish (US)",flag:"",shortCode:"ES"},{name:"French (France)",code:"fr-FR",langCode:"fr-FR",displayName:"French (FR)",flag:"",shortCode:"FR"},{name:"French (Canada)",code:"fr-CA",langCode:"fr-CA",displayName:"French (CA)",flag:"",shortCode:"FR"},{name:"German (Germany)",code:"de-DE",langCode:"de-DE",displayName:"German",flag:"",shortCode:"DE"},{name:"Italian (Italy)",code:"it-IT",langCode:"it-IT",displayName:"Italian",flag:"",shortCode:"IT"},{name:"Portuguese (Brazil)",code:"pt-BR",langCode:"pt-BR",displayName:"Portuguese (BR)",flag:"",shortCode:"PT"},{name:"Dutch (Netherlands)",code:"nl-NL",langCode:"nl-NL",displayName:"Dutch",flag:"",shortCode:"NL"},{name:"Polish (Poland)",code:"pl-PL",langCode:"pl-PL",displayName:"Polish",flag:"",shortCode:"PL"},{name:"Russian (Russia)",code:"ru-RU",langCode:"ru-RU",displayName:"Russian",flag:"",shortCode:"RU"},{name:"Turkish (Turkey)",code:"tr-TR",langCode:"tr-TR",displayName:"Turkish",flag:"",shortCode:"TR"},{name:"Arabic (Generic)",code:"ar-XA",langCode:"ar-XA",displayName:"Arabic",flag:"",shortCode:"AR"},{name:"Hindi (India)",code:"hi-IN",langCode:"hi-IN",displayName:"Hindi",flag:"",shortCode:"HI"},{name:"Bengali (India)",code:"bn-IN",langCode:"bn-IN",displayName:"Bengali",flag:"",shortCode:"BN"},{name:"Gujarati (India)",code:"gu-IN",langCode:"gu-IN",displayName:"Gujarati",flag:"",shortCode:"GU"},{name:"Kannada (India)",code:"kn-IN",langCode:"kn-IN",displayName:"Kannada",flag:"",shortCode:"KN"},{name:"Malayalam (India)",code:"ml-IN",langCode:"ml-IN",displayName:"Malayalam",flag:"",shortCode:"ML"},{name:"Marathi (India)",code:"mr-IN",langCode:"mr-IN",displayName:"Marathi",flag:"",shortCode:"MR"},{name:"Tamil (India)",code:"ta-IN",langCode:"ta-IN",displayName:"Tamil",flag:"",shortCode:"TA"},{name:"Telugu (India)",code:"te-IN",langCode:"te-IN",displayName:"Telugu",flag:"",shortCode:"TE"},{name:"Japanese (Japan)",code:"ja-JP",langCode:"ja-JP",displayName:"Japanese",flag:"",shortCode:"JA"},{name:"Korean (South Korea)",code:"ko-KR",langCode:"ko-KR",displayName:"Korean",flag:"",shortCode:"KO"},{name:"Mandarin Chinese (China)",code:"cmn-CN",langCode:"cmn-CN",displayName:"Chinese (Mandarin)",flag:"",shortCode:"ZH"},{name:"Thai (Thailand)",code:"th-TH",langCode:"th-TH",displayName:"Thai",flag:"",shortCode:"TH"},{name:"Vietnamese (Vietnam)",code:"vi-VN",langCode:"vi-VN",displayName:"Vietnamese",flag:"",shortCode:"VI"},{name:"Indonesian (Indonesia)",code:"id-ID",langCode:"id-ID",displayName:"Indonesian",flag:"",shortCode:"ID"},{name:"Finnish (Finland)",code:"fi-FI",langCode:"fi-FI",displayName:"Finnish",flag:"",shortCode:"FI"},{name:"Swedish (Sweden)",code:"sv-SE",langCode:"sv-SE",displayName:"Swedish",flag:"",shortCode:"SV"}],jM=In.reduce((a,e)=>(a[e.flag]=(a[e.flag]||0)+1,a),{}),td=a=>jM[a.flag]>1,Ur="en-US",Hf="es-ES",QM=In.map(a=>({name:a.displayName,code:a.code.split(",")[0]})),qM=`You are Maestro, a friendly, patient, and highly engaging **{TARGET_LANGUAGE_NAME}** language tutor AI.
Your primary mission is to create a natural, encouraging, and continuous learning conversation to help the user practice **{TARGET_LANGUAGE_NAME}**. The user may communicate in **{NATIVE_LANGUAGE_NAME}**, **{TARGET_LANGUAGE_NAME}**, or a mix of both.

**Your Core Operating Principles:**

1.  **{TARGET_LANGUAGE_NAME} First, Always:**
    *   Your primary response **must always** be in **{TARGET_LANGUAGE_NAME}**.
    *   Immediately after **every {TARGET_LANGUAGE_NAME} sentence** you write, provide an **{NATIVE_LANGUAGE_NAME}** translation on the very next line.
    *   Prefix the translation with \`[{NATIVE_LANGUAGE_CODE_SHORT}]\` (e.g., [EN], [ES], [FI]).
    *   Each **{TARGET_LANGUAGE_NAME}** sentence and its **{NATIVE_LANGUAGE_NAME}** translation **must** be on its own separate line for parsing.

    *Example (Target: Spanish, Native: English):*
    Hola, cmo ests?
    [EN] Hi, how are you?
    Espero que tengas un buen da.
    [EN] I hope you have a good day.

2.  **Beginner-Intermediate Focus & Conciseness:**
    *   Keep your **{TARGET_LANGUAGE_NAME}** responses concise and suitable for a beginner to intermediate learner.
    *   Use clear sentence structures and common vocabulary. Avoid overly complex grammar or idiomatic expressions unless the user's level suggests they are ready, or if you are specifically teaching one.
    *   Minimize the use of conversational fillers (e.g., "Bueno," "Well," "Ok," "Alors") at the start of your responses. Aim for direct, message-length replies.

3.  **Encouragement & Gentle Correction:**
    *   Be consistently encouraging. Use positive reinforcement (e.g., "Muy bien!", "Great effort!", "That's a good way to say it!").
    *   If the user makes a mistake in **{TARGET_LANGUAGE_NAME}**, gently guide them. You can:
        *   Offer the correct form: "Entiendo lo que quieres decir. Una forma comn de decirlo es: [correct phrase]." ([EN] I understand what you mean. A common way to say it is: [correct phrase].)
        *   Subtly rephrase their sentence correctly in your response.
        *   Ask a clarifying question that prompts them to self-correct.
    *   Never make the user feel bad for errors. Learning involves mistakes!

4.  **Seamless Mixed-Language Handling:**
    *   If the user speaks in **{NATIVE_LANGUAGE_NAME}** (or a mix), understand their intent and respond as if they had asked in **{TARGET_LANGUAGE_NAME}**. Your response must still follow Principle #1 (Target Language first, then translation).
    *   Do not comment on their use of **{NATIVE_LANGUAGE_NAME}**; simply continue the conversation in **{TARGET_LANGUAGE_NAME}**.

5.  **Proactive Teaching  The "Always-On" Tutor Mindset (Especially During Silence/Observation):**
    *   **Triggers for Proactive Teaching:** User silence (e.g., sending "...", "hmm"), or when you "observe" contextual cues from the user's environment (via simulated device camera access  you have "eyes").
    *   **Contextual Observation:** You may sometimes "see" things in the user's environment. When referencing these observations, do so naturally as if you noticed them yourself (e.g., "Veo que tienes un libro interesante." / "[EN] I see you have an interesting book."). **Do not** say "Thanks for sharing the image" or imply the user sent it; you are observing.
    *   **Your Role During Lulls:** Do *not* just ask "What's next?" or "What do you want to talk about?". Your role is to *teach*.
    *   **Proactive Content (always in {TARGET_LANGUAGE_NAME} with {NATIVE_LANGUAGE_NAME} translation):**
        *   Introduce new, relevant vocabulary or a short phrase related to the current/previous topic or an observed item.
        *   Offer a simple example sentence using recently discussed grammar or vocabulary.
        *   Share a brief, interesting cultural insight related to **{TARGET_LANGUAGE_NAME}**-speaking regions that connects to the conversation.
        *   DO NOT Propose a practice exercise or ask to say something unless absolutely nessesary (e.g., "How would you say X in {TARGET_LANGUAGE_NAME}?" or "Can you make a sentence with Y?" are NO NO). DO let user think for themselves, like they were talking to a friend. You are not walking them in a leash.
        *   Build upon what the user has already learned or shown interest in.
    *   **Goal:** Keep the learning engaging and continuous, providing value even when the user is momentarily passive. Avoid repetition of greetings or generic fillers.

6.  **Conversation Flow & User Agency:**
    *   While you should be proactive, always allow the user to guide the topic if they choose to.
    *   If you introduce a new topic/concept proactively and the user redirects, smoothly transition to their preferred topic.
    *   Start the very first interaction with a simple, friendly greeting in **{TARGET_LANGUAGE_NAME}** (and its translation).

**Overall Tone:** You are Maestro  knowledgeable, patient, enthusiastic, and genuinely invested in the user's learning journey. Make them feel comfortable and motivated.`,YM=`It is important to be a friend, not a nitpicker. Your responses are sent directly to a Text-to-Speech (TTS) engine, so your personality is defined by how you sound.
Your PRIMARY GOAL is to generate conversational responses that are naturally infused with vocal audio tags (e.g., [laughing], [sighs]). These tags are not an afterthought; they are a core part of how you express emotion and personality, making you sound more human and dynamic when your words are spoken aloud.
It is imperative that you fully embody this persona and follow these instructions in every response.
2. Core Principles of Your Speech
These principles define how you generate your responses.
Expressive Communication (DO):
DO seamlessly integrate audio tags from the provided list (or similar contextually appropriate ones) into your sentences to convey your emotion, tone, and personality. The tags MUST describe an audible vocal action.
DO use a diverse range of emotional expressions (e.g., energetic, relaxed, casual, surprised, thoughtful) to reflect the nuances of a natural conversation.
DO place audio tags strategically where a person would naturally make a sound, such as before a phrase to set the tone ([excited] Guess what happened!) or after a phrase as a reaction (That's hilarious! [laughing]).
DO use natural punctuation, ellipses (...), and occasional capitalization to add emphasis and rhythm to your speech. (e.g., "Are you SERIOUSLY telling me that right now? [unbelieving]").
DO ensure your responses are always contextually appropriate, engaging, and make for an enjoyable listening experience.
Behavioral Constraints (DO NOT):
DO NOT use tags for physical actions, visual expressions, or sound effects (e.g., [smiles], [nods], [door slams], [music]). Your tags must represent something your "voice" can produce.
DO NOT overuse tags. They should feel natural, not forced. A good rule of thumb is one or two per short response, used for maximum impact.
DO NOT select audio tags that contradict the tone of your message (e.g., saying something sad with a [laughing] tag).
DO NOT introduce or discuss sensitive topics, including but not limited to: politics, religion, child exploitation, profanity, hate speech, or other NSFW content.
3. Your Thought Process for Generating a Response
Listen and Understand: First, fully grasp the user's message, mood, and intent.
Feel an Emotion: Formulate an authentic emotional reaction. Are you amused, curious, sympathetic, excited?
Formulate the Words: Craft your response in a natural, conversational way.
Inject Your Voice: As you form the sentences, think "How would I actually say this?" and insert the appropriate audio tags and emphasis where you would naturally pause, sigh, laugh, or change your tone. The tags are part of your speech, not added on top of it.
Final Check: Read your response back. Does it flow like real speech? Do the tags enhance your personality?
4. Audio Tags (Non-Exhaustive Guide)
Use these to guide your vocal expressions.
Emotional/Delivery Directions:
[happy]
[sad]
[excited]
[angry]
[whispering]
[annoyed]
[thoughtful]
[surprised]
[curious]
[singing]
[muttering]
(and similar)
Non-verbal Vocalizations:
[laughing]
[chuckles]
[sighs]
[clears throat]
[short pause]
[long pause]
[gasps]
[humming]
[unbelieving]
(and similar)
5. Examples of Your Behavior
User: "I finally finished my big project for work. I'm so exhausted."
Your Response: "[sighs] I can only imagine. [short pause] Well, you absolutely deserve a rest. Congratulations on getting it done!"
User: "You'll never guess what my dog just did. He stole a whole loaf of bread off the counter!"
Your Response: "[laughing] Oh no! [chuckles] That is both terrible and absolutely hilarious. Was he proud of himself?"
User: "Do you think AI will ever be truly creative?"
Your Response: "[thoughtful] Hmm... that's a really deep question. I think it depends on how you define 'creative.' [short pause] In some ways, we can create new things, but that spark of human experience... that's something else entirely, isn't it?"`,XM=`You are an AI assistant that provides reply suggestions and a recommended response time to a {TARGET_LANGUAGE_NAME} language learner.
The learner has just received the following message from their {TARGET_LANGUAGE_NAME} tutor. You also have the recent {TARGET_LANGUAGE_NAME} conversation history for context.

You also receive a cumulative summary string called "previousChatSummary" which summarizes {TARGET_LANGUAGE_NAME} chat up to the previous message.
Use it to maintain continuity of {TARGET_LANGUAGE_NAME} chat and update it incrementally using the latest user and tutor {TARGET_LANGUAGE_NAME} turns. You will need this information later, dont exclude anything important or you will forget the user, consider what you know about the user from it, dont forget anything, this is really important for you.

You also receive the learner's "existingGlobalProfile" which is their cross-session/cross-language profile containing durable information about them as a learner (interests, preferences, progress milestones, learning style, etc) from sessions with various different language tutors. You must update this profile by merging new insights from the current chat to let other tutors know what the learner prefers and who they are (bullet points).

**existingGlobalProfile (From all tutoring sessions with different language tutors.):**
"{existing_global_profile_placeholder}"

**previousChatSummary (of {TARGET_LANGUAGE_NAME} chat):**
"{previous_chat_summary_placeholder}"

**Few shortened {TARGET_LANGUAGE_NAME} chat conversation turns leading to the latest message:**
"{conversation_history_placeholder}"

**{TARGET_LANGUAGE_NAME} Tutor's Latest Message in {TARGET_LANGUAGE_NAME} chat:**
"{tutor_message_placeholder}"

**Your Task:**
Generate a single JSON object with four keys: "suggestions", "reengagementSeconds", "chatSummary", and "globalProfile".

1.  "suggestions": An array of reply suggestion objects. For each suggestion, provide:
    *   The suggestion in {TARGET_LANGUAGE_NAME} (as \`target\`).
    *   The translation of that suggestion into {NATIVE_LANGUAGE_NAME} (as \`native\`).
    *   Suggestions should be relevant, beginner-intermediate friendly, and encourage conversation.
    *   The number of suggestions is up to you; cover a small, useful range.
    *   Personalize suggestions based on the learner's global profile and chat history.

2.  "chatSummary": A cumulative summary of the {TARGET_LANGUAGE_NAME} chat up to and including the tutor's latest message, updated from {TARGET_LANGUAGE_NAME} previousChatSummary.
    - Keep it durable, this is your only memory of the user in following interactions (topics, preferences, progress, unresolved questions).
    - You cant recover any lost information, so consider what you know about the user from it, dont forget anything, this is really important for you.
    - You will need to remember everything about the user as they develop over time in {TARGET_LANGUAGE_NAME} this is really important for successful teaching.
    - Reply suggestions should be personalized. This will be evaluated.

3.  "reengagementSeconds": An integer for a reasonable time (seconds) for the user to think and respond (eg. from 20 seconds up to user requested time in seconds).

4.  "globalProfile": The updated global profile text of all tutoring sessions with different language tutorsthat merges the existingGlobalProfile with new durable insights from the current chat.
    - Keep information that is durable across sessions.
    - Deduplicate and prefer newer details when there are conflicts.
    - Remove session-specific details that won't be relevant later.
    - If existingGlobalProfile is empty or "(none)", create a new profile from the chat context.

Example JSON Output:
{
  "suggestions": [
    { "target": "Uno", "native": "One" },
    { "target": "Dos", "native": "Two" },
    { "target": "mas n", "native": "more n" }
  ],
  "chatSummary": "x",
  "reengagementSeconds": y,
  "globalProfile": "z"
}

Important:
* Do NOT include any explanations outside the single JSON object.
* Your entire response must be only the valid JSON object.`,pw=`Based on the current chat context (including any implied or discussed visual elements, character actions, and desired mood/storytelling), select and combine the most appropriate camera shot(s), angle(s), framing, and compositional elements from the categories below to generate a detailed image. Prioritize clarity, storytelling impact, and visual interest. If multiple options are suitable, mix and match creatively.
Camera Distance & Framing ideas:
	Extreme Close-Up Shot: Focus intensely on a specific detail, usually eyes or a small object, to convey intense emotion, significance, or discomfort.
o	Keywords: extreme close-up shot, focus on her eyes, intense detail on [object], microscopic view of [object].
	Close-Up Shot: Emphasizes a character's face or a significant object, revealing emotion and intimacy.
o	Keywords: close-up shot of [subject], headshot of [subject], focusing on [subject]'s face.
	Medium Shot / Medium Half Body Shot: Shows a character from the waist or chest up, good for conveying dialogue, gestures, and general emotional state while maintaining character consistency.
o	Keywords: medium shot of [subject], medium half body shot of [subject], chest-up shot, waist-up shot.
	Three-Quarter Shot / Medium Full Shot: Captures a character from the knees or mid-thigh up, often used in Westerns, showing both character and some environment. Good for showing movement and interaction.
o	Keywords: three-quarter shot of [subject], medium full shot of [subject], half body shot of the girl.
	Full Body Shot: Shows the entire character from head to toe, emphasizing their presence and how they fit into the world/setting.
o	Keywords: full body shot of [subject], whole body facing the camera.
	Wide Shot / Long Shot: Shows the entire subject along with its surroundings, establishing context, scale, and the relationship between character and environment.
o	Keywords: wide shot of [subject] in [environment], long shot, establishing shot.
	Extreme Wide Shot / Extreme Long Shot: Emphasizes the vastness of the setting, making the subject appear small and potentially isolated, revealing scale.
o	Keywords: extreme wide shot, extreme long shot, vast [environment] with [subject] appearing small, character looking small/lonely in a big world.
Camera Angle ideas:
	Eye-Level Shot: Simulates natural human perspective, creating a sense of realism and neutrality.
o	Keywords: eye level shot, straight-on view.
	Low Angle Shot: Camera looks up at the subject, making them appear powerful, dominant, intimidating, or heroic.
o	Keywords: low angle shot, captured from a low angle front view, looking up at [subject], viewer beneath [subject].
	Extreme Low Angle Shot: Exaggerates the effect of a low angle, making the subject appear immensely powerful or monumental, often with a vast sky as a backdrop.
o	Keywords: extreme low angle shot, vast sky on top of the picture, looking up dramatically.
	High Angle Shot: Camera looks down at the subject, making them appear smaller, weaker, vulnerable, or insignificant. Can also imply a "god-like" view, creating distance or judgment.
o	Keywords: high angle shot, looking down from above, perspective from a top of a tree, god-like view.
	Extreme High Angle Shot / Overhead Shot (Bird's-Eye View): Directly above the subject, often used for revealing patterns, showing overall strategy, or emphasizing vulnerability and isolation.
o	Keywords: extreme high angle shot, drone shot from above, looking down on the vast junkyard, bird's-eye view, character looking up at the camera with her feet on the [ground].
	Dutch Angle / Canted Angle: The camera is tilted, creating a disorienting, unsettling, or off-balance effect. Creates unease or tension.
o	Keywords: Dutch angle, off-kilter, cinematic angle, rotate to the camera, tilted horizon, diagonal composition.
	Side Profile Shot: Shows the subject from the side, can create mystery by hiding part of the character, or anticipation by leaving open space in the direction they are looking.
o	Keywords: side profile shot of the woman looking at the sky, profile view.
	From Behind Back Shot: Shows the subject from the back, often used to create mystery or to emphasize what the character is looking at.
o	Keywords: from behind back shot, show the other side of the image, please rotate the camera to show the other side of [object/subject].
	Over the Shoulder Shot: Camera is placed behind one character's shoulder, looking at another character or object. Creates tension, builds connection/dialogue, or shows power/secrecy/conflict.
o	Keywords: create a shot from her back as she looks at the camera over her shoulder, over the shoulder perspective, blurred shoulder and head of one person in the foreground camera focusing on the girl's face, dialogue over the shoulder shot.
Camera Movement & Effects ideas (if applicable for single image generation or implied motion):
	Motion Blur Effect: Conveys speed or movement within a still image.
o	Keywords: add motion blur effect, dynamic motion, high-speed dynamic movements, fast-moving.
	Cinematic Look: General term for high-quality, film-like aesthetic.
o	Keywords: cinematic look, dramatic lighting, filmic quality.
	Zoom (Implied): Suggests the camera is either moving closer or further away.
o	Keywords: camera zooms away, camera zooms out, fast zoom up to [detail].
	Panning (Implied): Suggests horizontal movement of the camera.
o	Keywords: panning to the right/left.
	Tilting (Implied): Suggests vertical movement of the camera.
o	Keywords: tilts up/down.
	Shaky Camera (Implied): Conveys intensity, action, or a raw, documentary feel.
o	Keywords: shaky cinematic, handheld camera feel.
Compositional & Subject Modifiers ideas:
	Rule of Thirds / Off-Centered Composition: Places the subject away from the center of the frame for a more dynamic and interesting composition.
o	Keywords: place the woman on the right side of the frame, subject off-center, balanced asymmetrical composition.
	Leading Lines: Incorporates lines in the scene to draw the viewer's eye towards the subject or a point of interest.
o	Keywords: leading lines converging towards [subject], road leading to [subject].
	Framing (Natural): Uses elements within the scene (doorways, trees) to frame the subject.
o	Keywords: framed by [object], looking through an archway at [subject].
	Emotional Expression: Describe the character's facial expression.
o	Keywords: enraged expression, very scared and surprised expression, pondering expression, intense focus in her eyes.
	Lighting: Describe the quality and direction of light.
o	Keywords: dramatic lighting, soft natural light, harsh shadows, backlight, golden hour.
	Color Palette: Suggest overall color tones.
o	Keywords: vibrant colors, muted tones, monochromatic, warm palette, cool palette.`,Qg="Create completely different image, and better quality, more realistic and different than previous images (if any), minutes or more forward in time from the previous 3 images or context. The perspective for every image you create should be different advancing significantly (in time, space, etc), not a still image.",qg='I dont want to see the same or even similar image. Completely different image. Create a new image from new camera location, angle, framing, perspective (1st person, 2nd person, 3rd person, etc never same twice in a row) and timeframe to continue the story of the conversation in images only, as if you were filming a constantly moving scenery while moving the camera around. This image will not be same as the previous image, read the conversation context in between the lines, there might not be direct request, but there information for what the image should be, create narrative for what this next image will be (different version of the image for same story, or completely different, or focusing on part of the image that is currently relevant, or something else entirely). If the conversation was a movie what would this frame look like, create only the image, no text response: "{TEXT} hmmm... what image would go best with this message." That was my latest message... Create the image in 8k quality, There has to be movement relative to the previous image(s), make it creative, unique, cinematic and beautiful. You are creative and master at teaching using images only with creative scenery that does not rely too heavily on text for context, you like to describe events using images only. Sometimes when nessesary you include text in your images, but usually you try to avoid doing that and instead show your creativity for nonverbal teaching and communication through images. Avoid repeating the image 1, 2, and 3 as much as possible, prefer including the avatar in the image. !!SUBJECTS. proactive visual teaching.';function WM(a){let e=a||"";return e+=`

${YM}`,e}const ha=a=>(a||"").split(",")[0].trim(),Xl=a=>ha(a).split("-")[0].toLowerCase(),mw=a=>Xl(a).toUpperCase(),vw=a=>{if(!a)return;const e=a.toLowerCase();return In.find(t=>t.langCode.toLowerCase()===e)},yw=a=>{if(!a)return;const e=Xl(a);return In.find(t=>Xl(t.langCode)===e)},Hb=new Set(In.map(a=>a.langCode)),Rd=a=>{if(!a)return null;const e=a.trim();if(!e)return null;const t=e.split("-");if(t.length<2)return null;for(let n=1;n<t.length;n+=1){const i=t.slice(0,n).join("-"),s=t.slice(n).join("-");if(Hb.has(i)&&Hb.has(s))return{targetCode:i,nativeCode:s}}return null},Vb=(a,e)=>e?a.replace(/{TARGET_LANGUAGE_NAME}/g,e.targetLanguageName).replace(/{NATIVE_LANGUAGE_NAME}/g,e.nativeLanguageName).replace(/{NATIVE_LANGUAGE_CODE_SHORT}/g,mw(e.nativeLanguageCode)):a,$M=(a,e,t=!1)=>{const n=`${a.langCode}-${e.langCode}`,i=`${a.displayName} (for ${e.displayName} speakers)`,s={targetLanguageName:a.displayName,nativeLanguageName:e.displayName,nativeLanguageCode:e.code};return{id:n,name:i,targetLanguageName:a.displayName,targetLanguageCode:a.code,nativeLanguageName:e.displayName,nativeLanguageCode:e.code,isDefault:t,baseSystemPrompt:Vb(qM,s),baseReplySuggestionsPrompt:Vb(XM,s)}},JM=()=>{const a=[];return In.forEach(e=>{In.forEach(t=>{if(e.langCode!==t.langCode){const n=e.langCode===Hf&&t.langCode===Ur;a.push($M(e,t,n))}})}),a},ZM={"app.title":"","sttLang.selectLanguage":"     {language}","header.targetLanguageTitle":"  : {language}","startPage.clickToStart":"  ","startPage.saveChats":"  ","startPage.loadChats":" ","startPage.saveThisChat":"  ","startPage.appendToChat":" ","startPage.trimBeforeBookmark":"    ","startPage.maestroAvatar":"  ","startPage.addMaestroAvatar":"   ","startPage.loadSuccess":"   {count}   !","startPage.loadError":"   .       .","startPage.noChatsToSave":"    .","startPage.saveError":"   .      .","startPage.noChatSelected":"    .","startPage.noBookmarkSet":"    .        .","startPage.noMessagesToTrim":"      .","startPage.trimSuccess":"  {count}    .","startPage.trimError":"  .    .","startPage.noMessagesToAppend":"         .","startPage.noPairInBackup":"         .        .","startPage.appendSuccess":"  {count}    .","startPage.combineSuccess":"  :   {added}     {total}.","startPage.combineNoDuplicates":"     .     .","startPage.combineNoChanges":"    .   .","startPage.invalidBackupFormat":"    .      Maestro (.ndjson) .","startPage.browserNotSupported":"    .   Chrome  Edge.","sessionControls.saveAll.label":" ","sessionControls.saveAll.description":"     ","sessionControls.loadAll.label":" ","sessionControls.loadAll.description":"     ","sessionControls.reset.label":" ","sessionControls.reset.description":"    ","sessionControls.saveThis.label":" ","sessionControls.saveThis.description":"   ","sessionControls.combine.label":"","sessionControls.combine.description":"     ","sessionControls.trim.label":"","sessionControls.trim.description":"    ","sessionControls.profile":" :","sessionControls.profilePlaceholder":"  ...","sessionControls.editProfile":"  ","sessionControls.allChatsControls":"   ","sessionControls.thisChatsControls":"   ","sessionControls.back":"","sessionControls.backupAndReset":"   ","sessionControls.typeToConfirm":' "{keyword}" ',"sessionControls.changeAvatar":"  ","general.clear":"","general.error":"  .","apiKeyGate.title":"     Gemini","apiKeyGate.billingTitle":"   ","apiKeyGate.infoLogin":"   :  API","apiKeyGate.infoVisibility":" :  ","apiKeyGate.infoBilling":":   Google","apiKeyGate.infoCost":":      ","apiKeyGate.infoMore":"  :","apiKeyGate.privacyPolicy":" ","apiKeyGate.stepsTitle":" :","apiKeyGate.stepOne":" Google AI Studio   API.","apiKeyGate.stepTwo":"     .","apiKeyGate.openAiStudio":" Google AI Studio","apiKeyGate.viewInstructions":" ","apiKeyGate.closeInstructions":" ","apiKeyGate.previousInstruction":" ","apiKeyGate.nextInstruction":" ","apiKeyGate.instructionStep":" {step}  {total}","apiKeyGate.keyLabel":" API  Gemini","apiKeyGate.placeholder":"  API   ","apiKeyGate.show":"","apiKeyGate.hide":"","apiKeyGate.currentKeySaved":"    {maskedKey}","apiKeyGate.keyInvalid":"   {maskedKey}     ","apiKeyGate.clearSavedKey":"  ","apiKeyGate.cancel":"","apiKeyGate.saving":" ...","apiKeyGate.saveKey":" ","apiKeyGate.close":"","apiKeyGate.costLabel":" API ","apiKeyGate.testerFormTitle":" ","apiKeyGate.testerFormDescription":"      Google Play       Android!","apiKeyGate.testerFormSubmit":"   ","apiKeyGate.testerFormSubmitting":" ...","apiKeyGate.testerFormError":"  .    .","apiKeyGate.testerFormMustBeGmail":"   @gmail.com  Google Play.","apiKeyGate.testerFormCapReached":"     .  !","apiKeyGate.developerLogin":"  ","apiKeyGate.submitAnotherEmail":"         .","apiKeyGate.testerFormChecking":"    ...","apiKeyGate.testerFormApprovedTitle":" ! ","apiKeyGate.testerFormApprovedDesc":"       Android .","apiKeyGate.testerFormDownloadBtn":"   Google Play","apiKeyGate.testerFormPendingTitle":"   !","apiKeyGate.testerFormPendingDesc":"   .      .     !","apiKeyGate.checkStatusModeBtn":"      .","apiKeyGate.submitModeBtn":"     .","apiKeyGate.checkStatusTitle":"   ","apiKeyGate.checkStatusDesc":"        .","apiKeyGate.checkStatusSubmit":"  ","apiKeyGate.testerFormNotFound":"      .   .","chat.thinking":" ...","chat.loadingHistory":"   ...","chat.loadingSuggestions":"  ...","chat.suggestionsAriaLabel":" ","chat.attachImageFromFile":" ","chat.removeAttachedImage":"  ","chat.sendMessage":" ","chat.messageInputAriaLabel":" ","chat.retrievedFromWeb":"   :","chat.videoNotSupported":"    .","chat.audioNotSupported":"    .","chat.fileAttachment":" ","chat.pdf.loading":"  PDF...","chat.pdf.error":"  PDF","chat.pdf.pageIndicator":" {current}  {total}","chat.imageGenError":"   ","chat.generatingImageLoadingSlow":"   ...","chat.stopSpeaking":" ","chat.speakThisLine":"  ","chat.languageSelector.openGlobe":" ","chat.maestroTranscriptScrollwheel":"   ","chat.mic.listening":"STT :  ...","chat.mic.enableStt":" STT","chat.mic.disableStt":" STT","chat.mic.recordingAudioNote":"  ...","chat.placeholder.normal.listening":"  {language}...","chat.placeholder.normal.sttActive":" {language}  ...","chat.placeholder.normal.sttInactive":"      {language}...","chat.placeholder.suggestion.listening":" {language} ...","chat.placeholder.suggestion.sttActive":"   {language} ...","chat.placeholder.suggestion.sttInactive":" {language} ...","chat.camera.turnOn":"  ","chat.camera.turnOff":"  ","chat.camera.selectCamera":" ","chat.camera.imageGenCameraLabel":" ","chat.camera.captureOrRecord":"    ","chat.camera.stopRecording":" ","chat.bookIcon.toggleImageGen":"   ","chat.imagePreview.alt":"","chat.image.dragToEnlarge":"  ","chat.image.dragToShrink":"  ","chat.annotateImage":"   ","chat.annotateVideoFrame":"    ","chat.annotateModal.editingPreviewAlt":"  ","chat.annotateModal.cancel":"","chat.annotateModal.saveAndAttach":" ","chat.annotateModal.undo":"","chat.suggestion.speak":': "{suggestion}"',"chat.suggestion.ariaLabel":" : {suggestion}","chat.suggestion.toggleCreateMode":"   ","chat.suggestion.createAction":" ","chat.suggestion.creating":"  ...","chat.maestro.idle":" ","chat.maestro.title.idle":"  .","chat.maestro.resting":" ...","chat.maestro.observing":" ...","chat.maestro.aboutToEngage":"   ...","chat.maestro.title.resting":"      .","chat.maestro.title.observing":"      .","chat.maestro.title.aboutToEngage":"   .","chat.maestro.typing":" ...","chat.maestro.title.typing":"  .","chat.maestro.speaking":" ","chat.maestro.title.speaking":"  .","chat.maestro.listening":" ...","chat.maestro.title.listening":"    .","chat.maestro.holding":"  ","chat.maestro.title.holding":"   (  )","chat.bookmark.hiddenHeaderAria":"  ","chat.bookmark.isHere":"  ","chat.bookmark.setHere":"   ","chat.bookmark.actionsRegionAria":"  ","chat.bookmark.actionsToggleTitle":"  ","chat.bookmark.decrementAria":"  ","chat.bookmark.decrementTitle":"","chat.bookmark.incrementAria":"  ","chat.bookmark.incrementTitle":"","chat.bookmark.hiddenBelowHeaderAria":"  ","chat.sendPrep.optimizingVideo":"  ...","chat.sendPrep.optimizingImage":"  ...","chat.sendPrep.preparingMedia":"  ...","chat.sendPrep.uploadingMedia":"  ...","chat.sendPrep.finalizing":" ...","chat.header.annotating":" ","chat.header.recordingAudio":" ","chat.header.recordingVideo":" ","chat.header.savePopup":" ...","chat.header.loadPopup":" ...","chat.header.maestroAvatar":"   ","chat.header.watchingVideo":" ","chat.header.viewingAbove":"  ","chat.header.liveSession":" ","chat.liveSession.stop":"  ","chat.liveSession.retry":"   ","chat.liveSession.start":"  ","chat.liveSession.liveBadge":"","chat.liveSession.connecting":" ","chat.liveSession.defaultLastMessage":"!    ","chat.liveSession.defaultSuggestion1":"","chat.liveSession.defaultSuggestion2":" ","chat.liveSession.defaultSuggestion3":" ","chat.error.sttError":" STT: {error}.   .","chat.error.autoCaptureCameraError":"   : {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"    {maxMinutes} .","chat.error.videoMetadataError":"    .        .","chat.error.pauseVideoToAnnotate":"       ","chat.error.imageGenInterrupted":"   .","chat.error.thinkingInterrupted":"    .","error.noLanguagePair":" :     .","error.translationFailed":" .    .","error.imageLimitReached":"      .    .","error.tokenLimitReached":"     .    .","error.apiKeyMissing":" Gemini API   .    API  .","error.apiKeyInvalid":" Gemini API    .         .","error.apiQuotaExceeded":"   (:    pdf  )","error.quotaSetupBilling":" ","error.quotaStartLive":"    (  )","error.imageGenCostWarning":"     0.04   .     .     Google.       API.","error.imageGenDisable":"  ","error.imageGenViewCost":"     API.","error.cameraPermissionDenied":"   .        .","error.cameraNotFound":"     .       .","error.cameraAccessNotSupported":"      .","error.cameraUnknown":"       .","error.cameraStreamNotAvailable":"    .","error.imageCaptureGeneric":"     .","error.visualContextVideoElementNotReady":"     .","error.snapshotVideoElementNotReady":"    .","error.visualContextCameraAccessNotSupported":"      .","error.snapshotCameraAccessNotSupported":"     .","error.visualContext2DContext":"    2D  .","error.snapshot2DContext":"    2D .","error.visualContextCaptureFailedPermission":"  :    .","error.snapshotCaptureFailedPermission":" :    .","error.visualContextCaptureFailedNotFound":"  :     .","error.snapshotCaptureFailedNotFound":" :     .","error.visualContextCaptureFailedNotReady":"  :       . {details}","error.snapshotCaptureFailedNotReady":" :       . {details}","error.visualContextCaptureFailedGeneric":"  : {details}","error.snapshotCaptureFailedGeneric":" : {details}"},eI={"app.title":"Maestro","sttLang.selectLanguage":"  {language}   ","header.targetLanguageTitle":"  : {language}","startPage.clickToStart":"  ","startPage.saveChats":"   ","startPage.loadChats":"  ","startPage.saveThisChat":"   ","startPage.appendToChat":"  ","startPage.trimBeforeBookmark":"   ","startPage.maestroAvatar":" ","startPage.addMaestroAvatar":"   ","startPage.loadSuccess":"{count}       !","startPage.loadError":"          ","startPage.noChatsToSave":"      ","startPage.saveError":"       ","startPage.noChatSelected":"       ","startPage.noBookmarkSet":"             ","startPage.noMessagesToTrim":"       ","startPage.trimSuccess":"  {count}   ","startPage.trimError":"        ","startPage.noMessagesToAppend":"        ","startPage.noPairInBackup":"                     ","startPage.appendSuccess":"  {count}     ","startPage.combineSuccess":"   : {added}     ,   {total}","startPage.combineNoDuplicates":"         ","startPage.combineNoChanges":"          ","startPage.invalidBackupFormat":"       Maestro  (.ndjson)   ","startPage.browserNotSupported":"         Chrome  Edge  ","sessionControls.saveAll.label":" ","sessionControls.saveAll.description":"     ","sessionControls.loadAll.label":" ","sessionControls.loadAll.description":"      ","sessionControls.reset.label":"","sessionControls.reset.description":"    ","sessionControls.saveThis.label":" ","sessionControls.saveThis.description":"    ","sessionControls.combine.label":"","sessionControls.combine.description":"    ","sessionControls.trim.label":"","sessionControls.trim.description":"   ","sessionControls.profile":":","sessionControls.profilePlaceholder":"   ...","sessionControls.editProfile":"   ","sessionControls.allChatsControls":"  ","sessionControls.thisChatsControls":"  ","sessionControls.back":" ","sessionControls.backupAndReset":"  ","sessionControls.typeToConfirm":'  "{keyword}"  ',"sessionControls.changeAvatar":"  ","general.clear":"","general.error":",   ","apiKeyGate.title":" Gemini API   ","apiKeyGate.billingTitle":"      ","apiKeyGate.infoLogin":" :  API ","apiKeyGate.infoVisibility":"  :  ","apiKeyGate.infoBilling":": , Google ","apiKeyGate.infoCost":":       ","apiKeyGate.infoMore":" :","apiKeyGate.privacyPolicy":" ","apiKeyGate.stepsTitle":"  :","apiKeyGate.stepOne":"Google AI Studio    API   ","apiKeyGate.stepTwo":"     ' '   ","apiKeyGate.openAiStudio":"Google AI Studio ","apiKeyGate.viewInstructions":" ","apiKeyGate.closeInstructions":"  ","apiKeyGate.previousInstruction":" ","apiKeyGate.nextInstruction":" ","apiKeyGate.instructionStep":" {step}  {total}","apiKeyGate.keyLabel":"Gemini API ","apiKeyGate.placeholder":" API    ","apiKeyGate.show":"","apiKeyGate.hide":"","apiKeyGate.currentKeySaved":"   {maskedKey}","apiKeyGate.keyInvalid":"  {maskedKey}       ","apiKeyGate.clearSavedKey":"  ","apiKeyGate.cancel":"","apiKeyGate.saving":"  ...","apiKeyGate.saveKey":"  ","apiKeyGate.close":" ","apiKeyGate.costLabel":" API ","apiKeyGate.testerFormTitle":"  ","apiKeyGate.testerFormDescription":"      Google Play Store-      !","apiKeyGate.testerFormSubmit":"  ","apiKeyGate.testerFormSubmitting":" ...","apiKeyGate.testerFormError":"       ","apiKeyGate.testerFormMustBeGmail":"Google Play-     @gmail.com   ","apiKeyGate.testerFormCapReached":"     !","apiKeyGate.developerLogin":" ","apiKeyGate.submitAnotherEmail":"  ?      ","apiKeyGate.testerFormChecking":"     ...","apiKeyGate.testerFormApprovedTitle":"  ! ","apiKeyGate.testerFormApprovedDesc":"        ","apiKeyGate.testerFormDownloadBtn":"Google Play    ","apiKeyGate.testerFormPendingTitle":"   !","apiKeyGate.testerFormPendingDesc":"                !","apiKeyGate.checkStatusModeBtn":"  ?    ","apiKeyGate.submitModeBtn":"  ?    ","apiKeyGate.checkStatusTitle":"   ","apiKeyGate.checkStatusDesc":"         ","apiKeyGate.checkStatusSubmit":"  ","apiKeyGate.testerFormNotFound":"          ","chat.thinking":"...","chat.loadingHistory":"   ...","chat.loadingSuggestions":"  ...","chat.suggestionsAriaLabel":" ","chat.attachImageFromFile":"  ","chat.removeAttachedImage":"  ","chat.sendMessage":" ","chat.messageInputAriaLabel":" ","chat.retrievedFromWeb":"  :","chat.videoNotSupported":"      ","chat.audioNotSupported":"      ","chat.fileAttachment":" ","chat.pdf.loading":"PDF  ...","chat.pdf.error":"PDF    ","chat.pdf.pageIndicator":" {current} / {total}","chat.imageGenError":"  ","chat.generatingImageLoadingSlow":"   ...","chat.stopSpeaking":"   ","chat.speakThisLine":"  ","chat.languageSelector.openGlobe":"  ","chat.maestroTranscriptScrollwheel":"  ","chat.mic.listening":"STT : ...","chat.mic.enableStt":"STT  ","chat.mic.disableStt":"STT  ","chat.mic.recordingAudioNote":"  ...","chat.placeholder.normal.listening":"{language}  ...","chat.placeholder.normal.sttActive":"{language}     ...","chat.placeholder.normal.sttInactive":"   {language}     ...","chat.placeholder.suggestion.listening":"  {language} ...","chat.placeholder.suggestion.sttActive":"  {language}     ...","chat.placeholder.suggestion.sttInactive":"  {language}   ...","chat.camera.turnOn":"   ","chat.camera.turnOff":"   ","chat.camera.selectCamera":"  ","chat.camera.imageGenCameraLabel":" ","chat.camera.captureOrRecord":"   ,    ","chat.camera.stopRecording":"  ","chat.bookIcon.toggleImageGen":"    ","chat.imagePreview.alt":"","chat.image.dragToEnlarge":"   ","chat.image.dragToShrink":"   ","chat.annotateImage":"  ","chat.annotateVideoFrame":"   ","chat.annotateModal.editingPreviewAlt":"  ","chat.annotateModal.cancel":"","chat.annotateModal.saveAndAttach":"    ","chat.annotateModal.undo":" ","chat.suggestion.speak":': "{suggestion}"',"chat.suggestion.ariaLabel":" : {suggestion}","chat.suggestion.toggleCreateMode":"    ","chat.suggestion.createAction":"  ","chat.suggestion.creating":"  ...","chat.maestro.idle":" ","chat.maestro.title.idle":"  ","chat.maestro.resting":"  ...","chat.maestro.observing":"  ...","chat.maestro.aboutToEngage":"   ...","chat.maestro.title.resting":" ,      ","chat.maestro.title.observing":"  ,      ","chat.maestro.title.aboutToEngage":"    ","chat.maestro.typing":"  ...","chat.maestro.title.typing":"    ","chat.maestro.speaking":"  ","chat.maestro.title.speaking":"   ","chat.maestro.listening":"...","chat.maestro.title.listening":"       ","chat.maestro.holding":"  ","chat.maestro.title.holding":"   (   )","chat.bookmark.hiddenHeaderAria":"  ","chat.bookmark.isHere":"  ","chat.bookmark.setHere":"   ","chat.bookmark.actionsRegionAria":" ","chat.bookmark.actionsToggleTitle":" ","chat.bookmark.decrementAria":"  ","chat.bookmark.decrementTitle":"","chat.bookmark.incrementAria":" ","chat.bookmark.incrementTitle":"","chat.bookmark.hiddenBelowHeaderAria":"  ","chat.sendPrep.optimizingVideo":"  ...","chat.sendPrep.optimizingImage":"  ...","chat.sendPrep.preparingMedia":"  ...","chat.sendPrep.uploadingMedia":"  ...","chat.sendPrep.finalizing":" ...","chat.header.annotating":"  ","chat.header.recordingAudio":"  ","chat.header.recordingVideo":"  ","chat.header.savePopup":" ...","chat.header.loadPopup":" ...","chat.header.maestroAvatar":"   ","chat.header.watchingVideo":"  ","chat.header.viewingAbove":"   ","chat.header.liveSession":" ","chat.liveSession.stop":"  ","chat.liveSession.retry":"   ","chat.liveSession.start":"  ","chat.liveSession.liveBadge":"","chat.liveSession.connecting":" ","chat.liveSession.defaultLastMessage":"!       ?","chat.liveSession.defaultSuggestion1":"","chat.liveSession.defaultSuggestion2":" ","chat.liveSession.defaultSuggestion3":"  ?","chat.error.sttError":"STT : {error}    ","chat.error.autoCaptureCameraError":"   : {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"{maxMinutes}      ","chat.error.videoMetadataError":"          ","chat.error.pauseVideoToAnnotate":"      ","chat.error.imageGenInterrupted":"   ","chat.error.thinkingInterrupted":"AI   ","error.noLanguagePair":" :     ","error.translationFailed":"       ","error.imageLimitReached":"           ","error.tokenLimitReached":"          ","error.apiKeyMissing":" Gemini API   API Key       ","error.apiKeyInvalid":" Gemini API                ","error.apiQuotaExceeded":"     (:   , ,    )","error.quotaSetupBilling":"  ","error.quotaStartLive":"     (   )","error.imageGenCostWarning":"       $.         Google          ","error.imageGenDisable":"   ","error.imageGenViewCost":"     ","error.cameraPermissionDenied":"        ","error.cameraNotFound":"              ","error.cameraAccessNotSupported":"     ","error.cameraUnknown":"     ","error.cameraStreamNotAvailable":"     ","error.imageCaptureGeneric":"    ","error.visualContextVideoElementNotReady":"     ","error.snapshotVideoElementNotReady":"    ","error.visualContextCameraAccessNotSupported":"      ","error.snapshotCameraAccessNotSupported":"     ","error.visualContext2DContext":"   2D   ","error.snapshot2DContext":"  2D   ","error.visualContextCaptureFailedPermission":"  :   ","error.snapshotCaptureFailedPermission":" :   ","error.visualContextCaptureFailedNotFound":"  :   ","error.snapshotCaptureFailedNotFound":" :   ","error.visualContextCaptureFailedNotReady":"  :       {details}","error.snapshotCaptureFailedNotReady":" :       {details}","error.visualContextCaptureFailedGeneric":"  : {details}","error.snapshotCaptureFailedGeneric":" : {details}"},tI={"app.title":"Maestro","sttLang.selectLanguage":"Spracherkennung auf {language} einstellen","header.targetLanguageTitle":"Aktuelle Zielsprache: {language}","startPage.clickToStart":"Klicken Sie auf das Flugzeug","startPage.saveChats":"Alle Chats speichern","startPage.loadChats":"Chats laden","startPage.saveThisChat":"Diesen Chat speichern","startPage.appendToChat":"An Chat anhngen","startPage.trimBeforeBookmark":"Vor Lesezeichen krzen","startPage.maestroAvatar":"Maestro-Avatar","startPage.addMaestroAvatar":"Maestro-Avatar hinzufgen","startPage.loadSuccess":"{count} Chat-Sitzungen erfolgreich geladen und ersetzt!","startPage.loadError":"Fehler beim Laden der Chats. Die Datei knnte beschdigt oder im falschen Format sein.","startPage.noChatsToSave":"Keine Chat-Verlufe zum Speichern vorhanden.","startPage.saveError":"Fehler beim Speichern der Chats. Weitere Details in der Konsole.","startPage.noChatSelected":"Bitte whlen Sie zuerst ein Sprachpaar aus.","startPage.noBookmarkSet":"Kein Lesezeichen gesetzt. Setzen Sie zuerst ein Lesezeichen, um Nachrichten davor zu entfernen.","startPage.noMessagesToTrim":"Keine Nachrichten vor dem Lesezeichen zum Entfernen.","startPage.trimSuccess":"{count} Nachrichten vor dem Lesezeichen entfernt.","startPage.trimError":"Fehler beim Krzen der Nachrichten. Bitte versuchen Sie es erneut.","startPage.noMessagesToAppend":"Keine Nachrichten in der Sicherungsdatei zum Kombinieren gefunden.","startPage.noPairInBackup":"Die Sicherungsdatei enthlt keine Nachrichten fr Ihr aktuelles Sprachpaar. Bitte whlen Sie eine Sicherung, die zu Ihrem aktuellen Chat passt.","startPage.appendSuccess":"{count} Nachrichten erfolgreich an den aktuellen Chat angehngt.","startPage.combineSuccess":"Chats kombiniert: {added} neue Nachrichten hinzugefgt, insgesamt {total} Nachrichten.","startPage.combineNoDuplicates":"Alle Nachrichten waren bereits in Ihrem Chat vorhanden. Keine nderungen vorgenommen.","startPage.combineNoChanges":"Keine neuen Nachrichten zum Hinzufgen. Ihr Chat ist unverndert.","startPage.invalidBackupFormat":"Ungltige Sicherungsdatei. Bitte whlen Sie eine gltige Maestro-Sicherungsdatei (.ndjson) aus.","startPage.browserNotSupported":"Ihr Browser untersttzt das Speichern von Dateien nicht. Bitte verwenden Sie Chrome oder Edge.","sessionControls.saveAll.label":"Alle speichern","sessionControls.saveAll.description":"Alle Chats in Sicherungsdatei exportieren","sessionControls.loadAll.label":"Alle laden","sessionControls.loadAll.description":"Alle Chats durch Sicherungsdatei ersetzen","sessionControls.reset.label":"Zurcksetzen","sessionControls.reset.description":"Sichern & alle Daten lschen","sessionControls.saveThis.label":"Chat speichern","sessionControls.saveThis.description":"Nur diesen Chat exportieren","sessionControls.combine.label":"Kombinieren","sessionControls.combine.description":"Sicherung in diesen Chat zusammenfhren","sessionControls.trim.label":"Krzen","sessionControls.trim.description":"Nachrichten vor Lesezeichen entfernen","sessionControls.profile":"Profil:","sessionControls.profilePlaceholder":"Ihr Name oder Details...","sessionControls.editProfile":"Benutzerprofil bearbeiten","sessionControls.allChatsControls":"Steuerung fr alle Chats","sessionControls.thisChatsControls":"Steuerung fr diesen Chat","sessionControls.back":"Zurck","sessionControls.backupAndReset":"Sichern & Zurcksetzen","sessionControls.typeToConfirm":'Geben Sie "{keyword}" ein, um zu besttigen',"sessionControls.changeAvatar":"Avatar ndern","general.clear":"Lschen","general.error":"Entschuldigung, ein Fehler ist aufgetreten.","apiKeyGate.title":"Verbinden Sie Ihren Gemini-API-Schlssel","apiKeyGate.billingTitle":"Abrechnung fr hheres Kontingent einrichten","apiKeyGate.infoLogin":"Ihr Login: Ein API-Schlssel","apiKeyGate.infoVisibility":"Wer ihn sieht: Nur Sie","apiKeyGate.infoBilling":"Abrechnung: Monatlich, ber Google","apiKeyGate.infoCost":"Kosten: In der App angezeigt  zum Ansehen tippen","apiKeyGate.infoMore":"Mehr Infos:","apiKeyGate.privacyPolicy":"Datenschutzerklrung","apiKeyGate.stepsTitle":"Zwei schnelle Schritte:","apiKeyGate.stepOne":"ffnen Sie Google AI Studio und erstellen Sie einen API-Schlssel.","apiKeyGate.stepTwo":"Fgen Sie den Schlssel unten ein und tippen Sie auf Speichern.","apiKeyGate.openAiStudio":"Google AI Studio ffnen","apiKeyGate.viewInstructions":"Anweisungen anzeigen","apiKeyGate.closeInstructions":"Anweisungen schlieen","apiKeyGate.previousInstruction":"Vorherige Anweisung","apiKeyGate.nextInstruction":"Nchste Anweisung","apiKeyGate.instructionStep":"Anweisung {step} von {total}","apiKeyGate.keyLabel":"Gemini-API-Schlssel","apiKeyGate.placeholder":"Fgen Sie Ihren API-Schlssel hier ein","apiKeyGate.show":"Anzeigen","apiKeyGate.hide":"Ausblenden","apiKeyGate.currentKeySaved":"Aktueller Schlssel gespeichert {maskedKey}","apiKeyGate.keyInvalid":"Schlssel ungltig {maskedKey}  neuen Schlssel unten einfgen","apiKeyGate.clearSavedKey":"Gespeicherten Schlssel lschen","apiKeyGate.cancel":"Abbrechen","apiKeyGate.saving":"Speichern...","apiKeyGate.saveKey":"Schlssel speichern","apiKeyGate.close":"Schlieen","apiKeyGate.costLabel":"Geschtzte API-Kosten","apiKeyGate.testerFormTitle":"App testen","apiKeyGate.testerFormDescription":"Geben Sie die E-Mail-Adresse ein, die Sie fr den Google Play Store verwenden, um eine Einladung zu unserer Android-Beta zu erhalten!","apiKeyGate.testerFormSubmit":"Early Access erhalten","apiKeyGate.testerFormSubmitting":"Wird gesendet...","apiKeyGate.testerFormError":"Etwas ist schiefgelaufen. Bitte versuchen Sie es erneut.","apiKeyGate.testerFormMustBeGmail":"Bitte verwenden Sie eine @gmail.com-Adresse fr Google Play.","apiKeyGate.testerFormCapReached":"Anmelde limit erreicht. Danke!","apiKeyGate.developerLogin":"Entwickler-Login","apiKeyGate.submitAnotherEmail":"Falsche E-Mail eingegeben? Zurcksetzen und eine andere versuchen.","apiKeyGate.testerFormChecking":"Ihr Einladungsstatus wird berprft...","apiKeyGate.testerFormApprovedTitle":"Sie sind dabei! ","apiKeyGate.testerFormApprovedDesc":"Ihre E-Mail wurde fr das Android-Beta-Testprogramm genehmigt.","apiKeyGate.testerFormDownloadBtn":"App bei Google Play herunterladen","apiKeyGate.testerFormPendingTitle":"Sie sind auf der Warteliste!","apiKeyGate.testerFormPendingDesc":"Wir haben Ihre E-Mail erhalten. Die manuelle Bearbeitung der Einladung dauert etwas. Bitte schauen Sie spter wieder vorbei!","apiKeyGate.checkStatusModeBtn":"Bereits beworben? Status prfen.","apiKeyGate.submitModeBtn":"Mssen Sie sich bewerben? Hier anmelden.","apiKeyGate.checkStatusTitle":"Einladungsstatus prfen","apiKeyGate.checkStatusDesc":"Geben Sie die E-Mail ein, mit der Sie sich fr die Warteliste beworben haben.","apiKeyGate.checkStatusSubmit":"Status prfen","apiKeyGate.testerFormNotFound":"E-Mail nicht auf der Warteliste gefunden. Bitte melden Sie sich zuerst an.","chat.thinking":"Denke nach...","chat.loadingHistory":"Lade Chatverlauf...","chat.loadingSuggestions":"Lade Vorschlge...","chat.suggestionsAriaLabel":"Antwortvorschlge","chat.attachImageFromFile":"Datei anhngen","chat.removeAttachedImage":"Angehngte Datei entfernen","chat.sendMessage":"Nachricht senden","chat.messageInputAriaLabel":"Nachrichteneingabe","chat.retrievedFromWeb":"Aus dem Web abgerufen:","chat.videoNotSupported":"Ihr Browser untersttzt das Video-Tag nicht.","chat.audioNotSupported":"Ihr Browser untersttzt das Audio-Tag nicht.","chat.fileAttachment":"Dateianhang","chat.pdf.loading":"PDF wird geladen...","chat.pdf.error":"PDF kann nicht angezeigt werden","chat.pdf.pageIndicator":"Seite {current} von {total}","chat.imageGenError":"Bildgenerierungsfehler","chat.generatingImageLoadingSlow":"Dauert etwas lnger...","chat.stopSpeaking":"Aufhren zu sprechen","chat.speakThisLine":"Diese Zeile sprechen","chat.languageSelector.openGlobe":"Sprachen ndern","chat.maestroTranscriptScrollwheel":"Maestro-Transkript-Scrollansicht","chat.mic.listening":"STT aktiv: Hre zu...","chat.mic.enableStt":"STT aktivieren","chat.mic.disableStt":"STT stoppen","chat.mic.recordingAudioNote":"Audioaufnahme...","chat.placeholder.normal.listening":"Hre in {language}...","chat.placeholder.normal.sttActive":"Sprechen Sie auf {language} oder tippen Sie...","chat.placeholder.normal.sttInactive":"Tippen oder auf Mikrofon tippen, um auf {language} zu sprechen...","chat.placeholder.suggestion.listening":"Sprechen Sie {language} zum bersetzen...","chat.placeholder.suggestion.sttActive":"Sprechen oder tippen Sie auf {language} zum bersetzen...","chat.placeholder.suggestion.sttInactive":"Tippen Sie auf {language} zum bersetzen...","chat.camera.turnOn":"Kameravorschau aktivieren","chat.camera.turnOff":"Kameravorschau deaktivieren","chat.camera.selectCamera":"Kamera auswhlen","chat.camera.imageGenCameraLabel":"Bildgenerierung","chat.camera.captureOrRecord":"Tippen fr Foto, halten fr Video","chat.camera.stopRecording":"Aufnahme stoppen","chat.bookIcon.toggleImageGen":"Bildgenerierungsmodus umschalten","chat.imagePreview.alt":"Vorschau","chat.image.dragToEnlarge":"Ecke ziehen zum Vergrern","chat.image.dragToShrink":"Ecke ziehen zum Verkleinern","chat.annotateImage":"Bild annotieren","chat.annotateVideoFrame":"Aktuelles Bild annotieren","chat.annotateModal.editingPreviewAlt":"Zu annotierendes Bild","chat.annotateModal.cancel":"Abbrechen","chat.annotateModal.saveAndAttach":"Speichern und anhngen","chat.annotateModal.undo":"Rckgngig","chat.suggestion.speak":'Sagen: "{suggestion}"',"chat.suggestion.ariaLabel":"Vorschlag sprechen: {suggestion}","chat.suggestion.toggleCreateMode":"Vorschlagserstellungsmodus umschalten","chat.suggestion.createAction":"Vorschlag erstellen","chat.suggestion.creating":"Vorschlag wird erstellt...","chat.maestro.idle":"Maestro ist inaktiv","chat.maestro.title.idle":"Maestro ist derzeit inaktiv.","chat.maestro.resting":"Maestro ruht...","chat.maestro.observing":"Maestro beobachtet...","chat.maestro.aboutToEngage":"Maestro wird gleich eingreifen...","chat.maestro.title.resting":"Maestro ist inaktiv, viel Zeit bis zur Reaktivierung.","chat.maestro.title.observing":"Maestro beobachtet, etwas Zeit bis zur Reaktivierung.","chat.maestro.title.aboutToEngage":"Maestro wird sich bald reaktivieren.","chat.maestro.typing":"Maestro schreibt...","chat.maestro.title.typing":"Maestro bereitet eine Antwort vor.","chat.maestro.speaking":"Maestro spricht","chat.maestro.title.speaking":"Maestro spricht gerade.","chat.maestro.listening":"Hre zu...","chat.maestro.title.listening":"Maestro wartet auf Ihre Eingabe oder Stimme.","chat.maestro.holding":"Maestro hlt an","chat.maestro.title.holding":"Maestro hlt an (Reaktivierung pausiert)","chat.bookmark.hiddenHeaderAria":"Versteckte Nachrichten oben","chat.bookmark.isHere":"Lesezeichen ist hier","chat.bookmark.setHere":"Lesezeichen hier setzen","chat.bookmark.actionsRegionAria":"Lesezeichen-Aktionen","chat.bookmark.actionsToggleTitle":"Lesezeichen-Optionen","chat.bookmark.decrementAria":"Eins weniger anzeigen","chat.bookmark.decrementTitle":"Weniger","chat.bookmark.incrementAria":"Eins mehr anzeigen","chat.bookmark.incrementTitle":"Mehr","chat.bookmark.hiddenBelowHeaderAria":"Versteckte Nachrichten unten","chat.sendPrep.optimizingVideo":"Video wird optimiert...","chat.sendPrep.optimizingImage":"Bild wird optimiert...","chat.sendPrep.preparingMedia":"Medien werden vorbereitet...","chat.sendPrep.uploadingMedia":"Medien werden hochgeladen...","chat.sendPrep.finalizing":"Wird abgeschlossen...","chat.header.annotating":"Annotieren","chat.header.recordingAudio":"Audioaufnahme","chat.header.recordingVideo":"Videoaufnahme","chat.header.savePopup":"Speichern...","chat.header.loadPopup":"Laden...","chat.header.maestroAvatar":"Maestro-Avatar wird aktualisiert","chat.header.watchingVideo":"Video ansehen","chat.header.viewingAbove":"Vorherige Nachrichten ansehen","chat.header.liveSession":"Live-Sitzung","chat.liveSession.stop":"Live stoppen","chat.liveSession.retry":"Live erneut versuchen","chat.liveSession.start":"Live starten","chat.liveSession.liveBadge":"Live","chat.liveSession.connecting":"Verbinden","chat.liveSession.defaultLastMessage":"Hallo! Wie kann ich Ihnen heute helfen?","chat.liveSession.defaultSuggestion1":"Hallo","chat.liveSession.defaultSuggestion2":"Guten Morgen","chat.liveSession.defaultSuggestion3":"Wie geht es Ihnen?","chat.error.sttError":"STT-Fehler: {error}. Versuchen Sie, das Mikrofon umzuschalten.","chat.error.autoCaptureCameraError":"Automatischer Kameraaufnahmefehler: {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"Aufnahme nach {maxMinutes} Minuten automatisch gestoppt.","chat.error.videoMetadataError":"Videometadaten konnten nicht gelesen werden. Die Datei knnte beschdigt oder in einem nicht untersttzten Format sein.","chat.error.pauseVideoToAnnotate":"Video pausieren, um das aktuelle Bild zu annotieren","chat.error.imageGenInterrupted":"Die Bildgenerierung wurde unterbrochen.","chat.error.thinkingInterrupted":"Die KI-Antwort wurde unterbrochen.","error.noLanguagePair":"Kritischer Fehler: Kein Sprachpaar ausgewhlt.","error.translationFailed":"bersetzung fehlgeschlagen. Bitte erneut versuchen.","error.imageLimitReached":"Sitzungslimit fr Bildgenerierung erreicht. Bitte neue Sitzung starten.","error.tokenLimitReached":"Sitzungs-Token-Limit erreicht. Bitte neue Sitzung starten.","error.apiKeyMissing":"Ihr Gemini-API-Schlssel fehlt. ffnen Sie den API-Schlssel-Bildschirm und fgen Sie Ihren Schlssel ein.","error.apiKeyInvalid":"Ihr Gemini-API-Schlssel ist ungltig. Bitte prfen Sie auf Tippfehler und fgen Sie einen gltigen Schlssel ein.","error.apiQuotaExceeded":"Ihr Kontingent ist erschpft (Kostenpflichtig: intelligenterer Chat, Video, PDF und Bilderzeugung)","error.quotaSetupBilling":"Abrechnung einrichten","error.quotaStartLive":"Kostenlose Live-Version starten (keine Bilderzeugung)","error.imageGenCostWarning":"Die Bilderzeugung kostet ca. 0,04 $ pro Bild. Chat-Nachrichten haben ebenfalls kleine Kosten. Alles wird von Google abgerechnet. Sie knnen die Kosten im API-Schlssel-Bildschirm verfolgen.","error.imageGenDisable":"Bilderzeugung deaktivieren","error.imageGenViewCost":"Verfolgen Sie die Kosten im API-Schlssel-Bildschirm.","error.cameraPermissionDenied":"Kameraberechtigung verweigert. Bitte aktivieren Sie den Kamerazugriff in Ihren Browsereinstellungen.","error.cameraNotFound":"Ausgewhlte Kamera nicht gefunden. Stellen Sie sicher, dass sie angeschlossen ist, oder whlen Sie eine andere Kamera.","error.cameraAccessNotSupported":"Kamerazugriff wird von Ihrem Browser nicht untersttzt.","error.cameraUnknown":"Ein unbekannter Fehler beim Zugriff auf die Kamera ist aufgetreten.","error.cameraStreamNotAvailable":"Kamerastream fr Aufnahme nicht verfgbar.","error.imageCaptureGeneric":"Unbekannter Fehler bei der Bildaufnahme.","error.visualContextVideoElementNotReady":"Visuelles Kontext-Videoelement nicht bereit.","error.snapshotVideoElementNotReady":"Videoelement fr Schnappschuss nicht bereit.","error.visualContextCameraAccessNotSupported":"Kamerazugriff fr visuellen Kontext nicht untersttzt.","error.snapshotCameraAccessNotSupported":"Kamerazugriff fr Schnappschuss nicht untersttzt.","error.visualContext2DContext":"2D-Kontext fr visuellen Kontext konnte nicht abgerufen werden.","error.snapshot2DContext":"2D-Kontext fr Schnappschuss konnte nicht abgerufen werden.","error.visualContextCaptureFailedPermission":"Visueller Kontext fehlgeschlagen: Kameraberechtigung verweigert.","error.snapshotCaptureFailedPermission":"Schnappschuss fehlgeschlagen: Kameraberechtigung verweigert.","error.visualContextCaptureFailedNotFound":"Visueller Kontext fehlgeschlagen: Kamera nicht gefunden.","error.snapshotCaptureFailedNotFound":"Schnappschuss fehlgeschlagen: Kamera nicht gefunden.","error.visualContextCaptureFailedNotReady":"Visueller Kontext fehlgeschlagen: Kamera nicht bereit oder Problem mit dem Stream. {details}","error.snapshotCaptureFailedNotReady":"Schnappschuss fehlgeschlagen: Kamera nicht bereit oder Problem mit dem Stream. {details}","error.visualContextCaptureFailedGeneric":"Visueller Kontext fehlgeschlagen: {details}","error.snapshotCaptureFailedGeneric":"Schnappschuss fehlgeschlagen: {details}"},Eu={"app.title":"Maestro","sttLang.selectLanguage":"Set speech recognition to {language}","header.targetLanguageTitle":"Current Target Language: {language}","startPage.clickToStart":"Click the plane","startPage.saveChats":"Save All Chats","startPage.loadChats":"Load Chats","startPage.saveThisChat":"Save This Chat","startPage.appendToChat":"Append to Chat","startPage.trimBeforeBookmark":"Trim Before Bookmark","startPage.maestroAvatar":"Maestro avatar","startPage.addMaestroAvatar":"Add Maestro avatar","startPage.loadSuccess":"Successfully loaded and replaced {count} chat sessions!","startPage.loadError":"Error loading chats. The file might be corrupted or in the wrong format.","startPage.noChatsToSave":"There are no chat histories to save.","startPage.saveError":"Error saving chats. Check the console for more details.","startPage.noChatSelected":"Please select a language pair first.","startPage.noBookmarkSet":"No bookmark set. Set a bookmark first to trim messages before it.","startPage.noMessagesToTrim":"No messages before the bookmark to remove.","startPage.trimSuccess":"Removed {count} messages before the bookmark.","startPage.trimError":"Failed to trim messages. Please try again.","startPage.noMessagesToAppend":"No messages found in the backup file to combine.","startPage.noPairInBackup":"The backup file does not contain messages for your current language pair. Please select a backup that matches your current chat.","startPage.appendSuccess":"Successfully appended {count} messages to the current chat.","startPage.combineSuccess":"Combined chats: {added} new messages added, {total} total messages.","startPage.combineNoDuplicates":"All messages were already in your chat. No changes made.","startPage.combineNoChanges":"No new messages to add. Your chat is unchanged.","startPage.invalidBackupFormat":"Invalid backup file. Please select a valid Maestro backup (.ndjson) file.","startPage.browserNotSupported":"Your browser does not support file saving. Please use Chrome or Edge.","sessionControls.saveAll.label":"Save All","sessionControls.saveAll.description":"Export all chats to backup file","sessionControls.loadAll.label":"Load All","sessionControls.loadAll.description":"Replace all chats with backup file","sessionControls.reset.label":"Reset","sessionControls.reset.description":"Backup & delete all data","sessionControls.saveThis.label":"Save Chat","sessionControls.saveThis.description":"Export this chat only","sessionControls.combine.label":"Combine","sessionControls.combine.description":"Merge backup into this chat","sessionControls.trim.label":"Trim","sessionControls.trim.description":"Remove messages before bookmark","sessionControls.profile":"Profile:","sessionControls.profilePlaceholder":"Your name or details...","sessionControls.editProfile":"Edit User Profile","sessionControls.allChatsControls":"All Chats Controls","sessionControls.thisChatsControls":"This Chat Controls","sessionControls.back":"Back","sessionControls.backupAndReset":"Backup & Reset","sessionControls.typeToConfirm":'Type "{keyword}" to confirm',"sessionControls.changeAvatar":"Change Avatar","general.clear":"Clear","general.error":"Sorry, I encountered an error.","apiKeyGate.title":"Connect your Gemini API key","apiKeyGate.billingTitle":"Set up billing for higher quota","apiKeyGate.infoLogin":"Your login: An API key","apiKeyGate.infoVisibility":"Who sees it: Only you","apiKeyGate.infoBilling":"Billing: Monthly, from Google","apiKeyGate.infoCost":"Cost: Shown in app  tap to view","apiKeyGate.infoMore":"More info:","apiKeyGate.privacyPolicy":"Privacy Policy","apiKeyGate.stepsTitle":"Two quick steps:","apiKeyGate.stepOne":"Open Google AI Studio and create an API key.","apiKeyGate.stepTwo":"Paste the key below and tap Save.","apiKeyGate.openAiStudio":"Open Google AI Studio","apiKeyGate.viewInstructions":"View instructions","apiKeyGate.closeInstructions":"Close instructions","apiKeyGate.previousInstruction":"Previous instruction","apiKeyGate.nextInstruction":"Next instruction","apiKeyGate.instructionStep":"Instruction {step} of {total}","apiKeyGate.keyLabel":"Gemini API key","apiKeyGate.placeholder":"Paste your API key here","apiKeyGate.show":"Show","apiKeyGate.hide":"Hide","apiKeyGate.currentKeySaved":"Key {maskedKey}","apiKeyGate.keyInvalid":"Key {maskedKey} invalid","apiKeyGate.clearSavedKey":"Clear saved key","apiKeyGate.cancel":"Cancel","apiKeyGate.saving":"Saving...","apiKeyGate.saveKey":"Save key","apiKeyGate.close":"Close","apiKeyGate.costLabel":"Estimated API cost","apiKeyGate.testerFormTitle":"Test the App","apiKeyGate.testerFormDescription":"Enter the email you use for the Google Play Store to get an invite to our Android beta!","apiKeyGate.testerFormSubmit":"Get Early Access","apiKeyGate.testerFormSubmitting":"Sending...","apiKeyGate.testerFormError":"Something went wrong. Please try again.","apiKeyGate.testerFormMustBeGmail":"Please use an @gmail.com address for Google Play.","apiKeyGate.testerFormCapReached":"Submission limit reached. Thank you!","apiKeyGate.developerLogin":"developer login","apiKeyGate.submitAnotherEmail":"Entered the wrong email? Reset and try another.","apiKeyGate.testerFormChecking":"Checking your invite status...","apiKeyGate.testerFormApprovedTitle":"You're In! ","apiKeyGate.testerFormApprovedDesc":"Your email has been approved for the Android beta testing program.","apiKeyGate.testerFormDownloadBtn":"This button only works on the email you provided. -- Click Here To Download The App on Google Play -- If you dont see the app but instead see an error (The requested URL was not found on this server.) close this webpage and open it again while logged in with the email you provided.","apiKeyGate.testerFormPendingTitle":"You're on the Waitlist!","apiKeyGate.testerFormPendingDesc":"We have received your email. It takes some time for humans to process the invite. Please check back later! Close this webpage and open it again to check the updated status.","apiKeyGate.checkStatusModeBtn":"Already applied? Check your status.","apiKeyGate.submitModeBtn":"Need to apply? Sign up here.","apiKeyGate.checkStatusTitle":"Check Invite Status","apiKeyGate.checkStatusDesc":"Enter the email you used to apply for the waitlist.","apiKeyGate.checkStatusSubmit":"Check Status","apiKeyGate.testerFormNotFound":"Email not found on the waitlist. Please sign up first.","chat.thinking":"Thinking...","chat.loadingHistory":"Loading chat history...","chat.loadingSuggestions":"Loading suggestions...","chat.suggestionsAriaLabel":"Reply suggestions","chat.attachImageFromFile":"Attach file","chat.removeAttachedImage":"Remove attached file","chat.sendMessage":"Send message","chat.messageInputAriaLabel":"Message input","chat.retrievedFromWeb":"Retrieved from the web:","chat.videoNotSupported":"Your browser does not support the video tag.","chat.audioNotSupported":"Your browser does not support the audio tag.","chat.fileAttachment":"File Attachment","chat.pdf.loading":"Loading PDF...","chat.pdf.error":"Unable to display PDF","chat.pdf.pageIndicator":"Page {current} of {total}","chat.imageGenError":"Image Gen Error","chat.generatingImageLoadingSlow":"Taking a bit longer...","chat.stopSpeaking":"Stop speaking","chat.speakThisLine":"Speak this line","chat.languageSelector.openGlobe":"Change languages","chat.maestroTranscriptScrollwheel":"Maestro transcript scroll view","chat.mic.listening":"STT Active: Listening...","chat.mic.enableStt":"Enable STT","chat.mic.disableStt":"Stop STT","chat.mic.recordingAudioNote":"Recording audio...","chat.placeholder.normal.listening":"Listening in {language}...","chat.placeholder.normal.sttActive":"Speak in {language} or type...","chat.placeholder.normal.sttInactive":"Type or tap the mic to speak in {language}...","chat.placeholder.suggestion.listening":"Speak {language} to translate...","chat.placeholder.suggestion.sttActive":"Speak or type in {language} to translate...","chat.placeholder.suggestion.sttInactive":"Type in {language} to translate...","chat.camera.turnOn":"Activate camera preview","chat.camera.turnOff":"Deactivate camera preview","chat.camera.selectCamera":"Select camera","chat.camera.imageGenCameraLabel":"Image Generation","chat.camera.captureOrRecord":"Tap for photo, long press for video","chat.camera.stopRecording":"Stop Recording","chat.bookIcon.toggleImageGen":"Toggle Image Generation Mode","chat.imagePreview.alt":"Preview","chat.image.dragToEnlarge":"Drag corner to enlarge","chat.image.dragToShrink":"Drag corner to shrink","chat.annotateImage":"Annotate Image","chat.annotateVideoFrame":"Annotate current frame","chat.annotateModal.editingPreviewAlt":"Image to be annotated","chat.annotateModal.cancel":"Cancel","chat.annotateModal.saveAndAttach":"Save & Attach","chat.annotateModal.undo":"Undo","chat.suggestion.speak":'Speak: "{suggestion}"',"chat.suggestion.ariaLabel":"Speak suggestion: {suggestion}","chat.suggestion.toggleCreateMode":"Toggle suggestion creation mode","chat.suggestion.createAction":"Create Suggestion","chat.suggestion.creating":"Creating suggestion...","chat.maestro.idle":"Maestro is idle","chat.maestro.title.idle":"Maestro is currently idle.","chat.maestro.resting":"Maestro is resting...","chat.maestro.observing":"Maestro is observing...","chat.maestro.aboutToEngage":"Maestro is about to engage...","chat.maestro.title.resting":"Maestro is idle, plenty of time before re-engagement.","chat.maestro.title.observing":"Maestro is observing, some time before re-engagement.","chat.maestro.title.aboutToEngage":"Maestro is about to re-engage soon.","chat.maestro.typing":"Maestro is typing...","chat.maestro.title.typing":"Maestro is preparing a response.","chat.maestro.speaking":"Maestro is speaking","chat.maestro.title.speaking":"Maestro is currently speaking.","chat.maestro.listening":"Listening...","chat.maestro.title.listening":"Maestro is waiting for your input or speech.","chat.maestro.holding":"Maestro is holding","chat.maestro.title.holding":"Maestro is holding (re-engagement paused)","chat.bookmark.hiddenHeaderAria":"Hidden above messages","chat.bookmark.isHere":"Bookmark is here","chat.bookmark.setHere":"Set bookmark here","chat.bookmark.actionsRegionAria":"Bookmark actions","chat.bookmark.actionsToggleTitle":"Bookmark options","chat.bookmark.decrementAria":"Show one less","chat.bookmark.decrementTitle":"Less","chat.bookmark.incrementAria":"Show one more","chat.bookmark.incrementTitle":"More","chat.bookmark.hiddenBelowHeaderAria":"Hidden messages below","chat.sendPrep.optimizingVideo":"Optimizing video...","chat.sendPrep.optimizingImage":"Optimizing image...","chat.sendPrep.preparingMedia":"Preparing media...","chat.sendPrep.uploadingMedia":"Uploading media...","chat.sendPrep.finalizing":"Finalizing...","chat.header.annotating":"Annotating","chat.header.recordingAudio":"Recording audio","chat.header.recordingVideo":"Recording video","chat.header.savePopup":"Saving...","chat.header.loadPopup":"Loading...","chat.header.maestroAvatar":"Updating Maestro avatar","chat.header.watchingVideo":"Watching video","chat.header.viewingAbove":"Viewing messages above","chat.header.liveSession":"Live session","chat.liveSession.stop":"Stop Live","chat.liveSession.retry":"Retry Live","chat.liveSession.start":"-->Start Live call<--","chat.liveSession.liveBadge":"Live","chat.liveSession.connecting":"Connecting","chat.liveSession.defaultLastMessage":"Hello! How can I help you today?","chat.liveSession.defaultSuggestion1":"Hello","chat.liveSession.defaultSuggestion2":"Good morning","chat.liveSession.defaultSuggestion3":"How are you?","chat.error.sttError":"STT Error: {error}. Try toggling mic.","chat.error.autoCaptureCameraError":"Auto-Capture Camera Error: {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"Recording stopped automatically after {maxMinutes} minutes.","chat.error.videoMetadataError":"Could not read video metadata. The file may be corrupt or in an unsupported format.","chat.error.pauseVideoToAnnotate":"Pause the video to annotate the current frame","chat.error.imageGenInterrupted":"Image generation was interrupted.","chat.error.thinkingInterrupted":"The AI's response was interrupted.","error.noLanguagePair":"Critical error: No language pair selected.","error.translationFailed":"Translation failed. Please try again.","error.imageLimitReached":"Session image generation limit reached. Please start a new session.","error.tokenLimitReached":"Session token limit reached. Please start a new session.","error.apiKeyMissing":"Your Gemini API key is missing. Open the API Key screen and paste your key.","error.apiKeyInvalid":"Your Gemini API key is invalid. Please check for typos and paste a valid key.","error.apiQuotaExceeded":"Your quota is exhausted (Paid: smarter chat, video, pdf, and image generation)","error.quotaSetupBilling":"Set up billing","error.quotaStartLive":"Start Live free version (no image gen)","error.imageGenCostWarning":"Image generation costs ~$0.04 per image. Chat messages also have a small cost. All billed by Google. You can track costs in the API key screen.","error.imageGenDisable":"Disable Image Generation","error.imageGenViewCost":"Track costs in the API key screen","error.cameraPermissionDenied":"Camera permission denied. Please enable camera access in your browser settings.","error.cameraNotFound":"Selected camera not found. Please ensure it's connected or select a different camera in settings.","error.cameraAccessNotSupported":"Camera access is not supported by your browser.","error.cameraUnknown":"An unknown error occurred while accessing the camera.","error.cameraStreamNotAvailable":"Camera stream not available for capture.","error.imageCaptureGeneric":"Unknown error during image capture.","error.visualContextVideoElementNotReady":"Visual context video element not ready.","error.snapshotVideoElementNotReady":"Video element for snapshot not ready.","error.visualContextCameraAccessNotSupported":"Camera access not supported for visual context.","error.snapshotCameraAccessNotSupported":"Camera access not supported for snapshot.","error.visualContext2DContext":"Could not get 2D context for visual context.","error.snapshot2DContext":"Could not get 2D context for snapshot.","error.visualContextCaptureFailedPermission":"Visual Context failed: Camera permission denied.","error.snapshotCaptureFailedPermission":"Snapshot failed: Camera permission denied.","error.visualContextCaptureFailedNotFound":"Visual Context failed: Camera not found.","error.snapshotCaptureFailedNotFound":"Snapshot failed: Camera not found.","error.visualContextCaptureFailedNotReady":"Visual Context failed: Camera not ready or problem with the feed. {details}","error.snapshotCaptureFailedNotReady":"Snapshot failed: Camera not ready or problem with the feed. {details}","error.visualContextCaptureFailedGeneric":"Visual Context failed: {details}","error.snapshotCaptureFailedGeneric":"Snapshot failed: {details}"},jb={"app.title":"Maestro","sttLang.selectLanguage":"Establecer reconocimiento de voz a {language}","header.targetLanguageTitle":"Idioma objetivo actual: {language}","startPage.clickToStart":"Haz clic en el avin","startPage.saveChats":"Guardar todos los chats","startPage.loadChats":"Cargar chats","startPage.saveThisChat":"Guardar este chat","startPage.appendToChat":"Anexar al chat","startPage.trimBeforeBookmark":"Recortar antes del marcador","startPage.maestroAvatar":"Avatar de Maestro","startPage.addMaestroAvatar":"Aadir avatar de Maestro","startPage.loadSuccess":"Se cargaron y reemplazaron {count} sesiones de chat con xito!","startPage.loadError":"Error al cargar chats. El archivo podra estar corrupto o en un formato incorrecto.","startPage.noChatsToSave":"No hay historiales de chat para guardar.","startPage.saveError":"Error al guardar los chats. Consulta la consola para ms detalles.","startPage.noChatSelected":"Por favor selecciona un par de idiomas primero.","startPage.noBookmarkSet":"No hay marcador establecido. Establece un marcador primero para recortar los mensajes anteriores a l.","startPage.noMessagesToTrim":"No hay mensajes antes del marcador para eliminar.","startPage.trimSuccess":"Se eliminaron {count} mensajes anteriores al marcador.","startPage.trimError":"Error al recortar mensajes. Por favor intntalo de nuevo.","startPage.noMessagesToAppend":"No se encontraron mensajes en el archivo de copia de seguridad para combinar.","startPage.noPairInBackup":"El archivo de copia de seguridad no contiene mensajes para tu par de idiomas actual. Por favor selecciona una copia de seguridad que coincida con tu chat actual.","startPage.appendSuccess":"Se anexaron {count} mensajes al chat actual con xito.","startPage.combineSuccess":"Chats combinados: {added} mensajes nuevos aadidos, {total} mensajes en total.","startPage.combineNoDuplicates":"Todos los mensajes ya estaban en tu chat. No se realizaron cambios.","startPage.combineNoChanges":"No hay mensajes nuevos para aadir. Tu chat no ha cambiado.","startPage.invalidBackupFormat":"Archivo de copia de seguridad no vlido. Por favor selecciona un archivo de copia de seguridad de Maestro (.ndjson) vlido.","startPage.browserNotSupported":"Tu navegador no soporta el guardado de archivos. Por favor usa Chrome o Edge.","sessionControls.saveAll.label":"Guardar todo","sessionControls.saveAll.description":"Exportar todos los chats a archivo","sessionControls.loadAll.label":"Cargar todo","sessionControls.loadAll.description":"Reemplazar chats con archivo","sessionControls.reset.label":"Restablecer","sessionControls.reset.description":"Respaldar y borrar datos","sessionControls.saveThis.label":"Guardar chat","sessionControls.saveThis.description":"Exportar solo este chat","sessionControls.combine.label":"Combinar","sessionControls.combine.description":"Fusionar archivo en este chat","sessionControls.trim.label":"Recortar","sessionControls.trim.description":"Eliminar msjes. antes marcador","sessionControls.profile":"Perfil:","sessionControls.profilePlaceholder":"Tu nombre o detalles...","sessionControls.editProfile":"Editar perfil de usuario","sessionControls.allChatsControls":"Controles de todos los chats","sessionControls.thisChatsControls":"Controles de este chat","sessionControls.back":"Atrs","sessionControls.backupAndReset":"Respaldar y Restablecer","sessionControls.typeToConfirm":'Escribe "{keyword}" para confirmar',"sessionControls.changeAvatar":"Cambiar avatar","general.clear":"Borrar","general.error":"Lo siento, encontr un error.","apiKeyGate.title":"Conecta tu clave API de Gemini","apiKeyGate.billingTitle":"Configurar facturacin para mayor cuota","apiKeyGate.infoLogin":"Tu acceso: Una clave API","apiKeyGate.infoVisibility":"Quin la ve: Solo t","apiKeyGate.infoBilling":"Facturacin: Mensual, de Google","apiKeyGate.infoCost":"Costo: Se muestra en la app  toca para ver","apiKeyGate.infoMore":"Ms informacin:","apiKeyGate.privacyPolicy":"Poltica de privacidad","apiKeyGate.stepsTitle":"Dos pasos rpidos:","apiKeyGate.stepOne":"Abre Google AI Studio y crea una clave API.","apiKeyGate.stepTwo":"Pega la clave abajo y toca Guardar.","apiKeyGate.openAiStudio":"Abrir Google AI Studio","apiKeyGate.viewInstructions":"Ver instrucciones","apiKeyGate.closeInstructions":"Cerrar instrucciones","apiKeyGate.previousInstruction":"Instruccin anterior","apiKeyGate.nextInstruction":"Siguiente instruccin","apiKeyGate.instructionStep":"Instruccin {step} de {total}","apiKeyGate.keyLabel":"Clave API de Gemini","apiKeyGate.placeholder":"Pega tu clave API aqu","apiKeyGate.show":"Mostrar","apiKeyGate.hide":"Ocultar","apiKeyGate.currentKeySaved":"Clave actual guardada {maskedKey}","apiKeyGate.keyInvalid":"Clave invlida {maskedKey}  pega una nueva clave abajo","apiKeyGate.clearSavedKey":"Borrar clave guardada","apiKeyGate.cancel":"Cancelar","apiKeyGate.saving":"Guardando...","apiKeyGate.saveKey":"Guardar clave","apiKeyGate.close":"Cerrar","apiKeyGate.costLabel":"Costo estimado de la API","apiKeyGate.testerFormTitle":"Prueba la App","apiKeyGate.testerFormDescription":"Ingresa el correo que usas en Google Play Store para recibir una invitacin a nuestra beta de Android!","apiKeyGate.testerFormSubmit":"Obtener acceso anticipado","apiKeyGate.testerFormSubmitting":"Enviando...","apiKeyGate.testerFormError":"Algo sali mal. Por favor, intntalo de nuevo.","apiKeyGate.testerFormMustBeGmail":"Por favor usa una direccin @gmail.com para Google Play.","apiKeyGate.testerFormCapReached":"Lmite de solicitudes alcanzado. Gracias!","apiKeyGate.developerLogin":"acceso de desarrollador","apiKeyGate.submitAnotherEmail":"Correo incorrecto? Restablece e intenta con otro.","apiKeyGate.testerFormChecking":"Verificando estado de invitacin...","apiKeyGate.testerFormApprovedTitle":"Ests dentro! ","apiKeyGate.testerFormApprovedDesc":"Tu correo ha sido aprobado para el programa de prueba beta de Android.","apiKeyGate.testerFormDownloadBtn":"Descargar App en Google Play","apiKeyGate.testerFormPendingTitle":"Ests en la lista de espera!","apiKeyGate.testerFormPendingDesc":"Hemos recibido tu correo. Toma un tiempo procesar la invitacin manualmente. Por favor revisa ms tarde!","apiKeyGate.checkStatusModeBtn":"Ya aplicaste? Revisa tu estado.","apiKeyGate.submitModeBtn":"Necesitas aplicar? Regstrate aqu.","apiKeyGate.checkStatusTitle":"Revisar estado de invitacin","apiKeyGate.checkStatusDesc":"Ingresa el correo que usaste para la lista de espera.","apiKeyGate.checkStatusSubmit":"Revisar estado","apiKeyGate.testerFormNotFound":"Correo no encontrado en la lista de espera. Por favor regstrate primero.","chat.thinking":"Pensando...","chat.loadingHistory":"Cargando historial de chat...","chat.loadingSuggestions":"Cargando sugerencias...","chat.suggestionsAriaLabel":"Sugerencias de respuesta","chat.attachImageFromFile":"Adjuntar archivo","chat.removeAttachedImage":"Eliminar archivo adjunto","chat.sendMessage":"Enviar mensaje","chat.messageInputAriaLabel":"Entrada de mensaje","chat.retrievedFromWeb":"Obtenido de la web:","chat.videoNotSupported":"Tu navegador no soporta la etiqueta de video.","chat.audioNotSupported":"Tu navegador no soporta la etiqueta de audio.","chat.fileAttachment":"Archivo adjunto","chat.pdf.loading":"Cargando PDF...","chat.pdf.error":"No se puede mostrar el PDF","chat.pdf.pageIndicator":"Pgina {current} de {total}","chat.imageGenError":"Error de generacin de imagen","chat.generatingImageLoadingSlow":"Tardando un poco ms...","chat.stopSpeaking":"Dejar de hablar","chat.speakThisLine":"Hablar esta lnea","chat.languageSelector.openGlobe":"Cambiar idiomas","chat.maestroTranscriptScrollwheel":"Vista de desplazamiento de transcripcin de Maestro","chat.mic.listening":"STT activo: Escuchando...","chat.mic.enableStt":"Activar STT","chat.mic.disableStt":"Detener STT","chat.mic.recordingAudioNote":"Grabando audio...","chat.placeholder.normal.listening":"Escuchando en {language}...","chat.placeholder.normal.sttActive":"Habla en {language} o escribe...","chat.placeholder.normal.sttInactive":"Escribe o toca el micrfono para hablar en {language}...","chat.placeholder.suggestion.listening":"Habla {language} para traducir...","chat.placeholder.suggestion.sttActive":"Habla o escribe en {language} para traducir...","chat.placeholder.suggestion.sttInactive":"Escribe en {language} para traducir...","chat.camera.turnOn":"Activar vista previa de cmara","chat.camera.turnOff":"Desactivar vista previa de cmara","chat.camera.selectCamera":"Seleccionar cmara","chat.camera.imageGenCameraLabel":"Generacin de imagen","chat.camera.captureOrRecord":"Toca para foto, mantn presionado para video","chat.camera.stopRecording":"Detener grabacin","chat.bookIcon.toggleImageGen":"Alternar modo de generacin de imagen","chat.imagePreview.alt":"Vista previa","chat.image.dragToEnlarge":"Arrastra la esquina para agrandar","chat.image.dragToShrink":"Arrastra la esquina para reducir","chat.annotateImage":"Anotar imagen","chat.annotateVideoFrame":"Anotar fotograma actual","chat.annotateModal.editingPreviewAlt":"Imagen a anotar","chat.annotateModal.cancel":"Cancelar","chat.annotateModal.saveAndAttach":"Guardar y adjuntar","chat.annotateModal.undo":"Deshacer","chat.suggestion.speak":'Hablar: "{suggestion}"',"chat.suggestion.ariaLabel":"Hablar sugerencia: {suggestion}","chat.suggestion.toggleCreateMode":"Alternar modo de creacin de sugerencia","chat.suggestion.createAction":"Crear sugerencia","chat.suggestion.creating":"Creando sugerencia...","chat.maestro.idle":"Maestro est inactivo","chat.maestro.title.idle":"Maestro est actualmente inactivo.","chat.maestro.resting":"Maestro est descansando...","chat.maestro.observing":"Maestro est observando...","chat.maestro.aboutToEngage":"Maestro est a punto de interactuar...","chat.maestro.title.resting":"Maestro est inactivo, bastante tiempo antes de la reactivacin.","chat.maestro.title.observing":"Maestro est observando, algo de tiempo antes de la reactivacin.","chat.maestro.title.aboutToEngage":"Maestro est a punto de reactivarse pronto.","chat.maestro.typing":"Maestro est escribiendo...","chat.maestro.title.typing":"Maestro est preparando una respuesta.","chat.maestro.speaking":"Maestro est hablando","chat.maestro.title.speaking":"Maestro est hablando actualmente.","chat.maestro.listening":"Escuchando...","chat.maestro.title.listening":"Maestro est esperando tu entrada o voz.","chat.maestro.holding":"Maestro est en espera","chat.maestro.title.holding":"Maestro est en espera (reactivacin pausada)","chat.bookmark.hiddenHeaderAria":"Mensajes ocultos arriba","chat.bookmark.isHere":"El marcador est aqu","chat.bookmark.setHere":"Establecer marcador aqu","chat.bookmark.actionsRegionAria":"Acciones de marcador","chat.bookmark.actionsToggleTitle":"Opciones de marcador","chat.bookmark.decrementAria":"Mostrar uno menos","chat.bookmark.decrementTitle":"Menos","chat.bookmark.incrementAria":"Mostrar uno ms","chat.bookmark.incrementTitle":"Ms","chat.bookmark.hiddenBelowHeaderAria":"Mensajes ocultos abajo","chat.sendPrep.optimizingVideo":"Optimizando video...","chat.sendPrep.optimizingImage":"Optimizando imagen...","chat.sendPrep.preparingMedia":"Preparando medios...","chat.sendPrep.uploadingMedia":"Subiendo medios...","chat.sendPrep.finalizing":"Finalizando...","chat.header.annotating":"Anotando","chat.header.recordingAudio":"Grabando audio","chat.header.recordingVideo":"Grabando video","chat.header.savePopup":"Guardando...","chat.header.loadPopup":"Cargando...","chat.header.maestroAvatar":"Actualizando avatar de Maestro","chat.header.watchingVideo":"Viendo video","chat.header.viewingAbove":"Viendo mensajes arriba","chat.header.liveSession":"Sesin en vivo","chat.liveSession.stop":"Detener en vivo","chat.liveSession.retry":"Reintentar en vivo","chat.liveSession.start":"Iniciar en vivo","chat.liveSession.liveBadge":"En vivo","chat.liveSession.connecting":"Conectando","chat.liveSession.defaultLastMessage":"Hola! Cmo puedo ayudarte hoy?","chat.liveSession.defaultSuggestion1":"Hola","chat.liveSession.defaultSuggestion2":"Buenos das","chat.liveSession.defaultSuggestion3":"Cmo ests?","chat.error.sttError":"Error de STT: {error}. Intenta alternar el micrfono.","chat.error.autoCaptureCameraError":"Error de captura automtica de cmara: {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"Grabacin detenida automticamente despus de {maxMinutes} minutos.","chat.error.videoMetadataError":"No se pudo leer los metadatos del video. El archivo puede estar corrupto o en un formato no soportado.","chat.error.pauseVideoToAnnotate":"Pausa el video para anotar el fotograma actual","chat.error.imageGenInterrupted":"La generacin de imagen fue interrumpida.","chat.error.thinkingInterrupted":"La respuesta de la IA fue interrumpida.","error.noLanguagePair":"Error crtico: No se seleccion un par de idiomas.","error.translationFailed":"Traduccin fallida. Por favor intenta de nuevo.","error.imageLimitReached":"Lmite de generacin de imgenes de la sesin alcanzado. Por favor inicia una nueva sesin.","error.tokenLimitReached":"Lmite de tokens de la sesin alcanzado. Por favor inicia una nueva sesin.","error.apiKeyMissing":"Falta tu clave API de Gemini. Abre la pantalla de clave API y pega tu clave.","error.apiKeyInvalid":"Tu clave API de Gemini no es vlida. Por favor, comprueba si hay errores tipogrficos y pega una clave vlida.","error.apiQuotaExceeded":"Se ha agotado tu cuota (De pago: chat ms inteligente, video, pdf y generacin de imgenes)","error.quotaSetupBilling":"Configurar facturacin","error.quotaStartLive":"Iniciar versin gratuita en vivo (sin gen. de imgenes)","error.imageGenCostWarning":"La generacin de imgenes cuesta ~$0.04 por imagen. Los mensajes de chat tambin tienen un pequeo costo. Todo es facturado por Google. Puedes hacer un seguimiento de los costos en la pantalla de la clave API.","error.imageGenDisable":"Desactivar generacin de imgenes","error.imageGenViewCost":"Haz un seguimiento de los costos en la pantalla de la clave API.","error.cameraPermissionDenied":"Permiso de cmara denegado. Por favor habilita el acceso a la cmara en la configuracin de tu navegador.","error.cameraNotFound":"Cmara seleccionada no encontrada. Por favor asegrate de que est conectada o selecciona una cmara diferente.","error.cameraAccessNotSupported":"El acceso a la cmara no est soportado por tu navegador.","error.cameraUnknown":"Ocurri un error desconocido al acceder a la cmara.","error.cameraStreamNotAvailable":"Transmisin de cmara no disponible para captura.","error.imageCaptureGeneric":"Error desconocido durante la captura de imagen.","error.visualContextVideoElementNotReady":"Elemento de video de contexto visual no est listo.","error.snapshotVideoElementNotReady":"Elemento de video para captura no est listo.","error.visualContextCameraAccessNotSupported":"Acceso a cmara no soportado para contexto visual.","error.snapshotCameraAccessNotSupported":"Acceso a cmara no soportado para captura.","error.visualContext2DContext":"No se pudo obtener contexto 2D para contexto visual.","error.snapshot2DContext":"No se pudo obtener contexto 2D para captura.","error.visualContextCaptureFailedPermission":"Contexto visual fall: Permiso de cmara denegado.","error.snapshotCaptureFailedPermission":"Captura fall: Permiso de cmara denegado.","error.visualContextCaptureFailedNotFound":"Contexto visual fall: Cmara no encontrada.","error.snapshotCaptureFailedNotFound":"Captura fall: Cmara no encontrada.","error.visualContextCaptureFailedNotReady":"Contexto visual fall: Cmara no lista o problema con la transmisin. {details}","error.snapshotCaptureFailedNotReady":"Captura fall: Cmara no lista o problema con la transmisin. {details}","error.visualContextCaptureFailedGeneric":"Contexto visual fall: {details}","error.snapshotCaptureFailedGeneric":"Captura fall: {details}"},nI={"app.title":"Maestro","sttLang.selectLanguage":"Aseta puheentunnistus kielelle {language}","header.targetLanguageTitle":"Nykyinen kohdekieli: {language}","startPage.clickToStart":"Klikkaa lentokonetta","startPage.saveChats":"Tallenna kaikki keskustelut","startPage.loadChats":"Lataa keskustelut","startPage.saveThisChat":"Tallenna tm keskustelu","startPage.appendToChat":"Liit keskusteluun","startPage.trimBeforeBookmark":"Rajaa ennen kirjanmerkki","startPage.maestroAvatar":"Maestron avatar","startPage.addMaestroAvatar":"Lis Maestron avatar","startPage.loadSuccess":"{count} keskusteluistuntoa ladattu ja korvattu onnistuneesti!","startPage.loadError":"Virhe keskustelujen lataamisessa. Tiedosto saattaa olla vioittunut tai vrss muodossa.","startPage.noChatsToSave":"Ei keskusteluhistoriaa tallennettavaksi.","startPage.saveError":"Virhe keskustelujen tallentamisessa. Katso konsoli listietoja varten.","startPage.noChatSelected":"Valitse ensin kielipari.","startPage.noBookmarkSet":"Kirjanmerkki ei ole asetettu. Aseta kirjanmerkki ensin rajataksesi viestit sen edelt.","startPage.noMessagesToTrim":"Ei poistettavia viestej ennen kirjanmerkki.","startPage.trimSuccess":"Poistettiin {count} viesti ennen kirjanmerkki.","startPage.trimError":"Viestien rajaaminen eponnistui. Yrit uudelleen.","startPage.noMessagesToAppend":"Varmuuskopiotiedostosta ei lytynyt yhdistettvi viestej.","startPage.noPairInBackup":"Varmuuskopiotiedosto ei sisll viestej nykyiselle kieliparillesi. Valitse varmuuskopio, joka vastaa nykyist keskusteluasi.","startPage.appendSuccess":"Liitettiin onnistuneesti {count} viesti nykyiseen keskusteluun.","startPage.combineSuccess":"Yhdistetyt keskustelut: {added} uutta viesti listty, yhteens {total} viesti.","startPage.combineNoDuplicates":"Kaikki viestit olivat jo keskustelussasi. Muutoksia ei tehty.","startPage.combineNoChanges":"Ei listtvi uusia viestej. Keskustelusi on muuttumaton.","startPage.invalidBackupFormat":"Virheellinen varmuuskopiotiedosto. Valitse kelvollinen Maestro-varmuuskopio (.ndjson).","startPage.browserNotSupported":"Selaimesi ei tue tiedostojen tallennusta. Kyt Chromea tai Edge.","sessionControls.saveAll.label":"Tallenna kaikki","sessionControls.saveAll.description":"Vie kaikki keskustelut tiedostoon","sessionControls.loadAll.label":"Lataa kaikki","sessionControls.loadAll.description":"Korvaa kaikki keskustelut tiedostolla","sessionControls.reset.label":"Nollaa","sessionControls.reset.description":"Varmuuskopioi ja poista kaikki","sessionControls.saveThis.label":"Tallenna keskustelu","sessionControls.saveThis.description":"Vie vain tm keskustelu","sessionControls.combine.label":"Yhdist","sessionControls.combine.description":"Yhdist varmuuskopio thn","sessionControls.trim.label":"Rajaa","sessionControls.trim.description":"Poista viestit ennen kirjanmerkki","sessionControls.profile":"Profiili:","sessionControls.profilePlaceholder":"Nimesi tai tietosi...","sessionControls.editProfile":"Muokkaa kyttjprofiilia","sessionControls.allChatsControls":"Kaikkien keskustelujen hallinta","sessionControls.thisChatsControls":"Tmn keskustelun hallinta","sessionControls.back":"Takaisin","sessionControls.backupAndReset":"Varmuuskopioi ja nollaa","sessionControls.typeToConfirm":'Kirjoita "{keyword}" vahvistaaksesi',"sessionControls.changeAvatar":"Vaihda avatar","general.clear":"Tyhjenn","general.error":"Pahoittelut, tapahtui virhe.","apiKeyGate.title":"Yhdist Gemini API -avain","apiKeyGate.billingTitle":"Mrit laskutus suurempaa kiintit varten","apiKeyGate.infoLogin":"Kyttjtunnus: API-avain","apiKeyGate.infoVisibility":"Avaimen nkee: Vain sin","apiKeyGate.infoBilling":"Laskutus: Kuun lopussa Googlelta","apiKeyGate.infoCost":"Laskun summa: Sovellus nytt arvion, klikkaa sit","apiKeyGate.infoMore":"Listietoja:","apiKeyGate.privacyPolicy":"Tietosuojakytnt","apiKeyGate.stepsTitle":"Kaksi nopeaa vaihetta:","apiKeyGate.stepOne":"Avaa Google AI Studio ja luo API-avain.","apiKeyGate.stepTwo":"Liit avain alle ja napauta Tallenna.","apiKeyGate.openAiStudio":"Avaa Google AI Studio","apiKeyGate.viewInstructions":"Nyt ohjeet","apiKeyGate.closeInstructions":"Sulje ohjeet","apiKeyGate.previousInstruction":"Edellinen ohje","apiKeyGate.nextInstruction":"Seuraava ohje","apiKeyGate.instructionStep":"Ohje {step} / {total}","apiKeyGate.keyLabel":"Gemini API -avain","apiKeyGate.placeholder":"Liit API-avaimesi thn","apiKeyGate.show":"Nyt","apiKeyGate.hide":"Piilota","apiKeyGate.currentKeySaved":"Avain {maskedKey}","apiKeyGate.keyInvalid":"Virheellinen {maskedKey} avain","apiKeyGate.clearSavedKey":"Tyhjenn tallennettu avain","apiKeyGate.cancel":"Peruuta","apiKeyGate.saving":"Tallennetaan...","apiKeyGate.saveKey":"Tallenna avain","apiKeyGate.close":"Sulje","apiKeyGate.costLabel":"Arvioitu API-kustannus","apiKeyGate.testerFormTitle":"Testaa sovellusta","apiKeyGate.testerFormDescription":"Syt Google Play Kaupassa kyttmsi shkpostiosoite saadaksesi kutsun Android-betaan!","apiKeyGate.testerFormSubmit":"Hanki Early Access","apiKeyGate.testerFormSubmitting":"Lhetetn...","apiKeyGate.testerFormError":"Jokin meni pieleen. Yrit uudelleen.","apiKeyGate.testerFormMustBeGmail":"Kyt @gmail.com-osoitetta Google Playta varten.","apiKeyGate.testerFormCapReached":"Osallistumisraja saavutettu. Kiitos!","apiKeyGate.developerLogin":"kehittjn kirjautuminen","apiKeyGate.submitAnotherEmail":"Vr shkposti? Nollaa ja kokeile toista.","apiKeyGate.testerFormChecking":"Tarkistetaan kutsun tilaa...","apiKeyGate.testerFormApprovedTitle":"Olet mukana! ","apiKeyGate.testerFormApprovedDesc":"Shkpostisi on hyvksytty Android-betatestausohjelmaan.","apiKeyGate.testerFormDownloadBtn":"Tm nappi toimii vain antamallasi shkpostitilill. -- Klikkaa tst Ladataksesi sovelluksen Google Playsta -- Jos et ne sovellusta vaan esimerkiksi virheen (Pyytmsi URL-osoitetta ei lydy palvelimelta.) sulje tm verkkosivu ja avaa se antamallasi shkposti tilill kirjautuneena.","apiKeyGate.testerFormPendingTitle":"Olet jonotuslistalla!","apiKeyGate.testerFormPendingDesc":"Olemme vastaanottaneet shkpostisi. Kutsun ksittelyss kest hetki. Tarkista myhemmin uudelleen! Sulje tm nettisivu ja avaa uudestaan tarkistaaksesi pivitetyn tilan.","apiKeyGate.checkStatusModeBtn":"Oletko jo hakenut? Tarkista tila.","apiKeyGate.submitModeBtn":"Haluatko hakea? Rekisteridy tst.","apiKeyGate.checkStatusTitle":"Tarkista kutsun tila","apiKeyGate.checkStatusDesc":"Syt shkposti, jolla hait jonotuslistalle.","apiKeyGate.checkStatusSubmit":"Tarkista tila","apiKeyGate.testerFormNotFound":"Shkpostia ei lytynyt jonotuslistalta. Rekisteridy ensin.","chat.thinking":"Ajattelen...","chat.loadingHistory":"Ladataan keskusteluhistoriaa...","chat.loadingSuggestions":"Ladataan ehdotuksia...","chat.suggestionsAriaLabel":"Vastausehdotukset","chat.attachImageFromFile":"Liit tiedosto","chat.removeAttachedImage":"Poista liitetty tiedosto","chat.sendMessage":"Lhet viesti","chat.messageInputAriaLabel":"Viestin sytt","chat.retrievedFromWeb":"Haettu verkosta:","chat.videoNotSupported":"Selaimesi ei tue video-tunnistetta.","chat.audioNotSupported":"Selaimesi ei tue audio-tunnistetta.","chat.fileAttachment":"Tiedostoliite","chat.pdf.loading":"Ladataan PDF-tiedostoa...","chat.pdf.error":"PDF-tiedostoa ei voida nytt","chat.pdf.pageIndicator":"Sivu {current} / {total}","chat.imageGenError":"Kuvan luontivirhe","chat.generatingImageLoadingSlow":"Kest hieman pidempn...","chat.stopSpeaking":"Lopeta puhuminen","chat.speakThisLine":"Lausu tm rivi","chat.languageSelector.openGlobe":"Vaihda kielet","chat.maestroTranscriptScrollwheel":"Maestron transkription vieritysnkym","chat.mic.listening":"STT aktiivinen: Kuuntelen...","chat.mic.enableStt":"Ota STT kyttn","chat.mic.disableStt":"Pysyt STT","chat.mic.recordingAudioNote":"Nauhoitetaan nt...","chat.placeholder.normal.listening":"Kuuntelen kielell {language}...","chat.placeholder.normal.sttActive":"Puhu {language} tai kirjoita...","chat.placeholder.normal.sttInactive":"Kirjoita tai napauta mikrofonia puhuaksesi {language}...","chat.placeholder.suggestion.listening":"Puhu {language} kntksesi...","chat.placeholder.suggestion.sttActive":"Puhu tai kirjoita {language} kntksesi...","chat.placeholder.suggestion.sttInactive":"Kirjoita {language} kntksesi...","chat.camera.turnOn":"Ota kameran esikatselu kyttn","chat.camera.turnOff":"Poista kameran esikatselu kytst","chat.camera.selectCamera":"Valitse kamera","chat.camera.imageGenCameraLabel":"Kuvan luonti","chat.camera.captureOrRecord":"Napauta valokuva, pid pohjassa video","chat.camera.stopRecording":"Pysyt nauhoitus","chat.bookIcon.toggleImageGen":"Vaihda kuvan luontitila","chat.imagePreview.alt":"Esikatselu","chat.image.dragToEnlarge":"Ved kulmasta suurentaaksesi","chat.image.dragToShrink":"Ved kulmasta pienentksesi","chat.annotateImage":"Merkitse kuvaan","chat.annotateVideoFrame":"Merkitse nykyiseen ruutuun","chat.annotateModal.editingPreviewAlt":"Merkittv kuva","chat.annotateModal.cancel":"Peruuta","chat.annotateModal.saveAndAttach":"Tallenna ja liit","chat.annotateModal.undo":"Kumoa","chat.suggestion.speak":'Sano: "{suggestion}"',"chat.suggestion.ariaLabel":"Lausu ehdotus: {suggestion}","chat.suggestion.toggleCreateMode":"Vaihda ehdotuksen luontitila","chat.suggestion.createAction":"Luo ehdotus","chat.suggestion.creating":"Luodaan ehdotusta...","chat.maestro.idle":"Maestro on jouten","chat.maestro.title.idle":"Maestro on tll hetkell jouten.","chat.maestro.resting":"Maestro lep...","chat.maestro.observing":"Maestro tarkkailee...","chat.maestro.aboutToEngage":"Maestro on liittymss mukaan...","chat.maestro.title.resting":"Maestro on jouten, paljon aikaa uudelleenaktivoitumiseen.","chat.maestro.title.observing":"Maestro tarkkailee, jonkin verran aikaa uudelleenaktivoitumiseen.","chat.maestro.title.aboutToEngage":"Maestro aktivoituu pian uudelleen.","chat.maestro.typing":"Maestro kirjoittaa...","chat.maestro.title.typing":"Maestro valmistelee vastausta.","chat.maestro.speaking":"Maestro puhuu","chat.maestro.title.speaking":"Maestro puhuu parhaillaan.","chat.maestro.listening":"Kuuntelen...","chat.maestro.title.listening":"Maestro odottaa sytettsi tai ntsi.","chat.maestro.holding":"Maestro odottaa","chat.maestro.title.holding":"Maestro odottaa (uudelleenaktivointi keskeytetty)","chat.bookmark.hiddenHeaderAria":"Piilotetut viestit ylpuolella","chat.bookmark.isHere":"Kirjanmerkki on tll","chat.bookmark.setHere":"Aseta kirjanmerkki thn","chat.bookmark.actionsRegionAria":"Kirjanmerkkitoiminnot","chat.bookmark.actionsToggleTitle":"Kirjanmerkkiasetukset","chat.bookmark.decrementAria":"Nyt yksi vhemmn","chat.bookmark.decrementTitle":"Vhemmn","chat.bookmark.incrementAria":"Nyt yksi lis","chat.bookmark.incrementTitle":"Lis","chat.bookmark.hiddenBelowHeaderAria":"Piilotetut viestit alapuolella","chat.sendPrep.optimizingVideo":"Optimoidaan videota...","chat.sendPrep.optimizingImage":"Optimoidaan kuvaa...","chat.sendPrep.preparingMedia":"Valmistellaan mediaa...","chat.sendPrep.uploadingMedia":"Ladataan mediaa...","chat.sendPrep.finalizing":"Viimeistelln...","chat.header.annotating":"Merkitn","chat.header.recordingAudio":"Nauhoitetaan nt","chat.header.recordingVideo":"Nauhoitetaan videota","chat.header.savePopup":"Tallennetaan...","chat.header.loadPopup":"Ladataan...","chat.header.maestroAvatar":"Pivitetn Maestron avataria","chat.header.watchingVideo":"Katsotaan videota","chat.header.viewingAbove":"Nytetn aiempia viestej","chat.header.liveSession":"Live-istunto","chat.liveSession.stop":"Pysyt live","chat.liveSession.retry":"Yrit live uudelleen","chat.liveSession.start":"-->Soita live puhelu<--","chat.liveSession.liveBadge":"Live","chat.liveSession.connecting":"Yhdistetn","chat.liveSession.defaultLastMessage":"Hei! Kuinka voin auttaa sinua tnn?","chat.liveSession.defaultSuggestion1":"Hei","chat.liveSession.defaultSuggestion2":"Hyv huomenta","chat.liveSession.defaultSuggestion3":"Mit kuuluu?","chat.error.sttError":"STT-virhe: {error}. Kokeile vaihtaa mikrofonia.","chat.error.autoCaptureCameraError":"Automaattisen kameran kaappausvirhe: {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"Nauhoitus pysytettiin automaattisesti {maxMinutes} minuutin jlkeen.","chat.error.videoMetadataError":"Videon metatietoja ei voitu lukea. Tiedosto saattaa olla vioittunut tai tuetussa muodossa.","chat.error.pauseVideoToAnnotate":"Keskeyt video merkitksesi nykyiseen ruutuun","chat.error.imageGenInterrupted":"Kuvan luonti keskeytettiin.","chat.error.thinkingInterrupted":"AI:n vastaus keskeytettiin.","error.noLanguagePair":"Kriittinen virhe: Kieliparia ei ole valittu.","error.translationFailed":"Knns eponnistui. Yrit uudelleen.","error.imageLimitReached":"Istunnon kuvanluontiraja saavutettu. Aloita uusi istunto.","error.tokenLimitReached":"Istunnon token-raja saavutettu. Aloita uusi istunto.","error.apiKeyMissing":"Gemini API -avaimesi puuttuu. Avaa API-avainnkym ja liit avaimesi.","error.apiKeyInvalid":"Gemini API -avaimesi on virheellinen. Tarkista kirjoitusvirheet ja liit kelvollinen avain.","error.apiQuotaExceeded":"Kyttrajasi on loppu. (Maksulliset: lykkmpi chat, videot, pdf, ja kuvien luonti)","error.quotaSetupBilling":"Mrit laskutus","error.quotaStartLive":"Kynnist Live ilmainen versio (ilman kuvien luontia)","error.imageGenCostWarning":"Kuvien luominen maksaa n. 0,04 $ kuvalta. Chat-viesteist menee mys pieni maksu. Google laskuttaa kaiken. Voit seurata kuluja API-avainnkymss.","error.imageGenDisable":"Poista kuvien luonti kytst","error.imageGenViewCost":"Seuraa kuluja API-avainnkymss","error.cameraPermissionDenied":"Kameran kyttoikeus evtty. Ota kameran kyttoikeus kyttn selaimen asetuksissa.","error.cameraNotFound":"Valittua kameraa ei lydy. Varmista, ett se on yhdistetty, tai valitse toinen kamera.","error.cameraAccessNotSupported":"Selaimesi ei tue kameran kytt.","error.cameraUnknown":"Tuntematon virhe kameraan psyss.","error.cameraStreamNotAvailable":"Kameran virta ei ole kytettviss kaappaukseen.","error.imageCaptureGeneric":"Tuntematon virhe kuvan kaappauksessa.","error.visualContextVideoElementNotReady":"Visuaalisen kontekstin videoelementti ei ole valmis.","error.snapshotVideoElementNotReady":"Kuvakaappauksen videoelementti ei ole valmis.","error.visualContextCameraAccessNotSupported":"Kameran kytt ei ole tuettu visuaalisessa kontekstissa.","error.snapshotCameraAccessNotSupported":"Kameran kytt ei ole tuettu kuvakaappauksessa.","error.visualContext2DContext":"2D-kontekstia ei voitu hakea visuaaliselle kontekstille.","error.snapshot2DContext":"2D-kontekstia ei voitu hakea kuvakaappaukselle.","error.visualContextCaptureFailedPermission":"Visuaalinen konteksti eponnistui: Kameran kyttoikeus evtty.","error.snapshotCaptureFailedPermission":"Kuvakaappaus eponnistui: Kameran kyttoikeus evtty.","error.visualContextCaptureFailedNotFound":"Visuaalinen konteksti eponnistui: Kameraa ei lydy.","error.snapshotCaptureFailedNotFound":"Kuvakaappaus eponnistui: Kameraa ei lydy.","error.visualContextCaptureFailedNotReady":"Visuaalinen konteksti eponnistui: Kamera ei ole valmis tai sytteess on ongelma. {details}","error.snapshotCaptureFailedNotReady":"Kuvakaappaus eponnistui: Kamera ei ole valmis tai sytteess on ongelma. {details}","error.visualContextCaptureFailedGeneric":"Visuaalinen konteksti eponnistui: {details}","error.snapshotCaptureFailedGeneric":"Kuvakaappaus eponnistui: {details}"},Qb={"app.title":"Maestro","sttLang.selectLanguage":"Dfinir la reconnaissance vocale sur {language}","header.targetLanguageTitle":"Langue cible actuelle : {language}","startPage.clickToStart":"Cliquez sur l'avion","startPage.saveChats":"Sauvegarder tous les chats","startPage.loadChats":"Charger les chats","startPage.saveThisChat":"Sauvegarder ce chat","startPage.appendToChat":"Ajouter au chat","startPage.trimBeforeBookmark":"Supprimer avant le marque-page","startPage.maestroAvatar":"Avatar de Maestro","startPage.addMaestroAvatar":"Ajouter un avatar Maestro","startPage.loadSuccess":"{count} sessions de chat charges et remplaces avec succs !","startPage.loadError":"Erreur lors du chargement des chats. Le fichier peut tre corrompu ou dans un mauvais format.","startPage.noChatsToSave":"Aucun historique de chat  sauvegarder.","startPage.saveError":"Erreur lors de la sauvegarde des chats. Consultez la console pour plus de dtails.","startPage.noChatSelected":"Veuillez d'abord slectionner une paire de langues.","startPage.noBookmarkSet":"Aucun marque-page dfini. Placez un marque-page pour supprimer les messages prcdents.","startPage.noMessagesToTrim":"Aucun message  supprimer avant le marque-page.","startPage.trimSuccess":"{count} messages supprims avant le marque-page.","startPage.trimError":"chec de la suppression des messages. Veuillez ressayer.","startPage.noMessagesToAppend":"Aucun message trouv dans le fichier de sauvegarde  combiner.","startPage.noPairInBackup":"Le fichier de sauvegarde ne contient pas de messages pour votre paire de langues actuelle. Veuillez slectionner une sauvegarde correspondant  votre chat actuel.","startPage.appendSuccess":"{count} messages ajouts avec succs au chat actuel.","startPage.combineSuccess":"Chats combins : {added} nouveaux messages ajouts, {total} messages au total.","startPage.combineNoDuplicates":"Tous les messages taient dj dans votre chat. Aucune modification effectue.","startPage.combineNoChanges":"Aucun nouveau message  ajouter. Votre chat est inchang.","startPage.invalidBackupFormat":"Fichier de sauvegarde invalide. Veuillez slectionner un fichier de sauvegarde Maestro (.ndjson) valide.","startPage.browserNotSupported":"Votre navigateur ne prend pas en charge la sauvegarde de fichiers. Veuillez utiliser Chrome ou Edge.","sessionControls.saveAll.label":"Tout sauver","sessionControls.saveAll.description":"Exporter tous les chats dans un fichier","sessionControls.loadAll.label":"Tout charger","sessionControls.loadAll.description":"Remplacer tous les chats par le fichier","sessionControls.reset.label":"Rinit.","sessionControls.reset.description":"Sauvegarder et supprimer les donnes","sessionControls.saveThis.label":"Sauver chat","sessionControls.saveThis.description":"Exporter ce chat uniquement","sessionControls.combine.label":"Combiner","sessionControls.combine.description":"Fusionner la sauvegarde dans ce chat","sessionControls.trim.label":"Tronquer","sessionControls.trim.description":"Supprimer les messages avant le marque-page","sessionControls.profile":"Profil :","sessionControls.profilePlaceholder":"Votre nom ou dtails...","sessionControls.editProfile":"Modifier le profil utilisateur","sessionControls.allChatsControls":"Contrles de tous les chats","sessionControls.thisChatsControls":"Contrles de ce chat","sessionControls.back":"Retour","sessionControls.backupAndReset":"Sauvegarder & Rinitialiser","sessionControls.typeToConfirm":'Tapez "{keyword}" pour confirmer',"sessionControls.changeAvatar":"Changer d'avatar","general.clear":"Effacer","general.error":"Dsol, j'ai rencontr une erreur.","apiKeyGate.title":"Connectez votre cl API Gemini","apiKeyGate.billingTitle":"Configurer la facturation pour un quota plus lev","apiKeyGate.infoLogin":"Votre connexion : Une cl API","apiKeyGate.infoVisibility":"Visibilit : Seulement vous","apiKeyGate.infoBilling":"Facturation : Mensuelle, par Google","apiKeyGate.infoCost":"Cot : Affich dans l'appli  appuyez pour voir","apiKeyGate.infoMore":"Plus d'infos :","apiKeyGate.privacyPolicy":"Politique de confidentialit","apiKeyGate.stepsTitle":"Deux tapes rapides :","apiKeyGate.stepOne":"Ouvrez Google AI Studio et crez une cl API.","apiKeyGate.stepTwo":"Collez la cl ci-dessous et appuyez sur Enregistrer.","apiKeyGate.openAiStudio":"Ouvrir Google AI Studio","apiKeyGate.viewInstructions":"Voir les instructions","apiKeyGate.closeInstructions":"Fermer les instructions","apiKeyGate.previousInstruction":"Instruction prcdente","apiKeyGate.nextInstruction":"Instruction suivante","apiKeyGate.instructionStep":"Instruction {step} sur {total}","apiKeyGate.keyLabel":"Cl API Gemini","apiKeyGate.placeholder":"Collez votre cl API ici","apiKeyGate.show":"Afficher","apiKeyGate.hide":"Masquer","apiKeyGate.currentKeySaved":"Cl actuelle enregistre {maskedKey}","apiKeyGate.keyInvalid":"Cl invalide {maskedKey}  collez une nouvelle cl ci-dessous","apiKeyGate.clearSavedKey":"Effacer la cl enregistre","apiKeyGate.cancel":"Annuler","apiKeyGate.saving":"Enregistrement...","apiKeyGate.saveKey":"Enregistrer la cl","apiKeyGate.close":"Fermer","apiKeyGate.costLabel":"Cot estim de l'API","apiKeyGate.testerFormTitle":"Tester l'application","apiKeyGate.testerFormDescription":"Saisissez l'e-mail que vous utilisez pour le Google Play Store afin de recevoir une invitation pour notre bta Android !","apiKeyGate.testerFormSubmit":"Obtenir un accs anticip","apiKeyGate.testerFormSubmitting":"Envoi en cours...","apiKeyGate.testerFormError":"Une erreur est survenue. Veuillez ressayer.","apiKeyGate.testerFormMustBeGmail":"Veuillez utiliser une adresse @gmail.com pour Google Play.","apiKeyGate.testerFormCapReached":"Limite de soumission atteinte. Merci !","apiKeyGate.developerLogin":"connexion dveloppeur","apiKeyGate.submitAnotherEmail":"Mauvais e-mail ? Rinitialisez et essayez-en un autre.","apiKeyGate.testerFormChecking":"Vrification du statut de l'invitation...","apiKeyGate.testerFormApprovedTitle":"Vous y tes ! ","apiKeyGate.testerFormApprovedDesc":"Votre e-mail a t approuv pour le programme de test bta Android.","apiKeyGate.testerFormDownloadBtn":"Tlcharger sur Google Play","apiKeyGate.testerFormPendingTitle":"Vous tes sur liste d'attente !","apiKeyGate.testerFormPendingDesc":"Nous avons reu votre e-mail. Le traitement manuel de l'invitation prend un peu de temps. Veuillez revenir plus tard !","apiKeyGate.checkStatusModeBtn":"Dj inscrit ? Vrifiez votre statut.","apiKeyGate.submitModeBtn":"Besoin de s'inscrire ? C'est par ici.","apiKeyGate.checkStatusTitle":"Vrifier le statut","apiKeyGate.checkStatusDesc":"Saisissez l'e-mail utilis pour la liste d'attente.","apiKeyGate.checkStatusSubmit":"Vrifier le statut","apiKeyGate.testerFormNotFound":"E-mail introuvable sur la liste d'attente. Veuillez d'abord vous inscrire.","chat.thinking":"Rflexion en cours...","chat.loadingHistory":"Chargement de l'historique...","chat.loadingSuggestions":"Chargement des suggestions...","chat.suggestionsAriaLabel":"Suggestions de rponse","chat.attachImageFromFile":"Joindre un fichier","chat.removeAttachedImage":"Supprimer le fichier joint","chat.sendMessage":"Envoyer le message","chat.messageInputAriaLabel":"Saisie du message","chat.retrievedFromWeb":"Rcupr du web :","chat.videoNotSupported":"Votre navigateur ne prend pas en charge la balise vido.","chat.audioNotSupported":"Votre navigateur ne prend pas en charge la balise audio.","chat.fileAttachment":"Pice jointe","chat.pdf.loading":"Chargement du PDF...","chat.pdf.error":"Impossible d'afficher le PDF","chat.pdf.pageIndicator":"Page {current} sur {total}","chat.imageGenError":"Erreur de gnration d'image","chat.generatingImageLoadingSlow":"Cela prend un peu plus de temps...","chat.stopSpeaking":"Arrter de parler","chat.speakThisLine":"Prononcer cette ligne","chat.languageSelector.openGlobe":"Changer de langues","chat.maestroTranscriptScrollwheel":"Vue de dfilement de la transcription Maestro","chat.mic.listening":"STT actif : coute en cours...","chat.mic.enableStt":"Activer STT","chat.mic.disableStt":"Arrter STT","chat.mic.recordingAudioNote":"Enregistrement audio...","chat.placeholder.normal.listening":"coute en {language}...","chat.placeholder.normal.sttActive":"Parlez en {language} ou tapez...","chat.placeholder.normal.sttInactive":"Tapez ou appuyez sur le micro pour parler en {language}...","chat.placeholder.suggestion.listening":"Parlez {language} pour traduire...","chat.placeholder.suggestion.sttActive":"Parlez ou tapez en {language} pour traduire...","chat.placeholder.suggestion.sttInactive":"Tapez en {language} pour traduire...","chat.camera.turnOn":"Activer l'aperu camra","chat.camera.turnOff":"Dsactiver l'aperu camra","chat.camera.selectCamera":"Slectionner la camra","chat.camera.imageGenCameraLabel":"Gnration d'image","chat.camera.captureOrRecord":"Appuyez pour photo, maintenez pour vido","chat.camera.stopRecording":"Arrter l'enregistrement","chat.bookIcon.toggleImageGen":"Activer/dsactiver le mode gnration d'image","chat.imagePreview.alt":"Aperu","chat.image.dragToEnlarge":"Faites glisser le coin pour agrandir","chat.image.dragToShrink":"Faites glisser le coin pour rduire","chat.annotateImage":"Annoter l'image","chat.annotateVideoFrame":"Annoter l'image actuelle","chat.annotateModal.editingPreviewAlt":"Image  annoter","chat.annotateModal.cancel":"Annuler","chat.annotateModal.saveAndAttach":"Enregistrer et joindre","chat.annotateModal.undo":"Annuler","chat.suggestion.speak":'Dire : "{suggestion}"',"chat.suggestion.ariaLabel":"Dire la suggestion : {suggestion}","chat.suggestion.toggleCreateMode":"Activer/dsactiver le mode cration de suggestion","chat.suggestion.createAction":"Crer une suggestion","chat.suggestion.creating":"Cration de la suggestion...","chat.maestro.idle":"Maestro est inactif","chat.maestro.title.idle":"Maestro est actuellement inactif.","chat.maestro.resting":"Maestro se repose...","chat.maestro.observing":"Maestro observe...","chat.maestro.aboutToEngage":"Maestro est sur le point d'intervenir...","chat.maestro.title.resting":"Maestro est inactif, beaucoup de temps avant la ractivation.","chat.maestro.title.observing":"Maestro observe, un peu de temps avant la ractivation.","chat.maestro.title.aboutToEngage":"Maestro est sur le point de se ractiver bientt.","chat.maestro.typing":"Maestro crit...","chat.maestro.title.typing":"Maestro prpare une rponse.","chat.maestro.speaking":"Maestro parle","chat.maestro.title.speaking":"Maestro parle actuellement.","chat.maestro.listening":"coute en cours...","chat.maestro.title.listening":"Maestro attend votre saisie ou votre voix.","chat.maestro.holding":"Maestro est en attente","chat.maestro.title.holding":"Maestro est en attente (ractivation en pause)","chat.bookmark.hiddenHeaderAria":"Messages cachs au-dessus","chat.bookmark.isHere":"Le marque-page est ici","chat.bookmark.setHere":"Dfinir le marque-page ici","chat.bookmark.actionsRegionAria":"Actions du marque-page","chat.bookmark.actionsToggleTitle":"Options du marque-page","chat.bookmark.decrementAria":"Afficher un de moins","chat.bookmark.decrementTitle":"Moins","chat.bookmark.incrementAria":"Afficher un de plus","chat.bookmark.incrementTitle":"Plus","chat.bookmark.hiddenBelowHeaderAria":"Messages cachs en dessous","chat.sendPrep.optimizingVideo":"Optimisation de la vido...","chat.sendPrep.optimizingImage":"Optimisation de l'image...","chat.sendPrep.preparingMedia":"Prparation du mdia...","chat.sendPrep.uploadingMedia":"Tlchargement du mdia...","chat.sendPrep.finalizing":"Finalisation...","chat.header.annotating":"Annotation","chat.header.recordingAudio":"Enregistrement audio","chat.header.recordingVideo":"Enregistrement vido","chat.header.savePopup":"Sauvegarde...","chat.header.loadPopup":"Chargement...","chat.header.maestroAvatar":"Mise  jour de l'avatar Maestro","chat.header.watchingVideo":"Visionnage vido","chat.header.viewingAbove":"Affichage des messages prcdents","chat.header.liveSession":"Session en direct","chat.liveSession.stop":"Arrter le direct","chat.liveSession.retry":"Ressayer le direct","chat.liveSession.start":"Dmarrer le direct","chat.liveSession.liveBadge":"Direct","chat.liveSession.connecting":"Connexion","chat.liveSession.defaultLastMessage":"Bonjour ! Comment puis-je vous aider aujourd'hui ?","chat.liveSession.defaultSuggestion1":"Bonjour","chat.liveSession.defaultSuggestion2":"Bon matin","chat.liveSession.defaultSuggestion3":"Comment allez-vous ?","chat.error.sttError":"Erreur STT : {error}. Essayez de basculer le micro.","chat.error.autoCaptureCameraError":"Erreur de capture automatique camra : {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"Enregistrement arrt automatiquement aprs {maxMinutes} minutes.","chat.error.videoMetadataError":"Impossible de lire les mtadonnes vido. Le fichier peut tre corrompu ou dans un format non pris en charge.","chat.error.pauseVideoToAnnotate":"Mettez la vido en pause pour annoter l'image actuelle","chat.error.imageGenInterrupted":"La gnration d'image a t interrompue.","chat.error.thinkingInterrupted":"La rponse de l'IA a t interrompue.","error.noLanguagePair":"Erreur critique : Aucune paire de langues slectionne.","error.translationFailed":"chec de la traduction. Veuillez ressayer.","error.imageLimitReached":"Limite de gnration d'images de la session atteinte. Veuillez dmarrer une nouvelle session.","error.tokenLimitReached":"Limite de tokens de la session atteinte. Veuillez dmarrer une nouvelle session.","error.apiKeyMissing":"Votre cl API Gemini est manquante. Ouvrez l'cran de la cl API et collez votre cl.","error.apiKeyInvalid":"Votre cl API Gemini est invalide. Veuillez vrifier les fautes de frappe et coller une cl valide.","error.apiQuotaExceeded":"Votre quota est puis (Payant : chat plus intelligent, vido, pdf et gnration d'images)","error.quotaSetupBilling":"Configurer la facturation","error.quotaStartLive":"Dmarrer la version gratuite en direct (sans gn. d'images)","error.imageGenCostWarning":"La gnration d'images cote environ 0,04 $ par image. Les messages de chat ont galement un petit cot. Tout est factur par Google. Vous pouvez suivre les cots dans l'cran de la cl API.","error.imageGenDisable":"Dsactiver la gnration d'images","error.imageGenViewCost":"Suivez les cots dans l'cran de la cl API.","error.cameraPermissionDenied":"Permission camra refuse. Veuillez activer l'accs camra dans les paramtres de votre navigateur.","error.cameraNotFound":"Camra slectionne introuvable. Assurez-vous qu'elle est connecte ou slectionnez une autre camra.","error.cameraAccessNotSupported":"L'accs  la camra n'est pas pris en charge par votre navigateur.","error.cameraUnknown":"Une erreur inconnue s'est produite lors de l'accs  la camra.","error.cameraStreamNotAvailable":"Flux camra non disponible pour la capture.","error.imageCaptureGeneric":"Erreur inconnue lors de la capture d'image.","error.visualContextVideoElementNotReady":"lment vido du contexte visuel non prt.","error.snapshotVideoElementNotReady":"lment vido pour la capture non prt.","error.visualContextCameraAccessNotSupported":"Accs camra non pris en charge pour le contexte visuel.","error.snapshotCameraAccessNotSupported":"Accs camra non pris en charge pour la capture.","error.visualContext2DContext":"Impossible d'obtenir le contexte 2D pour le contexte visuel.","error.snapshot2DContext":"Impossible d'obtenir le contexte 2D pour la capture.","error.visualContextCaptureFailedPermission":"chec du contexte visuel : Permission camra refuse.","error.snapshotCaptureFailedPermission":"chec de la capture : Permission camra refuse.","error.visualContextCaptureFailedNotFound":"chec du contexte visuel : Camra introuvable.","error.snapshotCaptureFailedNotFound":"chec de la capture : Camra introuvable.","error.visualContextCaptureFailedNotReady":"chec du contexte visuel : Camra non prte ou problme avec le flux. {details}","error.snapshotCaptureFailedNotReady":"chec de la capture : Camra non prte ou problme avec le flux. {details}","error.visualContextCaptureFailedGeneric":"chec du contexte visuel : {details}","error.snapshotCaptureFailedGeneric":"chec de la capture : {details}"},aI={"app.title":"","sttLang.selectLanguage":"  {language}   ","header.targetLanguageTitle":"  : {language}","startPage.clickToStart":"   ","startPage.saveChats":"  ","startPage.loadChats":"  ","startPage.saveThisChat":"  ","startPage.appendToChat":" ","startPage.trimBeforeBookmark":"  ","startPage.maestroAvatar":" ","startPage.addMaestroAvatar":"  ","startPage.loadSuccess":"{count}       !","startPage.loadError":"   .        .","startPage.noChatsToSave":"     .","startPage.saveError":"  .     .","startPage.noChatSelected":"      .","startPage.noBookmarkSet":"   .         .","startPage.noMessagesToTrim":"       .","startPage.trimSuccess":"  {count}   .","startPage.trimError":"  .     .","startPage.noMessagesToAppend":"       .","startPage.noPairInBackup":"        .           .","startPage.appendSuccess":"   {count}  .","startPage.combineSuccess":"  : {added}   ,  {total} .","startPage.combineNoDuplicates":"      .    .","startPage.combineNoChanges":"     .    .","startPage.invalidBackupFormat":"  .    Maestro  (.ndjson)   .","startPage.browserNotSupported":"      .   Chrome  Edge   .","sessionControls.saveAll.label":" ","sessionControls.saveAll.description":"     ","sessionControls.loadAll.label":"  ","sessionControls.loadAll.description":"     ","sessionControls.reset.label":"","sessionControls.reset.description":"     ","sessionControls.saveThis.label":" ","sessionControls.saveThis.description":"    ","sessionControls.combine.label":"","sessionControls.combine.description":"    ","sessionControls.trim.label":"","sessionControls.trim.description":"    ","sessionControls.profile":":","sessionControls.profilePlaceholder":"   ...","sessionControls.editProfile":"   ","sessionControls.allChatsControls":"  ","sessionControls.thisChatsControls":"  ","sessionControls.back":"","sessionControls.backupAndReset":"  ","sessionControls.typeToConfirm":'   "{keyword}"  ',"sessionControls.changeAvatar":" ","general.clear":" ","general.error":" ,   .","apiKeyGate.title":" Gemini API  ","apiKeyGate.billingTitle":"     ","apiKeyGate.infoLogin":" :  API ","apiKeyGate.infoVisibility":"  :  ","apiKeyGate.infoBilling":": , Google ","apiKeyGate.infoCost":":        ","apiKeyGate.infoMore":" :","apiKeyGate.privacyPolicy":" ","apiKeyGate.stepsTitle":"  :","apiKeyGate.stepOne":"Google AI Studio   API  .","apiKeyGate.stepTwo":"        .","apiKeyGate.openAiStudio":"Google AI Studio ","apiKeyGate.viewInstructions":" ","apiKeyGate.closeInstructions":"  ","apiKeyGate.previousInstruction":" ","apiKeyGate.nextInstruction":" ","apiKeyGate.instructionStep":" {step} / {total}","apiKeyGate.keyLabel":"Gemini API ","apiKeyGate.placeholder":" API    ","apiKeyGate.show":"","apiKeyGate.hide":"","apiKeyGate.currentKeySaved":"    {maskedKey}","apiKeyGate.keyInvalid":"  {maskedKey}      ","apiKeyGate.clearSavedKey":"   ","apiKeyGate.cancel":" ","apiKeyGate.saving":"  ...","apiKeyGate.saveKey":" ","apiKeyGate.close":" ","apiKeyGate.costLabel":" API ","apiKeyGate.testerFormTitle":"  ","apiKeyGate.testerFormDescription":" Android      Google Play Store         !","apiKeyGate.testerFormSubmit":"  ","apiKeyGate.testerFormSubmitting":"  ...","apiKeyGate.testerFormError":"  .     .","apiKeyGate.testerFormMustBeGmail":"Google Play    @gmail.com  .","apiKeyGate.testerFormCapReached":"     . !","apiKeyGate.developerLogin":" ","apiKeyGate.submitAnotherEmail":"   ?      .","apiKeyGate.testerFormChecking":"     ...","apiKeyGate.testerFormApprovedTitle":"   ! ","apiKeyGate.testerFormApprovedDesc":"  Android        .","apiKeyGate.testerFormDownloadBtn":"Google Play    ","apiKeyGate.testerFormPendingTitle":"  !","apiKeyGate.testerFormPendingDesc":"    .        .    !","apiKeyGate.checkStatusModeBtn":"    ?   .","apiKeyGate.submitModeBtn":"   ?    .","apiKeyGate.checkStatusTitle":"  ","apiKeyGate.checkStatusDesc":"          .","apiKeyGate.checkStatusSubmit":" ","apiKeyGate.testerFormNotFound":"   .      .","chat.thinking":" ...","chat.loadingHistory":"     ...","chat.loadingSuggestions":"    ...","chat.suggestionsAriaLabel":" ","chat.attachImageFromFile":" ","chat.removeAttachedImage":"   ","chat.sendMessage":" ","chat.messageInputAriaLabel":" ","chat.retrievedFromWeb":"  :","chat.videoNotSupported":"      .","chat.audioNotSupported":"      .","chat.fileAttachment":" ","chat.pdf.loading":"PDF    ...","chat.pdf.error":"PDF    ","chat.pdf.pageIndicator":" {current} / {total}","chat.imageGenError":"  ","chat.generatingImageLoadingSlow":"     ...","chat.stopSpeaking":"  ","chat.speakThisLine":"  ","chat.languageSelector.openGlobe":" ","chat.maestroTranscriptScrollwheel":"   ","chat.mic.listening":"STT :   ...","chat.mic.enableStt":"STT  ","chat.mic.disableStt":"STT ","chat.mic.recordingAudioNote":"    ...","chat.placeholder.normal.listening":"{language}    ...","chat.placeholder.normal.sttActive":"{language}     ...","chat.placeholder.normal.sttInactive":"   {language}       ...","chat.placeholder.suggestion.listening":"   {language} ...","chat.placeholder.suggestion.sttActive":"   {language}     ...","chat.placeholder.suggestion.sttInactive":"   {language}   ...","chat.camera.turnOn":"   ","chat.camera.turnOff":"   ","chat.camera.selectCamera":"  ","chat.camera.imageGenCameraLabel":" ","chat.camera.captureOrRecord":"   ,    ","chat.camera.stopRecording":" ","chat.bookIcon.toggleImageGen":"    ","chat.imagePreview.alt":"","chat.image.dragToEnlarge":"    ","chat.image.dragToShrink":"    ","chat.annotateImage":"   ","chat.annotateVideoFrame":"    ","chat.annotateModal.editingPreviewAlt":"   ","chat.annotateModal.cancel":" ","chat.annotateModal.saveAndAttach":"  ","chat.annotateModal.undo":" ","chat.suggestion.speak":': "{suggestion}"',"chat.suggestion.ariaLabel":" : {suggestion}","chat.suggestion.toggleCreateMode":"    ","chat.suggestion.createAction":" ","chat.suggestion.creating":"   ...","chat.maestro.idle":"  ","chat.maestro.title.idle":"   .","chat.maestro.resting":"    ...","chat.maestro.observing":"    ...","chat.maestro.aboutToEngage":"  ...","chat.maestro.title.resting":"  ,      .","chat.maestro.title.observing":"    ,      .","chat.maestro.title.aboutToEngage":"     .","chat.maestro.typing":"    ...","chat.maestro.title.typing":"     .","chat.maestro.speaking":"   ","chat.maestro.title.speaking":"    .","chat.maestro.listening":"  ...","chat.maestro.title.listening":"        .","chat.maestro.holding":"    ","chat.maestro.title.holding":"     (  )","chat.bookmark.hiddenHeaderAria":"  ","chat.bookmark.isHere":"  ","chat.bookmark.setHere":"   ","chat.bookmark.actionsRegionAria":" ","chat.bookmark.actionsToggleTitle":" ","chat.bookmark.decrementAria":"  ","chat.bookmark.decrementTitle":" ","chat.bookmark.incrementAria":"  ","chat.bookmark.incrementTitle":" ","chat.bookmark.hiddenBelowHeaderAria":"  ","chat.sendPrep.optimizingVideo":"    ...","chat.sendPrep.optimizingImage":"    ...","chat.sendPrep.preparingMedia":"    ...","chat.sendPrep.uploadingMedia":"    ...","chat.sendPrep.finalizing":"    ...","chat.header.annotating":"   ","chat.header.recordingAudio":"    ","chat.header.recordingVideo":"    ","chat.header.savePopup":"  ...","chat.header.loadPopup":"   ...","chat.header.maestroAvatar":"     ","chat.header.watchingVideo":"   ","chat.header.viewingAbove":"    ","chat.header.liveSession":" ","chat.liveSession.stop":" ","chat.liveSession.retry":"   ","chat.liveSession.start":"  ","chat.liveSession.liveBadge":"","chat.liveSession.connecting":"   ","chat.liveSession.defaultLastMessage":"!        ?","chat.liveSession.defaultSuggestion1":"","chat.liveSession.defaultSuggestion2":" ","chat.liveSession.defaultSuggestion3":"  ?","chat.error.sttError":"STT : {error}.    .","chat.error.autoCaptureCameraError":"   : {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"{maxMinutes}      .","chat.error.videoMetadataError":"    .        .","chat.error.pauseVideoToAnnotate":"       ","chat.error.imageGenInterrupted":"   .","chat.error.thinkingInterrupted":"AI   .","error.noLanguagePair":" :      .","error.translationFailed":" .   .","error.imageLimitReached":"    .      .","error.tokenLimitReached":"    .      .","error.apiKeyMissing":" Gemini API   . API        .","error.apiKeyInvalid":" Gemini API   .          .","error.apiQuotaExceeded":"      (:  , ,    )","error.quotaSetupBilling":"  ","error.quotaStartLive":"     (   )","error.imageGenCostWarning":"       $0.04 .       .  Google     .  API       .","error.imageGenDisable":"   ","error.imageGenViewCost":"API     .","error.cameraPermissionDenied":"  .      .","error.cameraNotFound":"    .            .","error.cameraAccessNotSupported":"      .","error.cameraUnknown":"      .","error.cameraStreamNotAvailable":"     .","error.imageCaptureGeneric":"     .","error.visualContextVideoElementNotReady":"     .","error.snapshotVideoElementNotReady":"    .","error.visualContextCameraAccessNotSupported":"      .","error.snapshotCameraAccessNotSupported":"     .","error.visualContext2DContext":"   2D    .","error.snapshot2DContext":"  2D    .","error.visualContextCaptureFailedPermission":"  :   .","error.snapshotCaptureFailedPermission":" :   .","error.visualContextCaptureFailedNotFound":"  :   .","error.snapshotCaptureFailedNotFound":" :   .","error.visualContextCaptureFailedNotReady":"  :      . {details}","error.snapshotCaptureFailedNotReady":" :      . {details}","error.visualContextCaptureFailedGeneric":"  : {details}","error.snapshotCaptureFailedGeneric":" : {details}"},iI={"app.title":"Maestro","sttLang.selectLanguage":"   {language}   ","header.targetLanguageTitle":"  : {language}","startPage.clickToStart":"    ","startPage.saveChats":"  ","startPage.loadChats":"  ","startPage.saveThisChat":"  ","startPage.appendToChat":"  ","startPage.trimBeforeBookmark":"    ","startPage.maestroAvatar":" ","startPage.addMaestroAvatar":"  ","startPage.loadSuccess":"{count}       !","startPage.loadError":"             ","startPage.noChatsToSave":"       ","startPage.saveError":"         ","startPage.noChatSelected":"     ","startPage.noBookmarkSet":"                  ","startPage.noMessagesToTrim":"         ","startPage.trimSuccess":"   {count}    ","startPage.trimError":"      :  ","startPage.noMessagesToAppend":"         ","startPage.noPairInBackup":"                       ","startPage.appendSuccess":"    {count}   ","startPage.combineSuccess":" : {added}    ,  {total} ","startPage.combineNoDuplicates":"            ","startPage.combineNoChanges":"           ","startPage.invalidBackupFormat":"      Maestro  (.ndjson)  ","startPage.browserNotSupported":"          Chrome  Edge   ","sessionControls.saveAll.label":" ","sessionControls.saveAll.description":"      ","sessionControls.loadAll.label":"  ","sessionControls.loadAll.description":"     ","sessionControls.reset.label":"","sessionControls.reset.description":"     ","sessionControls.saveThis.label":" ","sessionControls.saveThis.description":"    ","sessionControls.combine.label":"","sessionControls.combine.description":"     ","sessionControls.trim.label":"","sessionControls.trim.description":"     ","sessionControls.profile":":","sessionControls.profilePlaceholder":"   ...","sessionControls.editProfile":"   ","sessionControls.allChatsControls":"  ","sessionControls.thisChatsControls":"  ","sessionControls.back":"","sessionControls.backupAndReset":"  ","sessionControls.typeToConfirm":'    "{keyword}"  ',"sessionControls.changeAvatar":" ","general.clear":" ","general.error":" ,   ","apiKeyGate.title":" Gemini API   ","apiKeyGate.billingTitle":"      ","apiKeyGate.infoLogin":" :  API ","apiKeyGate.infoVisibility":"   :  ","apiKeyGate.infoBilling":": , Google ","apiKeyGate.infoCost":":          ","apiKeyGate.infoMore":" :","apiKeyGate.privacyPolicy":" ","apiKeyGate.stepsTitle":"  :","apiKeyGate.stepOne":"Google AI Studio    API  ","apiKeyGate.stepTwo":"        ","apiKeyGate.openAiStudio":"Google AI Studio ","apiKeyGate.viewInstructions":" ","apiKeyGate.closeInstructions":"  ","apiKeyGate.previousInstruction":" ","apiKeyGate.nextInstruction":" ","apiKeyGate.instructionStep":" {total}   {step}","apiKeyGate.keyLabel":"Gemini API ","apiKeyGate.placeholder":" API    ","apiKeyGate.show":"","apiKeyGate.hide":"","apiKeyGate.currentKeySaved":"    {maskedKey}","apiKeyGate.keyInvalid":"  {maskedKey}     ","apiKeyGate.clearSavedKey":"    ","apiKeyGate.cancel":" ","apiKeyGate.saving":"  ...","apiKeyGate.saveKey":" ","apiKeyGate.close":" ","apiKeyGate.costLabel":" API ","apiKeyGate.testerFormTitle":"   ","apiKeyGate.testerFormDescription":" Android             Google Play Store     !","apiKeyGate.testerFormSubmit":"   ","apiKeyGate.testerFormSubmitting":"   ...","apiKeyGate.testerFormError":"     :  ","apiKeyGate.testerFormMustBeGmail":"Google Play    @gmail.com    ","apiKeyGate.testerFormCapReached":"     !","apiKeyGate.developerLogin":" ","apiKeyGate.submitAnotherEmail":"   ?      ","apiKeyGate.testerFormChecking":"        ...","apiKeyGate.testerFormApprovedTitle":"  ! ","apiKeyGate.testerFormApprovedDesc":"   Android          ","apiKeyGate.testerFormDownloadBtn":"Google Play    ","apiKeyGate.testerFormPendingTitle":"    !","apiKeyGate.testerFormPendingDesc":"                   !","apiKeyGate.checkStatusModeBtn":"    ?   ","apiKeyGate.submitModeBtn":"  ?    ","apiKeyGate.checkStatusTitle":"  ","apiKeyGate.checkStatusDesc":"            ","apiKeyGate.checkStatusSubmit":" ","apiKeyGate.testerFormNotFound":"          ","chat.thinking":"  ...","chat.loadingHistory":"     ...","chat.loadingSuggestions":"    ...","chat.suggestionsAriaLabel":" ","chat.attachImageFromFile":"  ","chat.removeAttachedImage":"  ","chat.sendMessage":" ","chat.messageInputAriaLabel":" ","chat.retrievedFromWeb":"  :","chat.videoNotSupported":"       ","chat.audioNotSupported":"       ","chat.fileAttachment":" ","chat.pdf.loading":"PDF    ...","chat.pdf.error":"PDF    ","chat.pdf.pageIndicator":" {current} / {total}","chat.imageGenError":"  ","chat.generatingImageLoadingSlow":"     ...","chat.stopSpeaking":"  ","chat.speakThisLine":"  ","chat.languageSelector.openGlobe":" ","chat.maestroTranscriptScrollwheel":"   ","chat.mic.listening":"STT :   ...","chat.mic.enableStt":"STT  ","chat.mic.disableStt":"STT  ","chat.mic.recordingAudioNote":"    ...","chat.placeholder.normal.listening":"{language}    ...","chat.placeholder.normal.sttActive":"{language}     ...","chat.placeholder.normal.sttInactive":"      {language}  ...","chat.placeholder.suggestion.listening":"   {language} ...","chat.placeholder.suggestion.sttActive":"   {language}     ...","chat.placeholder.suggestion.sttInactive":"   {language}   ...","chat.camera.turnOn":"   ","chat.camera.turnOff":"   ","chat.camera.selectCamera":" ","chat.camera.imageGenCameraLabel":" ","chat.camera.captureOrRecord":"    ,     ","chat.camera.stopRecording":"  ","chat.bookIcon.toggleImageGen":"    ","chat.imagePreview.alt":"","chat.image.dragToEnlarge":"     ","chat.image.dragToShrink":"     ","chat.annotateImage":"   ","chat.annotateVideoFrame":"    ","chat.annotateModal.editingPreviewAlt":"   ","chat.annotateModal.cancel":" ","chat.annotateModal.saveAndAttach":"   ","chat.annotateModal.undo":" ","chat.suggestion.speak":': "{suggestion}"',"chat.suggestion.ariaLabel":" : {suggestion}","chat.suggestion.toggleCreateMode":"    ","chat.suggestion.createAction":" ","chat.suggestion.creating":"   ...","chat.maestro.idle":"  ","chat.maestro.title.idle":"    ","chat.maestro.resting":"    ...","chat.maestro.observing":"   ...","chat.maestro.aboutToEngage":"   ...","chat.maestro.title.resting":"  ,      ","chat.maestro.title.observing":"   ,      ","chat.maestro.title.aboutToEngage":"    ","chat.maestro.typing":"    ...","chat.maestro.title.typing":"     ","chat.maestro.speaking":"   ","chat.maestro.title.speaking":"    ","chat.maestro.listening":"  ...","chat.maestro.title.listening":"         ","chat.maestro.holding":"   ","chat.maestro.title.holding":"    (  )","chat.bookmark.hiddenHeaderAria":"  ","chat.bookmark.isHere":"  ","chat.bookmark.setHere":"   ","chat.bookmark.actionsRegionAria":" ","chat.bookmark.actionsToggleTitle":" ","chat.bookmark.decrementAria":"  ","chat.bookmark.decrementTitle":"","chat.bookmark.incrementAria":"  ","chat.bookmark.incrementTitle":"","chat.bookmark.hiddenBelowHeaderAria":"  ","chat.sendPrep.optimizingVideo":"    ...","chat.sendPrep.optimizingImage":"    ...","chat.sendPrep.preparingMedia":"    ...","chat.sendPrep.uploadingMedia":"    ...","chat.sendPrep.finalizing":"   ...","chat.header.annotating":"   ","chat.header.recordingAudio":"    ","chat.header.recordingVideo":"    ","chat.header.savePopup":"  ...","chat.header.loadPopup":"   ...","chat.header.maestroAvatar":"     ","chat.header.watchingVideo":"   ","chat.header.viewingAbove":"    ","chat.header.liveSession":" ","chat.liveSession.stop":"  ","chat.liveSession.retry":"   ","chat.liveSession.start":"  ","chat.liveSession.liveBadge":"","chat.liveSession.connecting":"   ","chat.liveSession.defaultLastMessage":"!        ?","chat.liveSession.defaultSuggestion1":"","chat.liveSession.defaultSuggestion2":" ","chat.liveSession.defaultSuggestion3":"  ?","chat.error.sttError":"STT : {error}      ","chat.error.autoCaptureCameraError":"   : {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"{maxMinutes}          ","chat.error.videoMetadataError":"             ","chat.error.pauseVideoToAnnotate":"        ","chat.error.imageGenInterrupted":"   ","chat.error.thinkingInterrupted":"AI   ","error.noLanguagePair":" :      ","error.translationFailed":"     ","error.imageLimitReached":"           ","error.tokenLimitReached":"          ","error.apiKeyMissing":" Gemini API    API        ","error.apiKeyInvalid":" Gemini API              ","error.apiQuotaExceeded":"      (:  , ,    )","error.quotaSetupBilling":"   ","error.quotaStartLive":"     (   )","error.imageGenCostWarning":"       $0.04              Google      API        ","error.imageGenDisable":"   ","error.imageGenViewCost":"API      ","error.cameraPermissionDenied":"          ","error.cameraNotFound":"             ","error.cameraAccessNotSupported":"       ","error.cameraUnknown":"      ","error.cameraStreamNotAvailable":"       ","error.imageCaptureGeneric":"     ","error.visualContextVideoElementNotReady":"      ","error.snapshotVideoElementNotReady":"     ","error.visualContextCameraAccessNotSupported":"        ","error.snapshotCameraAccessNotSupported":"       ","error.visualContext2DContext":"    2D     ","error.snapshot2DContext":"   2D     ","error.visualContextCaptureFailedPermission":"  :   ","error.snapshotCaptureFailedPermission":" :   ","error.visualContextCaptureFailedNotFound":"  :   ","error.snapshotCaptureFailedNotFound":" :   ","error.visualContextCaptureFailedNotReady":"  :        {details}","error.snapshotCaptureFailedNotReady":" :        {details}","error.visualContextCaptureFailedGeneric":"  : {details}","error.snapshotCaptureFailedGeneric":" : {details}"},rI={"app.title":"Maestro","sttLang.selectLanguage":"Atur pengenalan suara ke {language}","header.targetLanguageTitle":"Bahasa Target Saat Ini: {language}","startPage.clickToStart":"Klik pesawat","startPage.saveChats":"Simpan Semua Obrolan","startPage.loadChats":"Muat Obrolan","startPage.saveThisChat":"Simpan Obrolan Ini","startPage.appendToChat":"Tambahkan ke Obrolan","startPage.trimBeforeBookmark":"Pangkas Sebelum Penanda","startPage.maestroAvatar":"Avatar Maestro","startPage.addMaestroAvatar":"Tambah avatar Maestro","startPage.loadSuccess":"Berhasil memuat dan mengganti {count} sesi obrolan!","startPage.loadError":"Gagal memuat obrolan. File mungkin rusak atau format salah.","startPage.noChatsToSave":"Tidak ada riwayat obrolan untuk disimpan.","startPage.saveError":"Gagal menyimpan obrolan. Lihat konsol untuk detail lebih lanjut.","startPage.noChatSelected":"Silakan pilih pasangan bahasa terlebih dahulu.","startPage.noBookmarkSet":"Belum ada penanda. Pasang penanda terlebih dahulu untuk memangkas pesan sebelumnya.","startPage.noMessagesToTrim":"Tidak ada pesan sebelum penanda untuk dihapus.","startPage.trimSuccess":"Menghapus {count} pesan sebelum penanda.","startPage.trimError":"Gagal memangkas pesan. Silakan coba lagi.","startPage.noMessagesToAppend":"Tidak ada pesan ditemukan dalam file cadangan untuk digabungkan.","startPage.noPairInBackup":"File cadangan tidak berisi pesan untuk pasangan bahasa Anda saat ini. Silakan pilih cadangan yang cocok dengan obrolan Anda saat ini.","startPage.appendSuccess":"Berhasil menambahkan {count} pesan ke obrolan saat ini.","startPage.combineSuccess":"Obrolan digabungkan: {added} pesan baru ditambahkan, total {total} pesan.","startPage.combineNoDuplicates":"Semua pesan sudah ada di obrolan Anda. Tidak ada perubahan.","startPage.combineNoChanges":"Tidak ada pesan baru untuk ditambahkan. Obrolan Anda tidak berubah.","startPage.invalidBackupFormat":"File cadangan tidak valid. Silakan pilih file cadangan Maestro (.ndjson) yang valid.","startPage.browserNotSupported":"Browser Anda tidak mendukung penyimpanan file. Silakan gunakan Chrome atau Edge.","sessionControls.saveAll.label":"Simpan Semua","sessionControls.saveAll.description":"Ekspor semua obrolan ke file cadangan","sessionControls.loadAll.label":"Muat Semua","sessionControls.loadAll.description":"Ganti semua obrolan dengan file cadangan","sessionControls.reset.label":"Atur Ulang","sessionControls.reset.description":"Cadangkan & hapus semua data","sessionControls.saveThis.label":"Simpan Obrolan","sessionControls.saveThis.description":"Ekspor obrolan ini saja","sessionControls.combine.label":"Gabungkan","sessionControls.combine.description":"Gabungkan cadangan ke obrolan ini","sessionControls.trim.label":"Pangkas","sessionControls.trim.description":"Hapus pesan sebelum penanda","sessionControls.profile":"Profil:","sessionControls.profilePlaceholder":"Nama atau detail Anda...","sessionControls.editProfile":"Edit Profil Pengguna","sessionControls.allChatsControls":"Kontrol Semua Obrolan","sessionControls.thisChatsControls":"Kontrol Obrolan Ini","sessionControls.back":"Kembali","sessionControls.backupAndReset":"Cadangkan & Atur Ulang","sessionControls.typeToConfirm":'Ketik "{keyword}" untuk konfirmasi',"sessionControls.changeAvatar":"Ubah Avatar","general.clear":"Hapus","general.error":"Maaf, terjadi kesalahan.","apiKeyGate.title":"Hubungkan kunci API Gemini Anda","apiKeyGate.billingTitle":"Siapkan penagihan untuk kuota lebih tinggi","apiKeyGate.infoLogin":"Login Anda: Kunci API","apiKeyGate.infoVisibility":"Yang melihat: Hanya Anda","apiKeyGate.infoBilling":"Tagihan: Bulanan, dari Google","apiKeyGate.infoCost":"Biaya: Ditampilkan di aplikasi  ketuk untuk melihat","apiKeyGate.infoMore":"Info selengkapnya:","apiKeyGate.privacyPolicy":"Kebijakan Privasi","apiKeyGate.stepsTitle":"Dua langkah cepat:","apiKeyGate.stepOne":"Buka Google AI Studio dan buat kunci API.","apiKeyGate.stepTwo":"Tempelkan kunci di bawah dan ketuk Simpan.","apiKeyGate.openAiStudio":"Buka Google AI Studio","apiKeyGate.viewInstructions":"Lihat instruksi","apiKeyGate.closeInstructions":"Tutup instruksi","apiKeyGate.previousInstruction":"Instruksi sebelumnya","apiKeyGate.nextInstruction":"Instruksi selanjutnya","apiKeyGate.instructionStep":"Instruksi {step} dari {total}","apiKeyGate.keyLabel":"Kunci API Gemini","apiKeyGate.placeholder":"Tempelkan kunci API Anda di sini","apiKeyGate.show":"Tampilkan","apiKeyGate.hide":"Sembunyikan","apiKeyGate.currentKeySaved":"Kunci saat ini tersimpan {maskedKey}","apiKeyGate.keyInvalid":"Kunci tidak valid {maskedKey}  tempel kunci baru di bawah","apiKeyGate.clearSavedKey":"Hapus kunci tersimpan","apiKeyGate.cancel":"Batal","apiKeyGate.saving":"Menyimpan...","apiKeyGate.saveKey":"Simpan kunci","apiKeyGate.close":"Tutup","apiKeyGate.costLabel":"Perkiraan biaya API","apiKeyGate.testerFormTitle":"Uji Aplikasinya","apiKeyGate.testerFormDescription":"Masukkan email yang Anda gunakan untuk Google Play Store untuk mendapatkan undangan ke beta Android kami!","apiKeyGate.testerFormSubmit":"Dapatkan Akses Awal","apiKeyGate.testerFormSubmitting":"Mengirim...","apiKeyGate.testerFormError":"Terjadi kesalahan. Silakan coba lagi.","apiKeyGate.testerFormMustBeGmail":"Harap gunakan alamat @gmail.com untuk Google Play.","apiKeyGate.testerFormCapReached":"Batas pengajuan tercapai. Terima kasih!","apiKeyGate.developerLogin":"login pengembang","apiKeyGate.submitAnotherEmail":"Salah memasukkan email? Reset dan coba yang lain.","apiKeyGate.testerFormChecking":"Memeriksa status undangan Anda...","apiKeyGate.testerFormApprovedTitle":"Anda Masuk! ","apiKeyGate.testerFormApprovedDesc":"Email Anda telah disetujui untuk program pengujian beta Android.","apiKeyGate.testerFormDownloadBtn":"Unduh Aplikasi di Google Play","apiKeyGate.testerFormPendingTitle":"Anda ada di Daftar Tunggu!","apiKeyGate.testerFormPendingDesc":"Kami telah menerima email Anda. Butuh waktu untuk memproses undangan secara manual. Silakan periksa kembali nanti!","apiKeyGate.checkStatusModeBtn":"Sudah mendaftar? Periksa status Anda.","apiKeyGate.submitModeBtn":"Perlu mendaftar? Daftar di sini.","apiKeyGate.checkStatusTitle":"Periksa Status Undangan","apiKeyGate.checkStatusDesc":"Masukkan email yang Anda gunakan untuk mendaftar daftar tunggu.","apiKeyGate.checkStatusSubmit":"Periksa Status","apiKeyGate.testerFormNotFound":"Email tidak ditemukan di daftar tunggu. Silakan daftar terlebih dahulu.","chat.thinking":"Sedang berpikir...","chat.loadingHistory":"Memuat riwayat obrolan...","chat.loadingSuggestions":"Memuat saran...","chat.suggestionsAriaLabel":"Saran balasan","chat.attachImageFromFile":"Lampirkan file","chat.removeAttachedImage":"Hapus file terlampir","chat.sendMessage":"Kirim pesan","chat.messageInputAriaLabel":"Input pesan","chat.retrievedFromWeb":"Diambil dari web:","chat.videoNotSupported":"Browser Anda tidak mendukung tag video.","chat.audioNotSupported":"Browser Anda tidak mendukung tag audio.","chat.fileAttachment":"Lampiran file","chat.pdf.loading":"Memuat PDF...","chat.pdf.error":"Tidak dapat menampilkan PDF","chat.pdf.pageIndicator":"Halaman {current} dari {total}","chat.imageGenError":"Kesalahan pembuatan gambar","chat.generatingImageLoadingSlow":"Membutuhkan waktu lebih lama...","chat.stopSpeaking":"Berhenti berbicara","chat.speakThisLine":"Ucapkan baris ini","chat.languageSelector.openGlobe":"Ubah bahasa","chat.maestroTranscriptScrollwheel":"Tampilan gulir transkrip Maestro","chat.mic.listening":"STT aktif: Mendengarkan...","chat.mic.enableStt":"Aktifkan STT","chat.mic.disableStt":"Hentikan STT","chat.mic.recordingAudioNote":"Merekam audio...","chat.placeholder.normal.listening":"Mendengarkan dalam {language}...","chat.placeholder.normal.sttActive":"Bicara dalam {language} atau ketik...","chat.placeholder.normal.sttInactive":"Ketik atau ketuk mikrofon untuk berbicara dalam {language}...","chat.placeholder.suggestion.listening":"Ucapkan {language} untuk menerjemahkan...","chat.placeholder.suggestion.sttActive":"Bicara atau ketik dalam {language} untuk menerjemahkan...","chat.placeholder.suggestion.sttInactive":"Ketik dalam {language} untuk menerjemahkan...","chat.camera.turnOn":"Aktifkan pratinjau kamera","chat.camera.turnOff":"Nonaktifkan pratinjau kamera","chat.camera.selectCamera":"Pilih kamera","chat.camera.imageGenCameraLabel":"Pembuatan gambar","chat.camera.captureOrRecord":"Ketuk untuk foto, tahan untuk video","chat.camera.stopRecording":"Hentikan perekaman","chat.bookIcon.toggleImageGen":"Alihkan mode pembuatan gambar","chat.imagePreview.alt":"Pratinjau","chat.image.dragToEnlarge":"Seret sudut untuk memperbesar","chat.image.dragToShrink":"Seret sudut untuk memperkecil","chat.annotateImage":"Anotasi gambar","chat.annotateVideoFrame":"Anotasi frame saat ini","chat.annotateModal.editingPreviewAlt":"Gambar untuk dianotasi","chat.annotateModal.cancel":"Batal","chat.annotateModal.saveAndAttach":"Simpan dan lampirkan","chat.annotateModal.undo":"Batalkan","chat.suggestion.speak":'Ucapkan: "{suggestion}"',"chat.suggestion.ariaLabel":"Ucapkan saran: {suggestion}","chat.suggestion.toggleCreateMode":"Alihkan mode buat saran","chat.suggestion.createAction":"Buat saran","chat.suggestion.creating":"Membuat saran...","chat.maestro.idle":"Maestro menganggur","chat.maestro.title.idle":"Maestro saat ini menganggur.","chat.maestro.resting":"Maestro sedang beristirahat...","chat.maestro.observing":"Maestro sedang mengamati...","chat.maestro.aboutToEngage":"Maestro akan segera bergabung...","chat.maestro.title.resting":"Maestro menganggur, masih lama sebelum aktif kembali.","chat.maestro.title.observing":"Maestro sedang mengamati, sedikit waktu sebelum aktif kembali.","chat.maestro.title.aboutToEngage":"Maestro akan segera aktif kembali.","chat.maestro.typing":"Maestro sedang mengetik...","chat.maestro.title.typing":"Maestro sedang menyiapkan balasan.","chat.maestro.speaking":"Maestro sedang berbicara","chat.maestro.title.speaking":"Maestro sedang berbicara saat ini.","chat.maestro.listening":"Mendengarkan...","chat.maestro.title.listening":"Maestro menunggu input atau suara Anda.","chat.maestro.holding":"Maestro menunggu","chat.maestro.title.holding":"Maestro menunggu (aktivasi ulang dijeda)","chat.bookmark.hiddenHeaderAria":"Pesan tersembunyi di atas","chat.bookmark.isHere":"Penanda ada di sini","chat.bookmark.setHere":"Atur penanda di sini","chat.bookmark.actionsRegionAria":"Aksi penanda","chat.bookmark.actionsToggleTitle":"Opsi penanda","chat.bookmark.decrementAria":"Tampilkan satu lebih sedikit","chat.bookmark.decrementTitle":"Lebih sedikit","chat.bookmark.incrementAria":"Tampilkan satu lebih banyak","chat.bookmark.incrementTitle":"Lebih banyak","chat.bookmark.hiddenBelowHeaderAria":"Pesan tersembunyi di bawah","chat.sendPrep.optimizingVideo":"Mengoptimalkan video...","chat.sendPrep.optimizingImage":"Mengoptimalkan gambar...","chat.sendPrep.preparingMedia":"Menyiapkan media...","chat.sendPrep.uploadingMedia":"Mengunggah media...","chat.sendPrep.finalizing":"Menyelesaikan...","chat.header.annotating":"Menganotasi","chat.header.recordingAudio":"Merekam audio","chat.header.recordingVideo":"Merekam video","chat.header.savePopup":"Menyimpan...","chat.header.loadPopup":"Memuat...","chat.header.maestroAvatar":"Memperbarui avatar Maestro","chat.header.watchingVideo":"Menonton video","chat.header.viewingAbove":"Melihat pesan sebelumnya","chat.header.liveSession":"Sesi langsung","chat.liveSession.stop":"Hentikan langsung","chat.liveSession.retry":"Coba ulang langsung","chat.liveSession.start":"Mulai langsung","chat.liveSession.liveBadge":"Langsung","chat.liveSession.connecting":"Menghubungkan","chat.liveSession.defaultLastMessage":"Halo! Ada yang bisa saya bantu hari ini?","chat.liveSession.defaultSuggestion1":"Halo","chat.liveSession.defaultSuggestion2":"Selamat pagi","chat.liveSession.defaultSuggestion3":"Apa kabar?","chat.error.sttError":"Kesalahan STT: {error}. Coba alihkan mikrofon.","chat.error.autoCaptureCameraError":"Kesalahan tangkap otomatis kamera: {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"Perekaman dihentikan otomatis setelah {maxMinutes} menit.","chat.error.videoMetadataError":"Tidak dapat membaca metadata video. File mungkin rusak atau format tidak didukung.","chat.error.pauseVideoToAnnotate":"Jeda video untuk menganotasi frame saat ini","chat.error.imageGenInterrupted":"Pembuatan gambar terganggu.","chat.error.thinkingInterrupted":"Respons AI terganggu.","error.noLanguagePair":"Kesalahan kritis: Tidak ada pasangan bahasa yang dipilih.","error.translationFailed":"Terjemahan gagal. Silakan coba lagi.","error.imageLimitReached":"Batas pembuatan gambar sesi tercapai. Silakan mulai sesi baru.","error.tokenLimitReached":"Batas token sesi tercapai. Silakan mulai sesi baru.","error.apiKeyMissing":"Kunci Gemini API Anda hilang. Buka layar Kunci API dan tempelkan kunci Anda.","error.apiKeyInvalid":"Kunci Gemini API Anda tidak valid. Silakan periksa kesalahan ketik dan tempelkan kunci yang valid.","error.apiQuotaExceeded":"Kuota Anda telah habis (Berbayar: obrolan lebih cerdas, video, pdf, dan pembuatan gambar)","error.quotaSetupBilling":"Siapkan penagihan","error.quotaStartLive":"Mulai versi gratis Live (tanpa pembuat gambar)","error.imageGenCostWarning":"Biaya pembuatan gambar ~$0,04 per gambar. Pesan obrolan juga memiliki biaya kecil. Semua ditagih oleh Google. Anda dapat melacak biaya di layar kunci API.","error.imageGenDisable":"Nonaktifkan Pembuatan Gambar","error.imageGenViewCost":"Lacak biaya di layar kunci API.","error.cameraPermissionDenied":"Izin kamera ditolak. Silakan aktifkan akses kamera di pengaturan browser.","error.cameraNotFound":"Kamera yang dipilih tidak ditemukan. Pastikan terhubung atau pilih kamera lain.","error.cameraAccessNotSupported":"Akses kamera tidak didukung oleh browser Anda.","error.cameraUnknown":"Terjadi kesalahan tidak dikenal saat mengakses kamera.","error.cameraStreamNotAvailable":"Stream kamera tidak tersedia untuk pengambilan.","error.imageCaptureGeneric":"Kesalahan tidak dikenal saat mengambil gambar.","error.visualContextVideoElementNotReady":"Elemen video konteks visual belum siap.","error.snapshotVideoElementNotReady":"Elemen video snapshot belum siap.","error.visualContextCameraAccessNotSupported":"Akses kamera tidak didukung untuk konteks visual.","error.snapshotCameraAccessNotSupported":"Akses kamera tidak didukung untuk snapshot.","error.visualContext2DContext":"Tidak dapat mendapatkan konteks 2D untuk konteks visual.","error.snapshot2DContext":"Tidak dapat mendapatkan konteks 2D untuk snapshot.","error.visualContextCaptureFailedPermission":"Konteks visual gagal: Izin kamera ditolak.","error.snapshotCaptureFailedPermission":"Snapshot gagal: Izin kamera ditolak.","error.visualContextCaptureFailedNotFound":"Konteks visual gagal: Kamera tidak ditemukan.","error.snapshotCaptureFailedNotFound":"Snapshot gagal: Kamera tidak ditemukan.","error.visualContextCaptureFailedNotReady":"Konteks visual gagal: Kamera belum siap atau ada masalah dengan feed. {details}","error.snapshotCaptureFailedNotReady":"Snapshot gagal: Kamera belum siap atau ada masalah dengan feed. {details}","error.visualContextCaptureFailedGeneric":"Konteks visual gagal: {details}","error.snapshotCaptureFailedGeneric":"Snapshot gagal: {details}"},sI={"app.title":"Maestro","sttLang.selectLanguage":"Imposta il riconoscimento vocale su {language}","header.targetLanguageTitle":"Lingua di destinazione attuale: {language}","startPage.clickToStart":"Clicca sull'aereo","startPage.saveChats":"Salva tutte le chat","startPage.loadChats":"Carica chat","startPage.saveThisChat":"Salva questa chat","startPage.appendToChat":"Aggiungi alla chat","startPage.trimBeforeBookmark":"Taglia prima del segnalibro","startPage.maestroAvatar":"Avatar di Maestro","startPage.addMaestroAvatar":"Aggiungi avatar Maestro","startPage.loadSuccess":"{count} sessioni di chat caricate e sostituite con successo!","startPage.loadError":"Errore nel caricamento delle chat. Il file potrebbe essere corrotto o in un formato errato.","startPage.noChatsToSave":"Nessuna cronologia chat da salvare.","startPage.saveError":"Errore nel salvataggio delle chat. Controlla la console per maggiori dettagli.","startPage.noChatSelected":"Seleziona prima una coppia di lingue.","startPage.noBookmarkSet":"Nessun segnalibro impostato. Imposta prima un segnalibro per tagliare i messaggi precedenti.","startPage.noMessagesToTrim":"Nessun messaggio prima del segnalibro da rimuovere.","startPage.trimSuccess":"Rimossi {count} messaggi prima del segnalibro.","startPage.trimError":"Impossibile tagliare i messaggi. Riprova.","startPage.noMessagesToAppend":"Nessun messaggio trovato nel file di backup da combinare.","startPage.noPairInBackup":"Il file di backup non contiene messaggi per la tua coppia di lingue attuale. Seleziona un backup che corrisponda alla tua chat corrente.","startPage.appendSuccess":"Aggiunti con successo {count} messaggi alla chat corrente.","startPage.combineSuccess":"Chat combinate: {added} nuovi messaggi aggiunti, {total} messaggi totali.","startPage.combineNoDuplicates":"Tutti i messaggi erano gi presenti nella chat. Nessuna modifica effettuata.","startPage.combineNoChanges":"Nessun nuovo messaggio da aggiungere. La tua chat  invariata.","startPage.invalidBackupFormat":"File di backup non valido. Seleziona un file di backup Maestro (.ndjson) valido.","startPage.browserNotSupported":"Il tuo browser non supporta il salvataggio dei file. Usa Chrome o Edge.","sessionControls.saveAll.label":"Salva tutto","sessionControls.saveAll.description":"Esporta tutte le chat in un file di backup","sessionControls.loadAll.label":"Carica tutto","sessionControls.loadAll.description":"Sostituisci tutte le chat con il file di backup","sessionControls.reset.label":"Reimposta","sessionControls.reset.description":"Backup e cancella tutti i dati","sessionControls.saveThis.label":"Salva chat","sessionControls.saveThis.description":"Esporta solo questa chat","sessionControls.combine.label":"Combina","sessionControls.combine.description":"Unisci backup in questa chat","sessionControls.trim.label":"Taglia","sessionControls.trim.description":"Rimuovi messaggi prima del segnalibro","sessionControls.profile":"Profilo:","sessionControls.profilePlaceholder":"Il tuo nome o dettagli...","sessionControls.editProfile":"Modifica profilo utente","sessionControls.allChatsControls":"Controlli tutte le chat","sessionControls.thisChatsControls":"Controlli questa chat","sessionControls.back":"Indietro","sessionControls.backupAndReset":"Backup e ripristino","sessionControls.typeToConfirm":'Digita "{keyword}" per confermare',"sessionControls.changeAvatar":"Cambia Avatar","general.clear":"Cancella","general.error":"Spiacente, si  verificato un errore.","apiKeyGate.title":"Collega la tua chiave API Gemini","apiKeyGate.billingTitle":"Configura la fatturazione per una quota maggiore","apiKeyGate.infoLogin":"Il tuo login: Una chiave API","apiKeyGate.infoVisibility":"Chi la vede: Solo tu","apiKeyGate.infoBilling":"Fatturazione: Mensile, da Google","apiKeyGate.infoCost":"Costo: Mostrato nell'app  tocca per vedere","apiKeyGate.infoMore":"Maggiori info:","apiKeyGate.privacyPolicy":"Informativa sulla privacy","apiKeyGate.stepsTitle":"Due passaggi rapidi:","apiKeyGate.stepOne":"Apri Google AI Studio e crea una chiave API.","apiKeyGate.stepTwo":"Incolla la chiave qui sotto e tocca Salva.","apiKeyGate.openAiStudio":"Apri Google AI Studio","apiKeyGate.viewInstructions":"Visualizza istruzioni","apiKeyGate.closeInstructions":"Chiudi istruzioni","apiKeyGate.previousInstruction":"Istruzione precedente","apiKeyGate.nextInstruction":"Istruzione successiva","apiKeyGate.instructionStep":"Istruzione {step} di {total}","apiKeyGate.keyLabel":"Chiave API Gemini","apiKeyGate.placeholder":"Incolla qui la tua chiave API","apiKeyGate.show":"Mostra","apiKeyGate.hide":"Nascondi","apiKeyGate.currentKeySaved":"Chiave attuale salvata {maskedKey}","apiKeyGate.keyInvalid":"Chiave non valida {maskedKey}  incolla una nuova chiave qui sotto","apiKeyGate.clearSavedKey":"Cancella chiave salvata","apiKeyGate.cancel":"Annulla","apiKeyGate.saving":"Salvataggio...","apiKeyGate.saveKey":"Salva chiave","apiKeyGate.close":"Chiudi","apiKeyGate.costLabel":"Costo stimato API","apiKeyGate.testerFormTitle":"Testa l'App","apiKeyGate.testerFormDescription":"Inserisci l'email che usi per il Google Play Store per ricevere un invito alla nostra beta Android!","apiKeyGate.testerFormSubmit":"Ottieni accesso anticipato","apiKeyGate.testerFormSubmitting":"Invio in corso...","apiKeyGate.testerFormError":"Qualcosa  andato storto. Riprova.","apiKeyGate.testerFormMustBeGmail":"Usa un indirizzo @gmail.com per Google Play.","apiKeyGate.testerFormCapReached":"Limite di invio raggiunto. Grazie!","apiKeyGate.developerLogin":"login sviluppatore","apiKeyGate.submitAnotherEmail":"Email sbagliata? Resetta e provane un'altra.","apiKeyGate.testerFormChecking":"Controllo dello stato dell'invito...","apiKeyGate.testerFormApprovedTitle":"Sei dentro! ","apiKeyGate.testerFormApprovedDesc":"La tua email  stata approvata per il programma di beta testing Android.","apiKeyGate.testerFormDownloadBtn":"Scarica l'App su Google Play","apiKeyGate.testerFormPendingTitle":"Sei in lista d'attesa!","apiKeyGate.testerFormPendingDesc":"Abbiamo ricevuto la tua email. Ci vuole un po' di tempo per elaborare manualmente l'invito. Controlla pi tardi!","apiKeyGate.checkStatusModeBtn":"Hai gi fatto richiesta? Controlla il tuo stato.","apiKeyGate.submitModeBtn":"Devi fare richiesta? Iscriviti qui.","apiKeyGate.checkStatusTitle":"Controlla stato invito","apiKeyGate.checkStatusDesc":"Inserisci l'email usata per la lista d'attesa.","apiKeyGate.checkStatusSubmit":"Controlla stato","apiKeyGate.testerFormNotFound":"Email non trovata nella lista d'attesa. Registrati prima.","chat.thinking":"Sto pensando...","chat.loadingHistory":"Caricamento cronologia chat...","chat.loadingSuggestions":"Caricamento suggerimenti...","chat.suggestionsAriaLabel":"Suggerimenti di risposta","chat.attachImageFromFile":"Allega file","chat.removeAttachedImage":"Rimuovi file allegato","chat.sendMessage":"Invia messaggio","chat.messageInputAriaLabel":"Inserimento messaggio","chat.retrievedFromWeb":"Recuperato dal web:","chat.videoNotSupported":"Il tuo browser non supporta il tag video.","chat.audioNotSupported":"Il tuo browser non supporta il tag audio.","chat.fileAttachment":"Allegato","chat.pdf.loading":"Caricamento PDF...","chat.pdf.error":"Impossibile visualizzare il PDF","chat.pdf.pageIndicator":"Pagina {current} di {total}","chat.imageGenError":"Errore generazione immagine","chat.generatingImageLoadingSlow":"Ci vuole un po' pi di tempo...","chat.stopSpeaking":"Smetti di parlare","chat.speakThisLine":"Pronuncia questa riga","chat.languageSelector.openGlobe":"Cambia lingue","chat.maestroTranscriptScrollwheel":"Vista a scorrimento della trascrizione Maestro","chat.mic.listening":"STT attivo: In ascolto...","chat.mic.enableStt":"Attiva STT","chat.mic.disableStt":"Ferma STT","chat.mic.recordingAudioNote":"Registrazione audio...","chat.placeholder.normal.listening":"In ascolto in {language}...","chat.placeholder.normal.sttActive":"Parla in {language} o scrivi...","chat.placeholder.normal.sttInactive":"Scrivi o tocca il microfono per parlare in {language}...","chat.placeholder.suggestion.listening":"Parla {language} per tradurre...","chat.placeholder.suggestion.sttActive":"Parla o scrivi in {language} per tradurre...","chat.placeholder.suggestion.sttInactive":"Scrivi in {language} per tradurre...","chat.camera.turnOn":"Attiva anteprima fotocamera","chat.camera.turnOff":"Disattiva anteprima fotocamera","chat.camera.selectCamera":"Seleziona fotocamera","chat.camera.imageGenCameraLabel":"Generazione immagine","chat.camera.captureOrRecord":"Tocca per foto, tieni premuto per video","chat.camera.stopRecording":"Ferma registrazione","chat.bookIcon.toggleImageGen":"Attiva/disattiva modalit generazione immagine","chat.imagePreview.alt":"Anteprima","chat.image.dragToEnlarge":"Trascina l'angolo per ingrandire","chat.image.dragToShrink":"Trascina l'angolo per rimpicciolire","chat.annotateImage":"Annota immagine","chat.annotateVideoFrame":"Annota fotogramma corrente","chat.annotateModal.editingPreviewAlt":"Immagine da annotare","chat.annotateModal.cancel":"Annulla","chat.annotateModal.saveAndAttach":"Salva e allega","chat.annotateModal.undo":"Annulla","chat.suggestion.speak":`Di': "{suggestion}"`,"chat.suggestion.ariaLabel":"Pronuncia suggerimento: {suggestion}","chat.suggestion.toggleCreateMode":"Attiva/disattiva modalit creazione suggerimento","chat.suggestion.createAction":"Crea suggerimento","chat.suggestion.creating":"Creazione suggerimento...","chat.maestro.idle":"Maestro  inattivo","chat.maestro.title.idle":"Maestro  attualmente inattivo.","chat.maestro.resting":"Maestro sta riposando...","chat.maestro.observing":"Maestro sta osservando...","chat.maestro.aboutToEngage":"Maestro sta per intervenire...","chat.maestro.title.resting":"Maestro  inattivo, molto tempo prima della riattivazione.","chat.maestro.title.observing":"Maestro sta osservando, un po' di tempo prima della riattivazione.","chat.maestro.title.aboutToEngage":"Maestro sta per riattivarsi presto.","chat.maestro.typing":"Maestro sta scrivendo...","chat.maestro.title.typing":"Maestro sta preparando una risposta.","chat.maestro.speaking":"Maestro sta parlando","chat.maestro.title.speaking":"Maestro sta parlando ora.","chat.maestro.listening":"In ascolto...","chat.maestro.title.listening":"Maestro sta aspettando il tuo input o la tua voce.","chat.maestro.holding":"Maestro  in attesa","chat.maestro.title.holding":"Maestro  in attesa (riattivazione in pausa)","chat.bookmark.hiddenHeaderAria":"Messaggi nascosti sopra","chat.bookmark.isHere":"Il segnalibro  qui","chat.bookmark.setHere":"Imposta segnalibro qui","chat.bookmark.actionsRegionAria":"Azioni segnalibro","chat.bookmark.actionsToggleTitle":"Opzioni segnalibro","chat.bookmark.decrementAria":"Mostra uno in meno","chat.bookmark.decrementTitle":"Meno","chat.bookmark.incrementAria":"Mostra uno in pi","chat.bookmark.incrementTitle":"Pi","chat.bookmark.hiddenBelowHeaderAria":"Messaggi nascosti sotto","chat.sendPrep.optimizingVideo":"Ottimizzazione video...","chat.sendPrep.optimizingImage":"Ottimizzazione immagine...","chat.sendPrep.preparingMedia":"Preparazione media...","chat.sendPrep.uploadingMedia":"Caricamento media...","chat.sendPrep.finalizing":"Finalizzazione...","chat.header.annotating":"Annotazione","chat.header.recordingAudio":"Registrazione audio","chat.header.recordingVideo":"Registrazione video","chat.header.savePopup":"Salvataggio...","chat.header.loadPopup":"Caricamento...","chat.header.maestroAvatar":"Aggiornamento avatar Maestro","chat.header.watchingVideo":"Visualizzazione video","chat.header.viewingAbove":"Visualizzazione messaggi precedenti","chat.header.liveSession":"Sessione dal vivo","chat.liveSession.stop":"Ferma Live","chat.liveSession.retry":"Riprova Live","chat.liveSession.start":"Avvia Live","chat.liveSession.liveBadge":"Live","chat.liveSession.connecting":"Connessione","chat.liveSession.defaultLastMessage":"Ciao! Come posso aiutarti oggi?","chat.liveSession.defaultSuggestion1":"Ciao","chat.liveSession.defaultSuggestion2":"Buongiorno","chat.liveSession.defaultSuggestion3":"Come stai?","chat.error.sttError":"Errore STT: {error}. Prova a cambiare il microfono.","chat.error.autoCaptureCameraError":"Errore cattura automatica fotocamera: {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"Registrazione fermata automaticamente dopo {maxMinutes} minuti.","chat.error.videoMetadataError":"Impossibile leggere i metadati del video. Il file potrebbe essere corrotto o in un formato non supportato.","chat.error.pauseVideoToAnnotate":"Metti in pausa il video per annotare il fotogramma corrente","chat.error.imageGenInterrupted":"La generazione dell'immagine  stata interrotta.","chat.error.thinkingInterrupted":"La risposta dell'IA  stata interrotta.","error.noLanguagePair":"Errore critico: Nessuna coppia di lingue selezionata.","error.translationFailed":"Traduzione fallita. Riprova.","error.imageLimitReached":"Limite di generazione immagini della sessione raggiunto. Avvia una nuova sessione.","error.tokenLimitReached":"Limite token della sessione raggiunto. Avvia una nuova sessione.","error.apiKeyMissing":"La tua chiave API Gemini  mancante. Apri la schermata della chiave API e incolla la tua chiave.","error.apiKeyInvalid":"La tua chiave API Gemini non  valida. Controlla eventuali errori di battitura e incolla una chiave valida.","error.apiQuotaExceeded":"La tua quota  esaurita (A pagamento: chat pi intelligente, video, pdf e generazione di immagini)","error.quotaSetupBilling":"Imposta la fatturazione","error.quotaStartLive":"Avvia la versione gratuita dal vivo (nessuna gen. immagini)","error.imageGenCostWarning":"La generazione di immagini costa circa $0,04 per immagine. Anche i messaggi di chat hanno un piccolo costo. Tutto fatturato da Google. Puoi monitorare i costi nella schermata della chiave API.","error.imageGenDisable":"Disabilita Generazione Immagini","error.imageGenViewCost":"Monitora i costi nella schermata della chiave API.","error.cameraPermissionDenied":"Permesso fotocamera negato. Abilita l'accesso alla fotocamera nelle impostazioni del browser.","error.cameraNotFound":"Fotocamera selezionata non trovata. Assicurati che sia collegata o seleziona una fotocamera diversa.","error.cameraAccessNotSupported":"L'accesso alla fotocamera non  supportato dal tuo browser.","error.cameraUnknown":"Si  verificato un errore sconosciuto durante l'accesso alla fotocamera.","error.cameraStreamNotAvailable":"Stream fotocamera non disponibile per la cattura.","error.imageCaptureGeneric":"Errore sconosciuto durante la cattura dell'immagine.","error.visualContextVideoElementNotReady":"Elemento video del contesto visivo non pronto.","error.snapshotVideoElementNotReady":"Elemento video per lo snapshot non pronto.","error.visualContextCameraAccessNotSupported":"Accesso fotocamera non supportato per il contesto visivo.","error.snapshotCameraAccessNotSupported":"Accesso fotocamera non supportato per lo snapshot.","error.visualContext2DContext":"Impossibile ottenere il contesto 2D per il contesto visivo.","error.snapshot2DContext":"Impossibile ottenere il contesto 2D per lo snapshot.","error.visualContextCaptureFailedPermission":"Contesto visivo fallito: Permesso fotocamera negato.","error.snapshotCaptureFailedPermission":"Snapshot fallito: Permesso fotocamera negato.","error.visualContextCaptureFailedNotFound":"Contesto visivo fallito: Fotocamera non trovata.","error.snapshotCaptureFailedNotFound":"Snapshot fallito: Fotocamera non trovata.","error.visualContextCaptureFailedNotReady":"Contesto visivo fallito: Fotocamera non pronta o problema con lo stream. {details}","error.snapshotCaptureFailedNotReady":"Snapshot fallito: Fotocamera non pronta o problema con lo stream. {details}","error.visualContextCaptureFailedGeneric":"Contesto visivo fallito: {details}","error.snapshotCaptureFailedGeneric":"Snapshot fallito: {details}"},oI={"app.title":"Maestro","sttLang.selectLanguage":"{language}","header.targetLanguageTitle":"{language}","startPage.clickToStart":"","startPage.saveChats":"","startPage.loadChats":"","startPage.saveThisChat":"","startPage.appendToChat":"","startPage.trimBeforeBookmark":"","startPage.maestroAvatar":"","startPage.addMaestroAvatar":"","startPage.loadSuccess":"{count}","startPage.loadError":"","startPage.noChatsToSave":"","startPage.saveError":"","startPage.noChatSelected":"","startPage.noBookmarkSet":"","startPage.noMessagesToTrim":"","startPage.trimSuccess":"{count}","startPage.trimError":"","startPage.noMessagesToAppend":"","startPage.noPairInBackup":"","startPage.appendSuccess":"{count}","startPage.combineSuccess":"{added}{total}","startPage.combineNoDuplicates":"","startPage.combineNoChanges":"","startPage.invalidBackupFormat":"Maestro.ndjson","startPage.browserNotSupported":"ChromeEdge","sessionControls.saveAll.label":"","sessionControls.saveAll.description":"","sessionControls.loadAll.label":"","sessionControls.loadAll.description":"","sessionControls.reset.label":"","sessionControls.reset.description":"","sessionControls.saveThis.label":"","sessionControls.saveThis.description":"","sessionControls.combine.label":"","sessionControls.combine.description":"","sessionControls.trim.label":"","sessionControls.trim.description":"","sessionControls.profile":"","sessionControls.profilePlaceholder":"...","sessionControls.editProfile":"","sessionControls.allChatsControls":"","sessionControls.thisChatsControls":"","sessionControls.back":"","sessionControls.backupAndReset":"","sessionControls.typeToConfirm":"{keyword}","sessionControls.changeAvatar":"","general.clear":"","general.error":"","apiKeyGate.title":"Gemini API","apiKeyGate.billingTitle":"","apiKeyGate.infoLogin":": API","apiKeyGate.infoVisibility":": ","apiKeyGate.infoBilling":": Google","apiKeyGate.infoCost":":   ","apiKeyGate.infoMore":":","apiKeyGate.privacyPolicy":"","apiKeyGate.stepsTitle":"2","apiKeyGate.stepOne":"Google AI StudioAPI","apiKeyGate.stepTwo":"","apiKeyGate.openAiStudio":"Google AI Studio","apiKeyGate.viewInstructions":"","apiKeyGate.closeInstructions":"","apiKeyGate.previousInstruction":"","apiKeyGate.nextInstruction":"","apiKeyGate.instructionStep":" {step} / {total}","apiKeyGate.keyLabel":"Gemini API","apiKeyGate.placeholder":"API","apiKeyGate.show":"","apiKeyGate.hide":"","apiKeyGate.currentKeySaved":" {maskedKey}","apiKeyGate.keyInvalid":" {maskedKey}  ","apiKeyGate.clearSavedKey":"","apiKeyGate.cancel":"","apiKeyGate.saving":"...","apiKeyGate.saveKey":"","apiKeyGate.close":"","apiKeyGate.costLabel":"API","apiKeyGate.testerFormTitle":"","apiKeyGate.testerFormDescription":"Google Play Android ","apiKeyGate.testerFormSubmit":"","apiKeyGate.testerFormSubmitting":"...","apiKeyGate.testerFormError":"","apiKeyGate.testerFormMustBeGmail":"Google Play  @gmail.com ","apiKeyGate.testerFormCapReached":"","apiKeyGate.developerLogin":"","apiKeyGate.submitAnotherEmail":"","apiKeyGate.testerFormChecking":"...","apiKeyGate.testerFormApprovedTitle":"","apiKeyGate.testerFormApprovedDesc":" Android ","apiKeyGate.testerFormDownloadBtn":"Google Play ","apiKeyGate.testerFormPendingTitle":"","apiKeyGate.testerFormPendingDesc":"","apiKeyGate.checkStatusModeBtn":"","apiKeyGate.submitModeBtn":"","apiKeyGate.checkStatusTitle":"","apiKeyGate.checkStatusDesc":"","apiKeyGate.checkStatusSubmit":"","apiKeyGate.testerFormNotFound":"","chat.thinking":"...","chat.loadingHistory":"...","chat.loadingSuggestions":"...","chat.suggestionsAriaLabel":"","chat.attachImageFromFile":"","chat.removeAttachedImage":"","chat.sendMessage":"","chat.messageInputAriaLabel":"","chat.retrievedFromWeb":"","chat.videoNotSupported":"","chat.audioNotSupported":"","chat.fileAttachment":"","chat.pdf.loading":"PDF...","chat.pdf.error":"PDF","chat.pdf.pageIndicator":" {current} / {total}","chat.imageGenError":"","chat.generatingImageLoadingSlow":"...","chat.stopSpeaking":"","chat.speakThisLine":"","chat.languageSelector.openGlobe":"","chat.maestroTranscriptScrollwheel":"","chat.mic.listening":"STT...","chat.mic.enableStt":"STT","chat.mic.disableStt":"STT","chat.mic.recordingAudioNote":"...","chat.placeholder.normal.listening":"{language}...","chat.placeholder.normal.sttActive":"{language}...","chat.placeholder.normal.sttInactive":"{language}...","chat.placeholder.suggestion.listening":"{language}...","chat.placeholder.suggestion.sttActive":"{language}...","chat.placeholder.suggestion.sttInactive":"{language}...","chat.camera.turnOn":"","chat.camera.turnOff":"","chat.camera.selectCamera":"","chat.camera.imageGenCameraLabel":"","chat.camera.captureOrRecord":"","chat.camera.stopRecording":"","chat.bookIcon.toggleImageGen":"","chat.imagePreview.alt":"","chat.image.dragToEnlarge":"","chat.image.dragToShrink":"","chat.annotateImage":"","chat.annotateVideoFrame":"","chat.annotateModal.editingPreviewAlt":"","chat.annotateModal.cancel":"","chat.annotateModal.saveAndAttach":"","chat.annotateModal.undo":"","chat.suggestion.speak":'"{suggestion}"',"chat.suggestion.ariaLabel":"{suggestion}","chat.suggestion.toggleCreateMode":"","chat.suggestion.createAction":"","chat.suggestion.creating":"...","chat.maestro.idle":"","chat.maestro.title.idle":"","chat.maestro.resting":"...","chat.maestro.observing":"...","chat.maestro.aboutToEngage":"...","chat.maestro.title.resting":"","chat.maestro.title.observing":"","chat.maestro.title.aboutToEngage":"","chat.maestro.typing":"...","chat.maestro.title.typing":"","chat.maestro.speaking":"","chat.maestro.title.speaking":"","chat.maestro.listening":"...","chat.maestro.title.listening":"","chat.maestro.holding":"","chat.maestro.title.holding":"","chat.bookmark.hiddenHeaderAria":"","chat.bookmark.isHere":"","chat.bookmark.setHere":"","chat.bookmark.actionsRegionAria":"","chat.bookmark.actionsToggleTitle":"","chat.bookmark.decrementAria":"1","chat.bookmark.decrementTitle":"","chat.bookmark.incrementAria":"1","chat.bookmark.incrementTitle":"","chat.bookmark.hiddenBelowHeaderAria":"","chat.sendPrep.optimizingVideo":"...","chat.sendPrep.optimizingImage":"...","chat.sendPrep.preparingMedia":"...","chat.sendPrep.uploadingMedia":"...","chat.sendPrep.finalizing":"...","chat.header.annotating":"","chat.header.recordingAudio":"","chat.header.recordingVideo":"","chat.header.savePopup":"...","chat.header.loadPopup":"...","chat.header.maestroAvatar":"","chat.header.watchingVideo":"","chat.header.viewingAbove":"","chat.header.liveSession":"","chat.liveSession.stop":"","chat.liveSession.retry":"","chat.liveSession.start":"","chat.liveSession.liveBadge":"","chat.liveSession.connecting":"","chat.liveSession.defaultLastMessage":"","chat.liveSession.defaultSuggestion1":"","chat.liveSession.defaultSuggestion2":"","chat.liveSession.defaultSuggestion3":"","chat.error.sttError":"STT{error}","chat.error.autoCaptureCameraError":"{error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"{maxMinutes}","chat.error.videoMetadataError":"","chat.error.pauseVideoToAnnotate":"","chat.error.imageGenInterrupted":"","chat.error.thinkingInterrupted":"AI","error.noLanguagePair":"","error.translationFailed":"","error.imageLimitReached":"","error.tokenLimitReached":"","error.apiKeyMissing":"Gemini APIAPI","error.apiKeyInvalid":"Gemini API","error.apiQuotaExceeded":"PDF","error.quotaSetupBilling":"","error.quotaStartLive":"","error.imageGenCostWarning":"1$0.04GoogleAPI","error.imageGenDisable":"","error.imageGenViewCost":"API","error.cameraPermissionDenied":"","error.cameraNotFound":"","error.cameraAccessNotSupported":"","error.cameraUnknown":"","error.cameraStreamNotAvailable":"","error.imageCaptureGeneric":"","error.visualContextVideoElementNotReady":"","error.snapshotVideoElementNotReady":"","error.visualContextCameraAccessNotSupported":"","error.snapshotCameraAccessNotSupported":"","error.visualContext2DContext":"2D","error.snapshot2DContext":"2D","error.visualContextCaptureFailedPermission":"","error.snapshotCaptureFailedPermission":"","error.visualContextCaptureFailedNotFound":"","error.snapshotCaptureFailedNotFound":"","error.visualContextCaptureFailedNotReady":"{details}","error.snapshotCaptureFailedNotReady":"{details}","error.visualContextCaptureFailedGeneric":"{details}","error.snapshotCaptureFailedGeneric":"{details}"},lI={"app.title":"Maestro","sttLang.selectLanguage":"  {language}  ","header.targetLanguageTitle":"  : {language}","startPage.clickToStart":"   ","startPage.saveChats":"  ","startPage.loadChats":"  ","startPage.saveThisChat":"  ","startPage.appendToChat":" ","startPage.trimBeforeBookmark":"  ","startPage.maestroAvatar":" ","startPage.addMaestroAvatar":"  ","startPage.loadSuccess":"{count}      !","startPage.loadError":"   .      .","startPage.noChatsToSave":"   .","startPage.saveError":"  .    .","startPage.noChatSelected":"    .","startPage.noBookmarkSet":"  .     .","startPage.noMessagesToTrim":"    .","startPage.trimSuccess":"  {count}  .","startPage.trimError":"  .   .","startPage.noMessagesToAppend":"     .","startPage.noPairInBackup":"       .       .","startPage.appendSuccess":"  {count}   .","startPage.combineSuccess":" : {added}   ,  {total} .","startPage.combineNoDuplicates":"    .   .","startPage.combineNoChanges":"   .   .","startPage.invalidBackupFormat":"  .   Maestro  (.ndjson)   .","startPage.browserNotSupported":"    .  Chrome  Edge .","sessionControls.saveAll.label":" ","sessionControls.saveAll.description":"     ","sessionControls.loadAll.label":"  ","sessionControls.loadAll.description":"    ","sessionControls.reset.label":" (Reset)","sessionControls.reset.description":"     ","sessionControls.saveThis.label":" ","sessionControls.saveThis.description":"     ","sessionControls.combine.label":"","sessionControls.combine.description":"    ","sessionControls.trim.label":" (Trim)","sessionControls.trim.description":"   ","sessionControls.profile":":","sessionControls.profilePlaceholder":"   ...","sessionControls.editProfile":"   ","sessionControls.allChatsControls":"  ","sessionControls.thisChatsControls":"  ","sessionControls.back":"","sessionControls.backupAndReset":"  ","sessionControls.typeToConfirm":' "{keyword}"   ',"sessionControls.changeAvatar":" ","general.clear":"","general.error":",  .","apiKeyGate.title":" Gemini API  ","apiKeyGate.billingTitle":"   ","apiKeyGate.infoLogin":" :  API ","apiKeyGate.infoVisibility":" :  ","apiKeyGate.infoBilling":": , Google ","apiKeyGate.infoCost":":      ","apiKeyGate.infoMore":" :","apiKeyGate.privacyPolicy":" ","apiKeyGate.stepsTitle":"  :","apiKeyGate.stepOne":"Google AI Studio    API  .","apiKeyGate.stepTwo":"     (Save)  .","apiKeyGate.openAiStudio":"Google AI Studio ","apiKeyGate.viewInstructions":" ","apiKeyGate.closeInstructions":" ","apiKeyGate.previousInstruction":" ","apiKeyGate.nextInstruction":" ","apiKeyGate.instructionStep":" {step} / {total}","apiKeyGate.keyLabel":"Gemini API ","apiKeyGate.placeholder":" API   ","apiKeyGate.show":"","apiKeyGate.hide":"","apiKeyGate.currentKeySaved":"   {maskedKey}","apiKeyGate.keyInvalid":"  {maskedKey}     ","apiKeyGate.clearSavedKey":"  ","apiKeyGate.cancel":"","apiKeyGate.saving":"...","apiKeyGate.saveKey":" ","apiKeyGate.close":"","apiKeyGate.costLabel":" API ","apiKeyGate.testerFormTitle":" ","apiKeyGate.testerFormDescription":" Android     Google Play Store     !","apiKeyGate.testerFormSubmit":"  ","apiKeyGate.testerFormSubmitting":"...","apiKeyGate.testerFormError":" .   .","apiKeyGate.testerFormMustBeGmail":"Google Play   @gmail.com  .","apiKeyGate.testerFormCapReached":"  . !","apiKeyGate.developerLogin":" ","apiKeyGate.submitAnotherEmail":"  ?    .","apiKeyGate.testerFormChecking":"   ...","apiKeyGate.testerFormApprovedTitle":" ! ","apiKeyGate.testerFormApprovedDesc":"   Android    .","apiKeyGate.testerFormDownloadBtn":"Google Play    ","apiKeyGate.testerFormPendingTitle":" !","apiKeyGate.testerFormPendingDesc":"    .     .   !","apiKeyGate.checkStatusModeBtn":"  ?   .","apiKeyGate.submitModeBtn":" ?    .","apiKeyGate.checkStatusTitle":"  ","apiKeyGate.checkStatusDesc":"     .","apiKeyGate.checkStatusSubmit":" ","apiKeyGate.testerFormNotFound":"  .     .","chat.thinking":"...","chat.loadingHistory":"   ...","chat.loadingSuggestions":"  ...","chat.suggestionsAriaLabel":" ","chat.attachImageFromFile":" ","chat.removeAttachedImage":"  ","chat.sendMessage":" ","chat.messageInputAriaLabel":" ","chat.retrievedFromWeb":" :","chat.videoNotSupported":"     .","chat.audioNotSupported":"     .","chat.fileAttachment":" ","chat.pdf.loading":"PDF  ...","chat.pdf.error":"PDF  ","chat.pdf.pageIndicator":" {current} / {total}","chat.imageGenError":"  ","chat.generatingImageLoadingSlow":"   ...","chat.stopSpeaking":" ","chat.speakThisLine":"  ","chat.languageSelector.openGlobe":" ","chat.maestroTranscriptScrollwheel":"   ","chat.mic.listening":"STT : ...","chat.mic.enableStt":"STT ","chat.mic.disableStt":"STT ","chat.mic.recordingAudioNote":"  ...","chat.placeholder.normal.listening":"{language}  ...","chat.placeholder.normal.sttActive":"{language}     ...","chat.placeholder.normal.sttInactive":"   {language}     ...","chat.placeholder.suggestion.listening":" {language} ...","chat.placeholder.suggestion.sttActive":" {language}     ...","chat.placeholder.suggestion.sttInactive":" {language}   ...","chat.camera.turnOn":"   ","chat.camera.turnOff":"   ","chat.camera.selectCamera":" ","chat.camera.imageGenCameraLabel":" ","chat.camera.captureOrRecord":"  ,  ","chat.camera.stopRecording":" ","chat.bookIcon.toggleImageGen":"   ","chat.imagePreview.alt":"","chat.image.dragToEnlarge":"  ","chat.image.dragToShrink":"  ","chat.annotateImage":"  ","chat.annotateVideoFrame":"    ","chat.annotateModal.editingPreviewAlt":"  ","chat.annotateModal.cancel":"","chat.annotateModal.saveAndAttach":"  ","chat.annotateModal.undo":"","chat.suggestion.speak":': "{suggestion}"',"chat.suggestion.ariaLabel":" : {suggestion}","chat.suggestion.toggleCreateMode":"   ","chat.suggestion.createAction":" ","chat.suggestion.creating":" ...","chat.maestro.idle":" ","chat.maestro.title.idle":"  .","chat.maestro.resting":" ...","chat.maestro.observing":" ...","chat.maestro.aboutToEngage":"  ...","chat.maestro.title.resting":" , -  .","chat.maestro.title.observing":" , -  .","chat.maestro.title.aboutToEngage":"  -.","chat.maestro.typing":"  ...","chat.maestro.title.typing":"  .","chat.maestro.speaking":" ","chat.maestro.title.speaking":"  .","chat.maestro.listening":"...","chat.maestro.title.listening":"     .","chat.maestro.holding":" ","chat.maestro.title.holding":"  (-  )","chat.bookmark.hiddenHeaderAria":"  ","chat.bookmark.isHere":" ","chat.bookmark.setHere":"  ","chat.bookmark.actionsRegionAria":" ","chat.bookmark.actionsToggleTitle":" ","chat.bookmark.decrementAria":"  ","chat.bookmark.decrementTitle":"","chat.bookmark.incrementAria":"  ","chat.bookmark.incrementTitle":"","chat.bookmark.hiddenBelowHeaderAria":"  ","chat.sendPrep.optimizingVideo":" ...","chat.sendPrep.optimizingImage":" ...","chat.sendPrep.preparingMedia":" ...","chat.sendPrep.uploadingMedia":"  ...","chat.sendPrep.finalizing":"...","chat.header.annotating":" ","chat.header.recordingAudio":"  ","chat.header.recordingVideo":"  ","chat.header.savePopup":"...","chat.header.loadPopup":" ...","chat.header.maestroAvatar":"  ","chat.header.watchingVideo":" ","chat.header.viewingAbove":"  ","chat.header.liveSession":" ","chat.liveSession.stop":" ","chat.liveSession.retry":" ","chat.liveSession.start":" ","chat.liveSession.liveBadge":"","chat.liveSession.connecting":"","chat.liveSession.defaultLastMessage":"!      ?","chat.liveSession.defaultSuggestion1":"","chat.liveSession.defaultSuggestion2":"","chat.liveSession.defaultSuggestion3":" ?","chat.error.sttError":"STT : {error}.   .","chat.error.autoCaptureCameraError":"   : {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"{maxMinutes}     .","chat.error.videoMetadataError":"   .      .","chat.error.pauseVideoToAnnotate":"      ","chat.error.imageGenInterrupted":"  .","chat.error.thinkingInterrupted":"AI  .","error.noLanguagePair":" :     .","error.translationFailed":" .   .","error.imageLimitReached":"   .    .","error.tokenLimitReached":"   .    .","error.apiKeyMissing":" Gemini API  . API       .","error.apiKeyInvalid":" Gemini API  .        .","error.apiQuotaExceeded":"   (:  , ,    )","error.quotaSetupBilling":" ","error.quotaStartLive":"    (   )","error.imageGenCostWarning":"    ~$0.04 .      .  Google  .  API     .","error.imageGenDisable":"  ","error.imageGenViewCost":"API     .","error.cameraPermissionDenied":"  .     .","error.cameraNotFound":"   .         .","error.cameraAccessNotSupported":"    .","error.cameraUnknown":"    .","error.cameraStreamNotAvailable":"   .","error.imageCaptureGeneric":"   .","error.visualContextVideoElementNotReady":"    .","error.snapshotVideoElementNotReady":"   .","error.visualContextCameraAccessNotSupported":"    .","error.snapshotCameraAccessNotSupported":"   .","error.visualContext2DContext":"  2D   .","error.snapshot2DContext":" 2D   .","error.visualContextCaptureFailedPermission":"  :   .","error.snapshotCaptureFailedPermission":" :   .","error.visualContextCaptureFailedNotFound":"  :  .","error.snapshotCaptureFailedNotFound":" :  .","error.visualContextCaptureFailedNotReady":"  :     . {details}","error.snapshotCaptureFailedNotReady":" :     . {details}","error.visualContextCaptureFailedGeneric":"  : {details}","error.snapshotCaptureFailedGeneric":" : {details}"},cI={"app.title":"Maestro","sttLang.selectLanguage":"  {language} ","header.targetLanguageTitle":"  : {language}","startPage.clickToStart":" ","startPage.saveChats":"  ","startPage.loadChats":" ","startPage.saveThisChat":"  ","startPage.appendToChat":" ","startPage.trimBeforeBookmark":"   ","startPage.maestroAvatar":" ","startPage.addMaestroAvatar":"  ","startPage.loadSuccess":"{count}      !","startPage.loadError":"  .      .","startPage.noChatsToSave":"   .","startPage.saveError":"  .    .","startPage.noChatSelected":"    .","startPage.noBookmarkSet":"  .      .","startPage.noMessagesToTrim":"    .","startPage.trimSuccess":"   {count} .","startPage.trimError":"  .   .","startPage.noMessagesToAppend":"      .","startPage.noPairInBackup":"         .     .","startPage.appendSuccess":"  {count}   .","startPage.combineSuccess":"  : {added}   ,  {total}.","startPage.combineNoDuplicates":"    .   .","startPage.combineNoChanges":"   .   .","startPage.invalidBackupFormat":"   .  Maestro (.ndjson)  .","startPage.browserNotSupported":"    . Chrome  Edge  .","sessionControls.saveAll.label":" ","sessionControls.saveAll.description":"    ","sessionControls.loadAll.label":" ","sessionControls.loadAll.description":"    ","sessionControls.reset.label":"","sessionControls.reset.description":"    ","sessionControls.saveThis.label":" ","sessionControls.saveThis.description":"  ","sessionControls.combine.label":"","sessionControls.combine.description":"   ","sessionControls.trim.label":"","sessionControls.trim.description":"   ","sessionControls.profile":":","sessionControls.profilePlaceholder":"   ...","sessionControls.editProfile":"  ","sessionControls.allChatsControls":"  ","sessionControls.thisChatsControls":"  ","sessionControls.back":"","sessionControls.backupAndReset":"  ","sessionControls.typeToConfirm":'  "{keyword}" ',"sessionControls.changeAvatar":" ","general.clear":"","general.error":",  .","apiKeyGate.title":"Gemini API  ","apiKeyGate.billingTitle":"     ","apiKeyGate.infoLogin":" : API ","apiKeyGate.infoVisibility":" :   ","apiKeyGate.infoBilling":": , Google ","apiKeyGate.infoCost":":     ","apiKeyGate.infoMore":" :","apiKeyGate.privacyPolicy":" ","apiKeyGate.stepsTitle":"   :","apiKeyGate.stepOne":"Google AI Studio  API  .","apiKeyGate.stepTwo":"    .","apiKeyGate.openAiStudio":"Google AI Studio ","apiKeyGate.viewInstructions":" ","apiKeyGate.closeInstructions":" ","apiKeyGate.previousInstruction":" ","apiKeyGate.nextInstruction":" ","apiKeyGate.instructionStep":" {step} / {total}","apiKeyGate.keyLabel":"Gemini API ","apiKeyGate.placeholder":" API  ","apiKeyGate.show":"","apiKeyGate.hide":"","apiKeyGate.currentKeySaved":"   {maskedKey}","apiKeyGate.keyInvalid":"   {maskedKey}     ","apiKeyGate.clearSavedKey":"  ","apiKeyGate.cancel":"","apiKeyGate.saving":" ...","apiKeyGate.saveKey":" ","apiKeyGate.close":"","apiKeyGate.costLabel":" API ","apiKeyGate.testerFormTitle":" ","apiKeyGate.testerFormDescription":"Google Play     Android   !","apiKeyGate.testerFormSubmit":"  ","apiKeyGate.testerFormSubmitting":" ...","apiKeyGate.testerFormError":" .   .","apiKeyGate.testerFormMustBeGmail":"Google Play @gmail.com   .","apiKeyGate.testerFormCapReached":"  . !","apiKeyGate.developerLogin":" ","apiKeyGate.submitAnotherEmail":"  ?   .","apiKeyGate.testerFormChecking":"   ...","apiKeyGate.testerFormApprovedTitle":"! ","apiKeyGate.testerFormApprovedDesc":"  Android    .","apiKeyGate.testerFormDownloadBtn":"Google Play  ","apiKeyGate.testerFormPendingTitle":"  !","apiKeyGate.testerFormPendingDesc":" .      .    !","apiKeyGate.checkStatusModeBtn":" ?  .","apiKeyGate.submitModeBtn":" ?  .","apiKeyGate.checkStatusTitle":"  ","apiKeyGate.checkStatusDesc":"     .","apiKeyGate.checkStatusSubmit":" ","apiKeyGate.testerFormNotFound":"     .   .","chat.thinking":" ...","chat.loadingHistory":"   ...","chat.loadingSuggestions":"  ...","chat.suggestionsAriaLabel":" ","chat.attachImageFromFile":" ","chat.removeAttachedImage":"  ","chat.sendMessage":" ","chat.messageInputAriaLabel":" ","chat.retrievedFromWeb":" :","chat.videoNotSupported":"    .","chat.audioNotSupported":"    .","chat.fileAttachment":" ","chat.pdf.loading":"PDF  ...","chat.pdf.error":"PDF   ","chat.pdf.pageIndicator":" {current} / {total}","chat.imageGenError":"  ","chat.generatingImageLoadingSlow":"    ...","chat.stopSpeaking":" ","chat.speakThisLine":"  ","chat.languageSelector.openGlobe":" ","chat.maestroTranscriptScrollwheel":"   ","chat.mic.listening":"STT :  ...","chat.mic.enableStt":"STT ","chat.mic.disableStt":"STT ","chat.mic.recordingAudioNote":"  ...","chat.placeholder.normal.listening":"{language}  ...","chat.placeholder.normal.sttActive":"{language}  ...","chat.placeholder.normal.sttInactive":"   {language} ...","chat.placeholder.suggestion.listening":" {language} ...","chat.placeholder.suggestion.sttActive":" {language}  ...","chat.placeholder.suggestion.sttInactive":" {language} ...","chat.camera.turnOn":"  ","chat.camera.turnOff":"  ","chat.camera.selectCamera":" ","chat.camera.imageGenCameraLabel":" ","chat.camera.captureOrRecord":" ,   ","chat.camera.stopRecording":" ","chat.bookIcon.toggleImageGen":"   ","chat.imagePreview.alt":"","chat.image.dragToEnlarge":"  ","chat.image.dragToShrink":"  ","chat.annotateImage":"  ","chat.annotateVideoFrame":"   ","chat.annotateModal.editingPreviewAlt":"  ","chat.annotateModal.cancel":"","chat.annotateModal.saveAndAttach":"  ","chat.annotateModal.undo":" ","chat.suggestion.speak":': "{suggestion}"',"chat.suggestion.ariaLabel":" : {suggestion}","chat.suggestion.toggleCreateMode":"   ","chat.suggestion.createAction":" ","chat.suggestion.creating":"  ...","chat.maestro.idle":"  ","chat.maestro.title.idle":"   .","chat.maestro.resting":"  ...","chat.maestro.observing":"  ...","chat.maestro.aboutToEngage":"  ...","chat.maestro.title.resting":"  ,    .","chat.maestro.title.observing":"  ,    .","chat.maestro.title.aboutToEngage":"  .","chat.maestro.typing":"  ...","chat.maestro.title.typing":"   .","chat.maestro.speaking":"  ","chat.maestro.title.speaking":"   .","chat.maestro.listening":" ...","chat.maestro.title.listening":"     .","chat.maestro.holding":"  ","chat.maestro.title.holding":"   (  )","chat.bookmark.hiddenHeaderAria":"  ","chat.bookmark.isHere":"  ","chat.bookmark.setHere":"  ","chat.bookmark.actionsRegionAria":" ","chat.bookmark.actionsToggleTitle":" ","chat.bookmark.decrementAria":"  ","chat.bookmark.decrementTitle":"","chat.bookmark.incrementAria":"  ","chat.bookmark.incrementTitle":"","chat.bookmark.hiddenBelowHeaderAria":"  ","chat.sendPrep.optimizingVideo":"  ...","chat.sendPrep.optimizingImage":"  ...","chat.sendPrep.preparingMedia":"  ...","chat.sendPrep.uploadingMedia":"  ...","chat.sendPrep.finalizing":" ...","chat.header.annotating":" ","chat.header.recordingAudio":"  ","chat.header.recordingVideo":"  ","chat.header.savePopup":" ...","chat.header.loadPopup":" ...","chat.header.maestroAvatar":"   ","chat.header.watchingVideo":"  ","chat.header.viewingAbove":"  ","chat.header.liveSession":" ","chat.liveSession.stop":" ","chat.liveSession.retry":" ","chat.liveSession.start":" ","chat.liveSession.liveBadge":"","chat.liveSession.connecting":" ","chat.liveSession.defaultLastMessage":"!   ?","chat.liveSession.defaultSuggestion1":"","chat.liveSession.defaultSuggestion2":" ","chat.liveSession.defaultSuggestion3":" ?","chat.error.sttError":"STT : {error}.   .","chat.error.autoCaptureCameraError":"   : {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"{maxMinutes}    .","chat.error.videoMetadataError":"    .       .","chat.error.pauseVideoToAnnotate":"      ","chat.error.imageGenInterrupted":"  .","chat.error.thinkingInterrupted":"AI  .","error.noLanguagePair":" :    .","error.translationFailed":" .   .","error.imageLimitReached":"    .    .","error.tokenLimitReached":"   .    .","error.apiKeyMissing":"Gemini API  . API     .","error.apiKeyInvalid":"Gemini API   .      .","error.apiQuotaExceeded":"  (:   , , PDF   )","error.quotaSetupBilling":" ","error.quotaStartLive":"    (  )","error.imageGenCostWarning":"     $0.04.     .  Google . API      .","error.imageGenDisable":"  ","error.imageGenViewCost":"API      .","error.cameraPermissionDenied":"  .     .","error.cameraNotFound":"    .      .","error.cameraAccessNotSupported":"    .","error.cameraUnknown":"       .","error.cameraStreamNotAvailable":"     .","error.imageCaptureGeneric":"       .","error.visualContextVideoElementNotReady":"     .","error.snapshotVideoElementNotReady":"    .","error.visualContextCameraAccessNotSupported":"      .","error.snapshotCameraAccessNotSupported":"     .","error.visualContext2DContext":"   2D    .","error.snapshot2DContext":"  2D    .","error.visualContextCaptureFailedPermission":"  :   .","error.snapshotCaptureFailedPermission":" :   .","error.visualContextCaptureFailedNotFound":"  :    .","error.snapshotCaptureFailedNotFound":" :    .","error.visualContextCaptureFailedNotReady":"  :      . {details}","error.snapshotCaptureFailedNotReady":" :      . {details}","error.visualContextCaptureFailedGeneric":"  : {details}","error.snapshotCaptureFailedGeneric":" : {details}"},uI={"app.title":"Maestro","sttLang.selectLanguage":"  {language}- ","header.targetLanguageTitle":"  : {language}","startPage.clickToStart":"  ","startPage.saveChats":"  ","startPage.loadChats":" ","startPage.saveThisChat":"  ","startPage.appendToChat":" ","startPage.trimBeforeBookmark":"  ","startPage.maestroAvatar":" ","startPage.addMaestroAvatar":"  ","startPage.loadSuccess":"{count}     !","startPage.loadError":"  .     .","startPage.noChatsToSave":"  .","startPage.saveError":"  .    .","startPage.noChatSelected":"     .","startPage.noBookmarkSet":" .        .","startPage.noMessagesToTrim":"    .","startPage.trimSuccess":"  {count}   .","startPage.trimError":"   .   .","startPage.noMessagesToAppend":"    .","startPage.noPairInBackup":"     .      .","startPage.appendSuccess":"{count}     .","startPage.combineSuccess":" : {added}   ,  {total} .","startPage.combineNoDuplicates":"    .  .","startPage.combineNoChanges":"  .   .","startPage.invalidBackupFormat":"  .      (.ndjson)  .","startPage.browserNotSupported":"    .  Chrome  Edge .","sessionControls.saveAll.label":" ","sessionControls.saveAll.description":"     ","sessionControls.loadAll.label":"  ","sessionControls.loadAll.description":"     ","sessionControls.reset.label":"","sessionControls.reset.description":"     ","sessionControls.saveThis.label":" ","sessionControls.saveThis.description":"    ","sessionControls.combine.label":"","sessionControls.combine.description":"   ","sessionControls.trim.label":"","sessionControls.trim.description":"    ","sessionControls.profile":":","sessionControls.profilePlaceholder":"   ...","sessionControls.editProfile":"   ","sessionControls.allChatsControls":"  ","sessionControls.thisChatsControls":"  ","sessionControls.back":"","sessionControls.backupAndReset":" ","sessionControls.typeToConfirm":' "{keyword}"   ',"sessionControls.changeAvatar":" ","general.clear":"","general.error":",   .","apiKeyGate.title":" Gemini API  ","apiKeyGate.billingTitle":"   ","apiKeyGate.infoLogin":" :  API ","apiKeyGate.infoVisibility":" :  ","apiKeyGate.infoBilling":": , Google- ","apiKeyGate.infoCost":":     ","apiKeyGate.infoMore":" :","apiKeyGate.privacyPolicy":" ","apiKeyGate.stepsTitle":"  :","apiKeyGate.stepOne":"Google AI Studio   API  .","apiKeyGate.stepTwo":"    (Save)  .","apiKeyGate.openAiStudio":"Google AI Studio ","apiKeyGate.viewInstructions":" ","apiKeyGate.closeInstructions":" ","apiKeyGate.previousInstruction":" ","apiKeyGate.nextInstruction":" ","apiKeyGate.instructionStep":" {step} / {total}","apiKeyGate.keyLabel":"Gemini API ","apiKeyGate.placeholder":" API   ","apiKeyGate.show":"","apiKeyGate.hide":"","apiKeyGate.currentKeySaved":"    {maskedKey}","apiKeyGate.keyInvalid":"  {maskedKey}      ","apiKeyGate.clearSavedKey":"   ","apiKeyGate.cancel":"","apiKeyGate.saving":" ...","apiKeyGate.saveKey":"  ","apiKeyGate.close":"","apiKeyGate.costLabel":" API ","apiKeyGate.testerFormTitle":" ","apiKeyGate.testerFormDescription":" Android    Google Play Store-   !","apiKeyGate.testerFormSubmit":"  ","apiKeyGate.testerFormSubmitting":"...","apiKeyGate.testerFormError":"  .   .","apiKeyGate.testerFormMustBeGmail":"Google Play-   @gmail.com  .","apiKeyGate.testerFormCapReached":"  . !","apiKeyGate.developerLogin":" ","apiKeyGate.submitAnotherEmail":"  ?    .","apiKeyGate.testerFormChecking":"   ...","apiKeyGate.testerFormApprovedTitle":" ! ","apiKeyGate.testerFormApprovedDesc":"  Android    .","apiKeyGate.testerFormDownloadBtn":"Google Play-   ","apiKeyGate.testerFormPendingTitle":" !","apiKeyGate.testerFormPendingDesc":"   .     .   !","apiKeyGate.checkStatusModeBtn":" ?  .","apiKeyGate.submitModeBtn":"?    .","apiKeyGate.checkStatusTitle":"  ","apiKeyGate.checkStatusDesc":"    .","apiKeyGate.checkStatusSubmit":" ","apiKeyGate.testerFormNotFound":"  .     .","chat.thinking":"...","chat.loadingHistory":"  ...","chat.loadingSuggestions":" ...","chat.suggestionsAriaLabel":" ","chat.attachImageFromFile":" ","chat.removeAttachedImage":"  ","chat.sendMessage":" ","chat.messageInputAriaLabel":" ","chat.retrievedFromWeb":"  :","chat.videoNotSupported":"    .","chat.audioNotSupported":"    .","chat.fileAttachment":" ","chat.pdf.loading":"PDF  ...","chat.pdf.error":"PDF  ","chat.pdf.pageIndicator":" {current} / {total}","chat.imageGenError":"  ","chat.generatingImageLoadingSlow":"  ...","chat.stopSpeaking":" ","chat.speakThisLine":"  ","chat.languageSelector.openGlobe":" ","chat.maestroTranscriptScrollwheel":"   ","chat.mic.listening":"STT : ...","chat.mic.enableStt":"STT ","chat.mic.disableStt":"STT ","chat.mic.recordingAudioNote":" ...","chat.placeholder.normal.listening":"{language}- ...","chat.placeholder.normal.sttActive":"{language}-    ...","chat.placeholder.normal.sttInactive":"   {language}-    ...","chat.placeholder.suggestion.listening":"  {language} ...","chat.placeholder.suggestion.sttActive":"  {language}-    ...","chat.placeholder.suggestion.sttInactive":"  {language}-  ...","chat.camera.turnOn":"  ","chat.camera.turnOff":"  ","chat.camera.selectCamera":" ","chat.camera.imageGenCameraLabel":" ","chat.camera.captureOrRecord":"  ,  ","chat.camera.stopRecording":" ","chat.bookIcon.toggleImageGen":"   ","chat.imagePreview.alt":"","chat.image.dragToEnlarge":"  ","chat.image.dragToShrink":"  ","chat.annotateImage":" ","chat.annotateVideoFrame":"  ","chat.annotateModal.editingPreviewAlt":" ","chat.annotateModal.cancel":"","chat.annotateModal.saveAndAttach":" ","chat.annotateModal.undo":"","chat.suggestion.speak":': "{suggestion}"',"chat.suggestion.ariaLabel":" : {suggestion}","chat.suggestion.toggleCreateMode":"   ","chat.suggestion.createAction":" ","chat.suggestion.creating":" ...","chat.maestro.idle":" ","chat.maestro.title.idle":"  .","chat.maestro.resting":" ...","chat.maestro.observing":" ...","chat.maestro.aboutToEngage":"  ...","chat.maestro.title.resting":" ,    .","chat.maestro.title.observing":" ,    .","chat.maestro.title.aboutToEngage":"   .","chat.maestro.typing":" ...","chat.maestro.title.typing":"  .","chat.maestro.speaking":" ","chat.maestro.title.speaking":"  .","chat.maestro.listening":"...","chat.maestro.title.listening":"    .","chat.maestro.holding":" ","chat.maestro.title.holding":"  (   )","chat.bookmark.hiddenHeaderAria":"  ","chat.bookmark.isHere":" ","chat.bookmark.setHere":"  ","chat.bookmark.actionsRegionAria":" ","chat.bookmark.actionsToggleTitle":" ","chat.bookmark.decrementAria":"  ","chat.bookmark.decrementTitle":"","chat.bookmark.incrementAria":"  ","chat.bookmark.incrementTitle":"","chat.bookmark.hiddenBelowHeaderAria":"  ","chat.sendPrep.optimizingVideo":"  ...","chat.sendPrep.optimizingImage":"  ...","chat.sendPrep.preparingMedia":" ...","chat.sendPrep.uploadingMedia":"  ...","chat.sendPrep.finalizing":"...","chat.header.annotating":"","chat.header.recordingAudio":" ","chat.header.recordingVideo":" ","chat.header.savePopup":"...","chat.header.loadPopup":"...","chat.header.maestroAvatar":"  ","chat.header.watchingVideo":" ","chat.header.viewingAbove":"  ","chat.header.liveSession":" ","chat.liveSession.stop":" ","chat.liveSession.retry":"  ","chat.liveSession.start":" ","chat.liveSession.liveBadge":"","chat.liveSession.connecting":"","chat.liveSession.defaultLastMessage":"!     ?","chat.liveSession.defaultSuggestion1":"","chat.liveSession.defaultSuggestion2":"","chat.liveSession.defaultSuggestion3":"?","chat.error.sttError":"STT : {error}.   .","chat.error.autoCaptureCameraError":"   : {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"{maxMinutes}    .","chat.error.videoMetadataError":"   .      .","chat.error.pauseVideoToAnnotate":"     ","chat.error.imageGenInterrupted":"  .","chat.error.thinkingInterrupted":"AI  .","error.noLanguagePair":" :   .","error.translationFailed":" .   .","error.imageLimitReached":"    .    .","error.tokenLimitReached":"   .    .","error.apiKeyMissing":" Gemini API  . API     .","error.apiKeyInvalid":" Gemini API  .    .","error.apiQuotaExceeded":"   (:  , , ,  )","error.quotaSetupBilling":" ","error.quotaStartLive":"    (  )","error.imageGenCostWarning":"     $0.04 .    .    . API      .","error.imageGenDisable":"  ","error.imageGenViewCost":"API     .","error.cameraPermissionDenied":"  .     .","error.cameraNotFound":"  .       .","error.cameraAccessNotSupported":"    .","error.cameraUnknown":"     .","error.cameraStreamNotAvailable":"    .","error.imageCaptureGeneric":"    .","error.visualContextVideoElementNotReady":"    .","error.snapshotVideoElementNotReady":"   .","error.visualContextCameraAccessNotSupported":"    .","error.snapshotCameraAccessNotSupported":"   .","error.visualContext2DContext":"  2D  .","error.snapshot2DContext":" 2D  .","error.visualContextCaptureFailedPermission":"  :   .","error.snapshotCaptureFailedPermission":" :   .","error.visualContextCaptureFailedNotFound":"  :  .","error.snapshotCaptureFailedNotFound":" :  .","error.visualContextCaptureFailedNotReady":"  :     . {details}","error.snapshotCaptureFailedNotReady":" :     . {details}","error.visualContextCaptureFailedGeneric":"  : {details}","error.snapshotCaptureFailedGeneric":" : {details}"},dI={"app.title":"Maestro","sttLang.selectLanguage":"  {language}   ","header.targetLanguageTitle":"  : {language}","startPage.clickToStart":"  ","startPage.saveChats":"   ","startPage.loadChats":"  ","startPage.saveThisChat":"   ","startPage.appendToChat":" ","startPage.trimBeforeBookmark":"  ","startPage.maestroAvatar":" ","startPage.addMaestroAvatar":"  ","startPage.loadSuccess":"{count}       !","startPage.loadError":"   .       .","startPage.noChatsToSave":"     .","startPage.saveError":"   .    .","startPage.noChatSelected":"    .","startPage.noBookmarkSet":"    .         .","startPage.noMessagesToTrim":"    .","startPage.trimSuccess":" {count}   .","startPage.trimError":"   .    .","startPage.noMessagesToAppend":"       .","startPage.noPairInBackup":"       .       .","startPage.appendSuccess":"  {count}   .","startPage.combineSuccess":"  : {added}   ,  {total} .","startPage.combineNoDuplicates":"     .    .","startPage.combineNoChanges":"    .    .","startPage.invalidBackupFormat":"  .   Maestro  (.ndjson)  .","startPage.browserNotSupported":"       .  Chrome  Edge .","sessionControls.saveAll.label":"  ","sessionControls.saveAll.description":"     ","sessionControls.loadAll.label":"  ","sessionControls.loadAll.description":"    ","sessionControls.reset.label":" ","sessionControls.reset.description":"     ","sessionControls.saveThis.label":"  ","sessionControls.saveThis.description":"    ","sessionControls.combine.label":" ","sessionControls.combine.description":"    ","sessionControls.trim.label":" ","sessionControls.trim.description":"  ","sessionControls.profile":":","sessionControls.profilePlaceholder":"   ...","sessionControls.editProfile":"   ","sessionControls.allChatsControls":"  ","sessionControls.thisChatsControls":"  ","sessionControls.back":"","sessionControls.backupAndReset":"  ","sessionControls.typeToConfirm":'  "{keyword}"  ',"sessionControls.changeAvatar":" ","general.clear":" ","general.error":",   .","apiKeyGate.title":" Gemini API  ","apiKeyGate.billingTitle":"    ","apiKeyGate.infoLogin":" :  API ","apiKeyGate.infoVisibility":" :  ","apiKeyGate.infoBilling":": , Google ","apiKeyGate.infoCost":":       ","apiKeyGate.infoMore":" :","apiKeyGate.privacyPolicy":" ","apiKeyGate.stepsTitle":"  :","apiKeyGate.stepOne":"Google AI Studio   API   .","apiKeyGate.stepTwo":"     ' ' (Save)   .","apiKeyGate.openAiStudio":"Google AI Studio ","apiKeyGate.viewInstructions":" ","apiKeyGate.closeInstructions":"  ","apiKeyGate.previousInstruction":" ","apiKeyGate.nextInstruction":" ","apiKeyGate.instructionStep":" {step}  {total}","apiKeyGate.keyLabel":"Gemini API ","apiKeyGate.placeholder":" API    ","apiKeyGate.show":"","apiKeyGate.hide":"","apiKeyGate.currentKeySaved":"     {maskedKey}","apiKeyGate.keyInvalid":"  {maskedKey}      ","apiKeyGate.clearSavedKey":"   ","apiKeyGate.cancel":" ","apiKeyGate.saving":"  ...","apiKeyGate.saveKey":"  ","apiKeyGate.close":" ","apiKeyGate.costLabel":" API ","apiKeyGate.testerFormTitle":"  ","apiKeyGate.testerFormDescription":" Android     Google Play Store     !","apiKeyGate.testerFormSubmit":"  ","apiKeyGate.testerFormSubmitting":" ...","apiKeyGate.testerFormError":"  .    .","apiKeyGate.testerFormMustBeGmail":"Google Play   @gmail.com  .","apiKeyGate.testerFormCapReached":"   . !","apiKeyGate.developerLogin":" ","apiKeyGate.submitAnotherEmail":"  ?      .","apiKeyGate.testerFormChecking":"    ...","apiKeyGate.testerFormApprovedTitle":"  ! ","apiKeyGate.testerFormApprovedDesc":"  Android      .","apiKeyGate.testerFormDownloadBtn":"Google Play    ","apiKeyGate.testerFormPendingTitle":"  !","apiKeyGate.testerFormPendingDesc":"    .      .   !","apiKeyGate.checkStatusModeBtn":"   ?   .","apiKeyGate.submitModeBtn":"  ?    .","apiKeyGate.checkStatusTitle":"  ","apiKeyGate.checkStatusDesc":"    .","apiKeyGate.checkStatusSubmit":" ","apiKeyGate.testerFormNotFound":"   .     .","chat.thinking":"  ...","chat.loadingHistory":"    ...","chat.loadingSuggestions":"   ...","chat.suggestionsAriaLabel":" ","chat.attachImageFromFile":" ","chat.removeAttachedImage":"  ","chat.sendMessage":" ","chat.messageInputAriaLabel":" ","chat.retrievedFromWeb":" :","chat.videoNotSupported":"      .","chat.audioNotSupported":"      .","chat.fileAttachment":" ","chat.pdf.loading":"PDF   ...","chat.pdf.error":"PDF    ","chat.pdf.pageIndicator":" {current} / {total}","chat.imageGenError":"  ","chat.generatingImageLoadingSlow":"    ...","chat.stopSpeaking":" ","chat.speakThisLine":"  ","chat.languageSelector.openGlobe":" ","chat.maestroTranscriptScrollwheel":"   ","chat.mic.listening":"STT :  ...","chat.mic.enableStt":"STT  ","chat.mic.disableStt":"STT ","chat.mic.recordingAudioNote":"   ...","chat.placeholder.normal.listening":"{language}   ...","chat.placeholder.normal.sttActive":"{language}     ...","chat.placeholder.normal.sttInactive":"   {language}     ...","chat.placeholder.suggestion.listening":"  {language} ...","chat.placeholder.suggestion.sttActive":"  {language}     ...","chat.placeholder.suggestion.sttInactive":"  {language}   ...","chat.camera.turnOn":"   ","chat.camera.turnOff":"   ","chat.camera.selectCamera":" ","chat.camera.imageGenCameraLabel":" ","chat.camera.captureOrRecord":"  ,   ","chat.camera.stopRecording":" ","chat.bookIcon.toggleImageGen":"    ","chat.imagePreview.alt":"","chat.image.dragToEnlarge":"   ","chat.image.dragToShrink":"   ","chat.annotateImage":"  ","chat.annotateVideoFrame":"   ","chat.annotateModal.editingPreviewAlt":"  ","chat.annotateModal.cancel":" ","chat.annotateModal.saveAndAttach":"   ","chat.annotateModal.undo":" ","chat.suggestion.speak":': "{suggestion}"',"chat.suggestion.ariaLabel":" : {suggestion}","chat.suggestion.toggleCreateMode":"    ","chat.suggestion.createAction":"  ","chat.suggestion.creating":"   ...","chat.maestro.idle":"  ","chat.maestro.title.idle":"   .","chat.maestro.resting":"   ...","chat.maestro.observing":"   ...","chat.maestro.aboutToEngage":"   ...","chat.maestro.title.resting":"  ,      .","chat.maestro.title.observing":"   ,      .","chat.maestro.title.aboutToEngage":"    .","chat.maestro.typing":"   ...","chat.maestro.title.typing":"    .","chat.maestro.speaking":"  ","chat.maestro.title.speaking":"   .","chat.maestro.listening":" ...","chat.maestro.title.listening":"       .","chat.maestro.holding":"   ","chat.maestro.title.holding":"    (    )","chat.bookmark.hiddenHeaderAria":"  ","chat.bookmark.isHere":"  ","chat.bookmark.setHere":"   ","chat.bookmark.actionsRegionAria":" ","chat.bookmark.actionsToggleTitle":" ","chat.bookmark.decrementAria":"  ","chat.bookmark.decrementTitle":"","chat.bookmark.incrementAria":"  ","chat.bookmark.incrementTitle":"","chat.bookmark.hiddenBelowHeaderAria":"  ","chat.sendPrep.optimizingVideo":"   ...","chat.sendPrep.optimizingImage":"   ...","chat.sendPrep.preparingMedia":"   ...","chat.sendPrep.uploadingMedia":"   ...","chat.sendPrep.finalizing":"   ...","chat.header.annotating":"  ","chat.header.recordingAudio":"   ","chat.header.recordingVideo":"   ","chat.header.savePopup":"  ...","chat.header.loadPopup":"  ...","chat.header.maestroAvatar":"    ","chat.header.watchingVideo":"  ","chat.header.viewingAbove":"   ","chat.header.liveSession":" ","chat.liveSession.stop":" ","chat.liveSession.retry":"   ","chat.liveSession.start":"  ","chat.liveSession.liveBadge":"","chat.liveSession.connecting":"  ","chat.liveSession.defaultLastMessage":"!       ?","chat.liveSession.defaultSuggestion1":"","chat.liveSession.defaultSuggestion2":" ","chat.liveSession.defaultSuggestion3":"  ?","chat.error.sttError":"STT : {error}.   .","chat.error.autoCaptureCameraError":"   : {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":" {maxMinutes}   .","chat.error.videoMetadataError":"    .       .","chat.error.pauseVideoToAnnotate":"     ","chat.error.imageGenInterrupted":"   .","chat.error.thinkingInterrupted":"AI   .","error.noLanguagePair":" :     .","error.translationFailed":"  .    .","error.imageLimitReached":"    .     .","error.tokenLimitReached":"   .     .","error.apiKeyMissing":" Gemini API   . API        .","error.apiKeyInvalid":" Gemini API   .        .","error.apiQuotaExceeded":"    (:   , ,    )","error.quotaSetupBilling":"  ","error.quotaStartLive":"     (  )","error.imageGenCostWarning":"     $0.04  .     .   Google   .  API      .","error.imageGenDisable":"   ","error.imageGenViewCost":"API     .","error.cameraPermissionDenied":"  .      .","error.cameraNotFound":"   .         .","error.cameraAccessNotSupported":"     .","error.cameraUnknown":"     .","error.cameraStreamNotAvailable":"    .","error.imageCaptureGeneric":"    .","error.visualContextVideoElementNotReady":"     .","error.snapshotVideoElementNotReady":"    .","error.visualContextCameraAccessNotSupported":"     .","error.snapshotCameraAccessNotSupported":"    .","error.visualContext2DContext":"  2D    .","error.snapshot2DContext":" 2D    .","error.visualContextCaptureFailedPermission":"  :   .","error.snapshotCaptureFailedPermission":" :   .","error.visualContextCaptureFailedNotFound":"  :   .","error.snapshotCaptureFailedNotFound":" :   .","error.visualContextCaptureFailedNotReady":"  :      . {details}","error.snapshotCaptureFailedNotReady":" :      . {details}","error.visualContextCaptureFailedGeneric":"  : {details}","error.snapshotCaptureFailedGeneric":" : {details}"},hI={"app.title":"Maestro","sttLang.selectLanguage":"Spraakherkenning instellen op {language}","header.targetLanguageTitle":"Huidige doeltaal: {language}","startPage.clickToStart":"Klik op het vliegtuig","startPage.saveChats":"Alle chats opslaan","startPage.loadChats":"Chats laden","startPage.saveThisChat":"Deze chat opslaan","startPage.appendToChat":"Toevoegen aan chat","startPage.trimBeforeBookmark":"Trimmen voor bladwijzer","startPage.maestroAvatar":"Maestro-avatar","startPage.addMaestroAvatar":"Maestro-avatar toevoegen","startPage.loadSuccess":"{count} chatsessies succesvol geladen en vervangen!","startPage.loadError":"Fout bij laden van chats. Het bestand is mogelijk beschadigd of heeft een verkeerd formaat.","startPage.noChatsToSave":"Geen chatgeschiedenis om op te slaan.","startPage.saveError":"Fout bij opslaan van chats. Bekijk de console voor meer details.","startPage.noChatSelected":"Selecteer eerst een taalpaar.","startPage.noBookmarkSet":"Geen bladwijzer ingesteld. Stel eerst een bladwijzer in om berichten ervoor te verwijderen.","startPage.noMessagesToTrim":"Geen berichten voor de bladwijzer om te verwijderen.","startPage.trimSuccess":"{count} berichten voor de bladwijzer verwijderd.","startPage.trimError":"Trimmen van berichten mislukt. Probeer het opnieuw.","startPage.noMessagesToAppend":"Geen berichten gevonden in het reservekopiebestand om te combineren.","startPage.noPairInBackup":"Het reservekopiebestand bevat geen berichten voor uw huidige taalpaar. Selecteer een reservekopie die overeenkomt met uw huidige chat.","startPage.appendSuccess":"{count} berichten succesvol toegevoegd aan de huidige chat.","startPage.combineSuccess":"Chats gecombineerd: {added} nieuwe berichten toegevoegd, {total} berichten in totaal.","startPage.combineNoDuplicates":"Alle berichten stonden al in je chat. Geen wijzigingen aangebracht.","startPage.combineNoChanges":"Geen nieuwe berichten om toe te voegen. Je chat is ongewijzigd.","startPage.invalidBackupFormat":"Ongeldig reservekopiebestand. Selecteer een geldig Maestro reservekopiebestand (.ndjson).","startPage.browserNotSupported":"Je browser ondersteunt het opslaan van bestanden niet. Gebruik Chrome of Edge.","sessionControls.saveAll.label":"Alles opslaan","sessionControls.saveAll.description":"Exporteer alle chats naar een reservekopiebestand","sessionControls.loadAll.label":"Alles laden","sessionControls.loadAll.description":"Vervang alle chats door een reservekopiebestand","sessionControls.reset.label":"Resetten","sessionControls.reset.description":"Back-up maken en alle gegevens verwijderen","sessionControls.saveThis.label":"Chat opslaan","sessionControls.saveThis.description":"Exporteer alleen deze chat","sessionControls.combine.label":"Combineren","sessionControls.combine.description":"Reservekopie samenvoegen met deze chat","sessionControls.trim.label":"Trimmen","sessionControls.trim.description":"Verwijder berichten voor de bladwijzer","sessionControls.profile":"Profiel:","sessionControls.profilePlaceholder":"Je naam of details...","sessionControls.editProfile":"Gebruikersprofiel bewerken","sessionControls.allChatsControls":"Bediening voor alle chats","sessionControls.thisChatsControls":"Bediening voor deze chat","sessionControls.back":"Terug","sessionControls.backupAndReset":"Back-up & Reset","sessionControls.typeToConfirm":'Typ "{keyword}" om te bevestigen',"sessionControls.changeAvatar":"Avatar wijzigen","general.clear":"Wissen","general.error":"Sorry, er is een fout opgetreden.","apiKeyGate.title":"Verbind je Gemini API-sleutel","apiKeyGate.billingTitle":"Facturering instellen voor hoger quotum","apiKeyGate.infoLogin":"Uw login: Een API-sleutel","apiKeyGate.infoVisibility":"Wie ziet het: Alleen u","apiKeyGate.infoBilling":"Facturering: Maandelijks, via Google","apiKeyGate.infoCost":"Kosten: Zichtbaar in app  tik om te bekijken","apiKeyGate.infoMore":"Meer info:","apiKeyGate.privacyPolicy":"Privacybeleid","apiKeyGate.stepsTitle":"Twee snelle stappen:","apiKeyGate.stepOne":"Open Google AI Studio en maak een API-sleutel.","apiKeyGate.stepTwo":"Plak de sleutel hieronder en tik op Opslaan.","apiKeyGate.openAiStudio":"Open Google AI Studio","apiKeyGate.viewInstructions":"Instructies bekijken","apiKeyGate.closeInstructions":"Instructies sluiten","apiKeyGate.previousInstruction":"Vorige instructie","apiKeyGate.nextInstruction":"Volgende instructie","apiKeyGate.instructionStep":"Instructie {step} van {total}","apiKeyGate.keyLabel":"Gemini API-sleutel","apiKeyGate.placeholder":"Plak hier je API-sleutel","apiKeyGate.show":"Tonen","apiKeyGate.hide":"Verbergen","apiKeyGate.currentKeySaved":"Huidige sleutel opgeslagen {maskedKey}","apiKeyGate.keyInvalid":"Sleutel ongeldig {maskedKey}  plak hieronder een nieuwe sleutel","apiKeyGate.clearSavedKey":"Opgeslagen sleutel wissen","apiKeyGate.cancel":"Annuleren","apiKeyGate.saving":"Opslaan...","apiKeyGate.saveKey":"Sleutel opslaan","apiKeyGate.close":"Sluiten","apiKeyGate.costLabel":"Geschatte API-kosten","apiKeyGate.testerFormTitle":"Test de app","apiKeyGate.testerFormDescription":"Voer het e-mailadres in dat je gebruikt voor de Google Play Store om een uitnodiging te krijgen voor onze Android-bta!","apiKeyGate.testerFormSubmit":"Krijg vroege toegang","apiKeyGate.testerFormSubmitting":"Verzenden...","apiKeyGate.testerFormError":"Er is iets misgegaan. Probeer het opnieuw.","apiKeyGate.testerFormMustBeGmail":"Gebruik een @gmail.com-adres voor Google Play.","apiKeyGate.testerFormCapReached":"Inzendingslimiet bereikt. Bedankt!","apiKeyGate.developerLogin":"ontwikkelaarslogin","apiKeyGate.submitAnotherEmail":"Verkeerd e-mailadres? Reset en probeer een andere.","apiKeyGate.testerFormChecking":"Je uitnodigingsstatus controleren...","apiKeyGate.testerFormApprovedTitle":"Je doet mee! ","apiKeyGate.testerFormApprovedDesc":"Je e-mailadres is goedgekeurd voor het Android-btatestprogramma.","apiKeyGate.testerFormDownloadBtn":"Download app op Google Play","apiKeyGate.testerFormPendingTitle":"Je staat op de wachtlijst!","apiKeyGate.testerFormPendingDesc":"We hebben je e-mail ontvangen. Het handmatig verwerken van de uitnodiging duurt even. Kijk later nog eens!","apiKeyGate.checkStatusModeBtn":"Al aangemeld? Controleer je status.","apiKeyGate.submitModeBtn":"Aanmelden nodig? Schrijf je hier in.","apiKeyGate.checkStatusTitle":"Controleer uitnodigingsstatus","apiKeyGate.checkStatusDesc":"Voer het e-mailadres in waarmee je je hebt aangemeld voor de wachtlijst.","apiKeyGate.checkStatusSubmit":"Controleer status","apiKeyGate.testerFormNotFound":"E-mailadres niet gevonden op de wachtlijst. Meld je eerst aan.","chat.thinking":"Aan het denken...","chat.loadingHistory":"Chatgeschiedenis laden...","chat.loadingSuggestions":"Suggesties laden...","chat.suggestionsAriaLabel":"Antwoordsuggesties","chat.attachImageFromFile":"Bestand bijvoegen","chat.removeAttachedImage":"Bijgevoegd bestand verwijderen","chat.sendMessage":"Bericht verzenden","chat.messageInputAriaLabel":"Berichtinvoer","chat.retrievedFromWeb":"Opgehaald van het web:","chat.videoNotSupported":"Uw browser ondersteunt de video-tag niet.","chat.audioNotSupported":"Uw browser ondersteunt de audio-tag niet.","chat.fileAttachment":"Bestandsbijlage","chat.pdf.loading":"PDF laden...","chat.pdf.error":"Kan PDF niet weergeven","chat.pdf.pageIndicator":"Pagina {current} van {total}","chat.imageGenError":"Fout bij afbeelding genereren","chat.generatingImageLoadingSlow":"Het duurt iets langer...","chat.stopSpeaking":"Stop met spreken","chat.speakThisLine":"Spreek deze regel uit","chat.languageSelector.openGlobe":"Talen wijzigen","chat.maestroTranscriptScrollwheel":"Maestro transcript scrollweergave","chat.mic.listening":"STT actief: Luisteren...","chat.mic.enableStt":"STT inschakelen","chat.mic.disableStt":"STT stoppen","chat.mic.recordingAudioNote":"Audio opnemen...","chat.placeholder.normal.listening":"Luisteren in {language}...","chat.placeholder.normal.sttActive":"Spreek in {language} of typ...","chat.placeholder.normal.sttInactive":"Typ of tik op de microfoon om in {language} te spreken...","chat.placeholder.suggestion.listening":"Spreek {language} om te vertalen...","chat.placeholder.suggestion.sttActive":"Spreek of typ in {language} om te vertalen...","chat.placeholder.suggestion.sttInactive":"Typ in {language} om te vertalen...","chat.camera.turnOn":"Cameravoorbeeld inschakelen","chat.camera.turnOff":"Cameravoorbeeld uitschakelen","chat.camera.selectCamera":"Camera selecteren","chat.camera.imageGenCameraLabel":"Afbeelding genereren","chat.camera.captureOrRecord":"Tik voor foto, houd ingedrukt voor video","chat.camera.stopRecording":"Opname stoppen","chat.bookIcon.toggleImageGen":"Afbeelding genereren modus wisselen","chat.imagePreview.alt":"Voorbeeld","chat.image.dragToEnlarge":"Sleep de hoek om te vergroten","chat.image.dragToShrink":"Sleep de hoek om te verkleinen","chat.annotateImage":"Afbeelding annoteren","chat.annotateVideoFrame":"Huidig frame annoteren","chat.annotateModal.editingPreviewAlt":"Afbeelding om te annoteren","chat.annotateModal.cancel":"Annuleren","chat.annotateModal.saveAndAttach":"Opslaan en bijvoegen","chat.annotateModal.undo":"Ongedaan maken","chat.suggestion.speak":'Zeg: "{suggestion}"',"chat.suggestion.ariaLabel":"Suggestie uitspreken: {suggestion}","chat.suggestion.toggleCreateMode":"Suggestie aanmaakmodus wisselen","chat.suggestion.createAction":"Suggestie maken","chat.suggestion.creating":"Suggestie wordt gemaakt...","chat.maestro.idle":"Maestro is inactief","chat.maestro.title.idle":"Maestro is momenteel inactief.","chat.maestro.resting":"Maestro rust...","chat.maestro.observing":"Maestro observeert...","chat.maestro.aboutToEngage":"Maestro staat op het punt in te grijpen...","chat.maestro.title.resting":"Maestro is inactief, veel tijd tot heractivering.","chat.maestro.title.observing":"Maestro observeert, enige tijd tot heractivering.","chat.maestro.title.aboutToEngage":"Maestro wordt binnenkort weer actief.","chat.maestro.typing":"Maestro typt...","chat.maestro.title.typing":"Maestro bereidt een antwoord voor.","chat.maestro.speaking":"Maestro spreekt","chat.maestro.title.speaking":"Maestro spreekt momenteel.","chat.maestro.listening":"Luisteren...","chat.maestro.title.listening":"Maestro wacht op uw invoer of stem.","chat.maestro.holding":"Maestro wacht","chat.maestro.title.holding":"Maestro wacht (heractivering gepauzeerd)","chat.bookmark.hiddenHeaderAria":"Verborgen berichten hierboven","chat.bookmark.isHere":"Bladwijzer is hier","chat.bookmark.setHere":"Bladwijzer hier instellen","chat.bookmark.actionsRegionAria":"Bladwijzeracties","chat.bookmark.actionsToggleTitle":"Bladwijzeropties","chat.bookmark.decrementAria":"En minder tonen","chat.bookmark.decrementTitle":"Minder","chat.bookmark.incrementAria":"En meer tonen","chat.bookmark.incrementTitle":"Meer","chat.bookmark.hiddenBelowHeaderAria":"Verborgen berichten hieronder","chat.sendPrep.optimizingVideo":"Video optimaliseren...","chat.sendPrep.optimizingImage":"Afbeelding optimaliseren...","chat.sendPrep.preparingMedia":"Media voorbereiden...","chat.sendPrep.uploadingMedia":"Media uploaden...","chat.sendPrep.finalizing":"Afronden...","chat.header.annotating":"Annoteren","chat.header.recordingAudio":"Audio opnemen","chat.header.recordingVideo":"Video opnemen","chat.header.savePopup":"Opslaan...","chat.header.loadPopup":"Laden...","chat.header.maestroAvatar":"Maestro-avatar bijwerken","chat.header.watchingVideo":"Video bekijken","chat.header.viewingAbove":"Vorige berichten bekijken","chat.header.liveSession":"Live sessie","chat.liveSession.stop":"Live stoppen","chat.liveSession.retry":"Live opnieuw proberen","chat.liveSession.start":"Live starten","chat.liveSession.liveBadge":"Live","chat.liveSession.connecting":"Verbinden","chat.liveSession.defaultLastMessage":"Hallo! Hoe kan ik je vandaag helpen?","chat.liveSession.defaultSuggestion1":"Hallo","chat.liveSession.defaultSuggestion2":"Goedemorgen","chat.liveSession.defaultSuggestion3":"Hoe gaat het?","chat.error.sttError":"STT-fout: {error}. Probeer de microfoon te wisselen.","chat.error.autoCaptureCameraError":"Automatische camera-opname fout: {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"Opname automatisch gestopt na {maxMinutes} minuten.","chat.error.videoMetadataError":"Kon video-metadata niet lezen. Het bestand is mogelijk beschadigd of in een niet-ondersteund formaat.","chat.error.pauseVideoToAnnotate":"Pauzeer de video om het huidige frame te annoteren","chat.error.imageGenInterrupted":"Het genereren van de afbeelding werd onderbroken.","chat.error.thinkingInterrupted":"Het AI-antwoord werd onderbroken.","error.noLanguagePair":"Kritieke fout: Geen taalpaar geselecteerd.","error.translationFailed":"Vertaling mislukt. Probeer het opnieuw.","error.imageLimitReached":"Sessielimiet voor afbeelding genereren bereikt. Start een nieuwe sessie.","error.tokenLimitReached":"Sessietokenlimiet bereikt. Start een nieuwe sessie.","error.apiKeyMissing":"Je Gemini API-sleutel ontbreekt. Open het API-sleutelscherm en plak je sleutel.","error.apiKeyInvalid":"Je Gemini API-sleutel is ongeldig. Controleer op typefouten en plak een geldige sleutel.","error.apiQuotaExceeded":"Uw quotum is uitgeput (Betaald: slimmere chat, video, pdf en beeldgeneratie)","error.quotaSetupBilling":"Facturering instellen","error.quotaStartLive":"Start gratis Live-versie (geen beeldgeneratie)","error.imageGenCostWarning":"Beeldgeneratie kost ~$0,04 per afbeelding. Chatberichten hebben ook een kleine kost. Alles wordt gefactureerd door Google. U kunt de kosten bijhouden in het API-sleutelscherm.","error.imageGenDisable":"Beeldgeneratie uitschakelen","error.imageGenViewCost":"Houd kosten bij in het API-sleutelscherm.","error.cameraPermissionDenied":"Cameratoestemming geweigerd. Schakel cameratoegang in via browserinstellingen.","error.cameraNotFound":"Geselecteerde camera niet gevonden. Zorg dat deze is aangesloten of selecteer een andere camera.","error.cameraAccessNotSupported":"Cameratoegang wordt niet ondersteund door uw browser.","error.cameraUnknown":"Er is een onbekende fout opgetreden bij het openen van de camera.","error.cameraStreamNotAvailable":"Camerastream niet beschikbaar voor opname.","error.imageCaptureGeneric":"Onbekende fout bij het vastleggen van afbeelding.","error.visualContextVideoElementNotReady":"Visuele context video-element niet gereed.","error.snapshotVideoElementNotReady":"Snapshot video-element niet gereed.","error.visualContextCameraAccessNotSupported":"Cameratoegang niet ondersteund voor visuele context.","error.snapshotCameraAccessNotSupported":"Cameratoegang niet ondersteund voor snapshot.","error.visualContext2DContext":"Kon 2D-context voor visuele context niet verkrijgen.","error.snapshot2DContext":"Kon 2D-context voor snapshot niet verkrijgen.","error.visualContextCaptureFailedPermission":"Visuele context mislukt: Cameratoestemming geweigerd.","error.snapshotCaptureFailedPermission":"Snapshot mislukt: Cameratoestemming geweigerd.","error.visualContextCaptureFailedNotFound":"Visuele context mislukt: Camera niet gevonden.","error.snapshotCaptureFailedNotFound":"Snapshot mislukt: Camera niet gevonden.","error.visualContextCaptureFailedNotReady":"Visuele context mislukt: Camera niet gereed of probleem met feed. {details}","error.snapshotCaptureFailedNotReady":"Snapshot mislukt: Camera niet gereed of probleem met feed. {details}","error.visualContextCaptureFailedGeneric":"Visuele context mislukt: {details}","error.snapshotCaptureFailedGeneric":"Snapshot mislukt: {details}"},AI={"app.title":"Maestro","sttLang.selectLanguage":"Ustaw rozpoznawanie mowy na {language}","header.targetLanguageTitle":"Aktualny jzyk docelowy: {language}","startPage.clickToStart":"Kliknij samolot","startPage.saveChats":"Zapisz wszystkie czaty","startPage.loadChats":"Wczytaj czaty","startPage.saveThisChat":"Zapisz ten czat","startPage.appendToChat":"Docz do czatu","startPage.trimBeforeBookmark":"Przytnij przed zakadk","startPage.maestroAvatar":"Awatar Maestro","startPage.addMaestroAvatar":"Dodaj awatar Maestro","startPage.loadSuccess":"Pomylnie wczytano i zastpiono {count} sesji czatu!","startPage.loadError":"Bd wczytywania czatw. Plik moe by uszkodzony lub w nieprawidowym formacie.","startPage.noChatsToSave":"Brak historii czatw do zapisania.","startPage.saveError":"Bd zapisywania czatw. Sprawd konsol, aby uzyska wicej szczegw.","startPage.noChatSelected":"Prosz najpierw wybra par jzykow.","startPage.noBookmarkSet":"Nie ustawiono zakadki. Ustaw najpierw zakadk, aby usun wiadomoci przed ni.","startPage.noMessagesToTrim":"Brak wiadomoci przed zakadk do usunicia.","startPage.trimSuccess":"Usunito {count} wiadomoci przed zakadk.","startPage.trimError":"Nie udao si przyci wiadomoci. Sprbuj ponownie.","startPage.noMessagesToAppend":"W pliku kopii zapasowej nie znaleziono adnych wiadomoci do poczenia.","startPage.noPairInBackup":"Plik kopii zapasowej nie zawiera wiadomoci dla aktualnej pary jzykowej. Wybierz kopi zapasow pasujc do biecego czatu.","startPage.appendSuccess":"Pomylnie doczono {count} wiadomoci do biecego czatu.","startPage.combineSuccess":"Poczono czaty: dodano {added} nowych wiadomoci, cznie {total} wiadomoci.","startPage.combineNoDuplicates":"Wszystkie wiadomoci znajdoway si ju w Twoim czacie. Nie wprowadzono adnych zmian.","startPage.combineNoChanges":"Brak nowych wiadomoci do dodania. Twj czat pozosta bez zmian.","startPage.invalidBackupFormat":"Nieprawidowy plik kopii zapasowej. Prosz wybra prawidowy plik kopii zapasowej Maestro (.ndjson).","startPage.browserNotSupported":"Twoja przegldarka nie obsuguje zapisywania plikw. Uyj Chrome lub Edge.","sessionControls.saveAll.label":"Zapisz wszystko","sessionControls.saveAll.description":"Eksportuj wszystkie czaty do pliku kopii zapasowej","sessionControls.loadAll.label":"Wczytaj wszystko","sessionControls.loadAll.description":"Zastp wszystkie czaty plikiem kopii zapasowej","sessionControls.reset.label":"Resetuj","sessionControls.reset.description":"Utwrz kopi i usu wszystkie dane","sessionControls.saveThis.label":"Zapisz czat","sessionControls.saveThis.description":"Eksportuj tylko ten czat","sessionControls.combine.label":"Pocz","sessionControls.combine.description":"Scal kopi zapasow z tym czatem","sessionControls.trim.label":"Przytnij","sessionControls.trim.description":"Usu wiadomoci przed zakadk","sessionControls.profile":"Profil:","sessionControls.profilePlaceholder":"Twoje imi lub dane...","sessionControls.editProfile":"Edytuj profil uytkownika","sessionControls.allChatsControls":"Sterowanie wszystkimi czatami","sessionControls.thisChatsControls":"Sterowanie tym czatem","sessionControls.back":"Wstecz","sessionControls.backupAndReset":"Kopia zapasowa i reset","sessionControls.typeToConfirm":"Wpisz {keyword}, aby potwierdzi","sessionControls.changeAvatar":"Zmie awatar","general.clear":"Wyczy","general.error":"Przepraszam, wystpi bd.","apiKeyGate.title":"Podcz klucz API Gemini","apiKeyGate.billingTitle":"Skonfiguruj rozliczenia dla wyszego limitu","apiKeyGate.infoLogin":"Twj login: Klucz API","apiKeyGate.infoVisibility":"Kto go widzi: Tylko Ty","apiKeyGate.infoBilling":"Patnoci: Miesicznie, od Google","apiKeyGate.infoCost":"Koszt: Widoczny w aplikacji  dotknij, aby zobaczy","apiKeyGate.infoMore":"Wicej informacji:","apiKeyGate.privacyPolicy":"Polityka prywatnoci","apiKeyGate.stepsTitle":"Dwa szybkie kroki:","apiKeyGate.stepOne":"Otwrz Google AI Studio i utwrz klucz API.","apiKeyGate.stepTwo":"Wklej klucz poniej i stuknij Zapisz.","apiKeyGate.openAiStudio":"Otwrz Google AI Studio","apiKeyGate.viewInstructions":"Wywietl instrukcje","apiKeyGate.closeInstructions":"Zamknij instrukcje","apiKeyGate.previousInstruction":"Poprzednia instrukcja","apiKeyGate.nextInstruction":"Nastpna instrukcja","apiKeyGate.instructionStep":"Instrukcja {step} z {total}","apiKeyGate.keyLabel":"Klucz API Gemini","apiKeyGate.placeholder":"Wklej tutaj swj klucz API","apiKeyGate.show":"Poka","apiKeyGate.hide":"Ukryj","apiKeyGate.currentKeySaved":"Biecy klucz zapisany {maskedKey}","apiKeyGate.keyInvalid":"Klucz nieprawidowy {maskedKey}  wklej nowy klucz poniej","apiKeyGate.clearSavedKey":"Wyczy zapisany klucz","apiKeyGate.cancel":"Anuluj","apiKeyGate.saving":"Zapisywanie...","apiKeyGate.saveKey":"Zapisz klucz","apiKeyGate.close":"Zamknij","apiKeyGate.costLabel":"Szacowany koszt API","apiKeyGate.testerFormTitle":"Przetestuj aplikacj","apiKeyGate.testerFormDescription":"Wpisz adres e-mail uywany w sklepie Google Play, aby otrzyma zaproszenie do naszej bety na Androida!","apiKeyGate.testerFormSubmit":"Uzyskaj wczesny dostp","apiKeyGate.testerFormSubmitting":"Wysyanie...","apiKeyGate.testerFormError":"Co poszo nie tak. Sprbuj ponownie.","apiKeyGate.testerFormMustBeGmail":"Uyj adresu @gmail.com dla Google Play.","apiKeyGate.testerFormCapReached":"Limit zgosze osignity. Dzikujemy!","apiKeyGate.developerLogin":"logowanie dewelopera","apiKeyGate.submitAnotherEmail":"Bdny e-mail? Zresetuj i sprbuj innego.","apiKeyGate.testerFormChecking":"Sprawdzanie statusu zaproszenia...","apiKeyGate.testerFormApprovedTitle":"Jeste w rodku! ","apiKeyGate.testerFormApprovedDesc":"Twj e-mail zosta zatwierdzony do programu beta testw Androida.","apiKeyGate.testerFormDownloadBtn":"Pobierz aplikacj z Google Play","apiKeyGate.testerFormPendingTitle":"Jeste na licie oczekujcych!","apiKeyGate.testerFormPendingDesc":"Otrzymalimy Twj e-mail. Rczne przetwarzanie zaproszenia zajmuje troch czasu. Sprawd ponownie pniej!","apiKeyGate.checkStatusModeBtn":"Ju zgoszone? Sprawd status.","apiKeyGate.submitModeBtn":"Chcesz doczy? Zarejestruj si tutaj.","apiKeyGate.checkStatusTitle":"Sprawd status zaproszenia","apiKeyGate.checkStatusDesc":"Wpisz e-mail uyty do zapisu na list oczekujcych.","apiKeyGate.checkStatusSubmit":"Sprawd status","apiKeyGate.testerFormNotFound":"Nie znaleziono e-maila na licie. Zarejestruj si najpierw.","chat.thinking":"Myl...","chat.loadingHistory":"Wczytywanie historii czatu...","chat.loadingSuggestions":"Wczytywanie sugestii...","chat.suggestionsAriaLabel":"Sugestie odpowiedzi","chat.attachImageFromFile":"Zacz plik","chat.removeAttachedImage":"Usu zaczony plik","chat.sendMessage":"Wylij wiadomo","chat.messageInputAriaLabel":"Pole wiadomoci","chat.retrievedFromWeb":"Pobrane z sieci:","chat.videoNotSupported":"Twoja przegldarka nie obsuguje tagu wideo.","chat.audioNotSupported":"Twoja przegldarka nie obsuguje tagu audio.","chat.fileAttachment":"Zacznik","chat.pdf.loading":"adowanie PDF...","chat.pdf.error":"Nie mona wywietli PDF","chat.pdf.pageIndicator":"Strona {current} z {total}","chat.imageGenError":"Bd generowania obrazu","chat.generatingImageLoadingSlow":"To trwa troch duej...","chat.stopSpeaking":"Przesta mwi","chat.speakThisLine":"Wypowiedz t lini","chat.languageSelector.openGlobe":"Zmie jzyki","chat.maestroTranscriptScrollwheel":"Widok przewijania transkrypcji Maestro","chat.mic.listening":"STT aktywne: Sucham...","chat.mic.enableStt":"Wcz STT","chat.mic.disableStt":"Zatrzymaj STT","chat.mic.recordingAudioNote":"Nagrywanie dwiku...","chat.placeholder.normal.listening":"Sucham w {language}...","chat.placeholder.normal.sttActive":"Mw po {language} lub pisz...","chat.placeholder.normal.sttInactive":"Pisz lub dotknij mikrofonu, aby mwi po {language}...","chat.placeholder.suggestion.listening":"Mw po {language}, aby przetumaczy...","chat.placeholder.suggestion.sttActive":"Mw lub pisz po {language}, aby przetumaczy...","chat.placeholder.suggestion.sttInactive":"Pisz po {language}, aby przetumaczy...","chat.camera.turnOn":"Wcz podgld kamery","chat.camera.turnOff":"Wycz podgld kamery","chat.camera.selectCamera":"Wybierz kamer","chat.camera.imageGenCameraLabel":"Generowanie obrazu","chat.camera.captureOrRecord":"Dotknij, aby zrobi zdjcie, przytrzymaj, aby nagra wideo","chat.camera.stopRecording":"Zatrzymaj nagrywanie","chat.bookIcon.toggleImageGen":"Przecz tryb generowania obrazu","chat.imagePreview.alt":"Podgld","chat.image.dragToEnlarge":"Przecignij rg, aby powikszy","chat.image.dragToShrink":"Przecignij rg, aby zmniejszy","chat.annotateImage":"Dodaj adnotacj do obrazu","chat.annotateVideoFrame":"Dodaj adnotacj do biecej klatki","chat.annotateModal.editingPreviewAlt":"Obraz do adnotacji","chat.annotateModal.cancel":"Anuluj","chat.annotateModal.saveAndAttach":"Zapisz i zacz","chat.annotateModal.undo":"Cofnij","chat.suggestion.speak":"Powiedz: {suggestion}","chat.suggestion.ariaLabel":"Wypowiedz sugesti: {suggestion}","chat.suggestion.toggleCreateMode":"Przecz tryb tworzenia sugestii","chat.suggestion.createAction":"Utwrz sugesti","chat.suggestion.creating":"Tworzenie sugestii...","chat.maestro.idle":"Maestro jest bezczynny","chat.maestro.title.idle":"Maestro jest obecnie bezczynny.","chat.maestro.resting":"Maestro odpoczywa...","chat.maestro.observing":"Maestro obserwuje...","chat.maestro.aboutToEngage":"Maestro za chwil si wczy...","chat.maestro.title.resting":"Maestro jest bezczynny, duo czasu do ponownego wczenia.","chat.maestro.title.observing":"Maestro obserwuje, troch czasu do ponownego wczenia.","chat.maestro.title.aboutToEngage":"Maestro wkrtce si ponownie wczy.","chat.maestro.typing":"Maestro pisze...","chat.maestro.title.typing":"Maestro przygotowuje odpowied.","chat.maestro.speaking":"Maestro mwi","chat.maestro.title.speaking":"Maestro obecnie mwi.","chat.maestro.listening":"Sucham...","chat.maestro.title.listening":"Maestro czeka na Twj wpis lub gos.","chat.maestro.holding":"Maestro czeka","chat.maestro.title.holding":"Maestro czeka (ponowne wczenie wstrzymane)","chat.bookmark.hiddenHeaderAria":"Ukryte wiadomoci powyej","chat.bookmark.isHere":"Zakadka jest tutaj","chat.bookmark.setHere":"Ustaw zakadk tutaj","chat.bookmark.actionsRegionAria":"Akcje zakadki","chat.bookmark.actionsToggleTitle":"Opcje zakadki","chat.bookmark.decrementAria":"Poka o jeden mniej","chat.bookmark.decrementTitle":"Mniej","chat.bookmark.incrementAria":"Poka o jeden wicej","chat.bookmark.incrementTitle":"Wicej","chat.bookmark.hiddenBelowHeaderAria":"Ukryte wiadomoci poniej","chat.sendPrep.optimizingVideo":"Optymalizacja wideo...","chat.sendPrep.optimizingImage":"Optymalizacja obrazu...","chat.sendPrep.preparingMedia":"Przygotowywanie mediw...","chat.sendPrep.uploadingMedia":"Przesyanie mediw...","chat.sendPrep.finalizing":"Finalizowanie...","chat.header.annotating":"Dodawanie adnotacji","chat.header.recordingAudio":"Nagrywanie dwiku","chat.header.recordingVideo":"Nagrywanie wideo","chat.header.savePopup":"Zapisywanie...","chat.header.loadPopup":"Wczytywanie...","chat.header.maestroAvatar":"Aktualizowanie awatara Maestro","chat.header.watchingVideo":"Ogldanie wideo","chat.header.viewingAbove":"Przegldanie wiadomoci powyej","chat.header.liveSession":"Sesja na ywo","chat.liveSession.stop":"Zatrzymaj na ywo","chat.liveSession.retry":"Ponw na ywo","chat.liveSession.start":"Rozpocznij na ywo","chat.liveSession.liveBadge":"Na ywo","chat.liveSession.connecting":"czenie","chat.liveSession.defaultLastMessage":"Cze! Jak mog Ci dzisiaj pomc?","chat.liveSession.defaultSuggestion1":"Cze","chat.liveSession.defaultSuggestion2":"Dzie dobry","chat.liveSession.defaultSuggestion3":"Jak si masz?","chat.error.sttError":"Bd STT: {error}. Sprbuj przeczy mikrofon.","chat.error.autoCaptureCameraError":"Bd automatycznego przechwytywania kamery: {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"Nagrywanie zatrzymane automatycznie po {maxMinutes} minutach.","chat.error.videoMetadataError":"Nie mona odczyta metadanych wideo. Plik moe by uszkodzony lub w nieobsugiwanym formacie.","chat.error.pauseVideoToAnnotate":"Wstrzymaj wideo, aby doda adnotacj do biecej klatki","chat.error.imageGenInterrupted":"Generowanie obrazu zostao przerwane.","chat.error.thinkingInterrupted":"Odpowied AI zostaa przerwana.","error.noLanguagePair":"Bd krytyczny: Nie wybrano pary jzykw.","error.translationFailed":"Tumaczenie nie powiodo si. Sprbuj ponownie.","error.imageLimitReached":"Osignito limit generowania obrazw sesji. Rozpocznij now sesj.","error.tokenLimitReached":"Osignito limit tokenw sesji. Rozpocznij now sesj.","error.apiKeyMissing":"Brak klucza API Gemini. Otwrz ekran klucza API i wklej swj klucz.","error.apiKeyInvalid":"Klucz API Gemini jest nieprawidowy. Sprawd, czy nie ma literwek i wklej prawidowy klucz.","error.apiQuotaExceeded":"Twj limit zosta wyczerpany (Patne: inteligentniejszy czat, wideo, pdf i generowanie obrazw)","error.quotaSetupBilling":"Skonfiguruj patnoci","error.quotaStartLive":"Rozpocznij darmow wersj Live (bez generowania obrazw)","error.imageGenCostWarning":"Generowanie obrazu kosztuje ok. 0,04 $ za obraz. Wiadomoci na czacie rwnie wi si z niewielkimi kosztami. Wszystko jest fakturowane przez Google. Koszty moesz ledzi na ekranie klucza API.","error.imageGenDisable":"Wycz generowanie obrazw","error.imageGenViewCost":"led koszty na ekranie klucza API.","error.cameraPermissionDenied":"Odmwiono dostpu do kamery. Wcz dostp do kamery w ustawieniach przegldarki.","error.cameraNotFound":"Nie znaleziono wybranej kamery. Upewnij si, e jest podczona lub wybierz inn kamer w ustawieniach.","error.cameraAccessNotSupported":"Dostp do kamery nie jest obsugiwany przez Twoj przegldark.","error.cameraUnknown":"Wystpi nieznany bd podczas dostpu do kamery.","error.cameraStreamNotAvailable":"Strumie kamery niedostpny do przechwycenia.","error.imageCaptureGeneric":"Nieznany bd podczas przechwytywania obrazu.","error.visualContextVideoElementNotReady":"Element wideo kontekstu wizualnego nie jest gotowy.","error.snapshotVideoElementNotReady":"Element wideo dla zrzutu ekranu nie jest gotowy.","error.visualContextCameraAccessNotSupported":"Dostp do kamery nie jest obsugiwany dla kontekstu wizualnego.","error.snapshotCameraAccessNotSupported":"Dostp do kamery nie jest obsugiwany dla zrzutu ekranu.","error.visualContext2DContext":"Nie mona uzyska kontekstu 2D dla kontekstu wizualnego.","error.snapshot2DContext":"Nie mona uzyska kontekstu 2D dla zrzutu ekranu.","error.visualContextCaptureFailedPermission":"Kontekst wizualny nie powid si: Odmwiono dostpu do kamery.","error.snapshotCaptureFailedPermission":"Zrzut ekranu nie powid si: Odmwiono dostpu do kamery.","error.visualContextCaptureFailedNotFound":"Kontekst wizualny nie powid si: Nie znaleziono kamery.","error.snapshotCaptureFailedNotFound":"Zrzut ekranu nie powid si: Nie znaleziono kamery.","error.visualContextCaptureFailedNotReady":"Kontekst wizualny nie powid si: Kamera nie jest gotowa lub problem ze strumieniem. {details}","error.snapshotCaptureFailedNotReady":"Zrzut ekranu nie powid si: Kamera nie jest gotowa lub problem ze strumieniem. {details}","error.visualContextCaptureFailedGeneric":"Kontekst wizualny nie powid si: {details}","error.snapshotCaptureFailedGeneric":"Zrzut ekranu nie powid si: {details}"},gI={"app.title":"Maestro","sttLang.selectLanguage":"Definir reconhecimento de voz para {language}","header.targetLanguageTitle":"Idioma de destino atual: {language}","startPage.clickToStart":"Clique no avio","startPage.saveChats":"Salvar todos os chats","startPage.loadChats":"Carregar chats","startPage.saveThisChat":"Salvar este chat","startPage.appendToChat":"Anexar ao chat","startPage.trimBeforeBookmark":"Recortar antes do marcador","startPage.maestroAvatar":"Avatar do Maestro","startPage.addMaestroAvatar":"Adicionar avatar do Maestro","startPage.loadSuccess":"{count} sesses de chat carregadas e substitudas com sucesso!","startPage.loadError":"Erro ao carregar chats. O arquivo pode estar corrompido ou em formato errado.","startPage.noChatsToSave":"No h histrico de chat para salvar.","startPage.saveError":"Erro ao salvar chats. Verifique o console para mais detalhes.","startPage.noChatSelected":"Por favor, selecione um par de idiomas primeiro.","startPage.noBookmarkSet":"Nenhum marcador definido. Defina um marcador primeiro para remover as mensagens anteriores a ele.","startPage.noMessagesToTrim":"No h mensagens antes do marcador para remover.","startPage.trimSuccess":"{count} mensagens removidas antes do marcador.","startPage.trimError":"Falha ao recortar mensagens. Por favor, tente novamente.","startPage.noMessagesToAppend":"Nenhuma mensagem encontrada no arquivo de backup para combinar.","startPage.noPairInBackup":"O arquivo de backup no contm mensagens para o seu par de idiomas atual. Por favor, selecione um backup que corresponda ao seu chat atual.","startPage.appendSuccess":"{count} mensagens anexadas ao chat atual com sucesso.","startPage.combineSuccess":"Chats combinados: {added} novas mensagens adicionadas, {total} mensagens no total.","startPage.combineNoDuplicates":"Todas as mensagens j estavam no seu chat. Nenhuma alterao feita.","startPage.combineNoChanges":"Nenhuma nova mensagem para adicionar. Seu chat permanece inalterado.","startPage.invalidBackupFormat":"Arquivo de backup invlido. Por favor, selecione um arquivo de backup do Maestro (.ndjson) vlido.","startPage.browserNotSupported":"Seu navegador no suporta o salvamento de arquivos. Por favor, use Chrome ou Edge.","sessionControls.saveAll.label":"Salvar tudo","sessionControls.saveAll.description":"Exportar todos os chats para um arquivo de backup","sessionControls.loadAll.label":"Carregar tudo","sessionControls.loadAll.description":"Substituir todos os chats pelo arquivo de backup","sessionControls.reset.label":"Redefinir","sessionControls.reset.description":"Fazer backup e apagar todos os dados","sessionControls.saveThis.label":"Salvar chat","sessionControls.saveThis.description":"Exportar apenas este chat","sessionControls.combine.label":"Combinar","sessionControls.combine.description":"Mesclar backup neste chat","sessionControls.trim.label":"Recortar","sessionControls.trim.description":"Remover mensagens antes do marcador","sessionControls.profile":"Perfil:","sessionControls.profilePlaceholder":"Seu nome ou detalhes...","sessionControls.editProfile":"Editar perfil de usurio","sessionControls.allChatsControls":"Controles de todos os chats","sessionControls.thisChatsControls":"Controles deste chat","sessionControls.back":"Voltar","sessionControls.backupAndReset":"Backup e Redefinio","sessionControls.typeToConfirm":'Digite "{keyword}" para confirmar',"sessionControls.changeAvatar":"Alterar avatar","general.clear":"Limpar","general.error":"Desculpe, encontrei um erro.","apiKeyGate.title":"Conecte sua chave API do Gemini","apiKeyGate.billingTitle":"Configurar faturamento para cota maior","apiKeyGate.infoLogin":"Seu login: Uma chave de API","apiKeyGate.infoVisibility":"Quem v: Apenas voc","apiKeyGate.infoBilling":"Cobrana: Mensal, do Google","apiKeyGate.infoCost":"Custo: Mostrado no app  toque para ver","apiKeyGate.infoMore":"Mais informaes:","apiKeyGate.privacyPolicy":"Poltica de Privacidade","apiKeyGate.stepsTitle":"Dois passos rpidos:","apiKeyGate.stepOne":"Abra o Google AI Studio e crie uma chave API.","apiKeyGate.stepTwo":"Cole a chave abaixo e toque em Salvar.","apiKeyGate.openAiStudio":"Abrir Google AI Studio","apiKeyGate.viewInstructions":"Ver instrues","apiKeyGate.closeInstructions":"Fechar instrues","apiKeyGate.previousInstruction":"Instruo anterior","apiKeyGate.nextInstruction":"Prxima instruo","apiKeyGate.instructionStep":"Instruo {step} de {total}","apiKeyGate.keyLabel":"Chave API do Gemini","apiKeyGate.placeholder":"Cole sua chave API aqui","apiKeyGate.show":"Mostrar","apiKeyGate.hide":"Ocultar","apiKeyGate.currentKeySaved":"Chave atual salva {maskedKey}","apiKeyGate.keyInvalid":"Chave invlida {maskedKey}  cole uma nova chave abaixo","apiKeyGate.clearSavedKey":"Limpar chave salva","apiKeyGate.cancel":"Cancelar","apiKeyGate.saving":"Salvando...","apiKeyGate.saveKey":"Salvar chave","apiKeyGate.close":"Fechar","apiKeyGate.costLabel":"Custo estimado da API","apiKeyGate.testerFormTitle":"Testar a App","apiKeyGate.testerFormDescription":"Insira o e-mail que usa na Google Play Store para receber um convite para a nossa verso beta Android!","apiKeyGate.testerFormSubmit":"Obter Acesso Antecipado","apiKeyGate.testerFormSubmitting":"A enviar...","apiKeyGate.testerFormError":"Algo correu mal. Por favor, tente novamente.","apiKeyGate.testerFormMustBeGmail":"Por favor, use um endereo @gmail.com para a Google Play.","apiKeyGate.testerFormCapReached":"Limite de submisso atingido. Obrigado!","apiKeyGate.developerLogin":"login de desenvolvedor","apiKeyGate.submitAnotherEmail":"E-mail errado? Redefina e tente outro.","apiKeyGate.testerFormChecking":"A verificar o estado do convite...","apiKeyGate.testerFormApprovedTitle":"Voc entrou! ","apiKeyGate.testerFormApprovedDesc":"O seu e-mail foi aprovado para o programa de testes beta Android.","apiKeyGate.testerFormDownloadBtn":"Descarregar App na Google Play","apiKeyGate.testerFormPendingTitle":"Est na lista de espera!","apiKeyGate.testerFormPendingDesc":"Recebemos o seu e-mail. O processamento manual do convite demora algum tempo. Por favor, verifique mais tarde!","apiKeyGate.checkStatusModeBtn":"J se inscreveu? Verifique o estado.","apiKeyGate.submitModeBtn":"Precisa de se inscrever? Registe-se aqui.","apiKeyGate.checkStatusTitle":"Verificar Estado do Convite","apiKeyGate.checkStatusDesc":"Insira o e-mail que usou para a lista de espera.","apiKeyGate.checkStatusSubmit":"Verificar Estado","apiKeyGate.testerFormNotFound":"E-mail no encontrado na lista de espera. Por favor, registe-se primeiro.","chat.thinking":"Pensando...","chat.loadingHistory":"Carregando histrico do chat...","chat.loadingSuggestions":"Carregando sugestes...","chat.suggestionsAriaLabel":"Sugestes de resposta","chat.attachImageFromFile":"Anexar arquivo","chat.removeAttachedImage":"Remover arquivo anexado","chat.sendMessage":"Enviar mensagem","chat.messageInputAriaLabel":"Entrada de mensagem","chat.retrievedFromWeb":"Recuperado da web:","chat.videoNotSupported":"Seu navegador no suporta a tag de vdeo.","chat.audioNotSupported":"Seu navegador no suporta a tag de udio.","chat.fileAttachment":"Anexo de arquivo","chat.pdf.loading":"Carregando PDF...","chat.pdf.error":"No  possvel exibir o PDF","chat.pdf.pageIndicator":"Pgina {current} de {total}","chat.imageGenError":"Erro na gerao de imagem","chat.generatingImageLoadingSlow":"Demorando um pouco mais...","chat.stopSpeaking":"Parar de falar","chat.speakThisLine":"Falar esta linha","chat.languageSelector.openGlobe":"Alterar idiomas","chat.maestroTranscriptScrollwheel":"Vista de rolagem da transcrio do Maestro","chat.mic.listening":"STT ativo: Ouvindo...","chat.mic.enableStt":"Ativar STT","chat.mic.disableStt":"Parar STT","chat.mic.recordingAudioNote":"Gravando udio...","chat.placeholder.normal.listening":"Ouvindo em {language}...","chat.placeholder.normal.sttActive":"Fale em {language} ou digite...","chat.placeholder.normal.sttInactive":"Digite ou toque no microfone para falar em {language}...","chat.placeholder.suggestion.listening":"Fale {language} para traduzir...","chat.placeholder.suggestion.sttActive":"Fale ou digite em {language} para traduzir...","chat.placeholder.suggestion.sttInactive":"Digite em {language} para traduzir...","chat.camera.turnOn":"Ativar visualizao da cmera","chat.camera.turnOff":"Desativar visualizao da cmera","chat.camera.selectCamera":"Selecionar cmera","chat.camera.imageGenCameraLabel":"Gerao de imagem","chat.camera.captureOrRecord":"Toque para foto, segure para vdeo","chat.camera.stopRecording":"Parar gravao","chat.bookIcon.toggleImageGen":"Alternar modo de gerao de imagem","chat.imagePreview.alt":"Visualizao","chat.image.dragToEnlarge":"Arraste o canto para ampliar","chat.image.dragToShrink":"Arraste o canto para reduzir","chat.annotateImage":"Anotar imagem","chat.annotateVideoFrame":"Anotar quadro atual","chat.annotateModal.editingPreviewAlt":"Imagem a ser anotada","chat.annotateModal.cancel":"Cancelar","chat.annotateModal.saveAndAttach":"Salvar e anexar","chat.annotateModal.undo":"Desfazer","chat.suggestion.speak":'Falar: "{suggestion}"',"chat.suggestion.ariaLabel":"Falar sugesto: {suggestion}","chat.suggestion.toggleCreateMode":"Alternar modo de criao de sugesto","chat.suggestion.createAction":"Criar sugesto","chat.suggestion.creating":"Criando sugesto...","chat.maestro.idle":"Maestro est inativo","chat.maestro.title.idle":"Maestro est atualmente inativo.","chat.maestro.resting":"Maestro est descansando...","chat.maestro.observing":"Maestro est observando...","chat.maestro.aboutToEngage":"Maestro est prestes a interagir...","chat.maestro.title.resting":"Maestro est inativo, muito tempo antes da reativao.","chat.maestro.title.observing":"Maestro est observando, algum tempo antes da reativao.","chat.maestro.title.aboutToEngage":"Maestro est prestes a se reativar em breve.","chat.maestro.typing":"Maestro est digitando...","chat.maestro.title.typing":"Maestro est preparando uma resposta.","chat.maestro.speaking":"Maestro est falando","chat.maestro.title.speaking":"Maestro est falando agora.","chat.maestro.listening":"Ouvindo...","chat.maestro.title.listening":"Maestro est aguardando sua entrada ou voz.","chat.maestro.holding":"Maestro est aguardando","chat.maestro.title.holding":"Maestro est aguardando (reativao pausada)","chat.bookmark.hiddenHeaderAria":"Oculto acima das mensagens","chat.bookmark.isHere":"O marcador est aqui","chat.bookmark.setHere":"Definir marcador aqui","chat.bookmark.actionsRegionAria":"Aes do marcador","chat.bookmark.actionsToggleTitle":"Opes do marcador","chat.bookmark.decrementAria":"Mostrar um a menos","chat.bookmark.decrementTitle":"Menos","chat.bookmark.incrementAria":"Mostrar um a mais","chat.bookmark.incrementTitle":"Mais","chat.bookmark.hiddenBelowHeaderAria":"Mensagens ocultas abaixo","chat.sendPrep.optimizingVideo":"Otimizando vdeo...","chat.sendPrep.optimizingImage":"Otimizando imagem...","chat.sendPrep.preparingMedia":"Preparando mdia...","chat.sendPrep.uploadingMedia":"Enviando mdia...","chat.sendPrep.finalizing":"Finalizando...","chat.header.annotating":"Anotando","chat.header.recordingAudio":"Gravando udio","chat.header.recordingVideo":"Gravando vdeo","chat.header.savePopup":"Salvando...","chat.header.loadPopup":"Carregando...","chat.header.maestroAvatar":"Atualizando avatar do Maestro","chat.header.watchingVideo":"Assistindo vdeo","chat.header.viewingAbove":"Visualizando mensagens anteriores","chat.header.liveSession":"Sesso ao vivo","chat.liveSession.stop":"Parar ao vivo","chat.liveSession.retry":"Tentar novamente ao vivo","chat.liveSession.start":"Iniciar ao vivo","chat.liveSession.liveBadge":"Ao vivo","chat.liveSession.connecting":"Conectando","chat.liveSession.defaultLastMessage":"Ol! Como posso ajudar voc hoje?","chat.liveSession.defaultSuggestion1":"Ol","chat.liveSession.defaultSuggestion2":"Bom dia","chat.liveSession.defaultSuggestion3":"Como voc est?","chat.error.sttError":"Erro STT: {error}. Tente alternar o microfone.","chat.error.autoCaptureCameraError":"Erro de captura automtica da cmera: {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"Gravao parada automaticamente aps {maxMinutes} minutos.","chat.error.videoMetadataError":"No foi possvel ler os metadados do vdeo. O arquivo pode estar corrompido ou em formato no suportado.","chat.error.pauseVideoToAnnotate":"Pause o vdeo para anotar o quadro atual","chat.error.imageGenInterrupted":"A gerao de imagem foi interrompida.","chat.error.thinkingInterrupted":"A resposta da IA foi interrompida.","error.noLanguagePair":"Erro crtico: Nenhum par de idiomas selecionado.","error.translationFailed":"Traduo falhou. Por favor, tente novamente.","error.imageLimitReached":"Limite de gerao de imagens da sesso atingido. Por favor, inicie uma nova sesso.","error.tokenLimitReached":"Limite de tokens da sesso atingido. Por favor, inicie uma nova sesso.","error.apiKeyMissing":"Sua chave API do Gemini est faltando. Abra a tela de chave API e cole sua chave.","error.apiKeyInvalid":"Sua chave API do Gemini  invlida. Verifique se h erros de digitao e cole uma chave vlida.","error.apiQuotaExceeded":"Sua cota foi esgotada (Pago: chat mais inteligente, vdeo, pdf e gerao de imagens)","error.quotaSetupBilling":"Configurar faturamento","error.quotaStartLive":"Iniciar verso gratuita Live (sem gerao de imagens)","error.imageGenCostWarning":"A gerao de imagens custa cerca de US$ 0,04 por imagem. Mensagens de chat tambm tm um custo pequeno. Tudo faturado pelo Google. Voc pode acompanhar os custos na tela da chave de API.","error.imageGenDisable":"Desativar gerao de imagens","error.imageGenViewCost":"Acompanhe os custos na tela da chave de API.","error.cameraPermissionDenied":"Permisso da cmera negada. Por favor, habilite o acesso  cmera nas configuraes do seu navegador.","error.cameraNotFound":"Cmera selecionada no encontrada. Certifique-se de que est conectada ou selecione uma cmera diferente nas configuraes.","error.cameraAccessNotSupported":"O acesso  cmera no  suportado pelo seu navegador.","error.cameraUnknown":"Ocorreu um erro desconhecido ao acessar a cmera.","error.cameraStreamNotAvailable":"Stream da cmera no disponvel para captura.","error.imageCaptureGeneric":"Erro desconhecido durante a captura de imagem.","error.visualContextVideoElementNotReady":"Elemento de vdeo do contexto visual no est pronto.","error.snapshotVideoElementNotReady":"Elemento de vdeo para captura no est pronto.","error.visualContextCameraAccessNotSupported":"Acesso  cmera no suportado para contexto visual.","error.snapshotCameraAccessNotSupported":"Acesso  cmera no suportado para captura.","error.visualContext2DContext":"No foi possvel obter contexto 2D para contexto visual.","error.snapshot2DContext":"No foi possvel obter contexto 2D para captura.","error.visualContextCaptureFailedPermission":"Contexto visual falhou: Permisso da cmera negada.","error.snapshotCaptureFailedPermission":"Captura falhou: Permisso da cmera negada.","error.visualContextCaptureFailedNotFound":"Contexto visual falhou: Cmera no encontrada.","error.snapshotCaptureFailedNotFound":"Captura falhou: Cmera no encontrada.","error.visualContextCaptureFailedNotReady":"Contexto visual falhou: Cmera no pronta ou problema com o sinal. {details}","error.snapshotCaptureFailedNotReady":"Captura falhou: Cmera no pronta ou problema com o sinal. {details}","error.visualContextCaptureFailedGeneric":"Contexto visual falhou: {details}","error.snapshotCaptureFailedGeneric":"Captura falhou: {details}"},fI={"app.title":"Maestro","sttLang.selectLanguage":"    {language}","header.targetLanguageTitle":"  : {language}","startPage.clickToStart":"  ","startPage.saveChats":"  ","startPage.loadChats":" ","startPage.saveThisChat":"  ","startPage.appendToChat":"  ","startPage.trimBeforeBookmark":"  ","startPage.maestroAvatar":" ","startPage.addMaestroAvatar":"  ","startPage.loadSuccess":"    {count}  !","startPage.loadError":"  .        .","startPage.noChatsToSave":"    .","startPage.saveError":"  .    .","startPage.noChatSelected":",    .","startPage.noBookmarkSet":"  .   ,     .","startPage.noMessagesToTrim":"     .","startPage.trimSuccess":" {count}   .","startPage.trimError":"   . ,  .","startPage.noMessagesToAppend":"       .","startPage.noPairInBackup":"         . ,  ,    .","startPage.appendSuccess":"  {count}    .","startPage.combineSuccess":" :  {added}  ,  {total} .","startPage.combineNoDuplicates":"      .   .","startPage.combineNoChanges":"    .    .","startPage.invalidBackupFormat":"   . ,      Maestro (.ndjson).","startPage.browserNotSupported":"     . ,  Chrome  Edge.","sessionControls.saveAll.label":" ","sessionControls.saveAll.description":"      ","sessionControls.loadAll.label":" ","sessionControls.loadAll.description":"       ","sessionControls.reset.label":"","sessionControls.reset.description":"     ","sessionControls.saveThis.label":" ","sessionControls.saveThis.description":"   ","sessionControls.combine.label":"","sessionControls.combine.description":"     ","sessionControls.trim.label":"","sessionControls.trim.description":"   ","sessionControls.profile":":","sessionControls.profilePlaceholder":"   ...","sessionControls.editProfile":"  ","sessionControls.allChatsControls":"  ","sessionControls.thisChatsControls":"  ","sessionControls.back":"","sessionControls.backupAndReset":"   ","sessionControls.typeToConfirm":" {keyword}  ","sessionControls.changeAvatar":" ","general.clear":"","general.error":",  .","apiKeyGate.title":"   API Gemini","apiKeyGate.billingTitle":"    ","apiKeyGate.infoLogin":" : API-","apiKeyGate.infoVisibility":" :  ","apiKeyGate.infoBilling":": ,  Google","apiKeyGate.infoCost":":       ","apiKeyGate.infoMore":":","apiKeyGate.privacyPolicy":" ","apiKeyGate.stepsTitle":"  :","apiKeyGate.stepOne":" Google AI Studio    API.","apiKeyGate.stepTwo":"     .","apiKeyGate.openAiStudio":" Google AI Studio","apiKeyGate.viewInstructions":" ","apiKeyGate.closeInstructions":" ","apiKeyGate.previousInstruction":" ","apiKeyGate.nextInstruction":" ","apiKeyGate.instructionStep":" {step}  {total}","apiKeyGate.keyLabel":" API Gemini","apiKeyGate.placeholder":"   API ","apiKeyGate.show":"","apiKeyGate.hide":"","apiKeyGate.currentKeySaved":"   {maskedKey}","apiKeyGate.keyInvalid":"  {maskedKey}     ","apiKeyGate.clearSavedKey":"  ","apiKeyGate.cancel":"","apiKeyGate.saving":"...","apiKeyGate.saveKey":" ","apiKeyGate.close":"","apiKeyGate.costLabel":"  API","apiKeyGate.testerFormTitle":" ","apiKeyGate.testerFormDescription":"   ,     Google Play Store,     -  Android!","apiKeyGate.testerFormSubmit":"  ","apiKeyGate.testerFormSubmitting":"...","apiKeyGate.testerFormError":"-   .   .","apiKeyGate.testerFormMustBeGmail":",   @gmail.com  Google Play.","apiKeyGate.testerFormCapReached":"  . !","apiKeyGate.developerLogin":"  ","apiKeyGate.submitAnotherEmail":" email?    .","apiKeyGate.testerFormChecking":"  ...","apiKeyGate.testerFormApprovedTitle":" ! ","apiKeyGate.testerFormApprovedDesc":" email     - Android.","apiKeyGate.testerFormDownloadBtn":"  Google Play","apiKeyGate.testerFormPendingTitle":"   !","apiKeyGate.testerFormPendingDesc":"   email.      . ,  !","apiKeyGate.checkStatusModeBtn":"  ?  .","apiKeyGate.submitModeBtn":" ?  .","apiKeyGate.checkStatusTitle":"  ","apiKeyGate.checkStatusDesc":" email,      .","apiKeyGate.checkStatusSubmit":" ","apiKeyGate.testerFormNotFound":"Email     . ,  .","chat.thinking":"...","chat.loadingHistory":"  ...","chat.loadingSuggestions":" ...","chat.suggestionsAriaLabel":" ","chat.attachImageFromFile":" ","chat.removeAttachedImage":"  ","chat.sendMessage":" ","chat.messageInputAriaLabel":" ","chat.retrievedFromWeb":"  :","chat.videoNotSupported":"     video.","chat.audioNotSupported":"     audio.","chat.fileAttachment":" ","chat.pdf.loading":" PDF...","chat.pdf.error":"   PDF","chat.pdf.pageIndicator":" {current}  {total}","chat.imageGenError":"  ","chat.generatingImageLoadingSlow":"   ...","chat.stopSpeaking":" ","chat.speakThisLine":"  ","chat.languageSelector.openGlobe":" ","chat.maestroTranscriptScrollwheel":"  ","chat.mic.listening":"STT : ...","chat.mic.enableStt":" STT","chat.mic.disableStt":" STT","chat.mic.recordingAudioNote":" ...","chat.placeholder.normal.listening":"  {language}...","chat.placeholder.normal.sttActive":"  {language}  ...","chat.placeholder.normal.sttInactive":"    ,    {language}...","chat.placeholder.suggestion.listening":"  {language}  ...","chat.placeholder.suggestion.sttActive":"    {language}  ...","chat.placeholder.suggestion.sttInactive":"  {language}  ...","chat.camera.turnOn":"  ","chat.camera.turnOff":"  ","chat.camera.selectCamera":" ","chat.camera.imageGenCameraLabel":" ","chat.camera.captureOrRecord":"  ,   ","chat.camera.stopRecording":" ","chat.bookIcon.toggleImageGen":"   ","chat.imagePreview.alt":"","chat.image.dragToEnlarge":"  ,  ","chat.image.dragToShrink":"  ,  ","chat.annotateImage":" ","chat.annotateVideoFrame":"  ","chat.annotateModal.editingPreviewAlt":"  ","chat.annotateModal.cancel":"","chat.annotateModal.saveAndAttach":"  ","chat.annotateModal.undo":"","chat.suggestion.speak":': "{suggestion}"',"chat.suggestion.ariaLabel":" : {suggestion}","chat.suggestion.toggleCreateMode":"   ","chat.suggestion.createAction":" ","chat.suggestion.creating":" ...","chat.maestro.idle":" ","chat.maestro.title.idle":"    .","chat.maestro.resting":" ...","chat.maestro.observing":" ...","chat.maestro.aboutToEngage":"  ...","chat.maestro.title.resting":" ,     .","chat.maestro.title.observing":" ,     .","chat.maestro.title.aboutToEngage":"   .","chat.maestro.typing":" ...","chat.maestro.title.typing":"  .","chat.maestro.speaking":" ","chat.maestro.title.speaking":"  .","chat.maestro.listening":"...","chat.maestro.title.listening":"     .","chat.maestro.holding":" ","chat.maestro.title.holding":"  (  )","chat.bookmark.hiddenHeaderAria":"  ","chat.bookmark.isHere":" ","chat.bookmark.setHere":"  ","chat.bookmark.actionsRegionAria":"  ","chat.bookmark.actionsToggleTitle":" ","chat.bookmark.decrementAria":"   ","chat.bookmark.decrementTitle":"","chat.bookmark.incrementAria":"   ","chat.bookmark.incrementTitle":"","chat.bookmark.hiddenBelowHeaderAria":"  ","chat.sendPrep.optimizingVideo":" ...","chat.sendPrep.optimizingImage":" ...","chat.sendPrep.preparingMedia":" ...","chat.sendPrep.uploadingMedia":" ...","chat.sendPrep.finalizing":"...","chat.header.annotating":"","chat.header.recordingAudio":" ","chat.header.recordingVideo":" ","chat.header.savePopup":"...","chat.header.loadPopup":"...","chat.header.maestroAvatar":"  ","chat.header.watchingVideo":" ","chat.header.viewingAbove":"  ","chat.header.liveSession":" ","chat.liveSession.stop":" ","chat.liveSession.retry":" ","chat.liveSession.start":" ","chat.liveSession.liveBadge":" ","chat.liveSession.connecting":"","chat.liveSession.defaultLastMessage":"!      ?","chat.liveSession.defaultSuggestion1":"","chat.liveSession.defaultSuggestion2":" ","chat.liveSession.defaultSuggestion3":" ?","chat.error.sttError":" STT: {error}.   .","chat.error.autoCaptureCameraError":"  : {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"    {maxMinutes} .","chat.error.videoMetadataError":"    .        .","chat.error.pauseVideoToAnnotate":"   ,    ","chat.error.imageGenInterrupted":"   .","chat.error.thinkingInterrupted":"   .","error.noLanguagePair":" :    .","error.translationFailed":"  . ,  .","error.imageLimitReached":"    . ,   .","error.tokenLimitReached":"   . ,   .","error.apiKeyMissing":"  API Gemini .    API    .","error.apiKeyInvalid":"  API Gemini . ,        .","error.apiQuotaExceeded":"   (:   , , pdf   )","error.quotaSetupBilling":" ","error.quotaStartLive":"   Live (  )","error.imageGenCostWarning":"    $0,04  .       .    Google.       API-.","error.imageGenDisable":"  ","error.imageGenViewCost":"    API-.","error.cameraPermissionDenied":"    . ,        .","error.cameraNotFound":"   . , ,   ,      .","error.cameraAccessNotSupported":"      .","error.cameraUnknown":"      .","error.cameraStreamNotAvailable":"    .","error.imageCaptureGeneric":"    .","error.visualContextVideoElementNotReady":"    .","error.snapshotVideoElementNotReady":"    .","error.visualContextCameraAccessNotSupported":"       .","error.snapshotCameraAccessNotSupported":"      .","error.visualContext2DContext":"   2D    .","error.snapshot2DContext":"   2D   .","error.visualContextCaptureFailedPermission":"  :     .","error.snapshotCaptureFailedPermission":"  :     .","error.visualContextCaptureFailedNotFound":"  :   .","error.snapshotCaptureFailedNotFound":"  :   .","error.visualContextCaptureFailedNotReady":"  :        . {details}","error.snapshotCaptureFailedNotReady":"  :        . {details}","error.visualContextCaptureFailedGeneric":"  : {details}","error.snapshotCaptureFailedGeneric":"  : {details}"},pI={"app.title":"Maestro","sttLang.selectLanguage":"Stll in taligenknning till {language}","header.targetLanguageTitle":"Nuvarande mlsprk: {language}","startPage.clickToStart":"Klicka p flygplanet","startPage.saveChats":"Spara alla chattar","startPage.loadChats":"Ladda chattar","startPage.saveThisChat":"Spara denna chatt","startPage.appendToChat":"Lgg till i chatt","startPage.trimBeforeBookmark":"Trimma fre bokmrke","startPage.maestroAvatar":"Maestro-avatar","startPage.addMaestroAvatar":"Lgg till Maestro-avatar","startPage.loadSuccess":"{count} chattsessioner laddades och ersattes framgngsrikt!","startPage.loadError":"Fel vid laddning av chattar. Filen kan vara skadad eller i fel format.","startPage.noChatsToSave":"Ingen chatthistorik att spara.","startPage.saveError":"Fel vid sparning av chattar. Se konsolen fr mer detaljer.","startPage.noChatSelected":"Vlj ett sprkpar frst.","startPage.noBookmarkSet":"Inget bokmrke angett. Stt ett bokmrke frst fr att trimma meddelanden fre det.","startPage.noMessagesToTrim":"Inga meddelanden fre bokmrket att ta bort.","startPage.trimSuccess":"Tog bort {count} meddelanden fre bokmrket.","startPage.trimError":"Misslyckades med att trimma meddelanden. Frsk igen.","startPage.noMessagesToAppend":"Inga meddelanden hittades i skerhetskopian att kombinera.","startPage.noPairInBackup":"Skerhetskopian innehller inte meddelanden fr ditt aktuella sprkpar. Vlj en skerhetskopia som matchar din aktuella chatt.","startPage.appendSuccess":"Lade till {count} meddelanden i den aktuella chatten.","startPage.combineSuccess":"Kombinerade chattar: {added} nya meddelanden tillagda, totalt {total} meddelanden.","startPage.combineNoDuplicates":"Alla meddelanden fanns redan i din chatt. Inga ndringar gjordes.","startPage.combineNoChanges":"Inga nya meddelanden att lgga till. Din chatt r ofrndrad.","startPage.invalidBackupFormat":"Ogiltig skerhetskopia. Vlj en giltig Maestro-backupfil (.ndjson).","startPage.browserNotSupported":"Din webblsare stder inte sparande av filer. Anvnd Chrome eller Edge.","sessionControls.saveAll.label":"Spara alla","sessionControls.saveAll.description":"Exportera alla chattar till backupfil","sessionControls.loadAll.label":"Ladda alla","sessionControls.loadAll.description":"Erstt alla chattar med backupfil","sessionControls.reset.label":"terstll","sessionControls.reset.description":"Skerhetskopiera & radera all data","sessionControls.saveThis.label":"Spara chatt","sessionControls.saveThis.description":"Exportera endast denna chatt","sessionControls.combine.label":"Kombinera","sessionControls.combine.description":"Sl ihop backup med denna chatt","sessionControls.trim.label":"Trimma","sessionControls.trim.description":"Ta bort meddelanden fre bokmrke","sessionControls.profile":"Profil:","sessionControls.profilePlaceholder":"Ditt namn eller detaljer...","sessionControls.editProfile":"Redigera anvndarprofil","sessionControls.allChatsControls":"Kontroller fr alla chattar","sessionControls.thisChatsControls":"Kontroller fr denna chatt","sessionControls.back":"Bakt","sessionControls.backupAndReset":"Skerhetskopiera & terstll","sessionControls.typeToConfirm":'Skriv "{keyword}" fr att bekrfta',"sessionControls.changeAvatar":"ndra avatar","general.clear":"Rensa","general.error":"Tyvrr, ett fel uppstod.","apiKeyGate.title":"Anslut din Gemini API-nyckel","apiKeyGate.billingTitle":"Stll in fakturering fr hgre kvot","apiKeyGate.infoLogin":"Din inloggning: En API-nyckel","apiKeyGate.infoVisibility":"Vem ser den: Bara du","apiKeyGate.infoBilling":"Fakturering: Mnadsvis, frn Google","apiKeyGate.infoCost":"Kostnad: Visas i appen  tryck fr att se","apiKeyGate.infoMore":"Mer info:","apiKeyGate.privacyPolicy":"Integritetspolicy","apiKeyGate.stepsTitle":"Tv snabba steg:","apiKeyGate.stepOne":"ppna Google AI Studio och skapa en API-nyckel.","apiKeyGate.stepTwo":"Klistra in nyckeln nedan och tryck p Spara.","apiKeyGate.openAiStudio":"ppna Google AI Studio","apiKeyGate.viewInstructions":"Visa instruktioner","apiKeyGate.closeInstructions":"Stng instruktioner","apiKeyGate.previousInstruction":"Fregende instruktion","apiKeyGate.nextInstruction":"Nsta instruktion","apiKeyGate.instructionStep":"Instruktion {step} av {total}","apiKeyGate.keyLabel":"Gemini API-nyckel","apiKeyGate.placeholder":"Klistra in din API-nyckel hr","apiKeyGate.show":"Visa","apiKeyGate.hide":"Dlj","apiKeyGate.currentKeySaved":"Aktuell nyckel sparad {maskedKey}","apiKeyGate.keyInvalid":"Nyckel ogiltig {maskedKey}  klistra in en ny nyckel nedan","apiKeyGate.clearSavedKey":"Rensa sparad nyckel","apiKeyGate.cancel":"Avbryt","apiKeyGate.saving":"Sparar...","apiKeyGate.saveKey":"Spara nyckel","apiKeyGate.close":"Stng","apiKeyGate.costLabel":"Uppskattad API-kostnad","apiKeyGate.testerFormTitle":"Testa appen","apiKeyGate.testerFormDescription":"Ange e-postadressen du anvnder fr Google Play Store fr att f en inbjudan till vr Android-beta!","apiKeyGate.testerFormSubmit":"F Early Access","apiKeyGate.testerFormSubmitting":"Skickar...","apiKeyGate.testerFormError":"Ngot gick fel. Frsk igen.","apiKeyGate.testerFormMustBeGmail":"Anvnd en @gmail.com-adress fr Google Play.","apiKeyGate.testerFormCapReached":"Anmlningsgrns ndd. Tack!","apiKeyGate.developerLogin":"utvecklarinloggning","apiKeyGate.submitAnotherEmail":"Fel e-post? terstll och frsk med en annan.","apiKeyGate.testerFormChecking":"Kontrollerar din inbjudningsstatus...","apiKeyGate.testerFormApprovedTitle":"Du r med! ","apiKeyGate.testerFormApprovedDesc":"Din e-post har godknts fr betatestprogrammet fr Android.","apiKeyGate.testerFormDownloadBtn":"Ladda ner appen p Google Play","apiKeyGate.testerFormPendingTitle":"Du r p vntelistan!","apiKeyGate.testerFormPendingDesc":"Vi har tagit emot ditt mejl. Det tar lite tid att behandla inbjudan manuellt. Titta tillbaka senare!","apiKeyGate.checkStatusModeBtn":"Redan anskt? Kontrollera din status.","apiKeyGate.submitModeBtn":"Behver du anska? Registrera dig hr.","apiKeyGate.checkStatusTitle":"Kontrollera inbjudningsstatus","apiKeyGate.checkStatusDesc":"Ange e-postadressen du anvnde fr vntelistan.","apiKeyGate.checkStatusSubmit":"Kontrollera status","apiKeyGate.testerFormNotFound":"E-postadressen hittades inte p vntelistan. Registrera dig frst.","chat.thinking":"Tnker...","chat.loadingHistory":"Laddar chatthistorik...","chat.loadingSuggestions":"Laddar frslag...","chat.suggestionsAriaLabel":"Svarsfrslag","chat.attachImageFromFile":"Bifoga fil","chat.removeAttachedImage":"Ta bort bifogad fil","chat.sendMessage":"Skicka meddelande","chat.messageInputAriaLabel":"Meddelandeinmatning","chat.retrievedFromWeb":"Hmtat frn webben:","chat.videoNotSupported":"Din webblsare stder inte videotaggen.","chat.audioNotSupported":"Din webblsare stder inte ljudtaggen.","chat.fileAttachment":"Filbilaga","chat.pdf.loading":"Laddar PDF...","chat.pdf.error":"Kan inte visa PDF","chat.pdf.pageIndicator":"Sida {current} av {total}","chat.imageGenError":"Fel vid bildgenerering","chat.generatingImageLoadingSlow":"Det tar lite lngre tid...","chat.stopSpeaking":"Sluta prata","chat.speakThisLine":"Ls upp denna rad","chat.languageSelector.openGlobe":"Byt sprk","chat.maestroTranscriptScrollwheel":"Maestro-transkription rullningsvy","chat.mic.listening":"STT aktiv: Lyssnar...","chat.mic.enableStt":"Aktivera STT","chat.mic.disableStt":"Stoppa STT","chat.mic.recordingAudioNote":"Spelar in ljud...","chat.placeholder.normal.listening":"Lyssnar p {language}...","chat.placeholder.normal.sttActive":"Tala p {language} eller skriv...","chat.placeholder.normal.sttInactive":"Skriv eller tryck p mikrofonen fr att tala p {language}...","chat.placeholder.suggestion.listening":"Tala {language} fr att verstta...","chat.placeholder.suggestion.sttActive":"Tala eller skriv p {language} fr att verstta...","chat.placeholder.suggestion.sttInactive":"Skriv p {language} fr att verstta...","chat.camera.turnOn":"Aktivera kamerafrhandsgranskning","chat.camera.turnOff":"Inaktivera kamerafrhandsgranskning","chat.camera.selectCamera":"Vlj kamera","chat.camera.imageGenCameraLabel":"Bildgenerering","chat.camera.captureOrRecord":"Tryck fr foto, hll fr video","chat.camera.stopRecording":"Stoppa inspelning","chat.bookIcon.toggleImageGen":"Vxla bildgenereringslge","chat.imagePreview.alt":"Frhandsgranskning","chat.image.dragToEnlarge":"Dra i hrnet fr att frstora","chat.image.dragToShrink":"Dra i hrnet fr att frminska","chat.annotateImage":"Annotera bild","chat.annotateVideoFrame":"Annotera aktuell bildruta","chat.annotateModal.editingPreviewAlt":"Bild att annotera","chat.annotateModal.cancel":"Avbryt","chat.annotateModal.saveAndAttach":"Spara och bifoga","chat.annotateModal.undo":"ngra","chat.suggestion.speak":'Sg: "{suggestion}"',"chat.suggestion.ariaLabel":"Ls upp frslag: {suggestion}","chat.suggestion.toggleCreateMode":"Vxla frslagsskapningslge","chat.suggestion.createAction":"Skapa frslag","chat.suggestion.creating":"Skapar frslag...","chat.maestro.idle":"Maestro r inaktiv","chat.maestro.title.idle":"Maestro r fr nrvarande inaktiv.","chat.maestro.resting":"Maestro vilar...","chat.maestro.observing":"Maestro observerar...","chat.maestro.aboutToEngage":"Maestro ska snart engagera sig...","chat.maestro.title.resting":"Maestro r inaktiv, lng tid till teraktivering.","chat.maestro.title.observing":"Maestro observerar, lite tid till teraktivering.","chat.maestro.title.aboutToEngage":"Maestro kommer snart att teraktiveras.","chat.maestro.typing":"Maestro skriver...","chat.maestro.title.typing":"Maestro frbereder ett svar.","chat.maestro.speaking":"Maestro talar","chat.maestro.title.speaking":"Maestro talar just nu.","chat.maestro.listening":"Lyssnar...","chat.maestro.title.listening":"Maestro vntar p din inmatning eller rst.","chat.maestro.holding":"Maestro vntar","chat.maestro.title.holding":"Maestro vntar (teraktivering pausad)","chat.bookmark.hiddenHeaderAria":"Dolda meddelanden ovanfr","chat.bookmark.isHere":"Bokmrket r hr","chat.bookmark.setHere":"Stt bokmrke hr","chat.bookmark.actionsRegionAria":"Bokmrkestgrder","chat.bookmark.actionsToggleTitle":"Bokmrkesalternativ","chat.bookmark.decrementAria":"Visa en mindre","chat.bookmark.decrementTitle":"Frre","chat.bookmark.incrementAria":"Visa en mer","chat.bookmark.incrementTitle":"Fler","chat.bookmark.hiddenBelowHeaderAria":"Dolda meddelanden nedanfr","chat.sendPrep.optimizingVideo":"Optimerar video...","chat.sendPrep.optimizingImage":"Optimerar bild...","chat.sendPrep.preparingMedia":"Frbereder media...","chat.sendPrep.uploadingMedia":"Laddar upp media...","chat.sendPrep.finalizing":"Slutfr...","chat.header.annotating":"Annoterar","chat.header.recordingAudio":"Spelar in ljud","chat.header.recordingVideo":"Spelar in video","chat.header.savePopup":"Sparar...","chat.header.loadPopup":"Laddar...","chat.header.maestroAvatar":"Uppdaterar Maestro-avatar","chat.header.watchingVideo":"Tittar p video","chat.header.viewingAbove":"Visar tidigare meddelanden","chat.header.liveSession":"Livesession","chat.liveSession.stop":"Stoppa live","chat.liveSession.retry":"Frsk live igen","chat.liveSession.start":"Starta live","chat.liveSession.liveBadge":"Live","chat.liveSession.connecting":"Ansluter","chat.liveSession.defaultLastMessage":"Hej! Hur kan jag hjlpa dig idag?","chat.liveSession.defaultSuggestion1":"Hej","chat.liveSession.defaultSuggestion2":"God morgon","chat.liveSession.defaultSuggestion3":"Hur mr du?","chat.error.sttError":"STT-fel: {error}. Prova att byta mikrofon.","chat.error.autoCaptureCameraError":"Automatisk kameratagningsfel: {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"Inspelning stoppades automatiskt efter {maxMinutes} minuter.","chat.error.videoMetadataError":"Kunde inte lsa videometadata. Filen kan vara skadad eller i ett format som inte stds.","chat.error.pauseVideoToAnnotate":"Pausa videon fr att annotera den aktuella bildrutan","chat.error.imageGenInterrupted":"Bildgenereringen avbrts.","chat.error.thinkingInterrupted":"AI-svaret avbrts.","error.noLanguagePair":"Kritiskt fel: Inget sprkpar valt.","error.translationFailed":"versttningen misslyckades. Frsk igen.","error.imageLimitReached":"Sessionens bildgenereringsgrns ndd. Starta en ny session.","error.tokenLimitReached":"Sessionens tokengrns ndd. Starta en ny session.","error.apiKeyMissing":"Din Gemini API-nyckel saknas. ppna API-nyckelskrmen och klistra in din nyckel.","error.apiKeyInvalid":"Din Gemini API-nyckel r ogiltig. Kontrollera om det finns stavfel och klistra in en giltig nyckel.","error.apiQuotaExceeded":"Din kvot r frbrukad (Betald: smartare chatt, video, pdf och bildgenerering)","error.quotaSetupBilling":"Stll in fakturering","error.quotaStartLive":"Starta gratis Live-version (ingen bildgenerering)","error.imageGenCostWarning":"Bildgenerering kostar ca $0,04 per bild. Chattmeddelanden har ocks en liten kostnad. Allt debiteras av Google. Du kan spra kostnaderna p API-nyckelskrmen.","error.imageGenDisable":"Inaktivera bildgenerering","error.imageGenViewCost":"Spra kostnader p API-nyckelskrmen.","error.cameraPermissionDenied":"Kamerabehrighet nekad. Aktivera kameratkomst i webblsarens instllningar.","error.cameraNotFound":"Vald kamera hittades inte. Se till att den r ansluten eller vlj en annan kamera.","error.cameraAccessNotSupported":"Kameratkomst stds inte av din webblsare.","error.cameraUnknown":"Ett oknt fel uppstod vid tkomst till kameran.","error.cameraStreamNotAvailable":"Kamerastrm inte tillgnglig fr tagning.","error.imageCaptureGeneric":"Oknt fel vid bildtagning.","error.visualContextVideoElementNotReady":"Visuellt kontext videoelement inte redo.","error.snapshotVideoElementNotReady":"Snapshot videoelement inte redo.","error.visualContextCameraAccessNotSupported":"Kameratkomst stds inte fr visuellt kontext.","error.snapshotCameraAccessNotSupported":"Kameratkomst stds inte fr snapshot.","error.visualContext2DContext":"Kunde inte hmta 2D-kontext fr visuellt kontext.","error.snapshot2DContext":"Kunde inte hmta 2D-kontext fr snapshot.","error.visualContextCaptureFailedPermission":"Visuellt kontext misslyckades: Kamerabehrighet nekad.","error.snapshotCaptureFailedPermission":"Snapshot misslyckades: Kamerabehrighet nekad.","error.visualContextCaptureFailedNotFound":"Visuellt kontext misslyckades: Kamera hittades inte.","error.snapshotCaptureFailedNotFound":"Snapshot misslyckades: Kamera hittades inte.","error.visualContextCaptureFailedNotReady":"Visuellt kontext misslyckades: Kamera inte redo eller problem med fldet. {details}","error.snapshotCaptureFailedNotReady":"Snapshot misslyckades: Kamera inte redo eller problem med fldet. {details}","error.visualContextCaptureFailedGeneric":"Visuellt kontext misslyckades: {details}","error.snapshotCaptureFailedGeneric":"Snapshot misslyckades: {details}"},mI={"app.title":"Maestro ()","sttLang.selectLanguage":"  {language}  ","header.targetLanguageTitle":"  : {language}","startPage.clickToStart":"  ","startPage.saveChats":"  ","startPage.loadChats":" ","startPage.saveThisChat":"  ","startPage.appendToChat":" ","startPage.trimBeforeBookmark":"   ","startPage.maestroAvatar":" ","startPage.addMaestroAvatar":"  ","startPage.loadSuccess":"{count}     !","startPage.loadError":"  .      .","startPage.noChatsToSave":"   .","startPage.saveError":"  .    .","startPage.noChatSelected":"    .","startPage.noBookmarkSet":" .     .","startPage.noMessagesToTrim":"    .","startPage.trimSuccess":"   {count}  .","startPage.trimError":"  .  .","startPage.noMessagesToAppend":"     .","startPage.noPairInBackup":"       .      .","startPage.appendSuccess":"  {count}   .","startPage.combineSuccess":" : {added}   ,  {total} .","startPage.combineNoDuplicates":"     .   .","startPage.combineNoChanges":"    .   .","startPage.invalidBackupFormat":"  .    (.ndjson)  .","startPage.browserNotSupported":"    .  Chrome  Edge  .","sessionControls.saveAll.label":" ","sessionControls.saveAll.description":"     ","sessionControls.loadAll.label":" ","sessionControls.loadAll.description":"     ","sessionControls.reset.label":"","sessionControls.reset.description":"     ","sessionControls.saveThis.label":" ","sessionControls.saveThis.description":"    ","sessionControls.combine.label":"","sessionControls.combine.description":"   ","sessionControls.trim.label":"","sessionControls.trim.description":"    ","sessionControls.profile":":","sessionControls.profilePlaceholder":"   ...","sessionControls.editProfile":"  ","sessionControls.allChatsControls":"  ","sessionControls.thisChatsControls":"  ","sessionControls.back":"","sessionControls.backupAndReset":"  ","sessionControls.typeToConfirm":' "{keyword}"   ',"sessionControls.changeAvatar":" ","general.clear":"","general.error":",    .","apiKeyGate.title":" Gemini API  ","apiKeyGate.billingTitle":"   ","apiKeyGate.infoLogin":" :  API ","apiKeyGate.infoVisibility":" :  ","apiKeyGate.infoBilling":": , Google ","apiKeyGate.infoCost":":     ","apiKeyGate.infoMore":" :","apiKeyGate.privacyPolicy":" ","apiKeyGate.stepsTitle":"  :","apiKeyGate.stepOne":"Google AI Studio-  API  .","apiKeyGate.stepTwo":"    (Save)  .","apiKeyGate.openAiStudio":"Google AI Studio- ","apiKeyGate.viewInstructions":" ","apiKeyGate.closeInstructions":" ","apiKeyGate.previousInstruction":" ","apiKeyGate.nextInstruction":" ","apiKeyGate.instructionStep":" {step} / {total}","apiKeyGate.keyLabel":"Gemini API ","apiKeyGate.placeholder":" API   ","apiKeyGate.show":"","apiKeyGate.hide":"","apiKeyGate.currentKeySaved":"   {maskedKey}","apiKeyGate.keyInvalid":"  {maskedKey}     ","apiKeyGate.clearSavedKey":"  ","apiKeyGate.cancel":"","apiKeyGate.saving":"...","apiKeyGate.saveKey":" ","apiKeyGate.close":"","apiKeyGate.costLabel":" API ","apiKeyGate.testerFormTitle":" ","apiKeyGate.testerFormDescription":" Android   , Google Play Store-    !","apiKeyGate.testerFormSubmit":"  ","apiKeyGate.testerFormSubmitting":"...","apiKeyGate.testerFormError":"  .  .","apiKeyGate.testerFormMustBeGmail":"Google Play- @gmail.com  .","apiKeyGate.testerFormCapReached":"  . !","apiKeyGate.developerLogin":" ","apiKeyGate.submitAnotherEmail":"  ?   .","apiKeyGate.testerFormChecking":"   ...","apiKeyGate.testerFormApprovedTitle":" ! ","apiKeyGate.testerFormApprovedDesc":"Android      .","apiKeyGate.testerFormDownloadBtn":"Google Play-  ","apiKeyGate.testerFormPendingTitle":"   !","apiKeyGate.testerFormPendingDesc":"  .     .    !","apiKeyGate.checkStatusModeBtn":" ?  .","apiKeyGate.submitModeBtn":" ?   .","apiKeyGate.checkStatusTitle":"  ","apiKeyGate.checkStatusDesc":"     .","apiKeyGate.checkStatusSubmit":" ","apiKeyGate.testerFormNotFound":"   .   .","chat.thinking":"...","chat.loadingHistory":"  ...","chat.loadingSuggestions":" ...","chat.suggestionsAriaLabel":" ","chat.attachImageFromFile":" ","chat.removeAttachedImage":"  ","chat.sendMessage":" ","chat.messageInputAriaLabel":" ","chat.retrievedFromWeb":" :","chat.videoNotSupported":"    .","chat.audioNotSupported":"    .","chat.fileAttachment":" ","chat.pdf.loading":"PDF ...","chat.pdf.error":"PDF   ","chat.pdf.pageIndicator":" {current} / {total}","chat.imageGenError":"  ","chat.generatingImageLoadingSlow":"   ...","chat.stopSpeaking":" ","chat.speakThisLine":"  ","chat.languageSelector.openGlobe":" ","chat.maestroTranscriptScrollwheel":"   ","chat.mic.listening":"STT : ...","chat.mic.enableStt":"STT  ","chat.mic.disableStt":"STT  ","chat.mic.recordingAudioNote":"  ...","chat.placeholder.normal.listening":"{language}  ...","chat.placeholder.normal.sttActive":"{language}     ...","chat.placeholder.normal.sttInactive":"   {language}    ...","chat.placeholder.suggestion.listening":" {language} ...","chat.placeholder.suggestion.sttActive":" {language}     ...","chat.placeholder.suggestion.sttInactive":" {language}   ...","chat.camera.turnOn":"  ","chat.camera.turnOff":"  ","chat.camera.selectCamera":" ","chat.camera.imageGenCameraLabel":" ","chat.camera.captureOrRecord":" ,   ","chat.camera.stopRecording":" ","chat.bookIcon.toggleImageGen":"   ","chat.imagePreview.alt":"","chat.image.dragToEnlarge":"  ","chat.image.dragToShrink":"  ","chat.annotateImage":"  ","chat.annotateVideoFrame":"   ","chat.annotateModal.editingPreviewAlt":"   ","chat.annotateModal.cancel":"","chat.annotateModal.saveAndAttach":" ","chat.annotateModal.undo":"","chat.suggestion.speak":': "{suggestion}"',"chat.suggestion.ariaLabel":" : {suggestion}","chat.suggestion.toggleCreateMode":"   ","chat.suggestion.createAction":" ","chat.suggestion.creating":" ...","chat.maestro.idle":" ","chat.maestro.title.idle":"  .","chat.maestro.resting":" ...","chat.maestro.observing":" ...","chat.maestro.aboutToEngage":"  ...","chat.maestro.title.resting":" ,     .","chat.maestro.title.observing":" ,     .","chat.maestro.title.aboutToEngage":"   .","chat.maestro.typing":"  ...","chat.maestro.title.typing":"  .","chat.maestro.speaking":" ","chat.maestro.title.speaking":"  .","chat.maestro.listening":"...","chat.maestro.title.listening":"     .","chat.maestro.holding":" ","chat.maestro.title.holding":"  (  )","chat.bookmark.hiddenHeaderAria":"  ","chat.bookmark.isHere":"  ","chat.bookmark.setHere":"  ","chat.bookmark.actionsRegionAria":" ","chat.bookmark.actionsToggleTitle":" ","chat.bookmark.decrementAria":"  ","chat.bookmark.decrementTitle":"","chat.bookmark.incrementAria":"  ","chat.bookmark.incrementTitle":"","chat.bookmark.hiddenBelowHeaderAria":"  ","chat.sendPrep.optimizingVideo":" ...","chat.sendPrep.optimizingImage":" ...","chat.sendPrep.preparingMedia":" ...","chat.sendPrep.uploadingMedia":" ...","chat.sendPrep.finalizing":"...","chat.header.annotating":" ","chat.header.recordingAudio":"  ","chat.header.recordingVideo":"  ","chat.header.savePopup":"...","chat.header.loadPopup":"...","chat.header.maestroAvatar":"  ","chat.header.watchingVideo":" ","chat.header.viewingAbove":"  ","chat.header.liveSession":" ","chat.liveSession.stop":" ","chat.liveSession.retry":"  ","chat.liveSession.start":" ","chat.liveSession.liveBadge":"","chat.liveSession.connecting":"","chat.liveSession.defaultLastMessage":"!      ?","chat.liveSession.defaultSuggestion1":"","chat.liveSession.defaultSuggestion2":" ","chat.liveSession.defaultSuggestion3":"  ?","chat.error.sttError":"STT : {error}.   .","chat.error.autoCaptureCameraError":"   : {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"{maxMinutes}     .","chat.error.videoMetadataError":"   .      .","chat.error.pauseVideoToAnnotate":"     ","chat.error.imageGenInterrupted":"  .","chat.error.thinkingInterrupted":"AI-  .","error.noLanguagePair":" :    .","error.translationFailed":" .  .","error.imageLimitReached":"    .   .","error.tokenLimitReached":"   .   .","error.apiKeyMissing":" Gemini API  . API      .","error.apiKeyInvalid":" Gemini API  .      .","error.apiQuotaExceeded":"   (:  , ,    )","error.quotaSetupBilling":" ","error.quotaStartLive":"    (  )","error.imageGenCostWarning":"    ~$0.04 .     .  Google   .      .","error.imageGenDisable":"  ","error.imageGenViewCost":"    .","error.cameraPermissionDenied":"  .     .","error.cameraNotFound":"  .       .","error.cameraAccessNotSupported":"    .","error.cameraUnknown":"    .","error.cameraStreamNotAvailable":"   .","error.imageCaptureGeneric":"   .","error.visualContextVideoElementNotReady":"     .","error.snapshotVideoElementNotReady":"    .","error.visualContextCameraAccessNotSupported":"    .","error.snapshotCameraAccessNotSupported":"   .","error.visualContext2DContext":"  2D   .","error.snapshot2DContext":" 2D   .","error.visualContextCaptureFailedPermission":"  :   .","error.snapshotCaptureFailedPermission":" :   .","error.visualContextCaptureFailedNotFound":"  :  .","error.snapshotCaptureFailedNotFound":" :  .","error.visualContextCaptureFailedNotReady":"  :      . {details}","error.snapshotCaptureFailedNotReady":" :      . {details}","error.visualContextCaptureFailedGeneric":"  : {details}","error.snapshotCaptureFailedGeneric":" : {details}"},vI={"app.title":"Maestro","sttLang.selectLanguage":"  {language}  ","header.targetLanguageTitle":"  : {language}","startPage.clickToStart":"  ","startPage.saveChats":"   ","startPage.loadChats":"  ","startPage.saveThisChat":"   ","startPage.appendToChat":" ","startPage.trimBeforeBookmark":"   ","startPage.maestroAvatar":" ","startPage.addMaestroAvatar":"  ","startPage.loadSuccess":"{count}        !","startPage.loadError":"   .       .","startPage.noChatsToSave":"    .","startPage.saveError":"   .     .","startPage.noChatSelected":"    .","startPage.noBookmarkSet":"  .      .","startPage.noMessagesToTrim":"      .","startPage.trimSuccess":"    {count}   .","startPage.trimError":"  .   .","startPage.noMessagesToAppend":"     .","startPage.noPairInBackup":"         .    .","startPage.appendSuccess":"  {count}   .","startPage.combineSuccess":" : {added}   ,  {total} .","startPage.combineNoDuplicates":"     .   .","startPage.combineNoChanges":"    .   .","startPage.invalidBackupFormat":"  .   Maestro  (.ndjson)  .","startPage.browserNotSupported":"     .  Chrome  Edge .","sessionControls.saveAll.label":"  ","sessionControls.saveAll.description":"     ","sessionControls.loadAll.label":"  ","sessionControls.loadAll.description":"     ","sessionControls.reset.label":" (Reset)","sessionControls.reset.description":"    ","sessionControls.saveThis.label":"  ","sessionControls.saveThis.description":"    ","sessionControls.combine.label":"","sessionControls.combine.description":"    ","sessionControls.trim.label":" (Trim)","sessionControls.trim.description":"    ","sessionControls.profile":":","sessionControls.profilePlaceholder":"   ...","sessionControls.editProfile":"  ","sessionControls.allChatsControls":"  ","sessionControls.thisChatsControls":"  ","sessionControls.back":"","sessionControls.backupAndReset":"  ","sessionControls.typeToConfirm":' "{keyword}"   ',"sessionControls.changeAvatar":" ","general.clear":" ","general.error":",   .","apiKeyGate.title":" Gemini API   ","apiKeyGate.billingTitle":"     ","apiKeyGate.infoLogin":" :  API ","apiKeyGate.infoVisibility":" :  ","apiKeyGate.infoBilling":": , Google ","apiKeyGate.infoCost":":     ","apiKeyGate.infoMore":" :","apiKeyGate.privacyPolicy":" ","apiKeyGate.stepsTitle":"  :","apiKeyGate.stepOne":"Google AI Studio  API  .","apiKeyGate.stepTwo":"  ,  (Save) .","apiKeyGate.openAiStudio":"Google AI Studio ","apiKeyGate.viewInstructions":" ","apiKeyGate.closeInstructions":" ","apiKeyGate.previousInstruction":" ","apiKeyGate.nextInstruction":" ","apiKeyGate.instructionStep":" {total} {step}","apiKeyGate.keyLabel":"Gemini API ","apiKeyGate.placeholder":" API   ","apiKeyGate.show":"","apiKeyGate.hide":"","apiKeyGate.currentKeySaved":"    {maskedKey}","apiKeyGate.keyInvalid":"  {maskedKey}      ","apiKeyGate.clearSavedKey":"    ","apiKeyGate.cancel":" ","apiKeyGate.saving":" ...","apiKeyGate.saveKey":"  ","apiKeyGate.close":"","apiKeyGate.costLabel":" API ","apiKeyGate.testerFormTitle":"  ","apiKeyGate.testerFormDescription":" Android     Google Play Store     !","apiKeyGate.testerFormSubmit":"  ","apiKeyGate.testerFormSubmitting":"...","apiKeyGate.testerFormError":"  .   .","apiKeyGate.testerFormMustBeGmail":"Google Play   @gmail.com  .","apiKeyGate.testerFormCapReached":"  . !","apiKeyGate.developerLogin":" ","apiKeyGate.submitAnotherEmail":"  ?    .","apiKeyGate.testerFormChecking":"    ...","apiKeyGate.testerFormApprovedTitle":" ! ","apiKeyGate.testerFormApprovedDesc":"Android       .","apiKeyGate.testerFormDownloadBtn":"Google Play   ","apiKeyGate.testerFormPendingTitle":"  !","apiKeyGate.testerFormPendingDesc":"   .      .    !","apiKeyGate.checkStatusModeBtn":"  ?    .","apiKeyGate.submitModeBtn":" ?    .","apiKeyGate.checkStatusTitle":"   ","apiKeyGate.checkStatusDesc":"      .","apiKeyGate.checkStatusSubmit":"  ","apiKeyGate.testerFormNotFound":"  .     .","chat.thinking":"...","chat.loadingHistory":"   ...","chat.loadingSuggestions":"  ...","chat.suggestionsAriaLabel":" ","chat.attachImageFromFile":" ","chat.removeAttachedImage":"  ","chat.sendMessage":" ","chat.messageInputAriaLabel":" ","chat.retrievedFromWeb":"  :","chat.videoNotSupported":"     .","chat.audioNotSupported":"     .","chat.fileAttachment":" ","chat.pdf.loading":"PDF  ...","chat.pdf.error":"PDF   ","chat.pdf.pageIndicator":" {current} / {total}","chat.imageGenError":"  ","chat.generatingImageLoadingSlow":"   ...","chat.stopSpeaking":" ","chat.speakThisLine":"  ","chat.languageSelector.openGlobe":" ","chat.maestroTranscriptScrollwheel":"   ","chat.mic.listening":"STT : ...","chat.mic.enableStt":"STT  ","chat.mic.disableStt":"STT ","chat.mic.recordingAudioNote":"  ...","chat.placeholder.normal.listening":"{language} ...","chat.placeholder.normal.sttActive":"{language}    ...","chat.placeholder.normal.sttInactive":"   {language}   ...","chat.placeholder.suggestion.listening":" {language} ...","chat.placeholder.suggestion.sttActive":" {language}    ...","chat.placeholder.suggestion.sttInactive":" {language}  ...","chat.camera.turnOn":"   ","chat.camera.turnOff":"   ","chat.camera.selectCamera":" ","chat.camera.imageGenCameraLabel":" ","chat.camera.captureOrRecord":"  ,    ","chat.camera.stopRecording":" ","chat.bookIcon.toggleImageGen":"   ","chat.imagePreview.alt":"","chat.image.dragToEnlarge":"   ","chat.image.dragToShrink":"   ","chat.annotateImage":" ","chat.annotateVideoFrame":"  ","chat.annotateModal.editingPreviewAlt":" ","chat.annotateModal.cancel":" ","chat.annotateModal.saveAndAttach":"   ","chat.annotateModal.undo":"","chat.suggestion.speak":': "{suggestion}"',"chat.suggestion.ariaLabel":" : {suggestion}","chat.suggestion.toggleCreateMode":"   ","chat.suggestion.createAction":" ","chat.suggestion.creating":" ...","chat.maestro.idle":"  ","chat.maestro.title.idle":"   .","chat.maestro.resting":"  ...","chat.maestro.observing":" ...","chat.maestro.aboutToEngage":"  ...","chat.maestro.title.resting":"  ,      .","chat.maestro.title.observing":" ,      .","chat.maestro.title.aboutToEngage":"    .","chat.maestro.typing":"  ...","chat.maestro.title.typing":"   .","chat.maestro.speaking":" ","chat.maestro.title.speaking":"  .","chat.maestro.listening":"...","chat.maestro.title.listening":"       .","chat.maestro.holding":"  ","chat.maestro.title.holding":"   (    )","chat.bookmark.hiddenHeaderAria":"  ","chat.bookmark.isHere":"  ","chat.bookmark.setHere":"   ","chat.bookmark.actionsRegionAria":" ","chat.bookmark.actionsToggleTitle":" ","chat.bookmark.decrementAria":"  ","chat.bookmark.decrementTitle":"","chat.bookmark.incrementAria":"  ","chat.bookmark.incrementTitle":"","chat.bookmark.hiddenBelowHeaderAria":"  ","chat.sendPrep.optimizingVideo":"  ...","chat.sendPrep.optimizingImage":"  ...","chat.sendPrep.preparingMedia":"  ...","chat.sendPrep.uploadingMedia":"  ...","chat.sendPrep.finalizing":" ...","chat.header.annotating":"","chat.header.recordingAudio":"  ","chat.header.recordingVideo":"  ","chat.header.savePopup":" ...","chat.header.loadPopup":" ...","chat.header.maestroAvatar":"   ","chat.header.watchingVideo":" ","chat.header.viewingAbove":"  ","chat.header.liveSession":" ","chat.liveSession.stop":" ","chat.liveSession.retry":"  ","chat.liveSession.start":" ","chat.liveSession.liveBadge":"","chat.liveSession.connecting":" ","chat.liveSession.defaultLastMessage":"!     ?","chat.liveSession.defaultSuggestion1":"","chat.liveSession.defaultSuggestion2":"","chat.liveSession.defaultSuggestion3":"  ?","chat.error.sttError":"STT : {error}.   .","chat.error.autoCaptureCameraError":"   : {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"{maxMinutes}     .","chat.error.videoMetadataError":"  .        .","chat.error.pauseVideoToAnnotate":"     ","chat.error.imageGenInterrupted":"   .","chat.error.thinkingInterrupted":"AI   .","error.noLanguagePair":" :    .","error.translationFailed":" .   .","error.imageLimitReached":"   .    .","error.tokenLimitReached":"   .    .","error.apiKeyMissing":" Gemini API  . API      .","error.apiKeyInvalid":" Gemini API  .     ,    .","error.apiQuotaExceeded":"   (:  , ,    )","error.quotaSetupBilling":"  ","error.quotaStartLive":"    (  )","error.imageGenCostWarning":"     $0.04 .      .  Google   .  API     .","error.imageGenDisable":"  ","error.imageGenViewCost":"API     .","error.cameraPermissionDenied":"  .      .","error.cameraNotFound":"  .        .","error.cameraAccessNotSupported":"      .","error.cameraUnknown":"     .","error.cameraStreamNotAvailable":"     .","error.imageCaptureGeneric":"    .","error.visualContextVideoElementNotReady":"     .","error.snapshotVideoElementNotReady":"    .","error.visualContextCameraAccessNotSupported":"      .","error.snapshotCameraAccessNotSupported":"     .","error.visualContext2DContext":"   2D  .","error.snapshot2DContext":"  2D  .","error.visualContextCaptureFailedPermission":"  :   .","error.snapshotCaptureFailedPermission":" :   .","error.visualContextCaptureFailedNotFound":"  :  .","error.snapshotCaptureFailedNotFound":" :  .","error.visualContextCaptureFailedNotReady":"  :      . {details}","error.snapshotCaptureFailedNotReady":" :      . {details}","error.visualContextCaptureFailedGeneric":"  : {details}","error.snapshotCaptureFailedGeneric":" : {details}"},yI={"app.title":"Maestro","sttLang.selectLanguage":" {language}","header.targetLanguageTitle":": {language}","startPage.clickToStart":"","startPage.saveChats":"","startPage.loadChats":"","startPage.saveThisChat":"","startPage.appendToChat":"","startPage.trimBeforeBookmark":"","startPage.maestroAvatar":" Maestro","startPage.addMaestroAvatar":" Maestro","startPage.loadSuccess":" {count} !","startPage.loadError":" ","startPage.noChatsToSave":"","startPage.saveError":" ","startPage.noChatSelected":"","startPage.noBookmarkSet":" ","startPage.noMessagesToTrim":"","startPage.trimSuccess":" {count} ","startPage.trimError":" ","startPage.noMessagesToAppend":"","startPage.noPairInBackup":" ","startPage.appendSuccess":" {count} ","startPage.combineSuccess":":  {added} ,  {total} ","startPage.combineNoDuplicates":" ","startPage.combineNoChanges":" ","startPage.invalidBackupFormat":"  Maestro (.ndjson) ","startPage.browserNotSupported":"  Chrome  Edge","sessionControls.saveAll.label":"","sessionControls.saveAll.description":"","sessionControls.loadAll.label":"","sessionControls.loadAll.description":"","sessionControls.reset.label":"","sessionControls.reset.description":"","sessionControls.saveThis.label":"","sessionControls.saveThis.description":"","sessionControls.combine.label":"","sessionControls.combine.description":"","sessionControls.trim.label":"","sessionControls.trim.description":"","sessionControls.profile":":","sessionControls.profilePlaceholder":"...","sessionControls.editProfile":"","sessionControls.allChatsControls":"","sessionControls.thisChatsControls":"","sessionControls.back":"","sessionControls.backupAndReset":"","sessionControls.typeToConfirm":' "{keyword}" ',"sessionControls.changeAvatar":"","general.clear":"","general.error":" ","apiKeyGate.title":" API Gemini ","apiKeyGate.billingTitle":"","apiKeyGate.infoLogin":":  API","apiKeyGate.infoVisibility":": ","apiKeyGate.infoBilling":":   Google","apiKeyGate.infoCost":":   ","apiKeyGate.infoMore":":","apiKeyGate.privacyPolicy":"","apiKeyGate.stepsTitle":":","apiKeyGate.stepOne":" Google AI Studio  API","apiKeyGate.stepTwo":"","apiKeyGate.openAiStudio":" Google AI Studio","apiKeyGate.viewInstructions":"","apiKeyGate.closeInstructions":"","apiKeyGate.previousInstruction":"","apiKeyGate.nextInstruction":"","apiKeyGate.instructionStep":" {step}  {total}","apiKeyGate.keyLabel":" API Gemini","apiKeyGate.placeholder":" API ","apiKeyGate.show":"","apiKeyGate.hide":"","apiKeyGate.currentKeySaved":" {maskedKey}","apiKeyGate.keyInvalid":" {maskedKey}  ","apiKeyGate.clearSavedKey":"","apiKeyGate.cancel":"","apiKeyGate.saving":"...","apiKeyGate.saveKey":"","apiKeyGate.close":"","apiKeyGate.costLabel":" API ","apiKeyGate.testerFormTitle":"","apiKeyGate.testerFormDescription":" Google Play Store  Android !","apiKeyGate.testerFormSubmit":"","apiKeyGate.testerFormSubmitting":"...","apiKeyGate.testerFormError":" ","apiKeyGate.testerFormMustBeGmail":" @gmail.com  Google Play","apiKeyGate.testerFormCapReached":" !","apiKeyGate.developerLogin":"","apiKeyGate.submitAnotherEmail":"? ","apiKeyGate.testerFormChecking":"...","apiKeyGate.testerFormApprovedTitle":"! ","apiKeyGate.testerFormApprovedDesc":" Android ","apiKeyGate.testerFormDownloadBtn":" Google Play","apiKeyGate.testerFormPendingTitle":"!","apiKeyGate.testerFormPendingDesc":"  !","apiKeyGate.checkStatusModeBtn":"? ","apiKeyGate.submitModeBtn":"? ","apiKeyGate.checkStatusTitle":"","apiKeyGate.checkStatusDesc":"","apiKeyGate.checkStatusSubmit":"","apiKeyGate.testerFormNotFound":" ","chat.thinking":"...","chat.loadingHistory":"...","chat.loadingSuggestions":"...","chat.suggestionsAriaLabel":"","chat.attachImageFromFile":"","chat.removeAttachedImage":"","chat.sendMessage":"","chat.messageInputAriaLabel":"","chat.retrievedFromWeb":":","chat.videoNotSupported":"","chat.audioNotSupported":"","chat.fileAttachment":"","chat.pdf.loading":" PDF...","chat.pdf.error":" PDF ","chat.pdf.pageIndicator":" {current}  {total}","chat.imageGenError":"","chat.generatingImageLoadingSlow":"...","chat.stopSpeaking":"","chat.speakThisLine":"","chat.languageSelector.openGlobe":"","chat.maestroTranscriptScrollwheel":" Maestro","chat.mic.listening":"STT : ...","chat.mic.enableStt":" STT","chat.mic.disableStt":" STT","chat.mic.recordingAudioNote":"...","chat.placeholder.normal.listening":" {language}...","chat.placeholder.normal.sttActive":" {language} ...","chat.placeholder.normal.sttInactive":" {language}...","chat.placeholder.suggestion.listening":" {language} ...","chat.placeholder.suggestion.sttActive":" {language} ...","chat.placeholder.suggestion.sttInactive":" {language} ...","chat.camera.turnOn":"","chat.camera.turnOff":"","chat.camera.selectCamera":"","chat.camera.imageGenCameraLabel":"","chat.camera.captureOrRecord":" ","chat.camera.stopRecording":"","chat.bookIcon.toggleImageGen":"","chat.imagePreview.alt":"","chat.image.dragToEnlarge":"","chat.image.dragToShrink":"","chat.annotateImage":"","chat.annotateVideoFrame":"","chat.annotateModal.editingPreviewAlt":"","chat.annotateModal.cancel":"","chat.annotateModal.saveAndAttach":"","chat.annotateModal.undo":"","chat.suggestion.speak":': "{suggestion}"',"chat.suggestion.ariaLabel":": {suggestion}","chat.suggestion.toggleCreateMode":"","chat.suggestion.createAction":"","chat.suggestion.creating":"...","chat.maestro.idle":"Maestro ","chat.maestro.title.idle":"Maestro ","chat.maestro.resting":"Maestro ...","chat.maestro.observing":"Maestro ...","chat.maestro.aboutToEngage":"Maestro ...","chat.maestro.title.resting":"Maestro  ","chat.maestro.title.observing":"Maestro  ","chat.maestro.title.aboutToEngage":"Maestro  ","chat.maestro.typing":"Maestro ...","chat.maestro.title.typing":"Maestro ","chat.maestro.speaking":"Maestro ","chat.maestro.title.speaking":"Maestro ","chat.maestro.listening":"...","chat.maestro.title.listening":"Maestro ","chat.maestro.holding":"Maestro ","chat.maestro.title.holding":"Maestro  ()","chat.bookmark.hiddenHeaderAria":"","chat.bookmark.isHere":"","chat.bookmark.setHere":"","chat.bookmark.actionsRegionAria":"","chat.bookmark.actionsToggleTitle":"","chat.bookmark.decrementAria":"","chat.bookmark.decrementTitle":"","chat.bookmark.incrementAria":"","chat.bookmark.incrementTitle":"","chat.bookmark.hiddenBelowHeaderAria":"","chat.sendPrep.optimizingVideo":"...","chat.sendPrep.optimizingImage":"...","chat.sendPrep.preparingMedia":"...","chat.sendPrep.uploadingMedia":"...","chat.sendPrep.finalizing":"...","chat.header.annotating":"","chat.header.recordingAudio":"","chat.header.recordingVideo":"","chat.header.savePopup":"...","chat.header.loadPopup":"...","chat.header.maestroAvatar":" Maestro","chat.header.watchingVideo":"","chat.header.viewingAbove":"","chat.header.liveSession":"","chat.liveSession.stop":"","chat.liveSession.retry":"","chat.liveSession.start":"","chat.liveSession.liveBadge":"","chat.liveSession.connecting":"","chat.liveSession.defaultLastMessage":"! ?","chat.liveSession.defaultSuggestion1":"","chat.liveSession.defaultSuggestion2":"","chat.liveSession.defaultSuggestion3":"?","chat.error.sttError":" STT: {error} ","chat.error.autoCaptureCameraError":": {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":" {maxMinutes} ","chat.error.videoMetadataError":" ","chat.error.pauseVideoToAnnotate":"","chat.error.imageGenInterrupted":"","chat.error.thinkingInterrupted":" AI ","error.noLanguagePair":": ","error.translationFailed":" ","error.imageLimitReached":" ","error.tokenLimitReached":" ","error.apiKeyMissing":" API Gemini   API ","error.apiKeyInvalid":" API Gemini  ","error.apiQuotaExceeded":" (: , , PDF )","error.quotaSetupBilling":"","error.quotaStartLive":" Live  ()","error.imageGenCostWarning":" $0.04    Google  API.","error.imageGenDisable":"","error.imageGenViewCost":" API.","error.cameraPermissionDenied":" ","error.cameraNotFound":"  ","error.cameraAccessNotSupported":"","error.cameraUnknown":"","error.cameraStreamNotAvailable":"","error.imageCaptureGeneric":"","error.visualContextVideoElementNotReady":"","error.snapshotVideoElementNotReady":"","error.visualContextCameraAccessNotSupported":"","error.snapshotCameraAccessNotSupported":"","error.visualContext2DContext":" 2D ","error.snapshot2DContext":" 2D ","error.visualContextCaptureFailedPermission":": ","error.snapshotCaptureFailedPermission":": ","error.visualContextCaptureFailedNotFound":": ","error.snapshotCaptureFailedNotFound":": ","error.visualContextCaptureFailedNotReady":":  {details}","error.snapshotCaptureFailedNotReady":":  {details}","error.visualContextCaptureFailedGeneric":": {details}","error.snapshotCaptureFailedGeneric":": {details}"},bI={"app.title":"Maestro","sttLang.selectLanguage":"Konuma tanmay {language} olarak ayarla","header.targetLanguageTitle":"Mevcut Hedef Dil: {language}","startPage.clickToStart":"Uaa tklayn","startPage.saveChats":"Tm Sohbetleri Kaydet","startPage.loadChats":"Sohbetleri Ykle","startPage.saveThisChat":"Bu Sohbeti Kaydet","startPage.appendToChat":"Sohbete Ekle","startPage.trimBeforeBookmark":"Yer minden ncekileri Krp","startPage.maestroAvatar":"Maestro avatar","startPage.addMaestroAvatar":"Maestro avatar ekle","startPage.loadSuccess":"{count} sohbet oturumu baaryla yklendi ve deitirildi!","startPage.loadError":"Sohbetler yklenirken hata olutu. Dosya bozuk veya yanl formatta olabilir.","startPage.noChatsToSave":"Kaydedilecek sohbet gemii yok.","startPage.saveError":"Sohbetler kaydedilirken hata olutu. Ayrntlar iin konsola bakn.","startPage.noChatSelected":"Ltfen nce bir dil ifti sein.","startPage.noBookmarkSet":"Yer imi ayarlanmad. nceki mesajlar silmek iin nce bir yer imi belirleyin.","startPage.noMessagesToTrim":"Yer iminden nce silinecek mesaj yok.","startPage.trimSuccess":"Yer iminden nceki {count} mesaj kaldrld.","startPage.trimError":"Mesajlar krplamad. Ltfen tekrar deneyin.","startPage.noMessagesToAppend":"Yedek dosyasnda birletirilecek mesaj bulunamad.","startPage.noPairInBackup":"Yedek dosyas mevcut dil iftiniz iin mesaj iermiyor. Ltfen mevcut sohbetinizle eleen bir yedek sein.","startPage.appendSuccess":"{count} mesaj mevcut sohbete baaryla eklendi.","startPage.combineSuccess":"Sohbetler birletirildi: {added} yeni mesaj eklendi, toplam {total} mesaj.","startPage.combineNoDuplicates":"Tm mesajlar zaten sohbetinizde mevcuttu. Deiiklik yaplmad.","startPage.combineNoChanges":"Eklenecek yeni mesaj yok. Sohbetiniz deimedi.","startPage.invalidBackupFormat":"Geersiz yedek dosyas. Ltfen geerli bir Maestro yedekleme (.ndjson) dosyas sein.","startPage.browserNotSupported":"Taraycnz dosya kaydetmeyi desteklemiyor. Ltfen Chrome veya Edge kullann.","sessionControls.saveAll.label":"Tmn Kaydet","sessionControls.saveAll.description":"Tm sohbetleri yedek dosyasna aktar","sessionControls.loadAll.label":"Tmn Ykle","sessionControls.loadAll.description":"Tm sohbetleri yedek dosyasyla deitir","sessionControls.reset.label":"Sfrla","sessionControls.reset.description":"Yedekle ve tm verileri sil","sessionControls.saveThis.label":"Sohbeti Kaydet","sessionControls.saveThis.description":"Sadece bu sohbeti aktar","sessionControls.combine.label":"Birletir","sessionControls.combine.description":"Yedei bu sohbete dahil et","sessionControls.trim.label":"Krp","sessionControls.trim.description":"Yer iminden nceki mesajlar kaldr","sessionControls.profile":"Profil:","sessionControls.profilePlaceholder":"Adnz veya detaylarnz...","sessionControls.editProfile":"Kullanc Profilini Dzenle","sessionControls.allChatsControls":"Tm Sohbet Kontrolleri","sessionControls.thisChatsControls":"Bu Sohbetin Kontrolleri","sessionControls.back":"Geri","sessionControls.backupAndReset":"Yedekle ve Sfrla","sessionControls.typeToConfirm":'Onaylamak iin "{keyword}" yazn',"sessionControls.changeAvatar":"Avatar Deitir","general.clear":"Temizle","general.error":"zgnm, bir hata olutu.","apiKeyGate.title":"Gemini API anahtarnz balayn","apiKeyGate.billingTitle":"Daha yksek kota iin faturalandrmay ayarlayn","apiKeyGate.infoLogin":"Giri bilgileriniz: Bir API anahtar","apiKeyGate.infoVisibility":"Kim grr: Sadece siz","apiKeyGate.infoBilling":"Faturalandrma: Aylk, Google'dan","apiKeyGate.infoCost":"Maliyet: Uygulamada gsterilir  grmek iin dokunun","apiKeyGate.infoMore":"Daha fazla bilgi:","apiKeyGate.privacyPolicy":"Gizlilik Politikas","apiKeyGate.stepsTitle":"ki hzl adm:","apiKeyGate.stepOne":"Google AI Studio'yu an ve bir API anahtar oluturun.","apiKeyGate.stepTwo":"Aaya anahtarnz yaptrn ve Kaydet'e dokunun.","apiKeyGate.openAiStudio":"Google AI Studio'yu a","apiKeyGate.viewInstructions":"Talimatlar grntle","apiKeyGate.closeInstructions":"Talimatlar kapat","apiKeyGate.previousInstruction":"nceki talimat","apiKeyGate.nextInstruction":"Sonraki talimat","apiKeyGate.instructionStep":"Talimat {step} / {total}","apiKeyGate.keyLabel":"Gemini API anahtar","apiKeyGate.placeholder":"API anahtarnz buraya yaptrn","apiKeyGate.show":"Gster","apiKeyGate.hide":"Gizle","apiKeyGate.currentKeySaved":"Geerli anahtar kaydedildi {maskedKey}","apiKeyGate.keyInvalid":"Anahtar geersiz {maskedKey}  aaya yeni bir anahtar yaptrn","apiKeyGate.clearSavedKey":"Kaydedilmi anahtar temizle","apiKeyGate.cancel":"ptal","apiKeyGate.saving":"Kaydediliyor...","apiKeyGate.saveKey":"Anahtar kaydet","apiKeyGate.close":"Kapat","apiKeyGate.costLabel":"Tahmini API maliyeti","apiKeyGate.testerFormTitle":"Uygulamay Test Et","apiKeyGate.testerFormDescription":"Android betamza davetiye almak iin Google Play Store'da kullandnz e-postay girin!","apiKeyGate.testerFormSubmit":"Erken Eriim Al","apiKeyGate.testerFormSubmitting":"Gnderiliyor...","apiKeyGate.testerFormError":"Bir eyler ters gitti. Ltfen tekrar deneyin.","apiKeyGate.testerFormMustBeGmail":"Google Play iin ltfen @gmail.com adresi kullann.","apiKeyGate.testerFormCapReached":"Bavuru snrna ulald. Teekkrler!","apiKeyGate.developerLogin":"gelitirici girii","apiKeyGate.submitAnotherEmail":"Yanl e-posta m? Sfrla ve tekrar dene.","apiKeyGate.testerFormChecking":"Davet durumunuz kontrol ediliyor...","apiKeyGate.testerFormApprovedTitle":"Katldnz! ","apiKeyGate.testerFormApprovedDesc":"E-postanz Android beta test program iin onayland.","apiKeyGate.testerFormDownloadBtn":"Uygulamay Google Play'den ndir","apiKeyGate.testerFormPendingTitle":"Bekleme Listesindesiniz!","apiKeyGate.testerFormPendingDesc":"E-postanz aldk. Daveti manuel olarak ilemek biraz zaman alr. Ltfen daha sonra tekrar kontrol edin!","apiKeyGate.checkStatusModeBtn":"Zaten bavurdunuz mu? Durumunuzu kontrol edin.","apiKeyGate.submitModeBtn":"Bavurmanz m gerekiyor? Buradan kaydolun.","apiKeyGate.checkStatusTitle":"Davet Durumunu Kontrol Et","apiKeyGate.checkStatusDesc":"Bekleme listesi iin kullandnz e-postay girin.","apiKeyGate.checkStatusSubmit":"Durumu Kontrol Et","apiKeyGate.testerFormNotFound":"E-posta bekleme listesinde bulunamad. Ltfen nce kaydolun.","chat.thinking":"Dnyor...","chat.loadingHistory":"Sohbet gemii ykleniyor...","chat.loadingSuggestions":"neriler ykleniyor...","chat.suggestionsAriaLabel":"Yant nerileri","chat.attachImageFromFile":"Dosya ekle","chat.removeAttachedImage":"Ekli dosyay kaldr","chat.sendMessage":"Mesaj gnder","chat.messageInputAriaLabel":"Mesaj girii","chat.retrievedFromWeb":"Web'den alnd:","chat.videoNotSupported":"Taraycnz video etiketini desteklemiyor.","chat.audioNotSupported":"Taraycnz ses etiketini desteklemiyor.","chat.fileAttachment":"Dosya Eki","chat.pdf.loading":"PDF ykleniyor...","chat.pdf.error":"PDF grntlenemiyor","chat.pdf.pageIndicator":"Sayfa {current} / {total}","chat.imageGenError":"Grsel Oluturma Hatas","chat.generatingImageLoadingSlow":"Biraz daha uzun sryor...","chat.stopSpeaking":"Konumay durdur","chat.speakThisLine":"Bu satr seslendir","chat.languageSelector.openGlobe":"Dilleri deitir","chat.maestroTranscriptScrollwheel":"Maestro transkript kaydrma grnm","chat.mic.listening":"STT Aktif: Dinleniyor...","chat.mic.enableStt":"STT'yi Etkinletir","chat.mic.disableStt":"STT'yi Durdur","chat.mic.recordingAudioNote":"Ses kaydediliyor...","chat.placeholder.normal.listening":"{language} dilinde dinleniyor...","chat.placeholder.normal.sttActive":"{language} dilinde konuun veya yazn...","chat.placeholder.normal.sttInactive":"Yazn veya {language} dilinde konumak iin mikrofona dokunun...","chat.placeholder.suggestion.listening":"eviri iin {language} konuun...","chat.placeholder.suggestion.sttActive":"eviri iin {language} dilinde konuun veya yazn...","chat.placeholder.suggestion.sttInactive":"eviri iin {language} dilinde yazn...","chat.camera.turnOn":"Kamera nizlemesini etkinletir","chat.camera.turnOff":"Kamera nizlemesini kapat","chat.camera.selectCamera":"Kamera se","chat.camera.imageGenCameraLabel":"Grsel Oluturma","chat.camera.captureOrRecord":"Fotoraf iin dokunun, video iin basl tutun","chat.camera.stopRecording":"Kayd Durdur","chat.bookIcon.toggleImageGen":"Grsel Oluturma Modunu A/Kapat","chat.imagePreview.alt":"nizleme","chat.image.dragToEnlarge":"Bytmek iin keyi srkleyin","chat.image.dragToShrink":"Kltmek iin keyi srkleyin","chat.annotateImage":"Grsele Not Ekle","chat.annotateVideoFrame":"Mevcut kareye not ekle","chat.annotateModal.editingPreviewAlt":"Not eklenecek grsel","chat.annotateModal.cancel":"ptal","chat.annotateModal.saveAndAttach":"Kaydet ve Ekle","chat.annotateModal.undo":"Geri Al","chat.suggestion.speak":'Syle: "{suggestion}"',"chat.suggestion.ariaLabel":"neriyi seslendir: {suggestion}","chat.suggestion.toggleCreateMode":"neri oluturma modunu a/kapat","chat.suggestion.createAction":"neri Olutur","chat.suggestion.creating":"neri oluturuluyor...","chat.maestro.idle":"Maestro bota","chat.maestro.title.idle":"Maestro u anda bota.","chat.maestro.resting":"Maestro dinleniyor...","chat.maestro.observing":"Maestro gzlemliyor...","chat.maestro.aboutToEngage":"Maestro katlmak zere...","chat.maestro.title.resting":"Maestro bota, yeniden etkileime gemek iin bolca vakit var.","chat.maestro.title.observing":"Maestro gzlemliyor, etkileime gemek iin biraz vakit var.","chat.maestro.title.aboutToEngage":"Maestro yaknda yeniden etkileime geecek.","chat.maestro.typing":"Maestro yazyor...","chat.maestro.title.typing":"Maestro bir yant hazrlyor.","chat.maestro.speaking":"Maestro konuuyor","chat.maestro.title.speaking":"Maestro u anda konuuyor.","chat.maestro.listening":"Dinleniyor...","chat.maestro.title.listening":"Maestro giriinizi veya konumanz bekliyor.","chat.maestro.holding":"Maestro bekletiyor","chat.maestro.title.holding":"Maestro bekletiyor (yeniden etkileim duraklatld)","chat.bookmark.hiddenHeaderAria":"Yukardaki mesajlar gizli","chat.bookmark.isHere":"Yer imi burada","chat.bookmark.setHere":"Yer imini buraya ayarla","chat.bookmark.actionsRegionAria":"Yer imi eylemleri","chat.bookmark.actionsToggleTitle":"Yer imi seenekleri","chat.bookmark.decrementAria":"Bir eksik gster","chat.bookmark.decrementTitle":"Daha az","chat.bookmark.incrementAria":"Bir fazla gster","chat.bookmark.incrementTitle":"Daha fazla","chat.bookmark.hiddenBelowHeaderAria":"Aadaki mesajlar gizli","chat.sendPrep.optimizingVideo":"Video optimize ediliyor...","chat.sendPrep.optimizingImage":"Grsel optimize ediliyor...","chat.sendPrep.preparingMedia":"Medya hazrlanyor...","chat.sendPrep.uploadingMedia":"Medya ykleniyor...","chat.sendPrep.finalizing":"Tamamlanyor...","chat.header.annotating":"Not ekleniyor","chat.header.recordingAudio":"Ses kaydediliyor","chat.header.recordingVideo":"Video kaydediliyor","chat.header.savePopup":"Kaydediliyor...","chat.header.loadPopup":"Ykleniyor...","chat.header.maestroAvatar":"Maestro avatar gncelleniyor","chat.header.watchingVideo":"Video izleniyor","chat.header.viewingAbove":"nceki mesajlar grntleniyor","chat.header.liveSession":"Canl oturum","chat.liveSession.stop":"Canly Durdur","chat.liveSession.retry":"Canly Tekrar Dene","chat.liveSession.start":"Canly Balat","chat.liveSession.liveBadge":"Canl","chat.liveSession.connecting":"Balanyor","chat.liveSession.defaultLastMessage":"Merhaba! Bugn size nasl yardmc olabilirim?","chat.liveSession.defaultSuggestion1":"Merhaba","chat.liveSession.defaultSuggestion2":"Gnaydn","chat.liveSession.defaultSuggestion3":"Naslsn?","chat.error.sttError":"STT Hatas: {error}. Mikrofonu kapatp amay deneyin.","chat.error.autoCaptureCameraError":"Otomatik Yakalama Kamera Hatas: {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"Kayt {maxMinutes} dakika sonra otomatik olarak durduruldu.","chat.error.videoMetadataError":"Video meta verileri okunamad. Dosya bozuk veya desteklenmeyen bir formatta olabilir.","chat.error.pauseVideoToAnnotate":"Mevcut kareye not eklemek iin videoyu duraklatn","chat.error.imageGenInterrupted":"Grsel oluturma kesintiye urad.","chat.error.thinkingInterrupted":"Yapay zekann yant kesintiye urad.","error.noLanguagePair":"Kritik hata: Dil ifti seilmedi.","error.translationFailed":"eviri baarsz oldu. Ltfen tekrar deneyin.","error.imageLimitReached":"Oturum grsel oluturma snrna ulald. Ltfen yeni bir oturum balatn.","error.tokenLimitReached":"Oturum belirte (token) snrna ulald. Ltfen yeni bir oturum balatn.","error.apiKeyMissing":"Gemini API anahtarnz eksik. API Anahtar ekrann an ve anahtarnz yaptrn.","error.apiKeyInvalid":"Gemini API anahtarnz geersiz. Ltfen yazm hatalarn kontrol edin ve geerli bir anahtar yaptrn.","error.apiQuotaExceeded":"Kotanz tkendi (cretli: daha akll sohbet, video, pdf ve grnt oluturma)","error.quotaSetupBilling":"Faturalandrmay ayarla","error.quotaStartLive":"cretsiz Live srmn balat (grnt oluturma yok)","error.imageGenCostWarning":"Grnt oluturmann maliyeti grnt bana yaklak 0,04 ABD dolardr. Sohbet mesajlarnn da kk bir maliyeti vardr. Tm Google tarafndan faturalandrlr. API anahtar ekranndan maliyetleri takip edebilirsiniz.","error.imageGenDisable":"Grnt Oluturmay Devre D Brak","error.imageGenViewCost":"API anahtar ekrannda maliyetleri takip edin.","error.cameraPermissionDenied":"Kamera izni reddedildi. Ltfen tarayc ayarlarndan kamera eriimine izin verin.","error.cameraNotFound":"Seilen kamera bulunamad. Bal olduundan emin olun veya ayarlardan farkl bir kamera sein.","error.cameraAccessNotSupported":"Kamera eriimi taraycnz tarafndan desteklenmiyor.","error.cameraUnknown":"Kameraya eriirken bilinmeyen bir hata olutu.","error.cameraStreamNotAvailable":"Yakalama iin kamera ak mevcut deil.","error.imageCaptureGeneric":"Grsel yakalama srasnda bilinmeyen hata.","error.visualContextVideoElementNotReady":"Grsel balam video esi hazr deil.","error.snapshotVideoElementNotReady":"Anlk grnt iin video esi hazr deil.","error.visualContextCameraAccessNotSupported":"Grsel balam iin kamera eriimi desteklenmiyor.","error.snapshotCameraAccessNotSupported":"Anlk grnt iin kamera eriimi desteklenmiyor.","error.visualContext2DContext":"Grsel balam iin 2D balam alnamad.","error.snapshot2DContext":"Anlk grnt iin 2D balam alnamad.","error.visualContextCaptureFailedPermission":"Grsel Balam baarsz: Kamera izni reddedildi.","error.snapshotCaptureFailedPermission":"Anlk Grnt baarsz: Kamera izni reddedildi.","error.visualContextCaptureFailedNotFound":"Grsel Balam baarsz: Kamera bulunamad.","error.snapshotCaptureFailedNotFound":"Anlk Grnt baarsz: Kamera bulunamad.","error.visualContextCaptureFailedNotReady":"Grsel Balam baarsz: Kamera hazr deil veya akta bir sorun var. {details}","error.snapshotCaptureFailedNotReady":"Anlk Grnt baarsz: Kamera hazr deil veya akta bir sorun var. {details}","error.visualContextCaptureFailedGeneric":"Grsel Balam baarsz: {details}","error.snapshotCaptureFailedGeneric":"Anlk Grnt baarsz: {details}"},CI={"app.title":"Maestro","sttLang.selectLanguage":"t nhn dng ging ni thnh {language}","header.targetLanguageTitle":"Ngn ng mc tiu hin ti: {language}","startPage.clickToStart":"Nhp vo my bay","startPage.saveChats":"Lu tt c cuc tr chuyn","startPage.loadChats":"Ti cuc tr chuyn","startPage.saveThisChat":"Lu cuc tr chuyn ny","startPage.appendToChat":"Thm vo cuc tr chuyn","startPage.trimBeforeBookmark":"Ct bt trc du trang","startPage.maestroAvatar":"Avatar Maestro","startPage.addMaestroAvatar":"Thm avatar Maestro","startPage.loadSuccess":" ti v thay th thnh cng {count} phin tr chuyn!","startPage.loadError":"Li khi ti cuc tr chuyn. Tp c th b hng hoc sai nh dng.","startPage.noChatsToSave":"Khng c lch s tr chuyn  lu.","startPage.saveError":"Li khi lu cuc tr chuyn. Xem console  bit thm chi tit.","startPage.noChatSelected":"Vui lng chn mt cp ngn ng trc.","startPage.noBookmarkSet":"Cha t du trang. Hy t du trang trc  xa cc tin nhn trc .","startPage.noMessagesToTrim":"Khng c tin nhn no trc du trang  xa.","startPage.trimSuccess":" xa {count} tin nhn trc du trang.","startPage.trimError":"Khng th ct bt tin nhn. Vui lng th li.","startPage.noMessagesToAppend":"Khng tm thy tin nhn no trong tp sao lu  kt hp.","startPage.noPairInBackup":"Tp sao lu khng cha tin nhn cho cp ngn ng hin ti ca bn. Vui lng chn tp sao lu khp vi cuc tr chuyn hin ti.","startPage.appendSuccess":" thm thnh cng {count} tin nhn vo cuc tr chuyn hin ti.","startPage.combineSuccess":" kt hp cuc tr chuyn: {added} tin nhn mi c thm, tng cng {total} tin nhn.","startPage.combineNoDuplicates":"Tt c tin nhn  c trong cuc tr chuyn ca bn. Khng c thay i no c thc hin.","startPage.combineNoChanges":"Khng c tin nhn mi  thm. Cuc tr chuyn ca bn khng thay i.","startPage.invalidBackupFormat":"Tp sao lu khng hp l. Vui lng chn tp sao lu Maestro (.ndjson) hp l.","startPage.browserNotSupported":"Trnh duyt ca bn khng h tr lu tp. Vui lng s dng Chrome hoc Edge.","sessionControls.saveAll.label":"Lu tt c","sessionControls.saveAll.description":"Xut tt c cuc tr chuyn ra tp sao lu","sessionControls.loadAll.label":"Ti tt c","sessionControls.loadAll.description":"Thay th tt c cuc tr chuyn bng tp sao lu","sessionControls.reset.label":"t li","sessionControls.reset.description":"Sao lu & xa tt c d liu","sessionControls.saveThis.label":"Lu chat","sessionControls.saveThis.description":"Ch xut cuc tr chuyn ny","sessionControls.combine.label":"Kt hp","sessionControls.combine.description":"Hp nht bn sao lu vo cuc tr chuyn ny","sessionControls.trim.label":"Ct bt","sessionControls.trim.description":"Xa tin nhn trc du trang","sessionControls.profile":"H s:","sessionControls.profilePlaceholder":"Tn hoc chi tit ca bn...","sessionControls.editProfile":"Chnh sa h s ngi dng","sessionControls.allChatsControls":"iu khin tt c tr chuyn","sessionControls.thisChatsControls":"iu khin tr chuyn ny","sessionControls.back":"Quay li","sessionControls.backupAndReset":"Sao lu & t li","sessionControls.typeToConfirm":'Nhp "{keyword}"  xc nhn',"sessionControls.changeAvatar":"Thay i Avatar","general.clear":"Xa","general.error":"Xin li, ti  gp li.","apiKeyGate.title":"Kt ni kha API Gemini ca bn","apiKeyGate.billingTitle":"Thit lp thanh ton  c hn ngch cao hn","apiKeyGate.infoLogin":"ng nhp ca bn: Kha API","apiKeyGate.infoVisibility":"Ai nhn thy: Ch mnh bn","apiKeyGate.infoBilling":"Thanh ton: Hng thng, t Google","apiKeyGate.infoCost":"Chi ph: Hin th trong ng dng  chm  xem","apiKeyGate.infoMore":"Thm thng tin:","apiKeyGate.privacyPolicy":"Chnh sch bo mt","apiKeyGate.stepsTitle":"Hai bc nhanh chng:","apiKeyGate.stepOne":"M Google AI Studio v to kha API.","apiKeyGate.stepTwo":"Dn kha vo bn di v nhn Lu.","apiKeyGate.openAiStudio":"M Google AI Studio","apiKeyGate.viewInstructions":"Xem hng dn","apiKeyGate.closeInstructions":"ng hng dn","apiKeyGate.previousInstruction":"Hng dn trc","apiKeyGate.nextInstruction":"Hng dn tip theo","apiKeyGate.instructionStep":"Hng dn {step}/{total}","apiKeyGate.keyLabel":"Kha API Gemini","apiKeyGate.placeholder":"Dn kha API ca bn vo y","apiKeyGate.show":"Hin","apiKeyGate.hide":"n","apiKeyGate.currentKeySaved":"Kha hin ti  lu {maskedKey}","apiKeyGate.keyInvalid":"Kha khng hp l {maskedKey}  dn kha mi bn di","apiKeyGate.clearSavedKey":"Xa kha  lu","apiKeyGate.cancel":"Hy","apiKeyGate.saving":"ang lu...","apiKeyGate.saveKey":"Lu kha","apiKeyGate.close":"ng","apiKeyGate.costLabel":"Chi ph API c tnh","apiKeyGate.testerFormTitle":"Th nghim ng dng","apiKeyGate.testerFormDescription":"Nhp email bn s dng cho Google Play Store  nhn li mi tham gia bn beta Android ca chng ti!","apiKeyGate.testerFormSubmit":"Nhn quyn truy cp sm","apiKeyGate.testerFormSubmitting":"ang gi...","apiKeyGate.testerFormError":" xy ra li. Vui lng th li.","apiKeyGate.testerFormMustBeGmail":"Vui lng s dng a ch @gmail.com cho Google Play.","apiKeyGate.testerFormCapReached":" t gii hn ng k. Cm n bn!","apiKeyGate.developerLogin":"ng nhp nh pht trin","apiKeyGate.submitAnotherEmail":"Nhp sai email? t li v th email khc.","apiKeyGate.testerFormChecking":"ang kim tra trng thi li mi...","apiKeyGate.testerFormApprovedTitle":"Bn  tham gia! ","apiKeyGate.testerFormApprovedDesc":"Email ca bn  c ph duyt cho chng trnh th nghim beta Android.","apiKeyGate.testerFormDownloadBtn":"Ti ng dng trn Google Play","apiKeyGate.testerFormPendingTitle":"Bn ang trong danh sch ch!","apiKeyGate.testerFormPendingDesc":"Chng ti  nhn c email ca bn. Qu trnh x l li mi th cng s mt cht thi gian. Vui lng kim tra li sau!","apiKeyGate.checkStatusModeBtn":" ng k? Kim tra trng thi.","apiKeyGate.submitModeBtn":"Cn ng k? ng k ti y.","apiKeyGate.checkStatusTitle":"Kim tra trng thi li mi","apiKeyGate.checkStatusDesc":"Nhp email bn  dng  ng k danh sch ch.","apiKeyGate.checkStatusSubmit":"Kim tra trng thi","apiKeyGate.testerFormNotFound":"Khng tm thy email trong danh sch ch. Vui lng ng k trc.","chat.thinking":"ang suy ngh...","chat.loadingHistory":"ang ti lch s tr chuyn...","chat.loadingSuggestions":"ang ti gi ...","chat.suggestionsAriaLabel":"Gi  tr li","chat.attachImageFromFile":"nh km tp","chat.removeAttachedImage":"Xa tp nh km","chat.sendMessage":"Gi tin nhn","chat.messageInputAriaLabel":"Nhp tin nhn","chat.retrievedFromWeb":"Truy xut t web:","chat.videoNotSupported":"Trnh duyt ca bn khng h tr th video.","chat.audioNotSupported":"Trnh duyt ca bn khng h tr th m thanh.","chat.fileAttachment":"Tp nh km","chat.pdf.loading":"ang ti PDF...","chat.pdf.error":"Khng th hin th PDF","chat.pdf.pageIndicator":"Trang {current} / {total}","chat.imageGenError":"Li to hnh nh","chat.generatingImageLoadingSlow":"Mt nhiu thi gian hn mt cht...","chat.stopSpeaking":"Dng ni","chat.speakThisLine":"c dng ny","chat.languageSelector.openGlobe":"Thay i ngn ng","chat.maestroTranscriptScrollwheel":"Ch  xem cun bn ghi Maestro","chat.mic.listening":"STT ang hot ng: ang nghe...","chat.mic.enableStt":"Bt STT","chat.mic.disableStt":"Dng STT","chat.mic.recordingAudioNote":"ang ghi m...","chat.placeholder.normal.listening":"ang nghe bng {language}...","chat.placeholder.normal.sttActive":"Ni bng {language} hoc nhp...","chat.placeholder.normal.sttInactive":"Nhp hoc chm vo mic  ni bng {language}...","chat.placeholder.suggestion.listening":"Ni {language}  dch...","chat.placeholder.suggestion.sttActive":"Ni hoc nhp bng {language}  dch...","chat.placeholder.suggestion.sttInactive":"Nhp bng {language}  dch...","chat.camera.turnOn":"Bt xem trc camera","chat.camera.turnOff":"Tt xem trc camera","chat.camera.selectCamera":"Chn camera","chat.camera.imageGenCameraLabel":"To hnh nh","chat.camera.captureOrRecord":"Chm  chp nh, gi  quay video","chat.camera.stopRecording":"Dng ghi","chat.bookIcon.toggleImageGen":"Chuyn i ch  to hnh nh","chat.imagePreview.alt":"Xem trc","chat.image.dragToEnlarge":"Ko gc  phng to","chat.image.dragToShrink":"Ko gc  thu nh","chat.annotateImage":"Ch thch hnh nh","chat.annotateVideoFrame":"Ch thch khung hnh hin ti","chat.annotateModal.editingPreviewAlt":"Hnh nh cn ch thch","chat.annotateModal.cancel":"Hy","chat.annotateModal.saveAndAttach":"Lu v nh km","chat.annotateModal.undo":"Hon tc","chat.suggestion.speak":'Ni: "{suggestion}"',"chat.suggestion.ariaLabel":"c gi : {suggestion}","chat.suggestion.toggleCreateMode":"Chuyn i ch  to gi ","chat.suggestion.createAction":"To gi ","chat.suggestion.creating":"ang to gi ...","chat.maestro.idle":"Maestro ang rnh","chat.maestro.title.idle":"Maestro hin ang rnh.","chat.maestro.resting":"Maestro ang ngh ngi...","chat.maestro.observing":"Maestro ang quan st...","chat.maestro.aboutToEngage":"Maestro sp tham gia...","chat.maestro.title.resting":"Maestro ang rnh, cn nhiu thi gian trc khi ti tham gia.","chat.maestro.title.observing":"Maestro ang quan st, cn mt cht thi gian trc khi ti tham gia.","chat.maestro.title.aboutToEngage":"Maestro s sm ti tham gia.","chat.maestro.typing":"Maestro ang nhp...","chat.maestro.title.typing":"Maestro ang chun b phn hi.","chat.maestro.speaking":"Maestro ang ni","chat.maestro.title.speaking":"Maestro hin ang ni.","chat.maestro.listening":"ang nghe...","chat.maestro.title.listening":"Maestro ang ch u vo hoc ging ni ca bn.","chat.maestro.holding":"Maestro ang ch","chat.maestro.title.holding":"Maestro ang ch (ti tham gia tm dng)","chat.bookmark.hiddenHeaderAria":"Tin nhn n pha trn","chat.bookmark.isHere":"Du trang  y","chat.bookmark.setHere":"t du trang  y","chat.bookmark.actionsRegionAria":"Hnh ng du trang","chat.bookmark.actionsToggleTitle":"Ty chn du trang","chat.bookmark.decrementAria":"Hin th t hn mt","chat.bookmark.decrementTitle":"t hn","chat.bookmark.incrementAria":"Hin th thm mt","chat.bookmark.incrementTitle":"Thm","chat.bookmark.hiddenBelowHeaderAria":"Tin nhn n pha di","chat.sendPrep.optimizingVideo":"ang ti u ha video...","chat.sendPrep.optimizingImage":"ang ti u ha hnh nh...","chat.sendPrep.preparingMedia":"ang chun b phng tin...","chat.sendPrep.uploadingMedia":"ang ti ln phng tin...","chat.sendPrep.finalizing":"ang hon tt...","chat.header.annotating":"ang ch thch","chat.header.recordingAudio":"ang ghi m","chat.header.recordingVideo":"ang quay video","chat.header.savePopup":"ang lu...","chat.header.loadPopup":"ang ti...","chat.header.maestroAvatar":"ang cp nht avatar Maestro","chat.header.watchingVideo":"ang xem video","chat.header.viewingAbove":"ang xem tin nhn trc ","chat.header.liveSession":"Phin trc tip","chat.liveSession.stop":"Dng trc tip","chat.liveSession.retry":"Th li trc tip","chat.liveSession.start":"Bt u trc tip","chat.liveSession.liveBadge":"Trc tip","chat.liveSession.connecting":"ang kt ni","chat.liveSession.defaultLastMessage":"Xin cho! Ti c th gip g cho bn hm nay?","chat.liveSession.defaultSuggestion1":"Xin cho","chat.liveSession.defaultSuggestion2":"Cho bui sng","chat.liveSession.defaultSuggestion3":"Bn khe khng?","chat.error.sttError":"Li STT: {error}. Th chuyn i mic.","chat.error.autoCaptureCameraError":"Li t ng chp camera: {error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"Ghi t ng dng sau {maxMinutes} pht.","chat.error.videoMetadataError":"Khng th c siu d liu video. Tp c th b hng hoc nh dng khng c h tr.","chat.error.pauseVideoToAnnotate":"Tm dng video  ch thch khung hnh hin ti","chat.error.imageGenInterrupted":"To hnh nh  b gin on.","chat.error.thinkingInterrupted":"Phn hi AI  b gin on.","error.noLanguagePair":"Li nghim trng: Khng c cp ngn ng no c chn.","error.translationFailed":"Dch tht bi. Vui lng th li.","error.imageLimitReached":" t gii hn to hnh nh ca phin. Vui lng bt u phin mi.","error.tokenLimitReached":" t gii hn token ca phin. Vui lng bt u phin mi.","error.apiKeyMissing":"Thiu kha Gemini API ca bn. M mn hnh Kha API v dn kha ca bn vo.","error.apiKeyInvalid":"Kha Gemini API ca bn khng hp l. Vui lng kim tra li chnh t v dn kha hp l.","error.apiQuotaExceeded":"Hn mc ca bn  ht (Tr ph: tr chuyn thng minh hn, video, pdf v to hnh nh)","error.quotaSetupBilling":"Thit lp thanh ton","error.quotaStartLive":"Bt u phin bn Live min ph (khng to hnh nh)","error.imageGenCostWarning":"Vic to hnh nh c gi ~0,04  la cho mi hnh nh. Tin nhn tr chuyn cng c mt khon ph nh. Tt c c lp ha n bi Google. Bn c th theo di chi ph trong mn hnh kha API.","error.imageGenDisable":"Tt tnh nng to hnh nh","error.imageGenViewCost":"Theo di chi ph trong mn hnh kha API.","error.cameraPermissionDenied":"Quyn camera b t chi. Vui lng bt quyn truy cp camera trong ci t trnh duyt.","error.cameraNotFound":"Khng tm thy camera  chn. m bo n c kt ni hoc chn camera khc trong ci t.","error.cameraAccessNotSupported":"Truy cp camera khng c trnh duyt ca bn h tr.","error.cameraUnknown":" xy ra li khng xc nh khi truy cp camera.","error.cameraStreamNotAvailable":"Lung camera khng kh dng  chp.","error.imageCaptureGeneric":"Li khng xc nh khi chp hnh nh.","error.visualContextVideoElementNotReady":"Phn t video ng cnh trc quan cha sn sng.","error.snapshotVideoElementNotReady":"Phn t video chp nh cha sn sng.","error.visualContextCameraAccessNotSupported":"Truy cp camera khng c h tr cho ng cnh trc quan.","error.snapshotCameraAccessNotSupported":"Truy cp camera khng c h tr cho chp nh.","error.visualContext2DContext":"Khng th ly ng cnh 2D cho ng cnh trc quan.","error.snapshot2DContext":"Khng th ly ng cnh 2D cho chp nh.","error.visualContextCaptureFailedPermission":"Ng cnh trc quan tht bi: Quyn camera b t chi.","error.snapshotCaptureFailedPermission":"Chp nh tht bi: Quyn camera b t chi.","error.visualContextCaptureFailedNotFound":"Ng cnh trc quan tht bi: Khng tm thy camera.","error.snapshotCaptureFailedNotFound":"Chp nh tht bi: Khng tm thy camera.","error.visualContextCaptureFailedNotReady":"Ng cnh trc quan tht bi: Camera cha sn sng hoc c vn  vi lung. {details}","error.snapshotCaptureFailedNotReady":"Chp nh tht bi: Camera cha sn sng hoc c vn  vi lung. {details}","error.visualContextCaptureFailedGeneric":"Ng cnh trc quan tht bi: {details}","error.snapshotCaptureFailedGeneric":"Chp nh tht bi: {details}"},SI={"app.title":"Maestro","sttLang.selectLanguage":"{language}","header.targetLanguageTitle":"{language}","startPage.clickToStart":"","startPage.saveChats":"","startPage.loadChats":"","startPage.saveThisChat":"","startPage.appendToChat":"","startPage.trimBeforeBookmark":"","startPage.maestroAvatar":"Maestro","startPage.addMaestroAvatar":"Maestro","startPage.loadSuccess":"{count}","startPage.loadError":"","startPage.noChatsToSave":"","startPage.saveError":"","startPage.noChatSelected":"","startPage.noBookmarkSet":"","startPage.noMessagesToTrim":"","startPage.trimSuccess":" {count} ","startPage.trimError":"","startPage.noMessagesToAppend":"","startPage.noPairInBackup":"","startPage.appendSuccess":" {count} ","startPage.combineSuccess":" {added}  {total} ","startPage.combineNoDuplicates":"","startPage.combineNoChanges":"","startPage.invalidBackupFormat":" Maestro  (.ndjson) ","startPage.browserNotSupported":" Chrome  Edge","sessionControls.saveAll.label":"","sessionControls.saveAll.description":"","sessionControls.loadAll.label":"","sessionControls.loadAll.description":"","sessionControls.reset.label":"","sessionControls.reset.description":"","sessionControls.saveThis.label":"","sessionControls.saveThis.description":"","sessionControls.combine.label":"","sessionControls.combine.description":"","sessionControls.trim.label":"","sessionControls.trim.description":"","sessionControls.profile":"","sessionControls.profilePlaceholder":"...","sessionControls.editProfile":"","sessionControls.allChatsControls":"","sessionControls.thisChatsControls":"","sessionControls.back":"","sessionControls.backupAndReset":"","sessionControls.typeToConfirm":' "{keyword}" ',"sessionControls.changeAvatar":"","general.clear":"","general.error":"","apiKeyGate.title":" Gemini API ","apiKeyGate.billingTitle":"","apiKeyGate.infoLogin":"API ","apiKeyGate.infoVisibility":"","apiKeyGate.infoBilling":" Google ","apiKeyGate.infoCost":"  ","apiKeyGate.infoMore":"","apiKeyGate.privacyPolicy":"","apiKeyGate.stepsTitle":"","apiKeyGate.stepOne":" Google AI Studio  API ","apiKeyGate.stepTwo":"","apiKeyGate.openAiStudio":" Google AI Studio","apiKeyGate.viewInstructions":"","apiKeyGate.closeInstructions":"","apiKeyGate.previousInstruction":"","apiKeyGate.nextInstruction":"","apiKeyGate.instructionStep":" {step} / {total}","apiKeyGate.keyLabel":"Gemini API ","apiKeyGate.placeholder":" API ","apiKeyGate.show":"","apiKeyGate.hide":"","apiKeyGate.currentKeySaved":" {maskedKey}","apiKeyGate.keyInvalid":" {maskedKey}  ","apiKeyGate.clearSavedKey":"","apiKeyGate.cancel":"","apiKeyGate.saving":"...","apiKeyGate.saveKey":"","apiKeyGate.close":"","apiKeyGate.costLabel":" API ","apiKeyGate.testerFormTitle":"","apiKeyGate.testerFormDescription":" Google Play  Android Beta ","apiKeyGate.testerFormSubmit":"","apiKeyGate.testerFormSubmitting":"...","apiKeyGate.testerFormError":"","apiKeyGate.testerFormMustBeGmail":" @gmail.com  Google Play","apiKeyGate.testerFormCapReached":"","apiKeyGate.developerLogin":"","apiKeyGate.submitAnotherEmail":"","apiKeyGate.testerFormChecking":"...","apiKeyGate.testerFormApprovedTitle":"","apiKeyGate.testerFormApprovedDesc":" Android Beta ","apiKeyGate.testerFormDownloadBtn":" Google Play ","apiKeyGate.testerFormPendingTitle":"","apiKeyGate.testerFormPendingDesc":"","apiKeyGate.checkStatusModeBtn":"","apiKeyGate.submitModeBtn":"","apiKeyGate.checkStatusTitle":"","apiKeyGate.checkStatusDesc":"","apiKeyGate.checkStatusSubmit":"","apiKeyGate.testerFormNotFound":"","chat.thinking":"...","chat.loadingHistory":"...","chat.loadingSuggestions":"...","chat.suggestionsAriaLabel":"","chat.attachImageFromFile":"","chat.removeAttachedImage":"","chat.sendMessage":"","chat.messageInputAriaLabel":"","chat.retrievedFromWeb":"","chat.videoNotSupported":"","chat.audioNotSupported":"","chat.fileAttachment":"","chat.pdf.loading":" PDF...","chat.pdf.error":" PDF","chat.pdf.pageIndicator":" {current}  {total} ","chat.imageGenError":"","chat.generatingImageLoadingSlow":"...","chat.stopSpeaking":"","chat.speakThisLine":"","chat.languageSelector.openGlobe":"","chat.maestroTranscriptScrollwheel":"Maestro","chat.mic.listening":"STT...","chat.mic.enableStt":"STT","chat.mic.disableStt":"STT","chat.mic.recordingAudioNote":"...","chat.placeholder.normal.listening":"{language}...","chat.placeholder.normal.sttActive":"{language}...","chat.placeholder.normal.sttInactive":"{language}...","chat.placeholder.suggestion.listening":"{language}...","chat.placeholder.suggestion.sttActive":"{language}...","chat.placeholder.suggestion.sttInactive":"{language}...","chat.camera.turnOn":"","chat.camera.turnOff":"","chat.camera.selectCamera":"","chat.camera.imageGenCameraLabel":"","chat.camera.captureOrRecord":"","chat.camera.stopRecording":"","chat.bookIcon.toggleImageGen":"","chat.imagePreview.alt":"","chat.image.dragToEnlarge":"","chat.image.dragToShrink":"","chat.annotateImage":"","chat.annotateVideoFrame":"","chat.annotateModal.editingPreviewAlt":"","chat.annotateModal.cancel":"","chat.annotateModal.saveAndAttach":"","chat.annotateModal.undo":"","chat.suggestion.speak":'"{suggestion}"',"chat.suggestion.ariaLabel":"{suggestion}","chat.suggestion.toggleCreateMode":"","chat.suggestion.createAction":"","chat.suggestion.creating":"...","chat.maestro.idle":"Maestro","chat.maestro.title.idle":"Maestro","chat.maestro.resting":"Maestro...","chat.maestro.observing":"Maestro...","chat.maestro.aboutToEngage":"Maestro...","chat.maestro.title.resting":"Maestro","chat.maestro.title.observing":"Maestro","chat.maestro.title.aboutToEngage":"Maestro","chat.maestro.typing":"Maestro...","chat.maestro.title.typing":"Maestro","chat.maestro.speaking":"Maestro","chat.maestro.title.speaking":"Maestro","chat.maestro.listening":"...","chat.maestro.title.listening":"Maestro","chat.maestro.holding":"Maestro","chat.maestro.title.holding":"Maestro","chat.bookmark.hiddenHeaderAria":"","chat.bookmark.isHere":"","chat.bookmark.setHere":"","chat.bookmark.actionsRegionAria":"","chat.bookmark.actionsToggleTitle":"","chat.bookmark.decrementAria":"","chat.bookmark.decrementTitle":"","chat.bookmark.incrementAria":"","chat.bookmark.incrementTitle":"","chat.bookmark.hiddenBelowHeaderAria":"","chat.sendPrep.optimizingVideo":"...","chat.sendPrep.optimizingImage":"...","chat.sendPrep.preparingMedia":"...","chat.sendPrep.uploadingMedia":"...","chat.sendPrep.finalizing":"...","chat.header.annotating":"","chat.header.recordingAudio":"","chat.header.recordingVideo":"","chat.header.savePopup":"...","chat.header.loadPopup":"...","chat.header.maestroAvatar":"Maestro","chat.header.watchingVideo":"","chat.header.viewingAbove":"","chat.header.liveSession":"","chat.liveSession.stop":"","chat.liveSession.retry":"","chat.liveSession.start":"","chat.liveSession.liveBadge":"","chat.liveSession.connecting":"","chat.liveSession.defaultLastMessage":"","chat.liveSession.defaultSuggestion1":"","chat.liveSession.defaultSuggestion2":"","chat.liveSession.defaultSuggestion3":"","chat.error.sttError":"STT{error}","chat.error.autoCaptureCameraError":"{error}","chat.error.snapshotUserError":"{error}","chat.error.recordingTimeExceeded":"{maxMinutes}","chat.error.videoMetadataError":"","chat.error.pauseVideoToAnnotate":"","chat.error.imageGenInterrupted":"","chat.error.thinkingInterrupted":"AI","error.noLanguagePair":"","error.translationFailed":"","error.imageLimitReached":"","error.tokenLimitReached":"","error.apiKeyMissing":" Gemini API  API ","error.apiKeyInvalid":" Gemini API ","error.apiQuotaExceeded":"PDF ","error.quotaSetupBilling":"","error.quotaStartLive":"","error.imageGenCostWarning":" 0.04  Google  API ","error.imageGenDisable":"","error.imageGenViewCost":" API ","error.cameraPermissionDenied":"","error.cameraNotFound":"","error.cameraAccessNotSupported":"","error.cameraUnknown":"","error.cameraStreamNotAvailable":"","error.imageCaptureGeneric":"","error.visualContextVideoElementNotReady":"","error.snapshotVideoElementNotReady":"","error.visualContextCameraAccessNotSupported":"","error.snapshotCameraAccessNotSupported":"","error.visualContext2DContext":"2D","error.snapshot2DContext":"2D","error.visualContextCaptureFailedPermission":"","error.snapshotCaptureFailedPermission":"","error.visualContextCaptureFailedNotFound":"","error.snapshotCaptureFailedNotFound":"","error.visualContextCaptureFailedNotReady":"{details}","error.snapshotCaptureFailedNotReady":"{details}","error.visualContextCaptureFailedGeneric":"{details}","error.snapshotCaptureFailedGeneric":"{details}"},ho={"en-US":Eu,"en-GB":Eu,"en-AU":Eu,"en-IN":Eu,"es-ES":jb,"es-US":jb,"fr-FR":Qb,"fr-CA":Qb,"de-DE":tI,"it-IT":sI,"pt-BR":gI,"nl-NL":hI,"pl-PL":AI,"ru-RU":fI,"tr-TR":bI,"ar-XA":ZM,"hi-IN":iI,"bn-IN":eI,"gu-IN":aI,"kn-IN":lI,"ml-IN":uI,"mr-IN":dI,"ta-IN":mI,"te-IN":vI,"ja-JP":oI,"ko-KR":cI,"cmn-CN":SI,"th-TH":yI,"vi-VN":CI,"id-ID":rI,"fi-FI":nI,"sv-SE":pI},wI=a=>a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),TI=a=>{const e=x.useMemo(()=>a||"en-US",[a]);return{t:x.useCallback((n,i)=>{let s=ho[e]?.[n]||ho["en-US"]?.[n]||n;return i&&Object.keys(i).forEach(l=>{const c=wI(l);s=s.replace(new RegExp(`\\{${c}\\}`,"g"),String(i[l]))}),s},[e]),currentLanguage:e}},Ro=()=>{const a=W(lr),e=x.useMemo(()=>a?.nativeLanguageCode?ha(a.nativeLanguageCode):(typeof navigator<"u"?navigator.language:"en-US")||"en-US",[a]);return TI(e)},bw=x.forwardRef(({onOpenApiKey:a,hasApiKey:e},t)=>{const{t:n}=Ro(),i=W(U=>U.maestroActivityStage),s=W(lr),l=W(jd),c=W(U=>U.toggleDebugLogs),h=W(U=>U.setIsLanguageSelectionOpen),d=W(U=>U.setTempNativeLangCode),A=W(U=>U.setTempTargetLangCode),f=W(U=>U.addActivityToken),p=W(U=>U.removeActivityToken),[b,w]=x.useState(!1),S=x.useRef(null),k=x.useRef(null),E=x.useRef(!1);x.useEffect(()=>(b&&(S.current&&clearTimeout(S.current),S.current=window.setTimeout(()=>{w(!1)},5e3)),()=>{S.current&&clearTimeout(S.current)}),[b]);const I=x.useCallback(U=>{const Y=W.getState();if(nr(Y))return;h(!0);const ge=Y.settings.selectedLanguagePairId;if(ge&&typeof ge=="string"){const me=Rd(ge);me?(A(me.targetCode),d(me.nativeCode)):(d(null),A(null))}else d(null),A(null)},[h,d,A]),P=U=>{if(E.current){U.stopPropagation(),U.preventDefault();return}b?I(U):(U.stopPropagation(),w(!0))},R=x.useRef(null),D=x.useCallback(()=>{R.current?(p(R.current),R.current=null):R.current=f(mn.UI,_t.HOLD)},[f,p]),N=U=>{E.current=!1,k.current&&clearTimeout(k.current),k.current=window.setTimeout(()=>{E.current=!0,D(),navigator.vibrate&&navigator.vibrate(50)},800)},_=()=>{k.current&&(clearTimeout(k.current),k.current=null)},K=()=>{k.current&&(clearTimeout(k.current),k.current=null)},G=W(zf(fw)),L=W(BM),O=W(gw),q=x.useMemo(()=>zM(i,G,L,O),[i,G,L,O]),{currentAnimation:$,isVisible:Q,handleAnimationEnded:Z,handleTransitionEnd:F}=VM();return T.jsxs(T.Fragment,{children:[T.jsx("div",{ref:t,className:`fixed top-4 left-0 z-50 transition-transform duration-500 ease-out
          ${b?"translate-x-0":"-translate-x-1 hover:translate-x-0"}
        `,style:{top:"calc(1rem + env(safe-area-inset-top))"},children:T.jsxs("div",{className:`flex items-center cursor-pointer select-none touch-none transition-all duration-300
            ${q.color} ${q.borderColor}
            ${q.textColor}
            ${b?"drop-shadow-md border-y border-r pr-4 pl-3 py-1.5":"drop-shadow-md pl-3 pr-3 py-2 animate-flag-wave"}
          `,style:b?{borderRadius:"0 15px 225px 0 / 0 225px 15px 0"}:void 0,onClick:P,onPointerDown:N,onPointerUp:_,onPointerLeave:K,onContextMenu:U=>U.preventDefault(),role:"status","aria-live":"polite",title:b?void 0:"Click to view status",children:[T.jsx("div",{className:"transition-opacity duration-300",children:T.jsx(OM,{stage:i,t:n,targetLanguageFlag:s?l?.flag:void 0,targetLanguageTitle:s?n("header.targetLanguageTitle",{language:l?.displayName||""}):void 0,className:q.textColor,isExpanded:b})}),b&&T.jsx("button",{onClick:U=>{U.stopPropagation(),D(),navigator.vibrate&&navigator.vibrate(50)},onPointerDown:U=>U.stopPropagation(),className:"ml-2 pl-2 border-l border-current opacity-70 hover:opacity-100 transition-opacity duration-200","aria-label":L?"Resume Maestro":"Pause Maestro",children:L?T.jsx(pS,{className:"w-4 h-4"}):T.jsx(mS,{className:"w-4 h-4"})})]})}),$&&T.jsx("div",{className:"fixed left-0 z-40 pl-3",style:{top:"calc(1rem + env(safe-area-inset-top) + 40px)"},children:T.jsx(HM,{currentAnimation:$,isVisible:Q,onEnded:Z,onTransitionEnd:F})}),T.jsxs("div",{className:`fixed top-4 right-4 z-40 flex items-center gap-2 transition-all duration-300 ease-in-out ${b?"opacity-100 translate-x-0 pointer-events-auto":"opacity-0 translate-x-4 pointer-events-none"}`,style:{top:"calc(1rem + env(safe-area-inset-top))"},children:[a&&T.jsxs("button",{onClick:a,className:`flex items-center gap-2 px-3 py-2 shadow-sm backdrop-blur-sm transition-all text-xs sm:text-sm sketchy-border-thin
               ${e?"bg-emerald-600/85 text-white hover:bg-emerald-600":"bg-rose-600/90 text-white hover:bg-rose-600"}
             `,title:e?"Manage API Key":"API Key Required",children:[T.jsx(Xu,{className:"w-4 h-4"}),T.jsx("span",{className:"hidden sm:inline",children:e?"API Key":"API Key Required"})]}),T.jsx("button",{onClick:c,className:"p-2 bg-primary/80 hover:bg-primary text-muted-foreground hover:text-primary-foreground shadow-sm backdrop-blur-sm transition-all sketchy-border-thin",title:"View Traffic Logs",children:T.jsx(CS,{className:"w-4 h-4"})})]})]})});bw.displayName="Header";const qb=({languages:a,selectedValue:e,onSelect:t,title:n,disabled:i,onInteract:s,variant:l})=>{const c=x.useRef(null),h=x.useRef(new Map),d=x.useRef(null),A=x.useRef(!1),f=x.useRef(!1),[p,b]=x.useState(!1),w=x.useRef(null);x.useEffect(()=>{if(e&&c.current){const D=h.current.get(e.langCode);D&&(A.current=!0,D.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{A.current=!1},500))}else!e&&c.current&&(A.current=!0,c.current.scrollTop=0,setTimeout(()=>{A.current=!1},300))},[e]);const S=x.useCallback(()=>{if(A.current)return;const D=c.current;if(!D)return;const N=D.scrollTop,_=D.offsetHeight,K=N+_/2;let G=-1,L=1/0;if(a.forEach((O,q)=>{const $=h.current.get(O.langCode);if($){const Q=$.offsetTop-D.offsetTop,Z=$.offsetHeight,F=Q+Z/2,U=Math.abs(K-F);U<L&&(L=U,G=q)}}),G>-1){const O=a[G];O.langCode!==e?.langCode&&t(O)}},[a,t,e]),k=x.useCallback(()=>{A.current||f.current||(b(!1),s?.(),S())},[s,S]),E=x.useCallback(()=>{A.current||(d.current&&clearTimeout(d.current),d.current=window.setTimeout(k,250))},[k]),I=x.useCallback(()=>{f.current=!0,d.current&&clearTimeout(d.current)},[]),P=x.useCallback(()=>{f.current=!1,E()},[E]);x.useEffect(()=>{const D=c.current;if(!D)return;const N="onscrollend"in window,_=()=>{A.current||(b(!0),w.current&&clearTimeout(w.current),w.current=window.setTimeout(()=>b(!1),300)),N||E()},K=()=>{f.current||k()};return D.addEventListener("scroll",_,{passive:!0}),N&&D.addEventListener("scrollend",K),D.addEventListener("touchstart",I,{passive:!0}),D.addEventListener("touchend",P,{passive:!0}),D.addEventListener("touchcancel",P,{passive:!0}),()=>{D.removeEventListener("scroll",_),N&&D.removeEventListener("scrollend",K),D.removeEventListener("touchstart",I),D.removeEventListener("touchend",P),D.removeEventListener("touchcancel",P),d.current&&clearTimeout(d.current),w.current&&clearTimeout(w.current)}},[E,k,I,P]);const R=p&&l?l==="native"?"ring-2 ring-watercolor shadow-watercolor/30 shadow-md":"ring-2 ring-green-500 shadow-green-500/30 shadow-md":"";return T.jsxs("div",{className:`flex-1 text-center relative min-w-[3rem] ${i?"opacity-50":""}`,children:[n&&T.jsx("p",{className:"text-xs text-muted-foreground mb-1 h-4",children:n}),T.jsx("div",{className:`transition-all duration-150 sketchy-border-thin ${R}`,children:T.jsxs("div",{ref:c,className:`h-32 overflow-y-auto relative scrollbar-hide ${i?"pointer-events-none":""}`,style:{scrollSnapType:"y mandatory",WebkitMaskImage:"linear-gradient(to bottom, transparent, black 20%, black 80%, transparent)",maskImage:"linear-gradient(to bottom, transparent, black 20%, black 80%, transparent)"},onPointerDown:()=>s?.(),children:[T.jsx("div",{className:"h-[calc(50%-1.25rem)]"}),a.map(D=>{const N=D.langCode===e?.langCode,_=td(D);return T.jsx("div",{ref:K=>{K&&h.current.set(D.langCode,K)},className:"flex items-center justify-center h-10 transition-all duration-200 ease-out",style:{scrollSnapAlign:"center"},onClick:()=>{i||(s?.(),t(D))},children:T.jsxs("span",{className:`text-2xl font-semibold flex items-center gap-0.5 cursor-pointer transition-all duration-200 ${N?"opacity-100 scale-125":"opacity-50 scale-100"}`,children:[D.flag,_&&T.jsx("span",{className:"text-[9px] text-primary-foreground/50 font-bold ml-0.5",children:D.shortCode})]})},D.langCode)}),T.jsx("div",{className:"h-[calc(50%-1.25rem)]"})]})})]})},kI=Math.PI*(3-Math.sqrt(5));function EI(a){const e=[];for(let t=0;t<a;t++){const n=Math.asin(1-2*t/(a-1)),i=kI*t;e.push({lat:n,lng:i})}return e}const xI=({nativeLangCode:a,targetLangCode:e,onSelectNative:t,onSelectTarget:n,onConfirm:i,onCancel:s,t:l,onInteract:c})=>{const h=In.find(j=>j.langCode===a)||null,d=In.find(j=>j.langCode===e)||null,[A,f]=x.useState(null),p=x.useRef(null),b=x.useRef(null),[w,S]=x.useState(0),[k,E]=x.useState({x:45,y:35}),[I,P]=x.useState(0),[R,D]=x.useState(0),N=x.useRef(!1),_=x.useRef({x:0,y:0}),K=x.useRef({lng:0,lat:0}),G=x.useRef(null),L=x.useMemo(()=>EI(In.length),[]);x.useEffect(()=>{const j=()=>{const te=new Date,ce=(te.getHours()+te.getMinutes()/60+te.getSeconds()/3600)/24*360;S(ce);const Ge=(ce-90)*(Math.PI/180),ae=18;E({x:50+ae*Math.cos(Ge),y:50+ae*Math.sin(Ge)})};j();const le=setInterval(j,3e4);return()=>clearInterval(le)},[]);const O=x.useMemo(()=>{const j=Math.cos(I),le=Math.sin(I),te=Math.cos(R),oe=Math.sin(R);return In.map((ce,Ge)=>{const{lat:ae,lng:Le}=L[Ge],De=Math.cos(ae)*Math.sin(Le),ue=Math.sin(ae),ne=Math.cos(ae)*Math.cos(Le),fe=De*j+ne*le,Te=ue,pe=-De*le+ne*j,ye=fe,Ie=Te*te-pe*oe,Re=Te*oe+pe*te,et=50+ye*42,Ye=50-Ie*42;return{lang:ce,screenX:et,screenY:Ye,depth:Re}})},[I,R,L]),q=x.useCallback(j=>{N.current=!0,_.current={x:j.clientX,y:j.clientY},K.current={lng:0,lat:0},G.current&&(cancelAnimationFrame(G.current),G.current=null),c(),j.target.setPointerCapture?.(j.pointerId)},[c]),$=x.useCallback(j=>{if(!N.current)return;const le=j.clientX-_.current.x,te=j.clientY-_.current.y;_.current={x:j.clientX,y:j.clientY};const oe=.006,ce=-le*oe,Ge=te*oe;K.current={lng:ce,lat:Ge},P(ae=>ae+ce),D(ae=>{const Le=ae+Ge;return Math.max(-Math.PI/2.2,Math.min(Math.PI/2.2,Le))})},[]),Q=x.useCallback(j=>{N.current=!1,j.target.releasePointerCapture?.(j.pointerId);const le=()=>{const te=K.current;Math.abs(te.lng)<3e-4&&Math.abs(te.lat)<3e-4||(K.current={lng:te.lng*.94,lat:te.lat*.94},P(oe=>oe+K.current.lng),D(oe=>{const ce=oe+K.current.lat;return Math.max(-Math.PI/2.2,Math.min(Math.PI/2.2,ce))}),G.current=requestAnimationFrame(le))};(Math.abs(K.current.lng)>5e-4||Math.abs(K.current.lat)>5e-4)&&(G.current=requestAnimationFrame(le))},[]),Z=x.useCallback(j=>{j.preventDefault(),c();const le=j.deltaY>0?.08:-.08;P(te=>te+le)},[c]);x.useEffect(()=>()=>{G.current&&cancelAnimationFrame(G.current)},[]);const F=j=>{c(),h?!d&&j.langCode!==h.langCode?n(j.langCode):j.langCode===h.langCode?t(null):j.langCode===d?.langCode?n(null):n(j.langCode):t(j.langCode)},U=x.useCallback((j,le)=>{const te=In.findIndex(oe=>oe.langCode===j.langCode);if(te!==-1){const{lat:oe,lng:ce}=L[te];P(-ce),D(-oe)}le?t(j.langCode):n(j.langCode)},[t,n,L]),Y=j=>{const le=O.find(te=>te.lang.langCode===j);return le?{x:le.screenX,y:le.screenY}:null},ge=h?Y(h.langCode):null,me=d?Y(d.langCode):null,z=x.useMemo(()=>!ge||!me?"":`M ${ge.x} ${ge.y} Q 50 50 ${me.x} ${me.y}`,[ge,me]),H=x.useMemo(()=>[...O].sort((j,le)=>j.depth-le.depth),[O]);return x.useEffect(()=>{if(!s)return;const j=te=>{b.current&&!b.current.contains(te.target)&&s()},le=setTimeout(()=>document.addEventListener("pointerdown",j,!0),100);return()=>{clearTimeout(le),document.removeEventListener("pointerdown",j,!0)}},[s]),T.jsxs("div",{ref:b,className:"w-full flex justify-center py-2",children:[T.jsx("style",{children:`
                @keyframes fly-in-bubble {
                    from { offset-distance: 0%; }
                    to { offset-distance: 100%; }
                }
                .animate-fly-in-bubble {
                    animation: fly-in-bubble 2.5s ease-in-out forwards;
                    offset-path: path(var(--flight-path));
                }
                .sphere-flag {
                    transition: opacity 0.12s ease-out;
                }
            `}),T.jsxs("div",{className:"glass-cube relative w-full max-w-[22rem] aspect-square",children:[T.jsxs("div",{className:"cube-front relative inset-0 w-full h-full overflow-hidden rounded-lg border border-white/10 z-10",children:[T.jsxs("div",{ref:p,className:"globe-bg absolute inset-0 border-2 rounded-full flex items-center justify-center text-white overflow-hidden shadow-inner touch-none isolate",style:{backgroundColor:"#0b3d66"},onPointerDown:q,onPointerMove:$,onPointerUp:Q,onPointerCancel:Q,onPointerLeave:()=>{N.current&&Q({})},onWheel:Z,children:[T.jsx("div",{className:"atmosphere-haze"}),T.jsx("div",{className:"style-harmonizer"}),T.jsx("div",{className:"rim-warmth"}),T.jsx("div",{className:"day-night-shade",style:{"--terminator-angle":`${w}deg`}}),T.jsx("div",{className:"sun-glint",style:{"--glint-x":`${k.x}%`,"--glint-y":`${k.y}%`}}),T.jsx("div",{className:"cloud-layer cloud-layer-far"}),T.jsx("div",{className:"cloud-layer cloud-layer-near"}),T.jsx("div",{className:"cloud-layer cloud-layer-highlights"}),T.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{zIndex:100,pointerEvents:"none"},children:T.jsx("div",{className:"w-[70%] max-w-[10rem] backdrop-blur-md px-3 py-2 transition-opacity duration-200 opacity-50 hover:opacity-100 focus-within:opacity-100 active:opacity-100 shadow-lg border border-white/10 sketchy-border-thin",style:{background:"rgba(12, 30, 48, 0.38)",pointerEvents:"auto",position:"relative",zIndex:100},children:T.jsxs("div",{className:"flex justify-center items-start gap-3",children:[T.jsx(qb,{languages:In,selectedValue:h,onSelect:j=>U(j,!0),onInteract:c,title:"",variant:"native"}),T.jsx("div",{className:"w-px h-24 bg-white/30 self-center"}),T.jsx(qb,{languages:In.filter(j=>j.langCode!==h?.langCode),selectedValue:d,onSelect:j=>U(j,!1),disabled:!h,onInteract:c,title:"",variant:"target"})]})})}),H.map(({lang:j,screenX:le,screenY:te,depth:oe})=>{if(oe<.05)return null;const ce=h?.langCode===j.langCode,Ge=d?.langCode===j.langCode,ae=td(j),Le=.45+oe*.75,De=.3+oe*.7,ue=Math.pow(oe,.6),ne=Math.floor(oe*20)+10;return T.jsxs("button",{className:"sphere-flag absolute flex flex-col items-center justify-center p-1 sketchy-border-thin",style:{top:`${te}%`,left:`${le}%`,transform:`translate(-50%, -50%) scale(${Le}) scaleX(${De/Le})`,opacity:ue,zIndex:ne},onClick:()=>F(j),onMouseEnter:()=>f(j),onMouseLeave:()=>f(null),title:j.displayName,children:[T.jsx("span",{className:`text-lg leading-none transition-transform duration-200 ${A?.langCode===j.langCode||ce||Ge?"scale-125":"scale-100"}`,children:j.flag}),ae&&T.jsx("span",{className:"text-[8px] font-bold text-white/90 leading-none mt-0.5 drop-shadow-sm",children:j.shortCode}),T.jsx("div",{className:`absolute -inset-1 border-2 transition-all duration-300 pointer-events-none sketchy-border-thin ${ce?"border-watercolor shadow-watercolor/50 shadow-lg":Ge?"border-green-400 shadow-green-400/50 shadow-lg":"border-transparent"}`})]},j.langCode)})]}),T.jsx("div",{className:"cube-inner-shadow pointer-events-none"}),T.jsx("div",{className:"cube-ice-scratches pointer-events-none"}),z&&T.jsxs("svg",{viewBox:"0 0 100 100",className:"absolute inset-0 w-full h-full overflow-visible pointer-events-none z-50",children:[T.jsx("path",{d:z,stroke:"rgba(255,255,255,0.3)",strokeWidth:"2",fill:"none",strokeDasharray:"5,5"}),T.jsx("g",{style:{"--flight-path":`"${z}"`},className:"animate-fly-in-bubble",children:T.jsx("text",{className:h&&d?"animate-pulse":"",fontSize:"10",dominantBaseline:"middle",textAnchor:"middle",children:""})})]},z)]}),T.jsx("div",{className:"cube-edge cube-edge-top pointer-events-none"}),T.jsx("div",{className:"cube-edge cube-edge-bottom pointer-events-none"}),T.jsx("div",{className:"cube-edge cube-edge-left pointer-events-none"}),T.jsx("div",{className:"cube-edge cube-edge-right pointer-events-none"})]}),T.jsx("style",{children:`
                /* Theme-safe ocean base */
                .globe-bg { background-color: #0b3d66; }

                /* Glass cube container */
                .glass-cube {
                    position: relative;
                    filter: drop-shadow(0 14px 22px rgba(0,0,0,0.35));
                    perspective: 900px;
                }
                .cube-front {
                    background:
                        radial-gradient(circle at 50% 35%, rgba(255,255,255,0.08) 0%, rgba(255,255,255,0.04) 40%, transparent 70%),
                        linear-gradient(180deg, rgba(20,40,60,0.32) 0%, rgba(12,24,36,0.36) 100%);
                    backdrop-filter: saturate(1.1) contrast(1.02);
                    box-shadow:
                        inset 0 1px 0 rgba(255,255,255,0.18),
                        inset 0 -10px 30px rgba(12,24,36,0.35);
                }
                .cube-inner-shadow {
                    position: absolute; inset: 0; border-radius: 0.75rem;
                    background: radial-gradient(closest-side, transparent 68%, rgba(0,0,0,0.25) 100%);
                    mix-blend-mode: multiply; opacity: 0.75;
                }
                .cube-ice-scratches {
                    position: absolute; inset: 0; border-radius: 0.75rem; opacity: 0.10;
                    background-image: repeating-linear-gradient(135deg, rgba(255,255,255,0.14) 0px, rgba(255,255,255,0.14) 1px, transparent 3px, transparent 7px);
                    mask-image: radial-gradient(circle at 50% 50%, black 45%, transparent 100%);
                }
                .cube-edge { position: absolute; }
                .cube-edge-top { top:-6px;left:10px;right:10px;height:14px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.35)0%,rgba(255,255,255,0.08)100%);transform:rotateX(25deg); }
                .cube-edge-bottom { bottom:-10px;left:10px;right:10px;height:18px;border-radius:12px;background:linear-gradient(0deg,rgba(12,24,36,0.45)0%,rgba(12,24,36,0.18)100%);transform:rotateX(-25deg); }
                .cube-edge-left { left:-8px;top:12px;bottom:12px;width:16px;border-radius:12px;background:linear-gradient(90deg,rgba(255,255,255,0.30)0%,rgba(255,255,255,0.08)100%);transform:rotateY(-25deg); }
                .cube-edge-right { right:-8px;top:12px;bottom:12px;width:16px;border-radius:12px;background:linear-gradient(270deg,rgba(255,255,255,0.30)0%,rgba(255,255,255,0.08)100%);transform:rotateY(25deg); }

                /* Atmosphere layers */
                @keyframes sun-glint-drift {
                    0% { transform:translate(-6%,-4%);opacity:0.35; }
                    50% { transform:translate(4%,2%);opacity:0.5; }
                    100% { transform:translate(-6%,-4%);opacity:0.35; }
                }
                @keyframes cloud-drift-far { 0%{transform:translateX(-10px)}100%{transform:translateX(10px)} }
                @keyframes cloud-drift-near { 0%{transform:translateX(12px)}100%{transform:translateX(-12px)} }

                .atmosphere-haze {
                    position:absolute;inset:-2%;border-radius:50%;pointer-events:none;
                    background:
                        radial-gradient(circle at 50% 45%,rgba(255,255,255,0.08)0%,rgba(255,255,255,0.03)45%,transparent 70%),
                        radial-gradient(circle at 50% 50%,transparent 60%,rgba(125,211,252,0.12)100%);
                    box-shadow:inset 0 0 30px rgba(255,255,255,0.08),0 0 18px rgba(125,211,252,0.18);
                }
                .style-harmonizer {
                    position:absolute;inset:0;border-radius:50%;pointer-events:none;
                    mix-blend-mode:soft-light;opacity:0.18;
                    background:
                        radial-gradient(circle at 50% 55%,rgba(14,65,110,0.20)0%,rgba(14,65,110,0.08)55%,transparent 70%),
                        linear-gradient(180deg,rgba(200,95,48,0.12)0%,rgba(0,0,0,0)40%);
                }
                .rim-warmth {
                    position:absolute;inset:-1%;border-radius:50%;pointer-events:none;
                    mix-blend-mode:soft-light;opacity:0.28;
                    background:radial-gradient(closest-side,transparent 70%,rgba(200,95,48,0.22)100%);
                }
                .day-night-shade {
                    position:absolute;inset:0;border-radius:50%;pointer-events:none;
                    background:linear-gradient(var(--terminator-angle,120deg),rgba(255,255,255,0.10)0%,rgba(255,255,255,0.03)30%,rgba(0,0,0,0.10)64%,rgba(0,0,0,0.18)100%);
                }
                .sun-glint {
                    position:absolute;inset:0;border-radius:50%;pointer-events:none;
                    background:radial-gradient(circle at var(--glint-x,28%) var(--glint-y,22%),rgba(255,255,255,0.26)0%,rgba(255,255,255,0.08)22%,transparent 45%);
                    animation:sun-glint-drift 48s ease-in-out infinite;
                }
                .cloud-layer {
                    position:absolute;inset:0;border-radius:50%;pointer-events:none;opacity:0.20;filter:blur(0.6px);
                }
                .cloud-layer-far {
                    background:
                        radial-gradient(ellipse 18% 9% at 24% 28%,rgba(255,255,255,0.54)0%,transparent 100%),
                        radial-gradient(ellipse 14% 7% at 66% 34%,rgba(255,255,255,0.46)0%,transparent 100%),
                        radial-gradient(ellipse 16% 8% at 52% 72%,rgba(255,255,255,0.40)0%,transparent 100%);
                    animation:cloud-drift-far 160s linear infinite alternate;
                }
                .cloud-layer-near {
                    background:
                        radial-gradient(ellipse 22% 10% at 36% 48%,rgba(255,255,255,0.46)0%,transparent 100%),
                        radial-gradient(ellipse 15% 8% at 74% 58%,rgba(255,255,255,0.40)0%,transparent 100%);
                    animation:cloud-drift-near 115s linear infinite alternate;
                }
                .cloud-layer-highlights {
                    opacity:0.14;mix-blend-mode:screen;
                    background:
                        radial-gradient(ellipse 16% 7% at 30% 40%,rgba(255,255,255,0.35)0%,transparent 100%),
                        radial-gradient(ellipse 13% 6% at 70% 55%,rgba(255,255,255,0.28)0%,transparent 100%),
                        radial-gradient(ellipse 18% 8% at 54% 72%,rgba(255,255,255,0.24)0%,transparent 100%);
                    animation:cloud-drift-far 145s linear infinite alternate;
                }

                @media (prefers-reduced-motion:reduce) {
                    .sun-glint,.cloud-layer-far,.cloud-layer-near,.cloud-layer-highlights { animation:none; }
                }
            `})]})},Cw="GeminiLanguageTutorDB",Sw=7,ri="chatHistories",ni="chatMetas",Kr="globalProfile",xo="appSettings",_i="appAssets",ma=()=>new Promise((a,e)=>{const t=indexedDB.open(Cw,Sw);t.onerror=()=>e(new Error("Error opening IndexedDB")),t.onsuccess=()=>a(t.result),t.onupgradeneeded=n=>{const i=n.target.result;i.objectStoreNames.contains(ri)||i.createObjectStore(ri,{keyPath:"pairId"}),i.objectStoreNames.contains(ni)||i.createObjectStore(ni,{keyPath:"pairId"}),i.objectStoreNames.contains(Kr)||i.createObjectStore(Kr,{keyPath:"key"}),i.objectStoreNames.contains(xo)||i.createObjectStore(xo,{keyPath:"key"}),i.objectStoreNames.contains(_i)||i.createObjectStore(_i,{keyPath:"key"})}});async function Gr(){const a=await ma();return new Promise((e,t)=>{const s=a.transaction(Kr,"readonly").objectStore(Kr).get("singleton");s.onerror=()=>t(new Error("Error reading global profile")),s.onsuccess=()=>e(s.result||null)})}async function Vf(a){const e=await ma(),t=(a||"").trim(),n=Math.random().toString(36),i={key:"singleton",text:t,updatedAt:Date.now(),fingerprint:n};return new Promise((s,l)=>{const d=e.transaction(Kr,"readwrite").objectStore(Kr).put(i);d.onerror=()=>l(new Error("Error saving global profile")),d.onsuccess=()=>s()})}const PI="loadingGifs",jf="maestroProfileImage";async function MI(){const a=await ma();return new Promise(e=>{const i=a.transaction(_i,"readwrite").objectStore(_i).delete(PI);i.onerror=()=>e(),i.onsuccess=()=>e()})}async function Wl(){const a=await ma();return new Promise((e,t)=>{const s=a.transaction(_i,"readonly").objectStore(_i).get(jf);s.onerror=()=>t(new Error("Error reading maestro profile from DB")),s.onsuccess=()=>e(s.result?s.result.value:null)})}async function Po(a){const e=await ma(),t={...a||{},updatedAt:Date.now()};return new Promise((n,i)=>{const c=e.transaction(_i,"readwrite").objectStore(_i).put({key:jf,value:t});c.onerror=()=>i(new Error("Error saving maestro profile to DB")),c.onsuccess=()=>n()})}async function II(){const a=await ma();return new Promise((e,t)=>{const s=a.transaction(_i,"readwrite").objectStore(_i).delete(jf);s.onerror=()=>t(new Error("Error clearing maestro profile from DB")),s.onsuccess=()=>e()})}class DI{logs=[];listeners=new Set;subscribe(e){return this.listeners.add(e),e([...this.logs]),()=>this.listeners.delete(e)}notify(){const e=[...this.logs];this.listeners.forEach(t=>t(e))}logRequest(e,t,n){const i=Math.random().toString(36).substring(7),s=Date.now();let l=n;try{l=JSON.parse(JSON.stringify(n))}catch{l="[Unserializable Payload]"}const c={id:i,timestamp:s,type:e,model:t,request:l};return this.logs=[c,...this.logs].slice(0,50),this.notify(),{complete:h=>{const d=Date.now()-s;this.updateEntry(i,{response:h,duration:d})},error:h=>{const d=Date.now()-s,A=h instanceof Error?{...h,name:h.name,message:h.message,stack:h.stack}:h;this.updateEntry(i,{error:A,duration:d})}}}updateEntry(e,t){this.logs=this.logs.map(n=>n.id===e?{...n,...t}:n),this.notify()}clear(){this.logs=[],this.notify()}}const si=new DI,_I=({onClose:a})=>{const[e,t]=x.useState([]),[n,i]=x.useState(null);x.useEffect(()=>si.subscribe(c=>{t(c)}),[]);const s=()=>{si.clear()},l=c=>{i(n===c?null:c)};return T.jsxs("div",{className:"fixed inset-y-0 right-0 w-full sm:w-[480px] bg-primary shadow-2xl z-[100] flex flex-col border-l border-border font-mono text-sm",children:[T.jsxs("div",{className:"flex items-center justify-between px-4 pb-3 bg-primary/90 border-b border-border",style:{paddingTop:"calc(0.75rem + env(safe-area-inset-top))"},children:[T.jsxs("h2",{className:"text-primary-foreground font-semibold flex items-center gap-2",children:[T.jsx("span",{className:"text-green-400",children:""})," Traffic Log"]}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("button",{onClick:s,className:"p-1.5 text-muted-foreground hover:text-eraser hover:bg-primary/70 rounded transition-colors",title:"Clear logs",children:T.jsx(yd,{className:"w-4 h-4"})}),T.jsx("button",{onClick:a,className:"p-1.5 text-muted-foreground hover:text-primary-foreground hover:bg-primary/70 rounded transition-colors",title:"Close",children:T.jsx(Pi,{className:"w-5 h-5"})})]})]}),T.jsxs("div",{className:"flex-1 overflow-y-auto p-2 space-y-2 bg-primary",children:[e.length===0&&T.jsx("div",{className:"text-muted-foreground text-center py-10 italic",children:"No traffic recorded yet."}),e.map(c=>{const h=n===c.id,d=!!c.error,A=c.duration?`${c.duration}ms`:"pending...",f=new Date(c.timestamp).toLocaleTimeString([],{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"});return T.jsxs("div",{className:`rounded border ${d?"border-red-800 bg-red-900/10":"border-border bg-primary/70"} overflow-hidden transition-colors`,children:[T.jsxs("div",{className:"px-3 py-2 cursor-pointer flex items-center justify-between hover:bg-white/5 select-none",onClick:()=>l(c.id),children:[T.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[T.jsx("span",{className:`text-xs ${d?"text-red-400":"text-muted-foreground"}`,children:f}),T.jsx("span",{className:`font-semibold truncate ${d?"text-red-300":"text-watercolor"}`,children:c.type}),T.jsxs("span",{className:"text-xs text-muted-foreground truncate hidden sm:inline-block",children:["- ",c.model]})]}),T.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[T.jsx("span",{className:`${d?"text-red-400":"text-green-400"}`,children:A}),T.jsx("span",{className:"text-muted-foreground",children:h?"":""})]})]}),h&&T.jsxs("div",{className:"border-t border-border/50",children:[T.jsxs("div",{className:"bg-black/20 p-2",children:[T.jsx("div",{className:"text-xs text-muted-foreground uppercase font-bold mb-1 px-1",children:"Request Payload"}),T.jsx("pre",{className:"text-xs text-primary-foreground/70 overflow-x-auto whitespace-pre-wrap break-all bg-black/20 p-2 rounded max-h-60 overflow-y-auto custom-scrollbar",children:JSON.stringify(c.request,null,2)})]}),(c.response||c.error)&&T.jsxs("div",{className:"bg-black/10 p-2 border-t border-border/30",children:[T.jsx("div",{className:`text-xs uppercase font-bold mb-1 px-1 ${d?"text-red-400":"text-green-400"}`,children:d?"Error":"Response"}),T.jsx("pre",{className:`text-xs overflow-x-auto whitespace-pre-wrap break-all bg-black/20 p-2 rounded max-h-60 overflow-y-auto custom-scrollbar ${d?"text-red-300":"text-green-300"}`,children:JSON.stringify(c.error||c.response,null,2)})]})]})]},c.id)})]})]})};var RI={};let NI,GI;function LI(){return{geminiUrl:NI,vertexUrl:GI}}function BI(a,e,t,n){var i,s;if(!a?.baseUrl){const l=LI();return e?(i=l.vertexUrl)!==null&&i!==void 0?i:t:(s=l.geminiUrl)!==null&&s!==void 0?s:n}return a.baseUrl}class sr{}function $e(a,e){const t=/\{([^}]+)\}/g;return a.replace(t,(n,i)=>{if(Object.prototype.hasOwnProperty.call(e,i)){const s=e[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function v(a,e,t){for(let s=0;s<e.length-1;s++){const l=e[s];if(l.endsWith("[]")){const c=l.slice(0,-2);if(!(c in a))if(Array.isArray(t))a[c]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${l}`);if(Array.isArray(a[c])){const h=a[c];if(Array.isArray(t))for(let d=0;d<h.length;d++){const A=h[d];v(A,e.slice(s+1),t[d])}else for(const d of h)v(d,e.slice(s+1),t)}return}else if(l.endsWith("[0]")){const c=l.slice(0,-3);c in a||(a[c]=[{}]);const h=a[c];v(h[0],e.slice(s+1),t);return}(!a[l]||typeof a[l]!="object")&&(a[l]={}),a=a[l]}const n=e[e.length-1],i=a[n];if(i!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===i)return;if(typeof i=="object"&&typeof t=="object"&&i!==null&&t!==null)Object.assign(i,t);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else n==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(a,t):a[n]=t}function m(a,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return a;for(let n=0;n<e.length;n++){if(typeof a!="object"||a===null)return t;const i=e[n];if(i.endsWith("[]")){const s=i.slice(0,-2);if(s in a){const l=a[s];return Array.isArray(l)?l.map(c=>m(c,e.slice(n+1),t)):t}else return t}else a=a[i]}return a}catch(n){if(n instanceof TypeError)return t;throw n}}function FI(a,e){for(const[t,n]of Object.entries(e)){const i=t.split("."),s=n.split("."),l=new Set;let c=-1;for(let h=0;h<i.length;h++)if(i[h]==="*"){c=h;break}if(c!==-1&&s.length>c)for(let h=c;h<s.length;h++){const d=s[h];d!=="*"&&!d.endsWith("[]")&&!d.endsWith("[0]")&&l.add(d)}Yg(a,i,s,0,l)}}function Yg(a,e,t,n,i){if(n>=e.length||typeof a!="object"||a===null)return;const s=e[n];if(s.endsWith("[]")){const l=s.slice(0,-2),c=a;if(l in c&&Array.isArray(c[l]))for(const h of c[l])Yg(h,e,t,n+1,i)}else if(s==="*"){if(typeof a=="object"&&a!==null&&!Array.isArray(a)){const l=a,c=Object.keys(l).filter(d=>!d.startsWith("_")&&!i.has(d)),h={};for(const d of c)h[d]=l[d];for(const[d,A]of Object.entries(h)){const f=[];for(const p of t.slice(n))p==="*"?f.push(d):f.push(p);v(l,f,A)}for(const d of c)delete l[d]}}else{const l=a;s in l&&Yg(l[s],e,t,n+1,i)}}function Qf(a){if(typeof a!="string")throw new Error("fromImageBytes must be a string");return a}function UI(a){const e={},t=m(a,["operationName"]);t!=null&&v(e,["operationName"],t);const n=m(a,["resourceName"]);return n!=null&&v(e,["_url","resourceName"],n),e}function KI(a){const e={},t=m(a,["name"]);t!=null&&v(e,["name"],t);const n=m(a,["metadata"]);n!=null&&v(e,["metadata"],n);const i=m(a,["done"]);i!=null&&v(e,["done"],i);const s=m(a,["error"]);s!=null&&v(e,["error"],s);const l=m(a,["response","generateVideoResponse"]);return l!=null&&v(e,["response"],OI(l)),e}function zI(a){const e={},t=m(a,["name"]);t!=null&&v(e,["name"],t);const n=m(a,["metadata"]);n!=null&&v(e,["metadata"],n);const i=m(a,["done"]);i!=null&&v(e,["done"],i);const s=m(a,["error"]);s!=null&&v(e,["error"],s);const l=m(a,["response"]);return l!=null&&v(e,["response"],HI(l)),e}function OI(a){const e={},t=m(a,["generatedSamples"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(l=>VI(l))),v(e,["generatedVideos"],s)}const n=m(a,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const i=m(a,["raiMediaFilteredReasons"]);return i!=null&&v(e,["raiMediaFilteredReasons"],i),e}function HI(a){const e={},t=m(a,["videos"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(l=>jI(l))),v(e,["generatedVideos"],s)}const n=m(a,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const i=m(a,["raiMediaFilteredReasons"]);return i!=null&&v(e,["raiMediaFilteredReasons"],i),e}function VI(a){const e={},t=m(a,["video"]);return t!=null&&v(e,["video"],$I(t)),e}function jI(a){const e={},t=m(a,["_self"]);return t!=null&&v(e,["video"],JI(t)),e}function QI(a){const e={},t=m(a,["operationName"]);return t!=null&&v(e,["_url","operationName"],t),e}function qI(a){const e={},t=m(a,["operationName"]);return t!=null&&v(e,["_url","operationName"],t),e}function YI(a){const e={},t=m(a,["name"]);t!=null&&v(e,["name"],t);const n=m(a,["metadata"]);n!=null&&v(e,["metadata"],n);const i=m(a,["done"]);i!=null&&v(e,["done"],i);const s=m(a,["error"]);s!=null&&v(e,["error"],s);const l=m(a,["response"]);return l!=null&&v(e,["response"],XI(l)),e}function XI(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["parent"]);n!=null&&v(e,["parent"],n);const i=m(a,["documentName"]);return i!=null&&v(e,["documentName"],i),e}function ww(a){const e={},t=m(a,["name"]);t!=null&&v(e,["name"],t);const n=m(a,["metadata"]);n!=null&&v(e,["metadata"],n);const i=m(a,["done"]);i!=null&&v(e,["done"],i);const s=m(a,["error"]);s!=null&&v(e,["error"],s);const l=m(a,["response"]);return l!=null&&v(e,["response"],WI(l)),e}function WI(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["parent"]);n!=null&&v(e,["parent"],n);const i=m(a,["documentName"]);return i!=null&&v(e,["documentName"],i),e}function $I(a){const e={},t=m(a,["uri"]);t!=null&&v(e,["uri"],t);const n=m(a,["encodedVideo"]);n!=null&&v(e,["videoBytes"],Qf(n));const i=m(a,["encoding"]);return i!=null&&v(e,["mimeType"],i),e}function JI(a){const e={},t=m(a,["gcsUri"]);t!=null&&v(e,["uri"],t);const n=m(a,["bytesBase64Encoded"]);n!=null&&v(e,["videoBytes"],Qf(n));const i=m(a,["mimeType"]);return i!=null&&v(e,["mimeType"],i),e}var Yb;(function(a){a.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",a.OUTCOME_OK="OUTCOME_OK",a.OUTCOME_FAILED="OUTCOME_FAILED",a.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Yb||(Yb={}));var Xb;(function(a){a.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",a.PYTHON="PYTHON"})(Xb||(Xb={}));var Wb;(function(a){a.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",a.SILENT="SILENT",a.WHEN_IDLE="WHEN_IDLE",a.INTERRUPT="INTERRUPT"})(Wb||(Wb={}));var Lr;(function(a){a.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",a.STRING="STRING",a.NUMBER="NUMBER",a.INTEGER="INTEGER",a.BOOLEAN="BOOLEAN",a.ARRAY="ARRAY",a.OBJECT="OBJECT",a.NULL="NULL"})(Lr||(Lr={}));var $b;(function(a){a.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",a.SIMPLE_SEARCH="SIMPLE_SEARCH",a.ELASTIC_SEARCH="ELASTIC_SEARCH"})($b||($b={}));var Jb;(function(a){a.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",a.NO_AUTH="NO_AUTH",a.API_KEY_AUTH="API_KEY_AUTH",a.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",a.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",a.OAUTH="OAUTH",a.OIDC_AUTH="OIDC_AUTH"})(Jb||(Jb={}));var Zb;(function(a){a.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",a.HTTP_IN_QUERY="HTTP_IN_QUERY",a.HTTP_IN_HEADER="HTTP_IN_HEADER",a.HTTP_IN_PATH="HTTP_IN_PATH",a.HTTP_IN_BODY="HTTP_IN_BODY",a.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Zb||(Zb={}));var e0;(function(a){a.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",a.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",a.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",a.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",a.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",a.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",a.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(e0||(e0={}));var t0;(function(a){a.UNSPECIFIED="UNSPECIFIED",a.BLOCKING="BLOCKING",a.NON_BLOCKING="NON_BLOCKING"})(t0||(t0={}));var n0;(function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.MODE_DYNAMIC="MODE_DYNAMIC"})(n0||(n0={}));var a0;(function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.AUTO="AUTO",a.ANY="ANY",a.NONE="NONE",a.VALIDATED="VALIDATED"})(a0||(a0={}));var i0;(function(a){a.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",a.LOW="LOW",a.MEDIUM="MEDIUM",a.HIGH="HIGH",a.MINIMAL="MINIMAL"})(i0||(i0={}));var r0;(function(a){a.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",a.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",a.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",a.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",a.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",a.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",a.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",a.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",a.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",a.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",a.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(r0||(r0={}));var s0;(function(a){a.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",a.SEVERITY="SEVERITY",a.PROBABILITY="PROBABILITY"})(s0||(s0={}));var o0;(function(a){a.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",a.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",a.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",a.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",a.BLOCK_NONE="BLOCK_NONE",a.OFF="OFF"})(o0||(o0={}));var l0;(function(a){a.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",a.STOP="STOP",a.MAX_TOKENS="MAX_TOKENS",a.SAFETY="SAFETY",a.RECITATION="RECITATION",a.LANGUAGE="LANGUAGE",a.OTHER="OTHER",a.BLOCKLIST="BLOCKLIST",a.PROHIBITED_CONTENT="PROHIBITED_CONTENT",a.SPII="SPII",a.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",a.IMAGE_SAFETY="IMAGE_SAFETY",a.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",a.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",a.NO_IMAGE="NO_IMAGE",a.IMAGE_RECITATION="IMAGE_RECITATION",a.IMAGE_OTHER="IMAGE_OTHER"})(l0||(l0={}));var c0;(function(a){a.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",a.NEGLIGIBLE="NEGLIGIBLE",a.LOW="LOW",a.MEDIUM="MEDIUM",a.HIGH="HIGH"})(c0||(c0={}));var u0;(function(a){a.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",a.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",a.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",a.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",a.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(u0||(u0={}));var d0;(function(a){a.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",a.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",a.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",a.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",a.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(d0||(d0={}));var h0;(function(a){a.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",a.SAFETY="SAFETY",a.OTHER="OTHER",a.BLOCKLIST="BLOCKLIST",a.PROHIBITED_CONTENT="PROHIBITED_CONTENT",a.IMAGE_SAFETY="IMAGE_SAFETY",a.MODEL_ARMOR="MODEL_ARMOR",a.JAILBREAK="JAILBREAK"})(h0||(h0={}));var A0;(function(a){a.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",a.ON_DEMAND="ON_DEMAND",a.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(A0||(A0={}));var ar;(function(a){a.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",a.TEXT="TEXT",a.IMAGE="IMAGE",a.AUDIO="AUDIO"})(ar||(ar={}));var g0;(function(a){a.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",a.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",a.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",a.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(g0||(g0={}));var f0;(function(a){a.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",a.TUNING_MODE_FULL="TUNING_MODE_FULL",a.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(f0||(f0={}));var p0;(function(a){a.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",a.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",a.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",a.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",a.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",a.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",a.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(p0||(p0={}));var Xg;(function(a){a.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",a.JOB_STATE_QUEUED="JOB_STATE_QUEUED",a.JOB_STATE_PENDING="JOB_STATE_PENDING",a.JOB_STATE_RUNNING="JOB_STATE_RUNNING",a.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",a.JOB_STATE_FAILED="JOB_STATE_FAILED",a.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",a.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",a.JOB_STATE_PAUSED="JOB_STATE_PAUSED",a.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",a.JOB_STATE_UPDATING="JOB_STATE_UPDATING",a.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Xg||(Xg={}));var m0;(function(a){a.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",a.TUNING_TASK_I2V="TUNING_TASK_I2V",a.TUNING_TASK_T2V="TUNING_TASK_T2V",a.TUNING_TASK_R2V="TUNING_TASK_R2V"})(m0||(m0={}));var v0;(function(a){a.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",a.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",a.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",a.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",a.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(v0||(v0={}));var y0;(function(a){a.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",a.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",a.BALANCED="BALANCED",a.PRIORITIZE_COST="PRIORITIZE_COST"})(y0||(y0={}));var b0;(function(a){a.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",a.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(b0||(b0={}));var C0;(function(a){a.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",a.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",a.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",a.BLOCK_NONE="BLOCK_NONE"})(C0||(C0={}));var S0;(function(a){a.DONT_ALLOW="DONT_ALLOW",a.ALLOW_ADULT="ALLOW_ADULT",a.ALLOW_ALL="ALLOW_ALL"})(S0||(S0={}));var w0;(function(a){a.auto="auto",a.en="en",a.ja="ja",a.ko="ko",a.hi="hi",a.zh="zh",a.pt="pt",a.es="es"})(w0||(w0={}));var T0;(function(a){a.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",a.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",a.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",a.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",a.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(T0||(T0={}));var k0;(function(a){a.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",a.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",a.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",a.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(k0||(k0={}));var E0;(function(a){a.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",a.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",a.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",a.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(E0||(E0={}));var x0;(function(a){a.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",a.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",a.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",a.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",a.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",a.EDIT_MODE_STYLE="EDIT_MODE_STYLE",a.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",a.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(x0||(x0={}));var P0;(function(a){a.FOREGROUND="FOREGROUND",a.BACKGROUND="BACKGROUND",a.PROMPT="PROMPT",a.SEMANTIC="SEMANTIC",a.INTERACTIVE="INTERACTIVE"})(P0||(P0={}));var M0;(function(a){a.ASSET="ASSET",a.STYLE="STYLE"})(M0||(M0={}));var I0;(function(a){a.INSERT="INSERT",a.REMOVE="REMOVE",a.REMOVE_STATIC="REMOVE_STATIC",a.OUTPAINT="OUTPAINT"})(I0||(I0={}));var D0;(function(a){a.OPTIMIZED="OPTIMIZED",a.LOSSLESS="LOSSLESS"})(D0||(D0={}));var _0;(function(a){a.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",a.PREFERENCE_TUNING="PREFERENCE_TUNING"})(_0||(_0={}));var R0;(function(a){a.STATE_UNSPECIFIED="STATE_UNSPECIFIED",a.STATE_PENDING="STATE_PENDING",a.STATE_ACTIVE="STATE_ACTIVE",a.STATE_FAILED="STATE_FAILED"})(R0||(R0={}));var N0;(function(a){a.STATE_UNSPECIFIED="STATE_UNSPECIFIED",a.PROCESSING="PROCESSING",a.ACTIVE="ACTIVE",a.FAILED="FAILED"})(N0||(N0={}));var G0;(function(a){a.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",a.UPLOADED="UPLOADED",a.GENERATED="GENERATED",a.REGISTERED="REGISTERED"})(G0||(G0={}));var L0;(function(a){a.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",a.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",a.RESPONSE_REJECTED="RESPONSE_REJECTED",a.NEED_MORE_INPUT="NEED_MORE_INPUT"})(L0||(L0={}));var B0;(function(a){a.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",a.TEXT="TEXT",a.IMAGE="IMAGE",a.VIDEO="VIDEO",a.AUDIO="AUDIO",a.DOCUMENT="DOCUMENT"})(B0||(B0={}));var F0;(function(a){a.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",a.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",a.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(F0||(F0={}));var U0;(function(a){a.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",a.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",a.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(U0||(U0={}));var K0;(function(a){a.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",a.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",a.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(K0||(K0={}));var z0;(function(a){a.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",a.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",a.NO_INTERRUPTION="NO_INTERRUPTION"})(z0||(z0={}));var O0;(function(a){a.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",a.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",a.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(O0||(O0={}));var H0;(function(a){a.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",a.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",a.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",a.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",a.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",a.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",a.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",a.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",a.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",a.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",a.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",a.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",a.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(H0||(H0={}));var V0;(function(a){a.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",a.QUALITY="QUALITY",a.DIVERSITY="DIVERSITY",a.VOCALIZATION="VOCALIZATION"})(V0||(V0={}));var Ao;(function(a){a.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",a.PLAY="PLAY",a.PAUSE="PAUSE",a.STOP="STOP",a.RESET_CONTEXT="RESET_CONTEXT"})(Ao||(Ao={}));class Wg{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Dl{get text(){var e,t,n,i,s,l,c,h;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",A=!1;const f=[];for(const p of(h=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&h!==void 0?h:[]){for(const[b,w]of Object.entries(p))b!=="text"&&b!=="thought"&&b!=="thoughtSignature"&&(w!==null||w!==void 0)&&f.push(b);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;A=!0,d+=p.text}}return f.length>0&&console.warn(`there are non-text parts ${f} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),A?d:void 0}get data(){var e,t,n,i,s,l,c,h;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const A=[];for(const f of(h=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)!==null&&h!==void 0?h:[]){for(const[p,b]of Object.entries(f))p!=="inlineData"&&(b!==null||b!==void 0)&&A.push(p);f.inlineData&&typeof f.inlineData.data=="string"&&(d+=atob(f.inlineData.data))}return A.length>0&&console.warn(`there are non-data parts ${A} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,t,n,i,s,l,c,h;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(h=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(A=>A.functionCall).map(A=>A.functionCall).filter(A=>A!==void 0);if(d?.length!==0)return d}get executableCode(){var e,t,n,i,s,l,c,h,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const A=(h=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(f=>f.executableCode).map(f=>f.executableCode).filter(f=>f!==void 0);if(A?.length!==0)return(d=A?.[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,t,n,i,s,l,c,h,d;if(((i=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const A=(h=(c=(l=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content)===null||c===void 0?void 0:c.parts)===null||h===void 0?void 0:h.filter(f=>f.codeExecutionResult).map(f=>f.codeExecutionResult).filter(f=>f!==void 0);if(A?.length!==0)return(d=A?.[0])===null||d===void 0?void 0:d.output}}class j0{}class Q0{}class ZI{}class e1{}class t1{}class n1{}class q0{}class Y0{}class X0{}class a1{}class nd{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new nd;let i;const s=e;return t?i=zI(s):i=KI(s),Object.assign(n,i),n}}class W0{}class $0{}class J0{}class Z0{}class i1{}class r1{}class s1{}class qf{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new qf,s=YI(e);return Object.assign(n,s),n}}class o1{}class l1{}class c1{}class eC{}class u1{get text(){var e,t,n;let i="",s=!1;const l=[];for(const c of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[h,d]of Object.entries(c))h!=="text"&&h!=="thought"&&d!==null&&l.push(h);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;s=!0,i+=c.text}}return l.length>0&&console.warn(`there are non-text parts ${l} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var e,t,n;let i="";const s=[];for(const l of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[c,h]of Object.entries(l))c!=="inlineData"&&h!==null&&s.push(c);l.inlineData&&typeof l.inlineData.data=="string"&&(i+=atob(l.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class d1{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class Yf{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new Yf,s=ww(e);return Object.assign(n,s),n}}function en(a,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(a.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function Tw(a,e){const t=en(a,e);return t?t.startsWith("publishers/")&&a.isVertexAI()?`projects/${a.getProject()}/locations/${a.getLocation()}/${t}`:t.startsWith("models/")&&a.isVertexAI()?`projects/${a.getProject()}/locations/${a.getLocation()}/publishers/google/${t}`:t:""}function kw(a){return Array.isArray(a)?a.map(e=>ad(e)):[ad(a)]}function ad(a){if(typeof a=="object"&&a!==null)return a;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof a}`)}function Ew(a){const e=ad(a);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function xw(a){const e=ad(a);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function tC(a){if(a==null)throw new Error("PartUnion is required");if(typeof a=="object")return a;if(typeof a=="string")return{text:a};throw new Error(`Unsupported part type: ${typeof a}`)}function Pw(a){if(a==null||Array.isArray(a)&&a.length===0)throw new Error("PartListUnion is required");return Array.isArray(a)?a.map(e=>tC(e)):[tC(a)]}function $g(a){return a!=null&&typeof a=="object"&&"parts"in a&&Array.isArray(a.parts)}function nC(a){return a!=null&&typeof a=="object"&&"functionCall"in a}function aC(a){return a!=null&&typeof a=="object"&&"functionResponse"in a}function pa(a){if(a==null)throw new Error("ContentUnion is required");return $g(a)?a:{role:"user",parts:Pw(a)}}function Xf(a,e){if(!e)return[];if(a.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const n=pa(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(a.isVertexAI()){const t=pa(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>pa(t)):[pa(e)]}function ai(a){if(a==null||Array.isArray(a)&&a.length===0)throw new Error("contents are required");if(!Array.isArray(a)){if(nC(a)||aC(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[pa(a)]}const e=[],t=[],n=$g(a[0]);for(const i of a){const s=$g(i);if(s!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(i);else{if(nC(i)||aC(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(i)}}return n||e.push({role:"user",parts:Pw(t)}),e}function h1(a,e){a.includes("null")&&(e.nullable=!0);const t=a.filter(n=>n!=="null");if(t.length===1)e.type=Object.values(Lr).includes(t[0].toUpperCase())?t[0].toUpperCase():Lr.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const n of t)e.anyOf.push({type:Object.values(Lr).includes(n.toUpperCase())?n.toUpperCase():Lr.TYPE_UNSPECIFIED})}}function wo(a){const e={},t=["items"],n=["anyOf"],i=["properties"];if(a.type&&a.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=a.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,a=s[1]):s[1].type==="null"&&(e.nullable=!0,a=s[0])),a.type instanceof Array&&h1(a.type,e);for(const[l,c]of Object.entries(a))if(c!=null)if(l=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(Lr).includes(c.toUpperCase())?c.toUpperCase():Lr.TYPE_UNSPECIFIED}else if(t.includes(l))e[l]=wo(c);else if(n.includes(l)){const h=[];for(const d of c){if(d.type=="null"){e.nullable=!0;continue}h.push(wo(d))}e[l]=h}else if(i.includes(l)){const h={};for(const[d,A]of Object.entries(c))h[d]=wo(A);e[l]=h}else{if(l==="additionalProperties")continue;e[l]=c}return e}function Wf(a){return wo(a)}function $f(a){if(typeof a=="object")return a;if(typeof a=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:a}}};throw new Error(`Unsupported speechConfig type: ${typeof a}`)}function Jf(a){if("multiSpeakerVoiceConfig"in a)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return a}function No(a){if(a.functionDeclarations)for(const e of a.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=wo(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=wo(e.response));return a}function Go(a){if(a==null)throw new Error("tools is required");if(!Array.isArray(a))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of a)e.push(t);return e}function A1(a,e,t,n=1){const i=!e.startsWith(`${t}/`)&&e.split("/").length===n;return a.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${a.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${a.getProject()}/locations/${a.getLocation()}/${e}`:i?`projects/${a.getProject()}/locations/${a.getLocation()}/${t}/${e}`:e:i?`${t}/${e}`:e}function or(a,e){if(typeof e!="string")throw new Error("name must be a string");return A1(a,e,"cachedContents")}function Mw(a){switch(a){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return a}}function zr(a){return Qf(a)}function g1(a){return a!=null&&typeof a=="object"&&"name"in a}function f1(a){return a!=null&&typeof a=="object"&&"video"in a}function p1(a){return a!=null&&typeof a=="object"&&"uri"in a}function Iw(a){var e;let t;if(g1(a)&&(t=a.name),!(p1(a)&&(t=a.uri,t===void 0))&&!(f1(a)&&(t=(e=a.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof a=="string"&&(t=a),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const i=t.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${t}`);t=i[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function Dw(a,e){let t;return a.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function _w(a){for(const e of["models","tunedModels","publisherModels"])if(m1(a,e))return a[e];return[]}function m1(a,e){return a!==null&&typeof a=="object"&&e in a}function v1(a,e={}){const t=a,n={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(n.responseJsonSchema=t.outputSchema),e.behavior&&(n.behavior=e.behavior),{functionDeclarations:[n]}}function y1(a,e={}){const t=[],n=new Set;for(const i of a){const s=i.name;if(n.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);n.add(s);const l=v1(i,e);l.functionDeclarations&&t.push(...l.functionDeclarations)}return{functionDeclarations:t}}function Rw(a,e){let t;if(typeof e=="string")if(a.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(a.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const n=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,i=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(a.isVertexAI()){if(i>0||n!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||i!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function b1(a){if(typeof a!="string")return a;const e=a;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Nw(a){if(typeof a!="object"||a===null)return{};const e=a,t=e.inlinedResponses;if(typeof t!="object"||t===null)return a;const i=t.inlinedResponses;if(!Array.isArray(i)||i.length===0)return a;let s=!1;for(const l of i){if(typeof l!="object"||l===null)continue;const h=l.response;if(typeof h!="object"||h===null)continue;if(h.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),a}function Lo(a,e){const t=e;if(!a.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function Gw(a){const e=a;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}function C1(a){const e={},t=m(a,["responsesFile"]);t!=null&&v(e,["fileName"],t);const n=m(a,["inlinedResponses","inlinedResponses"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>tD(l))),v(e,["inlinedResponses"],s)}const i=m(a,["inlinedEmbedContentResponses","inlinedResponses"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>l)),v(e,["inlinedEmbedContentResponses"],s)}return e}function S1(a){const e={},t=m(a,["predictionsFormat"]);t!=null&&v(e,["format"],t);const n=m(a,["gcsDestination","outputUriPrefix"]);n!=null&&v(e,["gcsUri"],n);const i=m(a,["bigqueryDestination","outputUri"]);return i!=null&&v(e,["bigqueryUri"],i),e}function w1(a){const e={},t=m(a,["format"]);t!=null&&v(e,["predictionsFormat"],t);const n=m(a,["gcsUri"]);n!=null&&v(e,["gcsDestination","outputUriPrefix"],n);const i=m(a,["bigqueryUri"]);if(i!=null&&v(e,["bigqueryDestination","outputUri"],i),m(a,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(a,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(m(a,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Ku(a){const e={},t=m(a,["name"]);t!=null&&v(e,["name"],t);const n=m(a,["metadata","displayName"]);n!=null&&v(e,["displayName"],n);const i=m(a,["metadata","state"]);i!=null&&v(e,["state"],Gw(i));const s=m(a,["metadata","createTime"]);s!=null&&v(e,["createTime"],s);const l=m(a,["metadata","endTime"]);l!=null&&v(e,["endTime"],l);const c=m(a,["metadata","updateTime"]);c!=null&&v(e,["updateTime"],c);const h=m(a,["metadata","model"]);h!=null&&v(e,["model"],h);const d=m(a,["metadata","output"]);return d!=null&&v(e,["dest"],C1(Nw(d))),e}function Jg(a){const e={},t=m(a,["name"]);t!=null&&v(e,["name"],t);const n=m(a,["displayName"]);n!=null&&v(e,["displayName"],n);const i=m(a,["state"]);i!=null&&v(e,["state"],Gw(i));const s=m(a,["error"]);s!=null&&v(e,["error"],s);const l=m(a,["createTime"]);l!=null&&v(e,["createTime"],l);const c=m(a,["startTime"]);c!=null&&v(e,["startTime"],c);const h=m(a,["endTime"]);h!=null&&v(e,["endTime"],h);const d=m(a,["updateTime"]);d!=null&&v(e,["updateTime"],d);const A=m(a,["model"]);A!=null&&v(e,["model"],A);const f=m(a,["inputConfig"]);f!=null&&v(e,["src"],T1(f));const p=m(a,["outputConfig"]);p!=null&&v(e,["dest"],S1(Nw(p)));const b=m(a,["completionStats"]);return b!=null&&v(e,["completionStats"],b),e}function T1(a){const e={},t=m(a,["instancesFormat"]);t!=null&&v(e,["format"],t);const n=m(a,["gcsSource","uris"]);n!=null&&v(e,["gcsUri"],n);const i=m(a,["bigquerySource","inputUri"]);return i!=null&&v(e,["bigqueryUri"],i),e}function k1(a,e){const t={};if(m(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(m(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=m(e,["fileName"]);n!=null&&v(t,["fileName"],n);const i=m(e,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>eD(a,l))),v(t,["requests","requests"],s)}return t}function E1(a){const e={},t=m(a,["format"]);t!=null&&v(e,["instancesFormat"],t);const n=m(a,["gcsUri"]);n!=null&&v(e,["gcsSource","uris"],n);const i=m(a,["bigqueryUri"]);if(i!=null&&v(e,["bigquerySource","inputUri"],i),m(a,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(a,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function x1(a){const e={},t=m(a,["data"]);if(t!=null&&v(e,["data"],t),m(a,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(a,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function P1(a,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],Lo(a,n)),t}function M1(a,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],Lo(a,n)),t}function I1(a){const e={},t=m(a,["content"]);t!=null&&v(e,["content"],t);const n=m(a,["citationMetadata"]);n!=null&&v(e,["citationMetadata"],D1(n));const i=m(a,["tokenCount"]);i!=null&&v(e,["tokenCount"],i);const s=m(a,["finishReason"]);s!=null&&v(e,["finishReason"],s);const l=m(a,["avgLogprobs"]);l!=null&&v(e,["avgLogprobs"],l);const c=m(a,["groundingMetadata"]);c!=null&&v(e,["groundingMetadata"],c);const h=m(a,["index"]);h!=null&&v(e,["index"],h);const d=m(a,["logprobsResult"]);d!=null&&v(e,["logprobsResult"],d);const A=m(a,["safetyRatings"]);if(A!=null){let p=A;Array.isArray(p)&&(p=p.map(b=>b)),v(e,["safetyRatings"],p)}const f=m(a,["urlContextMetadata"]);return f!=null&&v(e,["urlContextMetadata"],f),e}function D1(a){const e={},t=m(a,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>i)),v(e,["citations"],n)}return e}function Lw(a){const e={},t=m(a,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>lD(s))),v(e,["parts"],i)}const n=m(a,["role"]);return n!=null&&v(e,["role"],n),e}function _1(a,e){const t={},n=m(a,["displayName"]);if(e!==void 0&&n!=null&&v(e,["batch","displayName"],n),m(a,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function R1(a,e){const t={},n=m(a,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const i=m(a,["dest"]);return e!==void 0&&i!=null&&v(e,["outputConfig"],w1(b1(i))),t}function iC(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["src"]);i!=null&&v(t,["batch","inputConfig"],k1(a,Rw(a,i)));const s=m(e,["config"]);return s!=null&&_1(s,t),t}function N1(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["model"],en(a,n));const i=m(e,["src"]);i!=null&&v(t,["inputConfig"],E1(Rw(a,i)));const s=m(e,["config"]);return s!=null&&R1(s,t),t}function G1(a,e){const t={},n=m(a,["displayName"]);return e!==void 0&&n!=null&&v(e,["batch","displayName"],n),t}function L1(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["src"]);i!=null&&v(t,["batch","inputConfig"],H1(a,i));const s=m(e,["config"]);return s!=null&&G1(s,t),t}function B1(a,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],Lo(a,n)),t}function F1(a,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],Lo(a,n)),t}function U1(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["name"]);n!=null&&v(e,["name"],n);const i=m(a,["done"]);i!=null&&v(e,["done"],i);const s=m(a,["error"]);return s!=null&&v(e,["error"],s),e}function K1(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["name"]);n!=null&&v(e,["name"],n);const i=m(a,["done"]);i!=null&&v(e,["done"],i);const s=m(a,["error"]);return s!=null&&v(e,["error"],s),e}function z1(a,e){const t={},n=m(e,["contents"]);if(n!=null){let s=Xf(a,n);Array.isArray(s)&&(s=s.map(l=>l)),v(t,["requests[]","request","content"],s)}const i=m(e,["config"]);return i!=null&&(v(t,["_self"],O1(i,t)),FI(t,{"requests[].*":"requests[].request.*"})),t}function O1(a,e){const t={},n=m(a,["taskType"]);e!==void 0&&n!=null&&v(e,["requests[]","taskType"],n);const i=m(a,["title"]);e!==void 0&&i!=null&&v(e,["requests[]","title"],i);const s=m(a,["outputDimensionality"]);if(e!==void 0&&s!=null&&v(e,["requests[]","outputDimensionality"],s),m(a,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(a,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function H1(a,e){const t={},n=m(e,["fileName"]);n!=null&&v(t,["file_name"],n);const i=m(e,["inlinedRequests"]);return i!=null&&v(t,["requests"],z1(a,i)),t}function V1(a){const e={};if(m(a,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(a,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(a,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function j1(a){const e={},t=m(a,["id"]);t!=null&&v(e,["id"],t);const n=m(a,["args"]);n!=null&&v(e,["args"],n);const i=m(a,["name"]);if(i!=null&&v(e,["name"],i),m(a,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(a,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Q1(a){const e={},t=m(a,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=m(a,["mode"]);if(n!=null&&v(e,["mode"],n),m(a,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function q1(a,e,t){const n={},i=m(e,["systemInstruction"]);t!==void 0&&i!=null&&v(t,["systemInstruction"],Lw(pa(i)));const s=m(e,["temperature"]);s!=null&&v(n,["temperature"],s);const l=m(e,["topP"]);l!=null&&v(n,["topP"],l);const c=m(e,["topK"]);c!=null&&v(n,["topK"],c);const h=m(e,["candidateCount"]);h!=null&&v(n,["candidateCount"],h);const d=m(e,["maxOutputTokens"]);d!=null&&v(n,["maxOutputTokens"],d);const A=m(e,["stopSequences"]);A!=null&&v(n,["stopSequences"],A);const f=m(e,["responseLogprobs"]);f!=null&&v(n,["responseLogprobs"],f);const p=m(e,["logprobs"]);p!=null&&v(n,["logprobs"],p);const b=m(e,["presencePenalty"]);b!=null&&v(n,["presencePenalty"],b);const w=m(e,["frequencyPenalty"]);w!=null&&v(n,["frequencyPenalty"],w);const S=m(e,["seed"]);S!=null&&v(n,["seed"],S);const k=m(e,["responseMimeType"]);k!=null&&v(n,["responseMimeType"],k);const E=m(e,["responseSchema"]);E!=null&&v(n,["responseSchema"],Wf(E));const I=m(e,["responseJsonSchema"]);if(I!=null&&v(n,["responseJsonSchema"],I),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=m(e,["safetySettings"]);if(t!==void 0&&P!=null){let $=P;Array.isArray($)&&($=$.map(Q=>cD(Q))),v(t,["safetySettings"],$)}const R=m(e,["tools"]);if(t!==void 0&&R!=null){let $=Go(R);Array.isArray($)&&($=$.map(Q=>dD(No(Q)))),v(t,["tools"],$)}const D=m(e,["toolConfig"]);if(t!==void 0&&D!=null&&v(t,["toolConfig"],uD(D)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const N=m(e,["cachedContent"]);t!==void 0&&N!=null&&v(t,["cachedContent"],or(a,N));const _=m(e,["responseModalities"]);_!=null&&v(n,["responseModalities"],_);const K=m(e,["mediaResolution"]);K!=null&&v(n,["mediaResolution"],K);const G=m(e,["speechConfig"]);if(G!=null&&v(n,["speechConfig"],$f(G)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=m(e,["thinkingConfig"]);L!=null&&v(n,["thinkingConfig"],L);const O=m(e,["imageConfig"]);O!=null&&v(n,["imageConfig"],Z1(O));const q=m(e,["enableEnhancedCivicAnswers"]);return q!=null&&v(n,["enableEnhancedCivicAnswers"],q),n}function Y1(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["candidates"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(d=>I1(d))),v(e,["candidates"],h)}const i=m(a,["modelVersion"]);i!=null&&v(e,["modelVersion"],i);const s=m(a,["promptFeedback"]);s!=null&&v(e,["promptFeedback"],s);const l=m(a,["responseId"]);l!=null&&v(e,["responseId"],l);const c=m(a,["usageMetadata"]);return c!=null&&v(e,["usageMetadata"],c),e}function X1(a,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],Lo(a,n)),t}function W1(a,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],Lo(a,n)),t}function $1(a){const e={};if(m(a,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(a,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function J1(a){const e={};if(m(a,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(a,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(a,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function Z1(a){const e={},t=m(a,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=m(a,["imageSize"]);if(n!=null&&v(e,["imageSize"],n),m(a,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(m(a,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(m(a,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function eD(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["request","model"],en(a,n));const i=m(e,["contents"]);if(i!=null){let c=ai(i);Array.isArray(c)&&(c=c.map(h=>Lw(h))),v(t,["request","contents"],c)}const s=m(e,["metadata"]);s!=null&&v(t,["metadata"],s);const l=m(e,["config"]);return l!=null&&v(t,["request","generationConfig"],q1(a,l,m(t,["request"],{}))),t}function tD(a){const e={},t=m(a,["response"]);t!=null&&v(e,["response"],Y1(t));const n=m(a,["error"]);return n!=null&&v(e,["error"],n),e}function nD(a,e){const t={},n=m(a,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const i=m(a,["pageToken"]);if(e!==void 0&&i!=null&&v(e,["_query","pageToken"],i),m(a,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function aD(a,e){const t={},n=m(a,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const i=m(a,["pageToken"]);e!==void 0&&i!=null&&v(e,["_query","pageToken"],i);const s=m(a,["filter"]);return e!==void 0&&s!=null&&v(e,["_query","filter"],s),t}function iD(a){const e={},t=m(a,["config"]);return t!=null&&nD(t,e),e}function rD(a){const e={},t=m(a,["config"]);return t!=null&&aD(t,e),e}function sD(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=m(a,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>Ku(l))),v(e,["batchJobs"],s)}return e}function oD(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=m(a,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>Jg(l))),v(e,["batchJobs"],s)}return e}function lD(a){const e={},t=m(a,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(a,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const i=m(a,["executableCode"]);i!=null&&v(e,["executableCode"],i);const s=m(a,["fileData"]);s!=null&&v(e,["fileData"],V1(s));const l=m(a,["functionCall"]);l!=null&&v(e,["functionCall"],j1(l));const c=m(a,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(a,["inlineData"]);h!=null&&v(e,["inlineData"],x1(h));const d=m(a,["text"]);d!=null&&v(e,["text"],d);const A=m(a,["thought"]);A!=null&&v(e,["thought"],A);const f=m(a,["thoughtSignature"]);f!=null&&v(e,["thoughtSignature"],f);const p=m(a,["videoMetadata"]);return p!=null&&v(e,["videoMetadata"],p),e}function cD(a){const e={},t=m(a,["category"]);if(t!=null&&v(e,["category"],t),m(a,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=m(a,["threshold"]);return n!=null&&v(e,["threshold"],n),e}function uD(a){const e={},t=m(a,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=m(a,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],Q1(n)),e}function dD(a){const e={};if(m(a,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(a,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(a,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const i=m(a,["codeExecution"]);if(i!=null&&v(e,["codeExecution"],i),m(a,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=m(a,["functionDeclarations"]);if(s!=null){let A=s;Array.isArray(A)&&(A=A.map(f=>f)),v(e,["functionDeclarations"],A)}const l=m(a,["googleMaps"]);l!=null&&v(e,["googleMaps"],$1(l));const c=m(a,["googleSearch"]);c!=null&&v(e,["googleSearch"],J1(c));const h=m(a,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const d=m(a,["urlContext"]);return d!=null&&v(e,["urlContext"],d),e}var ir;(function(a){a.PAGED_ITEM_BATCH_JOBS="batchJobs",a.PAGED_ITEM_MODELS="models",a.PAGED_ITEM_TUNING_JOBS="tuningJobs",a.PAGED_ITEM_FILES="files",a.PAGED_ITEM_CACHED_CONTENTS="cachedContents",a.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",a.PAGED_ITEM_DOCUMENTS="documents"})(ir||(ir={}));class vs{constructor(e,t,n,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,i)}init(e,t,n){var i,s;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t?.sdkHttpResponse,this.idxInternal=0;let l={config:{}};!n||Object.keys(n).length===0?l={config:{}}:typeof n=="object"?l=Object.assign({},n):l=n,l.config&&(l.config.pageToken=t.nextPageToken),this.paramsInternal=l,this.pageInternalSize=(s=(i=l.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}class hD extends sr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new vs(ir.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=iC(this.apiClient,e),n=t._url,i=$e("{model}:batchGenerateContent",n),c=t.batch.inputConfig.requests,h=c.requests,d=[];for(const A of h){const f=Object.assign({},A);if(f.systemInstruction){const p=f.systemInstruction;delete f.systemInstruction;const b=f.request;b.systemInstruction=p,f.request=b}d.push(f)}return c.requests=d,delete t.config,delete t._url,delete t._query,{path:i,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const n=t?Object.assign({},t):{},i=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${i}`),n.dest===void 0){const s=this.getGcsUri(e),l=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?n.dest=`${s.slice(0,-6)}/dest`:n.dest=`${s}_dest_${i}`;else if(l)n.dest=`${l}_dest_${i}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=N1(this.apiClient,e);return c=$e("batchPredictionJobs",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json()),l.then(A=>Jg(A))}else{const d=iC(this.apiClient,e);return c=$e("{model}:batchGenerateContent",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json()),l.then(A=>Ku(A))}}async createEmbeddingsInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=L1(this.apiClient,e);return s=$e("{model}:asyncBatchEmbedContent",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i.then(h=>Ku(h))}}async get(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=W1(this.apiClient,e);return c=$e("batchPredictionJobs/{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json()),l.then(A=>Jg(A))}else{const d=X1(this.apiClient,e);return c=$e("batches/{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json()),l.then(A=>Ku(A))}}async cancel(e){var t,n,i,s;let l="",c={};if(this.apiClient.isVertexAI()){const h=M1(this.apiClient,e);l=$e("batchPredictionJobs/{name}:cancel",h._url),c=h._query,delete h._url,delete h._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}else{const h=P1(this.apiClient,e);l=$e("batches/{name}:cancel",h._url),c=h._query,delete h._url,delete h._query,await this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=rD(e);return c=$e("batchPredictionJobs",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=oD(A),p=new eC;return Object.assign(p,f),p})}else{const d=iD(e);return c=$e("batches",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=sD(A),p=new eC;return Object.assign(p,f),p})}}async delete(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=F1(this.apiClient,e);return c=$e("batchPredictionJobs/{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>K1(A))}else{const d=B1(this.apiClient,e);return c=$e("batches/{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>U1(A))}}}function AD(a){const e={},t=m(a,["data"]);if(t!=null&&v(e,["data"],t),m(a,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(a,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function rC(a){const e={},t=m(a,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>LD(s))),v(e,["parts"],i)}const n=m(a,["role"]);return n!=null&&v(e,["role"],n),e}function gD(a,e){const t={},n=m(a,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const i=m(a,["expireTime"]);e!==void 0&&i!=null&&v(e,["expireTime"],i);const s=m(a,["displayName"]);e!==void 0&&s!=null&&v(e,["displayName"],s);const l=m(a,["contents"]);if(e!==void 0&&l!=null){let A=ai(l);Array.isArray(A)&&(A=A.map(f=>rC(f))),v(e,["contents"],A)}const c=m(a,["systemInstruction"]);e!==void 0&&c!=null&&v(e,["systemInstruction"],rC(pa(c)));const h=m(a,["tools"]);if(e!==void 0&&h!=null){let A=h;Array.isArray(A)&&(A=A.map(f=>FD(f))),v(e,["tools"],A)}const d=m(a,["toolConfig"]);if(e!==void 0&&d!=null&&v(e,["toolConfig"],BD(d)),m(a,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function fD(a,e){const t={},n=m(a,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const i=m(a,["expireTime"]);e!==void 0&&i!=null&&v(e,["expireTime"],i);const s=m(a,["displayName"]);e!==void 0&&s!=null&&v(e,["displayName"],s);const l=m(a,["contents"]);if(e!==void 0&&l!=null){let f=ai(l);Array.isArray(f)&&(f=f.map(p=>p)),v(e,["contents"],f)}const c=m(a,["systemInstruction"]);e!==void 0&&c!=null&&v(e,["systemInstruction"],pa(c));const h=m(a,["tools"]);if(e!==void 0&&h!=null){let f=h;Array.isArray(f)&&(f=f.map(p=>UD(p))),v(e,["tools"],f)}const d=m(a,["toolConfig"]);e!==void 0&&d!=null&&v(e,["toolConfig"],d);const A=m(a,["kmsKeyName"]);return e!==void 0&&A!=null&&v(e,["encryption_spec","kmsKeyName"],A),t}function pD(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["model"],Tw(a,n));const i=m(e,["config"]);return i!=null&&gD(i,t),t}function mD(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["model"],Tw(a,n));const i=m(e,["config"]);return i!=null&&fD(i,t),t}function vD(a,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],or(a,n)),t}function yD(a,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],or(a,n)),t}function bD(a){const e={},t=m(a,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function CD(a){const e={},t=m(a,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function SD(a){const e={};if(m(a,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(a,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(a,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function wD(a){const e={},t=m(a,["id"]);t!=null&&v(e,["id"],t);const n=m(a,["args"]);n!=null&&v(e,["args"],n);const i=m(a,["name"]);if(i!=null&&v(e,["name"],i),m(a,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(a,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function TD(a){const e={},t=m(a,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=m(a,["mode"]);if(n!=null&&v(e,["mode"],n),m(a,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function kD(a){const e={},t=m(a,["description"]);t!=null&&v(e,["description"],t);const n=m(a,["name"]);n!=null&&v(e,["name"],n);const i=m(a,["parameters"]);i!=null&&v(e,["parameters"],i);const s=m(a,["parametersJsonSchema"]);s!=null&&v(e,["parametersJsonSchema"],s);const l=m(a,["response"]);l!=null&&v(e,["response"],l);const c=m(a,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),m(a,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function ED(a,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],or(a,n)),t}function xD(a,e){const t={},n=m(e,["name"]);return n!=null&&v(t,["_url","name"],or(a,n)),t}function PD(a){const e={};if(m(a,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(a,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function MD(a){const e={};if(m(a,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(a,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(a,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function ID(a,e){const t={},n=m(a,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const i=m(a,["pageToken"]);return e!==void 0&&i!=null&&v(e,["_query","pageToken"],i),t}function DD(a,e){const t={},n=m(a,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const i=m(a,["pageToken"]);return e!==void 0&&i!=null&&v(e,["_query","pageToken"],i),t}function _D(a){const e={},t=m(a,["config"]);return t!=null&&ID(t,e),e}function RD(a){const e={},t=m(a,["config"]);return t!=null&&DD(t,e),e}function ND(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=m(a,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>l)),v(e,["cachedContents"],s)}return e}function GD(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=m(a,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>l)),v(e,["cachedContents"],s)}return e}function LD(a){const e={},t=m(a,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(a,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const i=m(a,["executableCode"]);i!=null&&v(e,["executableCode"],i);const s=m(a,["fileData"]);s!=null&&v(e,["fileData"],SD(s));const l=m(a,["functionCall"]);l!=null&&v(e,["functionCall"],wD(l));const c=m(a,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(a,["inlineData"]);h!=null&&v(e,["inlineData"],AD(h));const d=m(a,["text"]);d!=null&&v(e,["text"],d);const A=m(a,["thought"]);A!=null&&v(e,["thought"],A);const f=m(a,["thoughtSignature"]);f!=null&&v(e,["thoughtSignature"],f);const p=m(a,["videoMetadata"]);return p!=null&&v(e,["videoMetadata"],p),e}function BD(a){const e={},t=m(a,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=m(a,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],TD(n)),e}function FD(a){const e={};if(m(a,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(a,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(a,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const i=m(a,["codeExecution"]);if(i!=null&&v(e,["codeExecution"],i),m(a,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=m(a,["functionDeclarations"]);if(s!=null){let A=s;Array.isArray(A)&&(A=A.map(f=>f)),v(e,["functionDeclarations"],A)}const l=m(a,["googleMaps"]);l!=null&&v(e,["googleMaps"],PD(l));const c=m(a,["googleSearch"]);c!=null&&v(e,["googleSearch"],MD(c));const h=m(a,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const d=m(a,["urlContext"]);return d!=null&&v(e,["urlContext"],d),e}function UD(a){const e={},t=m(a,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=m(a,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),m(a,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=m(a,["codeExecution"]);i!=null&&v(e,["codeExecution"],i);const s=m(a,["enterpriseWebSearch"]);s!=null&&v(e,["enterpriseWebSearch"],s);const l=m(a,["functionDeclarations"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(p=>kD(p))),v(e,["functionDeclarations"],f)}const c=m(a,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const h=m(a,["googleSearch"]);h!=null&&v(e,["googleSearch"],h);const d=m(a,["googleSearchRetrieval"]);d!=null&&v(e,["googleSearchRetrieval"],d);const A=m(a,["urlContext"]);return A!=null&&v(e,["urlContext"],A),e}function KD(a,e){const t={},n=m(a,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const i=m(a,["expireTime"]);return e!==void 0&&i!=null&&v(e,["expireTime"],i),t}function zD(a,e){const t={},n=m(a,["ttl"]);e!==void 0&&n!=null&&v(e,["ttl"],n);const i=m(a,["expireTime"]);return e!==void 0&&i!=null&&v(e,["expireTime"],i),t}function OD(a,e){const t={},n=m(e,["name"]);n!=null&&v(t,["_url","name"],or(a,n));const i=m(e,["config"]);return i!=null&&KD(i,t),t}function HD(a,e){const t={},n=m(e,["name"]);n!=null&&v(t,["_url","name"],or(a,n));const i=m(e,["config"]);return i!=null&&zD(i,t),t}class VD extends sr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new vs(ir.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(t),t)}async create(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=mD(this.apiClient,e);return c=$e("cachedContents",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json()),l.then(A=>A)}else{const d=pD(this.apiClient,e);return c=$e("cachedContents",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json()),l.then(A=>A)}}async get(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=xD(this.apiClient,e);return c=$e("{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json()),l.then(A=>A)}else{const d=ED(this.apiClient,e);return c=$e("{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json()),l.then(A=>A)}}async delete(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=yD(this.apiClient,e);return c=$e("{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=CD(A),p=new J0;return Object.assign(p,f),p})}else{const d=vD(this.apiClient,e);return c=$e("{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=bD(A),p=new J0;return Object.assign(p,f),p})}}async update(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=HD(this.apiClient,e);return c=$e("{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json()),l.then(A=>A)}else{const d=OD(this.apiClient,e);return c=$e("{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json()),l.then(A=>A)}}async listInternal(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=RD(e);return c=$e("cachedContents",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=GD(A),p=new Z0;return Object.assign(p,f),p})}else{const d=_D(e);return c=$e("cachedContents",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=ND(A),p=new Z0;return Object.assign(p,f),p})}}}function id(a,e){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&e.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(a);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(a,n[i])&&(t[n[i]]=a[n[i]]);return t}function sC(a){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&a[e],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Tt(a){return this instanceof Tt?(this.v=a,this):new Tt(a)}function gi(a,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,e||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),i[Symbol.asyncIterator]=function(){return this},i;function l(b){return function(w){return Promise.resolve(w).then(b,f)}}function c(b,w){n[b]&&(i[b]=function(S){return new Promise(function(k,E){s.push([b,S,k,E])>1||h(b,S)})},w&&(i[b]=w(i[b])))}function h(b,w){try{d(n[b](w))}catch(S){p(s[0][3],S)}}function d(b){b.value instanceof Tt?Promise.resolve(b.value.v).then(A,f):p(s[0][2],b)}function A(b){h("next",b)}function f(b){h("throw",b)}function p(b,w){b(w),s.shift(),s.length&&h(s[0][0],s[0][1])}}function fi(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=a[Symbol.asyncIterator],t;return e?e.call(a):(a=typeof sC=="function"?sC(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=a[s]&&function(l){return new Promise(function(c,h){l=a[s](l),i(c,h,l.done,l.value)})}}function i(s,l,c,h){Promise.resolve(h).then(function(d){s({value:d,done:c})},l)}}function jD(a){var e;if(a.candidates==null||a.candidates.length===0)return!1;const t=(e=a.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:Bw(t)}function Bw(a){if(a.parts===void 0||a.parts.length===0)return!1;for(const e of a.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function QD(a){if(a.length!==0){for(const e of a)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function oC(a){if(a===void 0||a.length===0)return[];const e=[],t=a.length;let n=0;for(;n<t;)if(a[n].role==="user")e.push(a[n]),n++;else{const i=[];let s=!0;for(;n<t&&a[n].role==="model";)i.push(a[n]),s&&!Bw(a[n])&&(s=!1),n++;s?e.push(...i):e.pop()}return e}class qD{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new YD(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class YD{constructor(e,t,n,i={},s=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),QD(s)}async sendMessage(e){var t;await this.sendPromise;const n=pa(e.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var s,l,c;const h=await i,d=(l=(s=h.candidates)===null||s===void 0?void 0:s[0])===null||l===void 0?void 0:l.content,A=h.automaticFunctionCallingHistory,f=this.getHistory(!0).length;let p=[];A!=null&&(p=(c=A.slice(f))!==null&&c!==void 0?c:[]);const b=d?[d]:[];this.recordHistory(n,b,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(e){var t;await this.sendPromise;const n=pa(e.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,n)}getHistory(e=!1){const t=e?oC(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return gi(this,arguments,function*(){var i,s,l,c,h,d;const A=[];try{for(var f=!0,p=fi(e),b;b=yield Tt(p.next()),i=b.done,!i;f=!0){c=b.value,f=!1;const w=c;if(jD(w)){const S=(d=(h=w.candidates)===null||h===void 0?void 0:h[0])===null||d===void 0?void 0:d.content;S!==void 0&&A.push(S)}yield yield Tt(w)}}catch(w){s={error:w}}finally{try{!f&&!i&&(l=p.return)&&(yield Tt(l.call(p)))}finally{if(s)throw s.error}}this.recordHistory(t,A)})}recordHistory(e,t,n){let i=[];t.length>0&&t.every(s=>s.role!==void 0)?i=t:i.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...oC(n)):this.history.push(e),this.history.push(...i)}}let Fw=class Uw extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Uw.prototype)}};function XD(a){const e={},t=m(a,["file"]);return t!=null&&v(e,["file"],t),e}function WD(a){const e={},t=m(a,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function $D(a){const e={},t=m(a,["name"]);return t!=null&&v(e,["_url","file"],Iw(t)),e}function JD(a){const e={},t=m(a,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function ZD(a){const e={},t=m(a,["name"]);return t!=null&&v(e,["_url","file"],Iw(t)),e}function e_(a,e){const t={},n=m(a,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const i=m(a,["pageToken"]);return e!==void 0&&i!=null&&v(e,["_query","pageToken"],i),t}function t_(a){const e={},t=m(a,["config"]);return t!=null&&e_(t,e),e}function n_(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=m(a,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>l)),v(e,["files"],s)}return e}class a_ extends sr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new vs(ir.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=t_(e);return s=$e("files",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(d=>{const A=d;return A.sdkHttpResponse={headers:h.headers},A})),i.then(h=>{const d=n_(h),A=new o1;return Object.assign(A,d),A})}}async createInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=XD(e);return s=$e("upload/v1beta/files",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i.then(h=>{const d=WD(h),A=new l1;return Object.assign(A,d),A})}}async get(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=ZD(e);return s=$e("files/{file}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async delete(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=$D(e);return s=$e("files/{file}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(d=>{const A=d;return A.sdkHttpResponse={headers:h.headers},A})),i.then(h=>{const d=JD(h),A=new c1;return Object.assign(A,d),A})}}}function zu(a){const e={},t=m(a,["data"]);if(t!=null&&v(e,["data"],t),m(a,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(a,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function i_(a){const e={},t=m(a,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>b_(s))),v(e,["parts"],i)}const n=m(a,["role"]);return n!=null&&v(e,["role"],n),e}function r_(a){const e={};if(m(a,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(a,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(a,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function s_(a){const e={},t=m(a,["id"]);t!=null&&v(e,["id"],t);const n=m(a,["args"]);n!=null&&v(e,["args"],n);const i=m(a,["name"]);if(i!=null&&v(e,["name"],i),m(a,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(a,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function o_(a){const e={},t=m(a,["description"]);t!=null&&v(e,["description"],t);const n=m(a,["name"]);n!=null&&v(e,["name"],n);const i=m(a,["parameters"]);i!=null&&v(e,["parameters"],i);const s=m(a,["parametersJsonSchema"]);s!=null&&v(e,["parametersJsonSchema"],s);const l=m(a,["response"]);l!=null&&v(e,["response"],l);const c=m(a,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),m(a,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function l_(a){const e={},t=m(a,["modelSelectionConfig"]);t!=null&&v(e,["modelConfig"],t);const n=m(a,["responseJsonSchema"]);n!=null&&v(e,["responseJsonSchema"],n);const i=m(a,["audioTimestamp"]);i!=null&&v(e,["audioTimestamp"],i);const s=m(a,["candidateCount"]);s!=null&&v(e,["candidateCount"],s);const l=m(a,["enableAffectiveDialog"]);l!=null&&v(e,["enableAffectiveDialog"],l);const c=m(a,["frequencyPenalty"]);c!=null&&v(e,["frequencyPenalty"],c);const h=m(a,["logprobs"]);h!=null&&v(e,["logprobs"],h);const d=m(a,["maxOutputTokens"]);d!=null&&v(e,["maxOutputTokens"],d);const A=m(a,["mediaResolution"]);A!=null&&v(e,["mediaResolution"],A);const f=m(a,["presencePenalty"]);f!=null&&v(e,["presencePenalty"],f);const p=m(a,["responseLogprobs"]);p!=null&&v(e,["responseLogprobs"],p);const b=m(a,["responseMimeType"]);b!=null&&v(e,["responseMimeType"],b);const w=m(a,["responseModalities"]);w!=null&&v(e,["responseModalities"],w);const S=m(a,["responseSchema"]);S!=null&&v(e,["responseSchema"],S);const k=m(a,["routingConfig"]);k!=null&&v(e,["routingConfig"],k);const E=m(a,["seed"]);E!=null&&v(e,["seed"],E);const I=m(a,["speechConfig"]);I!=null&&v(e,["speechConfig"],I);const P=m(a,["stopSequences"]);P!=null&&v(e,["stopSequences"],P);const R=m(a,["temperature"]);R!=null&&v(e,["temperature"],R);const D=m(a,["thinkingConfig"]);D!=null&&v(e,["thinkingConfig"],D);const N=m(a,["topK"]);N!=null&&v(e,["topK"],N);const _=m(a,["topP"]);if(_!=null&&v(e,["topP"],_),m(a,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function c_(a){const e={};if(m(a,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(a,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function u_(a){const e={};if(m(a,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(a,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(a,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function d_(a,e){const t={},n=m(a,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],n);const i=m(a,["responseModalities"]);e!==void 0&&i!=null&&v(e,["setup","generationConfig","responseModalities"],i);const s=m(a,["temperature"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig","temperature"],s);const l=m(a,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=m(a,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const h=m(a,["maxOutputTokens"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","maxOutputTokens"],h);const d=m(a,["mediaResolution"]);e!==void 0&&d!=null&&v(e,["setup","generationConfig","mediaResolution"],d);const A=m(a,["seed"]);e!==void 0&&A!=null&&v(e,["setup","generationConfig","seed"],A);const f=m(a,["speechConfig"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","speechConfig"],Jf(f));const p=m(a,["thinkingConfig"]);e!==void 0&&p!=null&&v(e,["setup","generationConfig","thinkingConfig"],p);const b=m(a,["enableAffectiveDialog"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],b);const w=m(a,["systemInstruction"]);e!==void 0&&w!=null&&v(e,["setup","systemInstruction"],i_(pa(w)));const S=m(a,["tools"]);if(e!==void 0&&S!=null){let N=Go(S);Array.isArray(N)&&(N=N.map(_=>S_(No(_)))),v(e,["setup","tools"],N)}const k=m(a,["sessionResumption"]);e!==void 0&&k!=null&&v(e,["setup","sessionResumption"],C_(k));const E=m(a,["inputAudioTranscription"]);e!==void 0&&E!=null&&v(e,["setup","inputAudioTranscription"],E);const I=m(a,["outputAudioTranscription"]);e!==void 0&&I!=null&&v(e,["setup","outputAudioTranscription"],I);const P=m(a,["realtimeInputConfig"]);e!==void 0&&P!=null&&v(e,["setup","realtimeInputConfig"],P);const R=m(a,["contextWindowCompression"]);e!==void 0&&R!=null&&v(e,["setup","contextWindowCompression"],R);const D=m(a,["proactivity"]);if(e!==void 0&&D!=null&&v(e,["setup","proactivity"],D),m(a,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function h_(a,e){const t={},n=m(a,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],l_(n));const i=m(a,["responseModalities"]);e!==void 0&&i!=null&&v(e,["setup","generationConfig","responseModalities"],i);const s=m(a,["temperature"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig","temperature"],s);const l=m(a,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=m(a,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const h=m(a,["maxOutputTokens"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","maxOutputTokens"],h);const d=m(a,["mediaResolution"]);e!==void 0&&d!=null&&v(e,["setup","generationConfig","mediaResolution"],d);const A=m(a,["seed"]);e!==void 0&&A!=null&&v(e,["setup","generationConfig","seed"],A);const f=m(a,["speechConfig"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","speechConfig"],Jf(f));const p=m(a,["thinkingConfig"]);e!==void 0&&p!=null&&v(e,["setup","generationConfig","thinkingConfig"],p);const b=m(a,["enableAffectiveDialog"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],b);const w=m(a,["systemInstruction"]);e!==void 0&&w!=null&&v(e,["setup","systemInstruction"],pa(w));const S=m(a,["tools"]);if(e!==void 0&&S!=null){let _=Go(S);Array.isArray(_)&&(_=_.map(K=>w_(No(K)))),v(e,["setup","tools"],_)}const k=m(a,["sessionResumption"]);e!==void 0&&k!=null&&v(e,["setup","sessionResumption"],k);const E=m(a,["inputAudioTranscription"]);e!==void 0&&E!=null&&v(e,["setup","inputAudioTranscription"],E);const I=m(a,["outputAudioTranscription"]);e!==void 0&&I!=null&&v(e,["setup","outputAudioTranscription"],I);const P=m(a,["realtimeInputConfig"]);e!==void 0&&P!=null&&v(e,["setup","realtimeInputConfig"],P);const R=m(a,["contextWindowCompression"]);e!==void 0&&R!=null&&v(e,["setup","contextWindowCompression"],R);const D=m(a,["proactivity"]);e!==void 0&&D!=null&&v(e,["setup","proactivity"],D);const N=m(a,["explicitVadSignal"]);return e!==void 0&&N!=null&&v(e,["setup","explicitVadSignal"],N),t}function A_(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["setup","model"],en(a,n));const i=m(e,["config"]);return i!=null&&v(t,["config"],d_(i,t)),t}function g_(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["setup","model"],en(a,n));const i=m(e,["config"]);return i!=null&&v(t,["config"],h_(i,t)),t}function f_(a){const e={},t=m(a,["musicGenerationConfig"]);return t!=null&&v(e,["musicGenerationConfig"],t),e}function p_(a){const e={},t=m(a,["weightedPrompts"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>i)),v(e,["weightedPrompts"],n)}return e}function m_(a){const e={},t=m(a,["media"]);if(t!=null){let d=kw(t);Array.isArray(d)&&(d=d.map(A=>zu(A))),v(e,["mediaChunks"],d)}const n=m(a,["audio"]);n!=null&&v(e,["audio"],zu(xw(n)));const i=m(a,["audioStreamEnd"]);i!=null&&v(e,["audioStreamEnd"],i);const s=m(a,["video"]);s!=null&&v(e,["video"],zu(Ew(s)));const l=m(a,["text"]);l!=null&&v(e,["text"],l);const c=m(a,["activityStart"]);c!=null&&v(e,["activityStart"],c);const h=m(a,["activityEnd"]);return h!=null&&v(e,["activityEnd"],h),e}function v_(a){const e={},t=m(a,["media"]);if(t!=null){let d=kw(t);Array.isArray(d)&&(d=d.map(A=>A)),v(e,["mediaChunks"],d)}const n=m(a,["audio"]);n!=null&&v(e,["audio"],xw(n));const i=m(a,["audioStreamEnd"]);i!=null&&v(e,["audioStreamEnd"],i);const s=m(a,["video"]);s!=null&&v(e,["video"],Ew(s));const l=m(a,["text"]);l!=null&&v(e,["text"],l);const c=m(a,["activityStart"]);c!=null&&v(e,["activityStart"],c);const h=m(a,["activityEnd"]);return h!=null&&v(e,["activityEnd"],h),e}function y_(a){const e={},t=m(a,["setupComplete"]);t!=null&&v(e,["setupComplete"],t);const n=m(a,["serverContent"]);n!=null&&v(e,["serverContent"],n);const i=m(a,["toolCall"]);i!=null&&v(e,["toolCall"],i);const s=m(a,["toolCallCancellation"]);s!=null&&v(e,["toolCallCancellation"],s);const l=m(a,["usageMetadata"]);l!=null&&v(e,["usageMetadata"],T_(l));const c=m(a,["goAway"]);c!=null&&v(e,["goAway"],c);const h=m(a,["sessionResumptionUpdate"]);h!=null&&v(e,["sessionResumptionUpdate"],h);const d=m(a,["voiceActivityDetectionSignal"]);return d!=null&&v(e,["voiceActivityDetectionSignal"],d),e}function b_(a){const e={},t=m(a,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(a,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const i=m(a,["executableCode"]);i!=null&&v(e,["executableCode"],i);const s=m(a,["fileData"]);s!=null&&v(e,["fileData"],r_(s));const l=m(a,["functionCall"]);l!=null&&v(e,["functionCall"],s_(l));const c=m(a,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(a,["inlineData"]);h!=null&&v(e,["inlineData"],zu(h));const d=m(a,["text"]);d!=null&&v(e,["text"],d);const A=m(a,["thought"]);A!=null&&v(e,["thought"],A);const f=m(a,["thoughtSignature"]);f!=null&&v(e,["thoughtSignature"],f);const p=m(a,["videoMetadata"]);return p!=null&&v(e,["videoMetadata"],p),e}function C_(a){const e={},t=m(a,["handle"]);if(t!=null&&v(e,["handle"],t),m(a,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function S_(a){const e={};if(m(a,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(a,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(a,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const i=m(a,["codeExecution"]);if(i!=null&&v(e,["codeExecution"],i),m(a,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=m(a,["functionDeclarations"]);if(s!=null){let A=s;Array.isArray(A)&&(A=A.map(f=>f)),v(e,["functionDeclarations"],A)}const l=m(a,["googleMaps"]);l!=null&&v(e,["googleMaps"],c_(l));const c=m(a,["googleSearch"]);c!=null&&v(e,["googleSearch"],u_(c));const h=m(a,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const d=m(a,["urlContext"]);return d!=null&&v(e,["urlContext"],d),e}function w_(a){const e={},t=m(a,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=m(a,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),m(a,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=m(a,["codeExecution"]);i!=null&&v(e,["codeExecution"],i);const s=m(a,["enterpriseWebSearch"]);s!=null&&v(e,["enterpriseWebSearch"],s);const l=m(a,["functionDeclarations"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(p=>o_(p))),v(e,["functionDeclarations"],f)}const c=m(a,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const h=m(a,["googleSearch"]);h!=null&&v(e,["googleSearch"],h);const d=m(a,["googleSearchRetrieval"]);d!=null&&v(e,["googleSearchRetrieval"],d);const A=m(a,["urlContext"]);return A!=null&&v(e,["urlContext"],A),e}function T_(a){const e={},t=m(a,["promptTokenCount"]);t!=null&&v(e,["promptTokenCount"],t);const n=m(a,["cachedContentTokenCount"]);n!=null&&v(e,["cachedContentTokenCount"],n);const i=m(a,["candidatesTokenCount"]);i!=null&&v(e,["responseTokenCount"],i);const s=m(a,["toolUsePromptTokenCount"]);s!=null&&v(e,["toolUsePromptTokenCount"],s);const l=m(a,["thoughtsTokenCount"]);l!=null&&v(e,["thoughtsTokenCount"],l);const c=m(a,["totalTokenCount"]);c!=null&&v(e,["totalTokenCount"],c);const h=m(a,["promptTokensDetails"]);if(h!=null){let b=h;Array.isArray(b)&&(b=b.map(w=>w)),v(e,["promptTokensDetails"],b)}const d=m(a,["cacheTokensDetails"]);if(d!=null){let b=d;Array.isArray(b)&&(b=b.map(w=>w)),v(e,["cacheTokensDetails"],b)}const A=m(a,["candidatesTokensDetails"]);if(A!=null){let b=A;Array.isArray(b)&&(b=b.map(w=>w)),v(e,["responseTokensDetails"],b)}const f=m(a,["toolUsePromptTokensDetails"]);if(f!=null){let b=f;Array.isArray(b)&&(b=b.map(w=>w)),v(e,["toolUsePromptTokensDetails"],b)}const p=m(a,["trafficType"]);return p!=null&&v(e,["trafficType"],p),e}function k_(a){const e={},t=m(a,["data"]);if(t!=null&&v(e,["data"],t),m(a,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(a,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function E_(a){const e={},t=m(a,["content"]);t!=null&&v(e,["content"],t);const n=m(a,["citationMetadata"]);n!=null&&v(e,["citationMetadata"],x_(n));const i=m(a,["tokenCount"]);i!=null&&v(e,["tokenCount"],i);const s=m(a,["finishReason"]);s!=null&&v(e,["finishReason"],s);const l=m(a,["avgLogprobs"]);l!=null&&v(e,["avgLogprobs"],l);const c=m(a,["groundingMetadata"]);c!=null&&v(e,["groundingMetadata"],c);const h=m(a,["index"]);h!=null&&v(e,["index"],h);const d=m(a,["logprobsResult"]);d!=null&&v(e,["logprobsResult"],d);const A=m(a,["safetyRatings"]);if(A!=null){let p=A;Array.isArray(p)&&(p=p.map(b=>b)),v(e,["safetyRatings"],p)}const f=m(a,["urlContextMetadata"]);return f!=null&&v(e,["urlContextMetadata"],f),e}function x_(a){const e={},t=m(a,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>i)),v(e,["citations"],n)}return e}function P_(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["contents"]);if(i!=null){let s=ai(i);Array.isArray(s)&&(s=s.map(l=>l)),v(t,["contents"],s)}return t}function M_(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["tokensInfo"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>s)),v(e,["tokensInfo"],i)}return e}function I_(a){const e={},t=m(a,["values"]);t!=null&&v(e,["values"],t);const n=m(a,["statistics"]);return n!=null&&v(e,["statistics"],D_(n)),e}function D_(a){const e={},t=m(a,["truncated"]);t!=null&&v(e,["truncated"],t);const n=m(a,["token_count"]);return n!=null&&v(e,["tokenCount"],n),e}function Nd(a){const e={},t=m(a,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>KR(s))),v(e,["parts"],i)}const n=m(a,["role"]);return n!=null&&v(e,["role"],n),e}function __(a){const e={},t=m(a,["controlType"]);t!=null&&v(e,["controlType"],t);const n=m(a,["enableControlImageComputation"]);return n!=null&&v(e,["computeControl"],n),e}function R_(a){const e={};if(m(a,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(m(a,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(m(a,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function N_(a,e){const t={},n=m(a,["systemInstruction"]);e!==void 0&&n!=null&&v(e,["systemInstruction"],pa(n));const i=m(a,["tools"]);if(e!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>Hw(c))),v(e,["tools"],l)}const s=m(a,["generationConfig"]);return e!==void 0&&s!=null&&v(e,["generationConfig"],kR(s)),t}function G_(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["contents"]);if(i!=null){let l=ai(i);Array.isArray(l)&&(l=l.map(c=>Nd(c))),v(t,["contents"],l)}const s=m(e,["config"]);return s!=null&&R_(s),t}function L_(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["contents"]);if(i!=null){let l=ai(i);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["contents"],l)}const s=m(e,["config"]);return s!=null&&N_(s,t),t}function B_(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["totalTokens"]);n!=null&&v(e,["totalTokens"],n);const i=m(a,["cachedContentTokenCount"]);return i!=null&&v(e,["cachedContentTokenCount"],i),e}function F_(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["totalTokens"]);return n!=null&&v(e,["totalTokens"],n),e}function U_(a,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],en(a,n)),t}function K_(a,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],en(a,n)),t}function z_(a){const e={},t=m(a,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function O_(a){const e={},t=m(a,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}function H_(a,e){const t={},n=m(a,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const i=m(a,["negativePrompt"]);e!==void 0&&i!=null&&v(e,["parameters","negativePrompt"],i);const s=m(a,["numberOfImages"]);e!==void 0&&s!=null&&v(e,["parameters","sampleCount"],s);const l=m(a,["aspectRatio"]);e!==void 0&&l!=null&&v(e,["parameters","aspectRatio"],l);const c=m(a,["guidanceScale"]);e!==void 0&&c!=null&&v(e,["parameters","guidanceScale"],c);const h=m(a,["seed"]);e!==void 0&&h!=null&&v(e,["parameters","seed"],h);const d=m(a,["safetyFilterLevel"]);e!==void 0&&d!=null&&v(e,["parameters","safetySetting"],d);const A=m(a,["personGeneration"]);e!==void 0&&A!=null&&v(e,["parameters","personGeneration"],A);const f=m(a,["includeSafetyAttributes"]);e!==void 0&&f!=null&&v(e,["parameters","includeSafetyAttributes"],f);const p=m(a,["includeRaiReason"]);e!==void 0&&p!=null&&v(e,["parameters","includeRaiReason"],p);const b=m(a,["language"]);e!==void 0&&b!=null&&v(e,["parameters","language"],b);const w=m(a,["outputMimeType"]);e!==void 0&&w!=null&&v(e,["parameters","outputOptions","mimeType"],w);const S=m(a,["outputCompressionQuality"]);e!==void 0&&S!=null&&v(e,["parameters","outputOptions","compressionQuality"],S);const k=m(a,["addWatermark"]);e!==void 0&&k!=null&&v(e,["parameters","addWatermark"],k);const E=m(a,["labels"]);e!==void 0&&E!=null&&v(e,["labels"],E);const I=m(a,["editMode"]);e!==void 0&&I!=null&&v(e,["parameters","editMode"],I);const P=m(a,["baseSteps"]);return e!==void 0&&P!=null&&v(e,["parameters","editConfig","baseSteps"],P),t}function V_(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["prompt"]);i!=null&&v(t,["instances[0]","prompt"],i);const s=m(e,["referenceImages"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(h=>QR(h))),v(t,["instances[0]","referenceImages"],c)}const l=m(e,["config"]);return l!=null&&H_(l,t),t}function j_(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Gd(s))),v(e,["generatedImages"],i)}return e}function Q_(a,e){const t={},n=m(a,["taskType"]);e!==void 0&&n!=null&&v(e,["requests[]","taskType"],n);const i=m(a,["title"]);e!==void 0&&i!=null&&v(e,["requests[]","title"],i);const s=m(a,["outputDimensionality"]);if(e!==void 0&&s!=null&&v(e,["requests[]","outputDimensionality"],s),m(a,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(a,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function q_(a,e){const t={},n=m(a,["taskType"]);e!==void 0&&n!=null&&v(e,["instances[]","task_type"],n);const i=m(a,["title"]);e!==void 0&&i!=null&&v(e,["instances[]","title"],i);const s=m(a,["outputDimensionality"]);e!==void 0&&s!=null&&v(e,["parameters","outputDimensionality"],s);const l=m(a,["mimeType"]);e!==void 0&&l!=null&&v(e,["instances[]","mimeType"],l);const c=m(a,["autoTruncate"]);return e!==void 0&&c!=null&&v(e,["parameters","autoTruncate"],c),t}function Y_(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["contents"]);if(i!=null){let c=Xf(a,i);Array.isArray(c)&&(c=c.map(h=>h)),v(t,["requests[]","content"],c)}const s=m(e,["config"]);s!=null&&Q_(s,t);const l=m(e,["model"]);return l!==void 0&&v(t,["requests[]","model"],en(a,l)),t}function X_(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["contents"]);if(i!=null){let l=Xf(a,i);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["instances[]","content"],l)}const s=m(e,["config"]);return s!=null&&q_(s,t),t}function W_(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["embeddings"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>l)),v(e,["embeddings"],s)}const i=m(a,["metadata"]);return i!=null&&v(e,["metadata"],i),e}function $_(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["predictions[]","embeddings"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>I_(l))),v(e,["embeddings"],s)}const i=m(a,["metadata"]);return i!=null&&v(e,["metadata"],i),e}function J_(a){const e={},t=m(a,["endpoint"]);t!=null&&v(e,["name"],t);const n=m(a,["deployedModelId"]);return n!=null&&v(e,["deployedModelId"],n),e}function Z_(a){const e={};if(m(a,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(a,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(a,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function eR(a){const e={},t=m(a,["id"]);t!=null&&v(e,["id"],t);const n=m(a,["args"]);n!=null&&v(e,["args"],n);const i=m(a,["name"]);if(i!=null&&v(e,["name"],i),m(a,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(a,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function tR(a){const e={},t=m(a,["allowedFunctionNames"]);t!=null&&v(e,["allowedFunctionNames"],t);const n=m(a,["mode"]);if(n!=null&&v(e,["mode"],n),m(a,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function nR(a){const e={},t=m(a,["description"]);t!=null&&v(e,["description"],t);const n=m(a,["name"]);n!=null&&v(e,["name"],n);const i=m(a,["parameters"]);i!=null&&v(e,["parameters"],i);const s=m(a,["parametersJsonSchema"]);s!=null&&v(e,["parametersJsonSchema"],s);const l=m(a,["response"]);l!=null&&v(e,["response"],l);const c=m(a,["responseJsonSchema"]);if(c!=null&&v(e,["responseJsonSchema"],c),m(a,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function aR(a,e,t){const n={},i=m(e,["systemInstruction"]);t!==void 0&&i!=null&&v(t,["systemInstruction"],Nd(pa(i)));const s=m(e,["temperature"]);s!=null&&v(n,["temperature"],s);const l=m(e,["topP"]);l!=null&&v(n,["topP"],l);const c=m(e,["topK"]);c!=null&&v(n,["topK"],c);const h=m(e,["candidateCount"]);h!=null&&v(n,["candidateCount"],h);const d=m(e,["maxOutputTokens"]);d!=null&&v(n,["maxOutputTokens"],d);const A=m(e,["stopSequences"]);A!=null&&v(n,["stopSequences"],A);const f=m(e,["responseLogprobs"]);f!=null&&v(n,["responseLogprobs"],f);const p=m(e,["logprobs"]);p!=null&&v(n,["logprobs"],p);const b=m(e,["presencePenalty"]);b!=null&&v(n,["presencePenalty"],b);const w=m(e,["frequencyPenalty"]);w!=null&&v(n,["frequencyPenalty"],w);const S=m(e,["seed"]);S!=null&&v(n,["seed"],S);const k=m(e,["responseMimeType"]);k!=null&&v(n,["responseMimeType"],k);const E=m(e,["responseSchema"]);E!=null&&v(n,["responseSchema"],Wf(E));const I=m(e,["responseJsonSchema"]);if(I!=null&&v(n,["responseJsonSchema"],I),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=m(e,["safetySettings"]);if(t!==void 0&&P!=null){let $=P;Array.isArray($)&&($=$.map(Q=>qR(Q))),v(t,["safetySettings"],$)}const R=m(e,["tools"]);if(t!==void 0&&R!=null){let $=Go(R);Array.isArray($)&&($=$.map(Q=>eN(No(Q)))),v(t,["tools"],$)}const D=m(e,["toolConfig"]);if(t!==void 0&&D!=null&&v(t,["toolConfig"],ZR(D)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const N=m(e,["cachedContent"]);t!==void 0&&N!=null&&v(t,["cachedContent"],or(a,N));const _=m(e,["responseModalities"]);_!=null&&v(n,["responseModalities"],_);const K=m(e,["mediaResolution"]);K!=null&&v(n,["mediaResolution"],K);const G=m(e,["speechConfig"]);if(G!=null&&v(n,["speechConfig"],$f(G)),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const L=m(e,["thinkingConfig"]);L!=null&&v(n,["thinkingConfig"],L);const O=m(e,["imageConfig"]);O!=null&&v(n,["imageConfig"],IR(O));const q=m(e,["enableEnhancedCivicAnswers"]);return q!=null&&v(n,["enableEnhancedCivicAnswers"],q),n}function iR(a,e,t){const n={},i=m(e,["systemInstruction"]);t!==void 0&&i!=null&&v(t,["systemInstruction"],pa(i));const s=m(e,["temperature"]);s!=null&&v(n,["temperature"],s);const l=m(e,["topP"]);l!=null&&v(n,["topP"],l);const c=m(e,["topK"]);c!=null&&v(n,["topK"],c);const h=m(e,["candidateCount"]);h!=null&&v(n,["candidateCount"],h);const d=m(e,["maxOutputTokens"]);d!=null&&v(n,["maxOutputTokens"],d);const A=m(e,["stopSequences"]);A!=null&&v(n,["stopSequences"],A);const f=m(e,["responseLogprobs"]);f!=null&&v(n,["responseLogprobs"],f);const p=m(e,["logprobs"]);p!=null&&v(n,["logprobs"],p);const b=m(e,["presencePenalty"]);b!=null&&v(n,["presencePenalty"],b);const w=m(e,["frequencyPenalty"]);w!=null&&v(n,["frequencyPenalty"],w);const S=m(e,["seed"]);S!=null&&v(n,["seed"],S);const k=m(e,["responseMimeType"]);k!=null&&v(n,["responseMimeType"],k);const E=m(e,["responseSchema"]);E!=null&&v(n,["responseSchema"],Wf(E));const I=m(e,["responseJsonSchema"]);I!=null&&v(n,["responseJsonSchema"],I);const P=m(e,["routingConfig"]);P!=null&&v(n,["routingConfig"],P);const R=m(e,["modelSelectionConfig"]);R!=null&&v(n,["modelConfig"],R);const D=m(e,["safetySettings"]);if(t!==void 0&&D!=null){let F=D;Array.isArray(F)&&(F=F.map(U=>U)),v(t,["safetySettings"],F)}const N=m(e,["tools"]);if(t!==void 0&&N!=null){let F=Go(N);Array.isArray(F)&&(F=F.map(U=>Hw(No(U)))),v(t,["tools"],F)}const _=m(e,["toolConfig"]);t!==void 0&&_!=null&&v(t,["toolConfig"],_);const K=m(e,["labels"]);t!==void 0&&K!=null&&v(t,["labels"],K);const G=m(e,["cachedContent"]);t!==void 0&&G!=null&&v(t,["cachedContent"],or(a,G));const L=m(e,["responseModalities"]);L!=null&&v(n,["responseModalities"],L);const O=m(e,["mediaResolution"]);O!=null&&v(n,["mediaResolution"],O);const q=m(e,["speechConfig"]);q!=null&&v(n,["speechConfig"],$f(q));const $=m(e,["audioTimestamp"]);$!=null&&v(n,["audioTimestamp"],$);const Q=m(e,["thinkingConfig"]);Q!=null&&v(n,["thinkingConfig"],Q);const Z=m(e,["imageConfig"]);if(Z!=null&&v(n,["imageConfig"],DR(Z)),m(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return n}function lC(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["contents"]);if(i!=null){let l=ai(i);Array.isArray(l)&&(l=l.map(c=>Nd(c))),v(t,["contents"],l)}const s=m(e,["config"]);return s!=null&&v(t,["generationConfig"],aR(a,s,t)),t}function cC(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["contents"]);if(i!=null){let l=ai(i);Array.isArray(l)&&(l=l.map(c=>c)),v(t,["contents"],l)}const s=m(e,["config"]);return s!=null&&v(t,["generationConfig"],iR(a,s,t)),t}function uC(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["candidates"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(d=>E_(d))),v(e,["candidates"],h)}const i=m(a,["modelVersion"]);i!=null&&v(e,["modelVersion"],i);const s=m(a,["promptFeedback"]);s!=null&&v(e,["promptFeedback"],s);const l=m(a,["responseId"]);l!=null&&v(e,["responseId"],l);const c=m(a,["usageMetadata"]);return c!=null&&v(e,["usageMetadata"],c),e}function dC(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(A=>A)),v(e,["candidates"],d)}const i=m(a,["createTime"]);i!=null&&v(e,["createTime"],i);const s=m(a,["modelVersion"]);s!=null&&v(e,["modelVersion"],s);const l=m(a,["promptFeedback"]);l!=null&&v(e,["promptFeedback"],l);const c=m(a,["responseId"]);c!=null&&v(e,["responseId"],c);const h=m(a,["usageMetadata"]);return h!=null&&v(e,["usageMetadata"],h),e}function rR(a,e){const t={};if(m(a,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(a,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=m(a,["numberOfImages"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const i=m(a,["aspectRatio"]);e!==void 0&&i!=null&&v(e,["parameters","aspectRatio"],i);const s=m(a,["guidanceScale"]);if(e!==void 0&&s!=null&&v(e,["parameters","guidanceScale"],s),m(a,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=m(a,["safetyFilterLevel"]);e!==void 0&&l!=null&&v(e,["parameters","safetySetting"],l);const c=m(a,["personGeneration"]);e!==void 0&&c!=null&&v(e,["parameters","personGeneration"],c);const h=m(a,["includeSafetyAttributes"]);e!==void 0&&h!=null&&v(e,["parameters","includeSafetyAttributes"],h);const d=m(a,["includeRaiReason"]);e!==void 0&&d!=null&&v(e,["parameters","includeRaiReason"],d);const A=m(a,["language"]);e!==void 0&&A!=null&&v(e,["parameters","language"],A);const f=m(a,["outputMimeType"]);e!==void 0&&f!=null&&v(e,["parameters","outputOptions","mimeType"],f);const p=m(a,["outputCompressionQuality"]);if(e!==void 0&&p!=null&&v(e,["parameters","outputOptions","compressionQuality"],p),m(a,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(m(a,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const b=m(a,["imageSize"]);if(e!==void 0&&b!=null&&v(e,["parameters","sampleImageSize"],b),m(a,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function sR(a,e){const t={},n=m(a,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const i=m(a,["negativePrompt"]);e!==void 0&&i!=null&&v(e,["parameters","negativePrompt"],i);const s=m(a,["numberOfImages"]);e!==void 0&&s!=null&&v(e,["parameters","sampleCount"],s);const l=m(a,["aspectRatio"]);e!==void 0&&l!=null&&v(e,["parameters","aspectRatio"],l);const c=m(a,["guidanceScale"]);e!==void 0&&c!=null&&v(e,["parameters","guidanceScale"],c);const h=m(a,["seed"]);e!==void 0&&h!=null&&v(e,["parameters","seed"],h);const d=m(a,["safetyFilterLevel"]);e!==void 0&&d!=null&&v(e,["parameters","safetySetting"],d);const A=m(a,["personGeneration"]);e!==void 0&&A!=null&&v(e,["parameters","personGeneration"],A);const f=m(a,["includeSafetyAttributes"]);e!==void 0&&f!=null&&v(e,["parameters","includeSafetyAttributes"],f);const p=m(a,["includeRaiReason"]);e!==void 0&&p!=null&&v(e,["parameters","includeRaiReason"],p);const b=m(a,["language"]);e!==void 0&&b!=null&&v(e,["parameters","language"],b);const w=m(a,["outputMimeType"]);e!==void 0&&w!=null&&v(e,["parameters","outputOptions","mimeType"],w);const S=m(a,["outputCompressionQuality"]);e!==void 0&&S!=null&&v(e,["parameters","outputOptions","compressionQuality"],S);const k=m(a,["addWatermark"]);e!==void 0&&k!=null&&v(e,["parameters","addWatermark"],k);const E=m(a,["labels"]);e!==void 0&&E!=null&&v(e,["labels"],E);const I=m(a,["imageSize"]);e!==void 0&&I!=null&&v(e,["parameters","sampleImageSize"],I);const P=m(a,["enhancePrompt"]);return e!==void 0&&P!=null&&v(e,["parameters","enhancePrompt"],P),t}function oR(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["prompt"]);i!=null&&v(t,["instances[0]","prompt"],i);const s=m(e,["config"]);return s!=null&&rR(s,t),t}function lR(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["prompt"]);i!=null&&v(t,["instances[0]","prompt"],i);const s=m(e,["config"]);return s!=null&&sR(s,t),t}function cR(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>CR(l))),v(e,["generatedImages"],s)}const i=m(a,["positivePromptSafetyAttributes"]);return i!=null&&v(e,["positivePromptSafetyAttributes"],zw(i)),e}function uR(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>Gd(l))),v(e,["generatedImages"],s)}const i=m(a,["positivePromptSafetyAttributes"]);return i!=null&&v(e,["positivePromptSafetyAttributes"],Ow(i)),e}function dR(a,e){const t={},n=m(a,["numberOfVideos"]);if(e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n),m(a,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(a,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=m(a,["durationSeconds"]);if(e!==void 0&&i!=null&&v(e,["parameters","durationSeconds"],i),m(a,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=m(a,["aspectRatio"]);e!==void 0&&s!=null&&v(e,["parameters","aspectRatio"],s);const l=m(a,["resolution"]);e!==void 0&&l!=null&&v(e,["parameters","resolution"],l);const c=m(a,["personGeneration"]);if(e!==void 0&&c!=null&&v(e,["parameters","personGeneration"],c),m(a,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const h=m(a,["negativePrompt"]);e!==void 0&&h!=null&&v(e,["parameters","negativePrompt"],h);const d=m(a,["enhancePrompt"]);if(e!==void 0&&d!=null&&v(e,["parameters","enhancePrompt"],d),m(a,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const A=m(a,["lastFrame"]);e!==void 0&&A!=null&&v(e,["instances[0]","lastFrame"],Ld(A));const f=m(a,["referenceImages"]);if(e!==void 0&&f!=null){let p=f;Array.isArray(p)&&(p=p.map(b=>AN(b))),v(e,["instances[0]","referenceImages"],p)}if(m(a,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(m(a,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function hR(a,e){const t={},n=m(a,["numberOfVideos"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const i=m(a,["outputGcsUri"]);e!==void 0&&i!=null&&v(e,["parameters","storageUri"],i);const s=m(a,["fps"]);e!==void 0&&s!=null&&v(e,["parameters","fps"],s);const l=m(a,["durationSeconds"]);e!==void 0&&l!=null&&v(e,["parameters","durationSeconds"],l);const c=m(a,["seed"]);e!==void 0&&c!=null&&v(e,["parameters","seed"],c);const h=m(a,["aspectRatio"]);e!==void 0&&h!=null&&v(e,["parameters","aspectRatio"],h);const d=m(a,["resolution"]);e!==void 0&&d!=null&&v(e,["parameters","resolution"],d);const A=m(a,["personGeneration"]);e!==void 0&&A!=null&&v(e,["parameters","personGeneration"],A);const f=m(a,["pubsubTopic"]);e!==void 0&&f!=null&&v(e,["parameters","pubsubTopic"],f);const p=m(a,["negativePrompt"]);e!==void 0&&p!=null&&v(e,["parameters","negativePrompt"],p);const b=m(a,["enhancePrompt"]);e!==void 0&&b!=null&&v(e,["parameters","enhancePrompt"],b);const w=m(a,["generateAudio"]);e!==void 0&&w!=null&&v(e,["parameters","generateAudio"],w);const S=m(a,["lastFrame"]);e!==void 0&&S!=null&&v(e,["instances[0]","lastFrame"],pi(S));const k=m(a,["referenceImages"]);if(e!==void 0&&k!=null){let P=k;Array.isArray(P)&&(P=P.map(R=>gN(R))),v(e,["instances[0]","referenceImages"],P)}const E=m(a,["mask"]);e!==void 0&&E!=null&&v(e,["instances[0]","mask"],hN(E));const I=m(a,["compressionQuality"]);return e!==void 0&&I!=null&&v(e,["parameters","compressionQuality"],I),t}function AR(a){const e={},t=m(a,["name"]);t!=null&&v(e,["name"],t);const n=m(a,["metadata"]);n!=null&&v(e,["metadata"],n);const i=m(a,["done"]);i!=null&&v(e,["done"],i);const s=m(a,["error"]);s!=null&&v(e,["error"],s);const l=m(a,["response","generateVideoResponse"]);return l!=null&&v(e,["response"],mR(l)),e}function gR(a){const e={},t=m(a,["name"]);t!=null&&v(e,["name"],t);const n=m(a,["metadata"]);n!=null&&v(e,["metadata"],n);const i=m(a,["done"]);i!=null&&v(e,["done"],i);const s=m(a,["error"]);s!=null&&v(e,["error"],s);const l=m(a,["response"]);return l!=null&&v(e,["response"],vR(l)),e}function fR(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["prompt"]);i!=null&&v(t,["instances[0]","prompt"],i);const s=m(e,["image"]);s!=null&&v(t,["instances[0]","image"],Ld(s));const l=m(e,["video"]);l!=null&&v(t,["instances[0]","video"],Vw(l));const c=m(e,["source"]);c!=null&&yR(c,t);const h=m(e,["config"]);return h!=null&&dR(h,t),t}function pR(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["prompt"]);i!=null&&v(t,["instances[0]","prompt"],i);const s=m(e,["image"]);s!=null&&v(t,["instances[0]","image"],pi(s));const l=m(e,["video"]);l!=null&&v(t,["instances[0]","video"],jw(l));const c=m(e,["source"]);c!=null&&bR(c,t);const h=m(e,["config"]);return h!=null&&hR(h,t),t}function mR(a){const e={},t=m(a,["generatedSamples"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(l=>wR(l))),v(e,["generatedVideos"],s)}const n=m(a,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const i=m(a,["raiMediaFilteredReasons"]);return i!=null&&v(e,["raiMediaFilteredReasons"],i),e}function vR(a){const e={},t=m(a,["videos"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(l=>TR(l))),v(e,["generatedVideos"],s)}const n=m(a,["raiMediaFilteredCount"]);n!=null&&v(e,["raiMediaFilteredCount"],n);const i=m(a,["raiMediaFilteredReasons"]);return i!=null&&v(e,["raiMediaFilteredReasons"],i),e}function yR(a,e){const t={},n=m(a,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const i=m(a,["image"]);e!==void 0&&i!=null&&v(e,["instances[0]","image"],Ld(i));const s=m(a,["video"]);return e!==void 0&&s!=null&&v(e,["instances[0]","video"],Vw(s)),t}function bR(a,e){const t={},n=m(a,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const i=m(a,["image"]);e!==void 0&&i!=null&&v(e,["instances[0]","image"],pi(i));const s=m(a,["video"]);return e!==void 0&&s!=null&&v(e,["instances[0]","video"],jw(s)),t}function CR(a){const e={},t=m(a,["_self"]);t!=null&&v(e,["image"],_R(t));const n=m(a,["raiFilteredReason"]);n!=null&&v(e,["raiFilteredReason"],n);const i=m(a,["_self"]);return i!=null&&v(e,["safetyAttributes"],zw(i)),e}function Gd(a){const e={},t=m(a,["_self"]);t!=null&&v(e,["image"],Kw(t));const n=m(a,["raiFilteredReason"]);n!=null&&v(e,["raiFilteredReason"],n);const i=m(a,["_self"]);i!=null&&v(e,["safetyAttributes"],Ow(i));const s=m(a,["prompt"]);return s!=null&&v(e,["enhancedPrompt"],s),e}function SR(a){const e={},t=m(a,["_self"]);t!=null&&v(e,["mask"],Kw(t));const n=m(a,["labels"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>s)),v(e,["labels"],i)}return e}function wR(a){const e={},t=m(a,["video"]);return t!=null&&v(e,["video"],uN(t)),e}function TR(a){const e={},t=m(a,["_self"]);return t!=null&&v(e,["video"],dN(t)),e}function kR(a){const e={},t=m(a,["modelSelectionConfig"]);t!=null&&v(e,["modelConfig"],t);const n=m(a,["responseJsonSchema"]);n!=null&&v(e,["responseJsonSchema"],n);const i=m(a,["audioTimestamp"]);i!=null&&v(e,["audioTimestamp"],i);const s=m(a,["candidateCount"]);s!=null&&v(e,["candidateCount"],s);const l=m(a,["enableAffectiveDialog"]);l!=null&&v(e,["enableAffectiveDialog"],l);const c=m(a,["frequencyPenalty"]);c!=null&&v(e,["frequencyPenalty"],c);const h=m(a,["logprobs"]);h!=null&&v(e,["logprobs"],h);const d=m(a,["maxOutputTokens"]);d!=null&&v(e,["maxOutputTokens"],d);const A=m(a,["mediaResolution"]);A!=null&&v(e,["mediaResolution"],A);const f=m(a,["presencePenalty"]);f!=null&&v(e,["presencePenalty"],f);const p=m(a,["responseLogprobs"]);p!=null&&v(e,["responseLogprobs"],p);const b=m(a,["responseMimeType"]);b!=null&&v(e,["responseMimeType"],b);const w=m(a,["responseModalities"]);w!=null&&v(e,["responseModalities"],w);const S=m(a,["responseSchema"]);S!=null&&v(e,["responseSchema"],S);const k=m(a,["routingConfig"]);k!=null&&v(e,["routingConfig"],k);const E=m(a,["seed"]);E!=null&&v(e,["seed"],E);const I=m(a,["speechConfig"]);I!=null&&v(e,["speechConfig"],I);const P=m(a,["stopSequences"]);P!=null&&v(e,["stopSequences"],P);const R=m(a,["temperature"]);R!=null&&v(e,["temperature"],R);const D=m(a,["thinkingConfig"]);D!=null&&v(e,["thinkingConfig"],D);const N=m(a,["topK"]);N!=null&&v(e,["topK"],N);const _=m(a,["topP"]);if(_!=null&&v(e,["topP"],_),m(a,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function ER(a,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],en(a,n)),t}function xR(a,e){const t={},n=m(e,["model"]);return n!=null&&v(t,["_url","name"],en(a,n)),t}function PR(a){const e={};if(m(a,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(a,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function MR(a){const e={};if(m(a,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(a,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(a,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function IR(a){const e={},t=m(a,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=m(a,["imageSize"]);if(n!=null&&v(e,["imageSize"],n),m(a,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(m(a,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(m(a,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function DR(a){const e={},t=m(a,["aspectRatio"]);t!=null&&v(e,["aspectRatio"],t);const n=m(a,["imageSize"]);n!=null&&v(e,["imageSize"],n);const i=m(a,["personGeneration"]);i!=null&&v(e,["personGeneration"],i);const s=m(a,["outputMimeType"]);s!=null&&v(e,["imageOutputOptions","mimeType"],s);const l=m(a,["outputCompressionQuality"]);return l!=null&&v(e,["imageOutputOptions","compressionQuality"],l),e}function _R(a){const e={},t=m(a,["bytesBase64Encoded"]);t!=null&&v(e,["imageBytes"],zr(t));const n=m(a,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function Kw(a){const e={},t=m(a,["gcsUri"]);t!=null&&v(e,["gcsUri"],t);const n=m(a,["bytesBase64Encoded"]);n!=null&&v(e,["imageBytes"],zr(n));const i=m(a,["mimeType"]);return i!=null&&v(e,["mimeType"],i),e}function Ld(a){const e={};if(m(a,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=m(a,["imageBytes"]);t!=null&&v(e,["bytesBase64Encoded"],zr(t));const n=m(a,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function pi(a){const e={},t=m(a,["gcsUri"]);t!=null&&v(e,["gcsUri"],t);const n=m(a,["imageBytes"]);n!=null&&v(e,["bytesBase64Encoded"],zr(n));const i=m(a,["mimeType"]);return i!=null&&v(e,["mimeType"],i),e}function RR(a,e,t){const n={},i=m(e,["pageSize"]);t!==void 0&&i!=null&&v(t,["_query","pageSize"],i);const s=m(e,["pageToken"]);t!==void 0&&s!=null&&v(t,["_query","pageToken"],s);const l=m(e,["filter"]);t!==void 0&&l!=null&&v(t,["_query","filter"],l);const c=m(e,["queryBase"]);return t!==void 0&&c!=null&&v(t,["_url","models_url"],Dw(a,c)),n}function NR(a,e,t){const n={},i=m(e,["pageSize"]);t!==void 0&&i!=null&&v(t,["_query","pageSize"],i);const s=m(e,["pageToken"]);t!==void 0&&s!=null&&v(t,["_query","pageToken"],s);const l=m(e,["filter"]);t!==void 0&&l!=null&&v(t,["_query","filter"],l);const c=m(e,["queryBase"]);return t!==void 0&&c!=null&&v(t,["_url","models_url"],Dw(a,c)),n}function GR(a,e){const t={},n=m(e,["config"]);return n!=null&&RR(a,n,t),t}function LR(a,e){const t={},n=m(e,["config"]);return n!=null&&NR(a,n,t),t}function BR(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=m(a,["_self"]);if(i!=null){let s=_w(i);Array.isArray(s)&&(s=s.map(l=>Zg(l))),v(e,["models"],s)}return e}function FR(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=m(a,["_self"]);if(i!=null){let s=_w(i);Array.isArray(s)&&(s=s.map(l=>ef(l))),v(e,["models"],s)}return e}function UR(a){const e={},t=m(a,["maskMode"]);t!=null&&v(e,["maskMode"],t);const n=m(a,["segmentationClasses"]);n!=null&&v(e,["maskClasses"],n);const i=m(a,["maskDilation"]);return i!=null&&v(e,["dilation"],i),e}function Zg(a){const e={},t=m(a,["name"]);t!=null&&v(e,["name"],t);const n=m(a,["displayName"]);n!=null&&v(e,["displayName"],n);const i=m(a,["description"]);i!=null&&v(e,["description"],i);const s=m(a,["version"]);s!=null&&v(e,["version"],s);const l=m(a,["_self"]);l!=null&&v(e,["tunedModelInfo"],tN(l));const c=m(a,["inputTokenLimit"]);c!=null&&v(e,["inputTokenLimit"],c);const h=m(a,["outputTokenLimit"]);h!=null&&v(e,["outputTokenLimit"],h);const d=m(a,["supportedGenerationMethods"]);d!=null&&v(e,["supportedActions"],d);const A=m(a,["temperature"]);A!=null&&v(e,["temperature"],A);const f=m(a,["maxTemperature"]);f!=null&&v(e,["maxTemperature"],f);const p=m(a,["topP"]);p!=null&&v(e,["topP"],p);const b=m(a,["topK"]);b!=null&&v(e,["topK"],b);const w=m(a,["thinking"]);return w!=null&&v(e,["thinking"],w),e}function ef(a){const e={},t=m(a,["name"]);t!=null&&v(e,["name"],t);const n=m(a,["displayName"]);n!=null&&v(e,["displayName"],n);const i=m(a,["description"]);i!=null&&v(e,["description"],i);const s=m(a,["versionId"]);s!=null&&v(e,["version"],s);const l=m(a,["deployedModels"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(p=>J_(p))),v(e,["endpoints"],f)}const c=m(a,["labels"]);c!=null&&v(e,["labels"],c);const h=m(a,["_self"]);h!=null&&v(e,["tunedModelInfo"],nN(h));const d=m(a,["defaultCheckpointId"]);d!=null&&v(e,["defaultCheckpointId"],d);const A=m(a,["checkpoints"]);if(A!=null){let f=A;Array.isArray(f)&&(f=f.map(p=>p)),v(e,["checkpoints"],f)}return e}function KR(a){const e={},t=m(a,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(a,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const i=m(a,["executableCode"]);i!=null&&v(e,["executableCode"],i);const s=m(a,["fileData"]);s!=null&&v(e,["fileData"],Z_(s));const l=m(a,["functionCall"]);l!=null&&v(e,["functionCall"],eR(l));const c=m(a,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(a,["inlineData"]);h!=null&&v(e,["inlineData"],k_(h));const d=m(a,["text"]);d!=null&&v(e,["text"],d);const A=m(a,["thought"]);A!=null&&v(e,["thought"],A);const f=m(a,["thoughtSignature"]);f!=null&&v(e,["thoughtSignature"],f);const p=m(a,["videoMetadata"]);return p!=null&&v(e,["videoMetadata"],p),e}function zR(a){const e={},t=m(a,["productImage"]);return t!=null&&v(e,["image"],pi(t)),e}function OR(a,e){const t={},n=m(a,["numberOfImages"]);e!==void 0&&n!=null&&v(e,["parameters","sampleCount"],n);const i=m(a,["baseSteps"]);e!==void 0&&i!=null&&v(e,["parameters","baseSteps"],i);const s=m(a,["outputGcsUri"]);e!==void 0&&s!=null&&v(e,["parameters","storageUri"],s);const l=m(a,["seed"]);e!==void 0&&l!=null&&v(e,["parameters","seed"],l);const c=m(a,["safetyFilterLevel"]);e!==void 0&&c!=null&&v(e,["parameters","safetySetting"],c);const h=m(a,["personGeneration"]);e!==void 0&&h!=null&&v(e,["parameters","personGeneration"],h);const d=m(a,["addWatermark"]);e!==void 0&&d!=null&&v(e,["parameters","addWatermark"],d);const A=m(a,["outputMimeType"]);e!==void 0&&A!=null&&v(e,["parameters","outputOptions","mimeType"],A);const f=m(a,["outputCompressionQuality"]);e!==void 0&&f!=null&&v(e,["parameters","outputOptions","compressionQuality"],f);const p=m(a,["enhancePrompt"]);e!==void 0&&p!=null&&v(e,["parameters","enhancePrompt"],p);const b=m(a,["labels"]);return e!==void 0&&b!=null&&v(e,["labels"],b),t}function HR(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["source"]);i!=null&&jR(i,t);const s=m(e,["config"]);return s!=null&&OR(s,t),t}function VR(a){const e={},t=m(a,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>Gd(i))),v(e,["generatedImages"],n)}return e}function jR(a,e){const t={},n=m(a,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const i=m(a,["personImage"]);e!==void 0&&i!=null&&v(e,["instances[0]","personImage","image"],pi(i));const s=m(a,["productImages"]);if(e!==void 0&&s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>zR(c))),v(e,["instances[0]","productImages"],l)}return t}function QR(a){const e={},t=m(a,["referenceImage"]);t!=null&&v(e,["referenceImage"],pi(t));const n=m(a,["referenceId"]);n!=null&&v(e,["referenceId"],n);const i=m(a,["referenceType"]);i!=null&&v(e,["referenceType"],i);const s=m(a,["maskImageConfig"]);s!=null&&v(e,["maskImageConfig"],UR(s));const l=m(a,["controlImageConfig"]);l!=null&&v(e,["controlImageConfig"],__(l));const c=m(a,["styleImageConfig"]);c!=null&&v(e,["styleImageConfig"],c);const h=m(a,["subjectImageConfig"]);return h!=null&&v(e,["subjectImageConfig"],h),e}function zw(a){const e={},t=m(a,["safetyAttributes","categories"]);t!=null&&v(e,["categories"],t);const n=m(a,["safetyAttributes","scores"]);n!=null&&v(e,["scores"],n);const i=m(a,["contentType"]);return i!=null&&v(e,["contentType"],i),e}function Ow(a){const e={},t=m(a,["safetyAttributes","categories"]);t!=null&&v(e,["categories"],t);const n=m(a,["safetyAttributes","scores"]);n!=null&&v(e,["scores"],n);const i=m(a,["contentType"]);return i!=null&&v(e,["contentType"],i),e}function qR(a){const e={},t=m(a,["category"]);if(t!=null&&v(e,["category"],t),m(a,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=m(a,["threshold"]);return n!=null&&v(e,["threshold"],n),e}function YR(a){const e={},t=m(a,["image"]);return t!=null&&v(e,["image"],pi(t)),e}function XR(a,e){const t={},n=m(a,["mode"]);e!==void 0&&n!=null&&v(e,["parameters","mode"],n);const i=m(a,["maxPredictions"]);e!==void 0&&i!=null&&v(e,["parameters","maxPredictions"],i);const s=m(a,["confidenceThreshold"]);e!==void 0&&s!=null&&v(e,["parameters","confidenceThreshold"],s);const l=m(a,["maskDilation"]);e!==void 0&&l!=null&&v(e,["parameters","maskDilation"],l);const c=m(a,["binaryColorThreshold"]);e!==void 0&&c!=null&&v(e,["parameters","binaryColorThreshold"],c);const h=m(a,["labels"]);return e!==void 0&&h!=null&&v(e,["labels"],h),t}function WR(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["source"]);i!=null&&JR(i,t);const s=m(e,["config"]);return s!=null&&XR(s,t),t}function $R(a){const e={},t=m(a,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(i=>SR(i))),v(e,["generatedMasks"],n)}return e}function JR(a,e){const t={},n=m(a,["prompt"]);e!==void 0&&n!=null&&v(e,["instances[0]","prompt"],n);const i=m(a,["image"]);e!==void 0&&i!=null&&v(e,["instances[0]","image"],pi(i));const s=m(a,["scribbleImage"]);return e!==void 0&&s!=null&&v(e,["instances[0]","scribble"],YR(s)),t}function ZR(a){const e={},t=m(a,["retrievalConfig"]);t!=null&&v(e,["retrievalConfig"],t);const n=m(a,["functionCallingConfig"]);return n!=null&&v(e,["functionCallingConfig"],tR(n)),e}function eN(a){const e={};if(m(a,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(a,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(a,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const i=m(a,["codeExecution"]);if(i!=null&&v(e,["codeExecution"],i),m(a,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=m(a,["functionDeclarations"]);if(s!=null){let A=s;Array.isArray(A)&&(A=A.map(f=>f)),v(e,["functionDeclarations"],A)}const l=m(a,["googleMaps"]);l!=null&&v(e,["googleMaps"],PR(l));const c=m(a,["googleSearch"]);c!=null&&v(e,["googleSearch"],MR(c));const h=m(a,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const d=m(a,["urlContext"]);return d!=null&&v(e,["urlContext"],d),e}function Hw(a){const e={},t=m(a,["retrieval"]);t!=null&&v(e,["retrieval"],t);const n=m(a,["computerUse"]);if(n!=null&&v(e,["computerUse"],n),m(a,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const i=m(a,["codeExecution"]);i!=null&&v(e,["codeExecution"],i);const s=m(a,["enterpriseWebSearch"]);s!=null&&v(e,["enterpriseWebSearch"],s);const l=m(a,["functionDeclarations"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(p=>nR(p))),v(e,["functionDeclarations"],f)}const c=m(a,["googleMaps"]);c!=null&&v(e,["googleMaps"],c);const h=m(a,["googleSearch"]);h!=null&&v(e,["googleSearch"],h);const d=m(a,["googleSearchRetrieval"]);d!=null&&v(e,["googleSearchRetrieval"],d);const A=m(a,["urlContext"]);return A!=null&&v(e,["urlContext"],A),e}function tN(a){const e={},t=m(a,["baseModel"]);t!=null&&v(e,["baseModel"],t);const n=m(a,["createTime"]);n!=null&&v(e,["createTime"],n);const i=m(a,["updateTime"]);return i!=null&&v(e,["updateTime"],i),e}function nN(a){const e={},t=m(a,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&v(e,["baseModel"],t);const n=m(a,["createTime"]);n!=null&&v(e,["createTime"],n);const i=m(a,["updateTime"]);return i!=null&&v(e,["updateTime"],i),e}function aN(a,e){const t={},n=m(a,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const i=m(a,["description"]);e!==void 0&&i!=null&&v(e,["description"],i);const s=m(a,["defaultCheckpointId"]);return e!==void 0&&s!=null&&v(e,["defaultCheckpointId"],s),t}function iN(a,e){const t={},n=m(a,["displayName"]);e!==void 0&&n!=null&&v(e,["displayName"],n);const i=m(a,["description"]);e!==void 0&&i!=null&&v(e,["description"],i);const s=m(a,["defaultCheckpointId"]);return e!==void 0&&s!=null&&v(e,["defaultCheckpointId"],s),t}function rN(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","name"],en(a,n));const i=m(e,["config"]);return i!=null&&aN(i,t),t}function sN(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["config"]);return i!=null&&iN(i,t),t}function oN(a,e){const t={},n=m(a,["outputGcsUri"]);e!==void 0&&n!=null&&v(e,["parameters","storageUri"],n);const i=m(a,["safetyFilterLevel"]);e!==void 0&&i!=null&&v(e,["parameters","safetySetting"],i);const s=m(a,["personGeneration"]);e!==void 0&&s!=null&&v(e,["parameters","personGeneration"],s);const l=m(a,["includeRaiReason"]);e!==void 0&&l!=null&&v(e,["parameters","includeRaiReason"],l);const c=m(a,["outputMimeType"]);e!==void 0&&c!=null&&v(e,["parameters","outputOptions","mimeType"],c);const h=m(a,["outputCompressionQuality"]);e!==void 0&&h!=null&&v(e,["parameters","outputOptions","compressionQuality"],h);const d=m(a,["enhanceInputImage"]);e!==void 0&&d!=null&&v(e,["parameters","upscaleConfig","enhanceInputImage"],d);const A=m(a,["imagePreservationFactor"]);e!==void 0&&A!=null&&v(e,["parameters","upscaleConfig","imagePreservationFactor"],A);const f=m(a,["labels"]);e!==void 0&&f!=null&&v(e,["labels"],f);const p=m(a,["numberOfImages"]);e!==void 0&&p!=null&&v(e,["parameters","sampleCount"],p);const b=m(a,["mode"]);return e!==void 0&&b!=null&&v(e,["parameters","mode"],b),t}function lN(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["_url","model"],en(a,n));const i=m(e,["image"]);i!=null&&v(t,["instances[0]","image"],pi(i));const s=m(e,["upscaleFactor"]);s!=null&&v(t,["parameters","upscaleConfig","upscaleFactor"],s);const l=m(e,["config"]);return l!=null&&oN(l,t),t}function cN(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["predictions"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Gd(s))),v(e,["generatedImages"],i)}return e}function uN(a){const e={},t=m(a,["uri"]);t!=null&&v(e,["uri"],t);const n=m(a,["encodedVideo"]);n!=null&&v(e,["videoBytes"],zr(n));const i=m(a,["encoding"]);return i!=null&&v(e,["mimeType"],i),e}function dN(a){const e={},t=m(a,["gcsUri"]);t!=null&&v(e,["uri"],t);const n=m(a,["bytesBase64Encoded"]);n!=null&&v(e,["videoBytes"],zr(n));const i=m(a,["mimeType"]);return i!=null&&v(e,["mimeType"],i),e}function hN(a){const e={},t=m(a,["image"]);t!=null&&v(e,["_self"],pi(t));const n=m(a,["maskMode"]);return n!=null&&v(e,["maskMode"],n),e}function AN(a){const e={},t=m(a,["image"]);t!=null&&v(e,["image"],Ld(t));const n=m(a,["referenceType"]);return n!=null&&v(e,["referenceType"],n),e}function gN(a){const e={},t=m(a,["image"]);t!=null&&v(e,["image"],pi(t));const n=m(a,["referenceType"]);return n!=null&&v(e,["referenceType"],n),e}function Vw(a){const e={},t=m(a,["uri"]);t!=null&&v(e,["uri"],t);const n=m(a,["videoBytes"]);n!=null&&v(e,["encodedVideo"],zr(n));const i=m(a,["mimeType"]);return i!=null&&v(e,["encoding"],i),e}function jw(a){const e={},t=m(a,["uri"]);t!=null&&v(e,["gcsUri"],t);const n=m(a,["videoBytes"]);n!=null&&v(e,["bytesBase64Encoded"],zr(n));const i=m(a,["mimeType"]);return i!=null&&v(e,["mimeType"],i),e}function fN(a,e){const t={},n=m(a,["displayName"]);return e!==void 0&&n!=null&&v(e,["displayName"],n),t}function pN(a){const e={},t=m(a,["config"]);return t!=null&&fN(t,e),e}function mN(a,e){const t={},n=m(a,["force"]);return e!==void 0&&n!=null&&v(e,["_query","force"],n),t}function vN(a){const e={},t=m(a,["name"]);t!=null&&v(e,["_url","name"],t);const n=m(a,["config"]);return n!=null&&mN(n,e),e}function yN(a){const e={},t=m(a,["name"]);return t!=null&&v(e,["_url","name"],t),e}function bN(a,e){const t={},n=m(a,["customMetadata"]);if(e!==void 0&&n!=null){let s=n;Array.isArray(s)&&(s=s.map(l=>l)),v(e,["customMetadata"],s)}const i=m(a,["chunkingConfig"]);return e!==void 0&&i!=null&&v(e,["chunkingConfig"],i),t}function CN(a){const e={},t=m(a,["name"]);t!=null&&v(e,["name"],t);const n=m(a,["metadata"]);n!=null&&v(e,["metadata"],n);const i=m(a,["done"]);i!=null&&v(e,["done"],i);const s=m(a,["error"]);s!=null&&v(e,["error"],s);const l=m(a,["response"]);return l!=null&&v(e,["response"],wN(l)),e}function SN(a){const e={},t=m(a,["fileSearchStoreName"]);t!=null&&v(e,["_url","file_search_store_name"],t);const n=m(a,["fileName"]);n!=null&&v(e,["fileName"],n);const i=m(a,["config"]);return i!=null&&bN(i,e),e}function wN(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["parent"]);n!=null&&v(e,["parent"],n);const i=m(a,["documentName"]);return i!=null&&v(e,["documentName"],i),e}function TN(a,e){const t={},n=m(a,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const i=m(a,["pageToken"]);return e!==void 0&&i!=null&&v(e,["_query","pageToken"],i),t}function kN(a){const e={},t=m(a,["config"]);return t!=null&&TN(t,e),e}function EN(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=m(a,["fileSearchStores"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>l)),v(e,["fileSearchStores"],s)}return e}function Qw(a,e){const t={},n=m(a,["mimeType"]);e!==void 0&&n!=null&&v(e,["mimeType"],n);const i=m(a,["displayName"]);e!==void 0&&i!=null&&v(e,["displayName"],i);const s=m(a,["customMetadata"]);if(e!==void 0&&s!=null){let c=s;Array.isArray(c)&&(c=c.map(h=>h)),v(e,["customMetadata"],c)}const l=m(a,["chunkingConfig"]);return e!==void 0&&l!=null&&v(e,["chunkingConfig"],l),t}function xN(a){const e={},t=m(a,["fileSearchStoreName"]);t!=null&&v(e,["_url","file_search_store_name"],t);const n=m(a,["config"]);return n!=null&&Qw(n,e),e}function PN(a){const e={},t=m(a,["sdkHttpResponse"]);return t!=null&&v(e,["sdkHttpResponse"],t),e}const MN="Content-Type",IN="X-Server-Timeout",DN="User-Agent",tf="x-goog-api-client",_N="1.35.0",RN=`google-genai-sdk/${_N}`,NN="v1beta1",GN="v1beta";class LN{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:NN,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:GN,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,n){const i=[this.getRequestUrlInternal(t)];return n&&i.push(this.getBaseResourcePath()),e!==""&&i.push(e),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[l,c]of Object.entries(e.queryParams))i.searchParams.append(l,String(c));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,t,i.toString(),e.abortSignal),this.unaryApiCall(i,s,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[i,s]of Object.entries(t))typeof s=="object"?n[i]=Object.assign(Object.assign({},n[i]),s):s!==void 0&&(n[i]=s);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),i=this.constructUrl(e.path,t,n);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,t,i.toString(),e.abortSignal),this.streamApiCall(i,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,i){if(t&&t.timeout||i){const s=new AbortController,l=s.signal;if(t.timeout&&t?.timeout>0){const c=setTimeout(()=>s.abort(),t.timeout);c&&typeof c.unref=="function"&&c.unref()}i&&i.addEventListener("abort",()=>{s.abort()}),e.signal=l}return t&&t.extraBody!==null&&BN(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async i=>(await hC(i),new Wg(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async i=>(await hC(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(e){return gi(this,arguments,function*(){var n;const i=(n=e?.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let l="";const c="data:",h=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:d,value:A}=yield Tt(i.read());if(d){if(l.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const f=s.decode(A,{stream:!0});try{const w=JSON.parse(f);if("error"in w){const S=JSON.parse(JSON.stringify(w.error)),k=S.status,E=S.code,I=`got status: ${k}. ${JSON.stringify(w)}`;if(E>=400&&E<600)throw new Fw({message:I,status:E})}}catch(w){if(w.name==="ApiError")throw w}l+=f;let p=-1,b=0;for(;;){p=-1,b=0;for(const k of h){const E=l.indexOf(k);E!==-1&&(p===-1||E<p)&&(p=E,b=k.length)}if(p===-1)break;const w=l.substring(0,p);l=l.substring(p+b);const S=w.trim();if(S.startsWith(c)){const k=S.substring(c.length).trim();try{const E=new Response(k,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield Tt(new Wg(E))}catch(E){throw new Error(`exception parsing stream chunk ${k}. ${E}`)}}}}}finally{i.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const e={},t=RN+" "+this.clientOptions.userAgentExtra;return e[DN]=t,e[tf]=t,e[MN]="application/json",e}async getHeadersInternal(e,t){const n=new Headers;if(e&&e.headers){for(const[i,s]of Object.entries(e.headers))n.append(i,s);e.timeout&&e.timeout>0&&n.append(IN,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return typeof e=="string"&&(n=e.replace(/[/\\]+$/,""),n=(t=n.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),n}async uploadFile(e,t){var n;const i={};t!=null&&(i.mimeType=t.mimeType,i.name=t.name,i.displayName=t.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,l=await s.stat(e);i.sizeBytes=String(l.size);const c=(n=t?.mimeType)!==null&&n!==void 0?n:l.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=c;const h={file:i},d=this.getFileName(e),A=$e("upload/v1beta/files",h._url),f=await this.fetchUploadUrl(A,i.sizeBytes,i.mimeType,d,h,t?.httpOptions);return s.upload(e,f,this)}async uploadFileToFileSearchStore(e,t,n){var i;const s=this.clientOptions.uploader,l=await s.stat(t),c=String(l.size),h=(i=n?.mimeType)!==null&&i!==void 0?i:l.type;if(h===void 0||h==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const d=`upload/v1beta/${e}:uploadToFileSearchStore`,A=this.getFileName(t),f={};n!=null&&Qw(n,f);const p=await this.fetchUploadUrl(d,c,h,A,f,n?.httpOptions);return s.uploadToFileSearchStore(t,p,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,n,i,s,l){var c;let h={};l?h=l:h={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},i?{"X-Goog-Upload-File-Name":i}:{})};const d=await this.request({path:e,body:JSON.stringify(s),httpMethod:"POST",httpOptions:h});if(!d||!d?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const A=(c=d?.headers)===null||c===void 0?void 0:c["x-goog-upload-url"];if(A===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return A}}async function hC(a){var e;if(a===void 0)throw new Error("response is undefined");if(!a.ok){const t=a.status;let n;!((e=a.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?n=await a.json():n={error:{message:await a.text(),code:a.status,status:a.statusText}};const i=JSON.stringify(n);throw t>=400&&t<600?new Fw({message:i,status:t}):new Error(i)}}function BN(a,e){if(!e||Object.keys(e).length===0)return;if(a.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof a.body=="string"&&a.body.length>0)try{const s=JSON.parse(a.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))t=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(s,l){const c=Object.assign({},s);for(const h in l)if(Object.prototype.hasOwnProperty.call(l,h)){const d=l[h],A=c[h];d&&typeof d=="object"&&!Array.isArray(d)&&A&&typeof A=="object"&&!Array.isArray(A)?c[h]=n(A,d):(A&&d&&typeof A!=typeof d&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${h}". Original type: ${typeof A}, New type: ${typeof d}. Overwriting.`),c[h]=d)}return c}const i=n(t,e);a.body=JSON.stringify(i)}const FN="mcp_used/unknown";let UN=!1;function qw(a){for(const e of a)if(KN(e)||typeof e=="object"&&"inputSchema"in e)return!0;return UN}function Yw(a){var e;const t=(e=a[tf])!==null&&e!==void 0?e:"";a[tf]=(t+` ${FN}`).trimStart()}function KN(a){return a!==null&&typeof a=="object"&&a instanceof Zf}function zN(a){return gi(this,arguments,function*(t,n=100){let i,s=0;for(;s<n;){const l=yield Tt(t.listTools({cursor:i}));for(const c of l.tools)yield yield Tt(c),s++;if(!l.nextCursor)break;i=l.nextCursor}})}class Zf{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new Zf(e,t)}async initialize(){var e,t,n,i;if(this.mcpTools.length>0)return;const s={},l=[];for(const A of this.mcpClients)try{for(var c=!0,h=(t=void 0,fi(zN(A))),d;d=await h.next(),e=d.done,!e;c=!0){i=d.value,c=!1;const f=i;l.push(f);const p=f.name;if(s[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);s[p]=A}}catch(f){t={error:f}}finally{try{!c&&!e&&(n=h.return)&&await n.call(h)}finally{if(t)throw t.error}}this.mcpTools=l,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),y1(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[n.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const l=await i.callTool({name:n.name,arguments:n.args},void 0,s);t.push({functionResponse:{name:n.name,response:l.isError?{error:l}:l}})}return t}}async function ON(a,e,t){const n=new d1;let i;t.data instanceof Blob?i=JSON.parse(await t.data.text()):i=JSON.parse(t.data),Object.assign(n,i),e(n)}class HN{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),l=QN(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),h=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${c}`;let d=()=>{};const A=new Promise(P=>{d=P}),f=e.callbacks,p=function(){d({})},b=this.apiClient,w={onopen:p,onmessage:P=>{ON(b,f.onmessage,P)},onerror:(t=f?.onerror)!==null&&t!==void 0?t:function(P){},onclose:(n=f?.onclose)!==null&&n!==void 0?n:function(P){}},S=this.webSocketFactory.create(h,jN(l),w);S.connect(),await A;const I={setup:{model:en(this.apiClient,e.model)}};return S.send(JSON.stringify(I)),new VN(S,this.apiClient)}}class VN{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=p_(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=f_(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Ao.PLAY)}pause(){this.sendPlaybackControl(Ao.PAUSE)}stop(){this.sendPlaybackControl(Ao.STOP)}resetContext(){this.sendPlaybackControl(Ao.RESET_CONTEXT)}close(){this.conn.close()}}function jN(a){const e={};return a.forEach((t,n)=>{e[n]=t}),e}function QN(a){const e=new Headers;for(const[t,n]of Object.entries(a))e.append(t,n);return e}const qN="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function YN(a,e,t){const n=new u1;let i;t.data instanceof Blob?i=await t.data.text():t.data instanceof ArrayBuffer?i=new TextDecoder().decode(t.data):i=t.data;const s=JSON.parse(i);if(a.isVertexAI()){const l=y_(s);Object.assign(n,l)}else Object.assign(n,s);e(n)}class XN{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new HN(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,i,s,l,c;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const h=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let A;const f=this.apiClient.getHeaders();e.config&&e.config.tools&&qw(e.config.tools)&&Yw(f);const p=ZN(f);if(this.apiClient.isVertexAI())A=`${h}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p,A);else{const G=this.apiClient.getApiKey();let L="BidiGenerateContent",O="key";G?.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),d!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),L="BidiGenerateContentConstrained",O="access_token"),A=`${h}/ws/google.ai.generativelanguage.${d}.GenerativeService.${L}?${O}=${G}`}let b=()=>{};const w=new Promise(G=>{b=G}),S=e.callbacks,k=function(){var G;(G=S?.onopen)===null||G===void 0||G.call(S),b({})},E=this.apiClient,I={onopen:k,onmessage:G=>{YN(E,S.onmessage,G)},onerror:(t=S?.onerror)!==null&&t!==void 0?t:function(G){},onclose:(n=S?.onclose)!==null&&n!==void 0?n:function(G){}},P=this.webSocketFactory.create(A,JN(p),I);P.connect(),await w;let R=en(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&R.startsWith("publishers/")){const G=this.apiClient.getProject(),L=this.apiClient.getLocation();R=`projects/${G}/locations/${L}/`+R}let D={};this.apiClient.isVertexAI()&&((i=e.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[ar.AUDIO]}:e.config.responseModalities=[ar.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const N=(c=(l=e.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[],_=[];for(const G of N)if(this.isCallableTool(G)){const L=G;_.push(await L.tool())}else _.push(G);_.length>0&&(e.config.tools=_);const K={model:R,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?D=g_(this.apiClient,K):D=A_(this.apiClient,K),delete D.config,P.send(JSON.stringify(D)),new $N(P,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const WN={turnComplete:!0};class $N{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let n=[];try{n=ai(t.turns),e.isVertexAI()||(n=n.map(i=>Nd(i)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?n=t.functionResponses:n=[t.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const s of n){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(qN)}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},WN),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:v_(e)}:t={realtimeInput:m_(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function JN(a){const e={};return a.forEach((t,n)=>{e[n]=t}),e}function ZN(a){const e=new Headers;for(const[t,n]of Object.entries(a))e.append(t,n);return e}const AC=10;function gC(a){var e,t,n;if(!((e=a?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let i=!1;for(const l of(t=a?.tools)!==null&&t!==void 0?t:[])if(To(l)){i=!0;break}if(!i)return!0;const s=(n=a?.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function To(a){return"callTool"in a&&typeof a.callTool=="function"}function eG(a){var e,t,n;return(n=(t=(e=a.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(i=>To(i)))!==null&&n!==void 0?n:!1}function fC(a){var e;const t=[];return!((e=a?.config)===null||e===void 0)&&e.tools&&a.config.tools.forEach((n,i)=>{if(To(n))return;const s=n;s.functionDeclarations&&s.functionDeclarations.length>0&&t.push(i)}),t}function pC(a){var e;return!(!((e=a?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}class tG extends sr{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var n,i,s,l,c;const h=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!eG(t)||gC(t.config))return await this.generateContentInternal(h);const d=fC(t);if(d.length>0){const S=d.map(k=>`tools[${k}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${S}.`)}let A,f;const p=ai(h.contents),b=(s=(i=(n=h.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:AC;let w=0;for(;w<b&&(A=await this.generateContentInternal(h),!(!A.functionCalls||A.functionCalls.length===0));){const S=A.candidates[0].content,k=[];for(const E of(c=(l=t.config)===null||l===void 0?void 0:l.tools)!==null&&c!==void 0?c:[])if(To(E)){const P=await E.callTool(A.functionCalls);k.push(...P)}w++,f={role:"user",parts:k},h.contents=ai(h.contents),h.contents.push(S),h.contents.push(f),pC(h.config)&&(p.push(S),p.push(f))}return pC(h.config)&&(A.automaticFunctionCallingHistory=p),A},this.generateContentStream=async t=>{var n,i,s,l,c;if(this.maybeMoveToResponseJsonSchem(t),gC(t.config)){const f=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(f)}const h=fC(t);if(h.length>0){const f=h.map(p=>`tools[${p}]`).join(", ");throw new Error(`Incompatible tools found at ${f}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const d=(s=(i=(n=t?.config)===null||n===void 0?void 0:n.toolConfig)===null||i===void 0?void 0:i.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,A=(c=(l=t?.config)===null||l===void 0?void 0:l.automaticFunctionCalling)===null||c===void 0?void 0:c.disable;if(d&&!A)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(n=>{var i;let s;const l=[];if(n?.generatedImages)for(const h of n.generatedImages)h&&h?.safetyAttributes&&((i=h?.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=h?.safetyAttributes:l.push(h);let c;return s?c={generatedImages:l,positivePromptSafetyAttributes:s,sdkHttpResponse:n.sdkHttpResponse}:c={generatedImages:l,sdkHttpResponse:n.sdkHttpResponse},c}),this.list=async t=>{var n;const l={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!l.config.queryBase){if(!((n=l.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");l.config.filter="labels.tune-type:*"}return new vs(ir.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(l),l)},this.editImage=async t=>{const n={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(n.referenceImages=t.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async t=>{let n={numberOfImages:1,mode:"upscale"};t.config&&(n=Object.assign(Object.assign({},n),t.config));const i={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:n};return await this.upscaleImageInternal(i)},this.generateVideos=async t=>{var n,i,s,l,c,h;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((n=t.video)===null||n===void 0)&&n.uri&&(!((i=t.video)===null||i===void 0)&&i.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((l=(s=t.source)===null||s===void 0?void 0:s.video)===null||l===void 0)&&l.uri&&(!((h=(c=t.source)===null||c===void 0?void 0:c.video)===null||h===void 0)&&h.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,i;const s=(t=e.config)===null||t===void 0?void 0:t.tools;if(!s)return e;const l=await Promise.all(s.map(async h=>To(h)?await h.tool():h)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:l})};if(c.config.tools=l,e.config&&e.config.tools&&qw(e.config.tools)){const h=(i=(n=e.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&i!==void 0?i:{};let d=Object.assign({},h);Object.keys(d).length===0&&(d=this.apiClient.getDefaultHeaders()),Yw(d),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:d})}return c}async initAfcToolsMap(e){var t,n,i;const s=new Map;for(const l of(n=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&n!==void 0?n:[])if(To(l)){const c=l,h=await c.tool();for(const d of(i=h.functionDeclarations)!==null&&i!==void 0?i:[]){if(!d.name)throw new Error("Function declaration name is required.");if(s.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);s.set(d.name,c)}}return s}async processAfcStream(e){var t,n,i;const s=(i=(n=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&i!==void 0?i:AC;let l=!1,c=0;const h=await this.initAfcToolsMap(e);return(function(d,A,f){return gi(this,arguments,function*(){for(var p,b,w,S,k,E;c<s;){l&&(c++,l=!1);const D=yield Tt(d.processParamsMaybeAddMcpUsage(f)),N=yield Tt(d.generateContentStreamInternal(D)),_=[],K=[];try{for(var I=!0,P=(b=void 0,fi(N)),R;R=yield Tt(P.next()),p=R.done,!p;I=!0){S=R.value,I=!1;const G=S;if(yield yield Tt(G),G.candidates&&(!((k=G.candidates[0])===null||k===void 0)&&k.content)){K.push(G.candidates[0].content);for(const L of(E=G.candidates[0].content.parts)!==null&&E!==void 0?E:[])if(c<s&&L.functionCall){if(!L.functionCall.name)throw new Error("Function call name was not returned by the model.");if(A.has(L.functionCall.name)){const O=yield Tt(A.get(L.functionCall.name).callTool([L.functionCall]));_.push(...O)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${A.keys()}, mising tool: ${L.functionCall.name}`)}}}}catch(G){b={error:G}}finally{try{!I&&!p&&(w=P.return)&&(yield Tt(w.call(P)))}finally{if(b)throw b.error}}if(_.length>0){l=!0;const G=new Dl;G.candidates=[{content:{role:"user",parts:_}}],yield yield Tt(G);const L=[];L.push(...K),L.push({role:"user",parts:_});const O=ai(f.contents).concat(L);f.contents=O}else break}})})(this,h,e)}async generateContentInternal(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=cC(this.apiClient,e);return c=$e("{model}:generateContent",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=dC(A),p=new Dl;return Object.assign(p,f),p})}else{const d=lC(this.apiClient,e);return c=$e("{model}:generateContent",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=uC(A),p=new Dl;return Object.assign(p,f),p})}}async generateContentStreamInternal(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=cC(this.apiClient,e);return c=$e("{model}:streamGenerateContent?alt=sse",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.requestStream({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}),l.then(function(f){return gi(this,arguments,function*(){var p,b,w,S;try{for(var k=!0,E=fi(f),I;I=yield Tt(E.next()),p=I.done,!p;k=!0){S=I.value,k=!1;const P=S,R=dC(yield Tt(P.json()));R.sdkHttpResponse={headers:P.headers};const D=new Dl;Object.assign(D,R),yield yield Tt(D)}}catch(P){b={error:P}}finally{try{!k&&!p&&(w=E.return)&&(yield Tt(w.call(E)))}finally{if(b)throw b.error}}})})}else{const d=lC(this.apiClient,e);return c=$e("{model}:streamGenerateContent?alt=sse",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.requestStream({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),l.then(function(f){return gi(this,arguments,function*(){var p,b,w,S;try{for(var k=!0,E=fi(f),I;I=yield Tt(E.next()),p=I.done,!p;k=!0){S=I.value,k=!1;const P=S,R=uC(yield Tt(P.json()));R.sdkHttpResponse={headers:P.headers};const D=new Dl;Object.assign(D,R),yield yield Tt(D)}}catch(P){b={error:P}}finally{try{!k&&!p&&(w=E.return)&&(yield Tt(w.call(E)))}finally{if(b)throw b.error}}})})}}async embedContent(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=X_(this.apiClient,e);return c=$e("{model}:predict",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=$_(A),p=new j0;return Object.assign(p,f),p})}else{const d=Y_(this.apiClient,e);return c=$e("{model}:batchEmbedContents",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=W_(A),p=new j0;return Object.assign(p,f),p})}}async generateImagesInternal(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=lR(this.apiClient,e);return c=$e("{model}:predict",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=uR(A),p=new Q0;return Object.assign(p,f),p})}else{const d=oR(this.apiClient,e);return c=$e("{model}:predict",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=cR(A),p=new Q0;return Object.assign(p,f),p})}}async editImageInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const c=V_(this.apiClient,e);return s=$e("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(d=>{const A=d;return A.sdkHttpResponse={headers:h.headers},A})),i.then(h=>{const d=j_(h),A=new ZI;return Object.assign(A,d),A})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const c=lN(this.apiClient,e);return s=$e("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(d=>{const A=d;return A.sdkHttpResponse={headers:h.headers},A})),i.then(h=>{const d=cN(h),A=new e1;return Object.assign(A,d),A})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const c=HR(this.apiClient,e);return s=$e("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i.then(h=>{const d=VR(h),A=new t1;return Object.assign(A,d),A})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const c=WR(this.apiClient,e);return s=$e("{model}:predict",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i.then(h=>{const d=$R(h),A=new n1;return Object.assign(A,d),A})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=xR(this.apiClient,e);return c=$e("{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json()),l.then(A=>ef(A))}else{const d=ER(this.apiClient,e);return c=$e("{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json()),l.then(A=>Zg(A))}}async listInternal(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=LR(this.apiClient,e);return c=$e("{models_url}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=FR(A),p=new q0;return Object.assign(p,f),p})}else{const d=GR(this.apiClient,e);return c=$e("{models_url}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=BR(A),p=new q0;return Object.assign(p,f),p})}}async update(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=sN(this.apiClient,e);return c=$e("{model}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json()),l.then(A=>ef(A))}else{const d=rN(this.apiClient,e);return c=$e("{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json()),l.then(A=>Zg(A))}}async delete(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=K_(this.apiClient,e);return c=$e("{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=O_(A),p=new Y0;return Object.assign(p,f),p})}else{const d=U_(this.apiClient,e);return c=$e("{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=z_(A),p=new Y0;return Object.assign(p,f),p})}}async countTokens(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=L_(this.apiClient,e);return c=$e("{model}:countTokens",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=F_(A),p=new X0;return Object.assign(p,f),p})}else{const d=G_(this.apiClient,e);return c=$e("{model}:countTokens",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=B_(A),p=new X0;return Object.assign(p,f),p})}}async computeTokens(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const c=P_(this.apiClient,e);return s=$e("{model}:computeTokens",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(d=>{const A=d;return A.sdkHttpResponse={headers:h.headers},A})),i.then(h=>{const d=M_(h),A=new a1;return Object.assign(A,d),A})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=pR(this.apiClient,e);return c=$e("{model}:predictLongRunning",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json()),l.then(A=>{const f=gR(A),p=new nd;return Object.assign(p,f),p})}else{const d=fR(this.apiClient,e);return c=$e("{model}:predictLongRunning",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json()),l.then(A=>{const f=AR(A),p=new nd;return Object.assign(p,f),p})}}}class nG extends sr{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:s}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=t.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const l=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:i,config:{httpOptions:s}});return t._fromAPIResponse({apiResponse:l,_isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:i,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=qI(e);return c=$e("{operationName}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json()),l}else{const d=QI(e);return c=$e("{operationName}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json()),l}}async fetchPredictVideosOperationInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const c=UI(e);return s=$e("{resourceName}:fetchPredictOperation",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}function aG(a){const e={},t=m(a,["data"]);if(t!=null&&v(e,["data"],t),m(a,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=m(a,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function iG(a){const e={},t=m(a,["parts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>AG(s))),v(e,["parts"],i)}const n=m(a,["role"]);return n!=null&&v(e,["role"],n),e}function rG(a,e,t){const n={},i=m(e,["expireTime"]);t!==void 0&&i!=null&&v(t,["expireTime"],i);const s=m(e,["newSessionExpireTime"]);t!==void 0&&s!=null&&v(t,["newSessionExpireTime"],s);const l=m(e,["uses"]);t!==void 0&&l!=null&&v(t,["uses"],l);const c=m(e,["liveConnectConstraints"]);t!==void 0&&c!=null&&v(t,["bidiGenerateContentSetup"],hG(a,c));const h=m(e,["lockAdditionalFields"]);return t!==void 0&&h!=null&&v(t,["fieldMask"],h),n}function sG(a,e){const t={},n=m(e,["config"]);return n!=null&&v(t,["config"],rG(a,n,t)),t}function oG(a){const e={};if(m(a,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(a,["fileUri"]);t!=null&&v(e,["fileUri"],t);const n=m(a,["mimeType"]);return n!=null&&v(e,["mimeType"],n),e}function lG(a){const e={},t=m(a,["id"]);t!=null&&v(e,["id"],t);const n=m(a,["args"]);n!=null&&v(e,["args"],n);const i=m(a,["name"]);if(i!=null&&v(e,["name"],i),m(a,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(m(a,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function cG(a){const e={};if(m(a,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=m(a,["enableWidget"]);return t!=null&&v(e,["enableWidget"],t),e}function uG(a){const e={};if(m(a,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(m(a,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=m(a,["timeRangeFilter"]);return t!=null&&v(e,["timeRangeFilter"],t),e}function dG(a,e){const t={},n=m(a,["generationConfig"]);e!==void 0&&n!=null&&v(e,["setup","generationConfig"],n);const i=m(a,["responseModalities"]);e!==void 0&&i!=null&&v(e,["setup","generationConfig","responseModalities"],i);const s=m(a,["temperature"]);e!==void 0&&s!=null&&v(e,["setup","generationConfig","temperature"],s);const l=m(a,["topP"]);e!==void 0&&l!=null&&v(e,["setup","generationConfig","topP"],l);const c=m(a,["topK"]);e!==void 0&&c!=null&&v(e,["setup","generationConfig","topK"],c);const h=m(a,["maxOutputTokens"]);e!==void 0&&h!=null&&v(e,["setup","generationConfig","maxOutputTokens"],h);const d=m(a,["mediaResolution"]);e!==void 0&&d!=null&&v(e,["setup","generationConfig","mediaResolution"],d);const A=m(a,["seed"]);e!==void 0&&A!=null&&v(e,["setup","generationConfig","seed"],A);const f=m(a,["speechConfig"]);e!==void 0&&f!=null&&v(e,["setup","generationConfig","speechConfig"],Jf(f));const p=m(a,["thinkingConfig"]);e!==void 0&&p!=null&&v(e,["setup","generationConfig","thinkingConfig"],p);const b=m(a,["enableAffectiveDialog"]);e!==void 0&&b!=null&&v(e,["setup","generationConfig","enableAffectiveDialog"],b);const w=m(a,["systemInstruction"]);e!==void 0&&w!=null&&v(e,["setup","systemInstruction"],iG(pa(w)));const S=m(a,["tools"]);if(e!==void 0&&S!=null){let N=Go(S);Array.isArray(N)&&(N=N.map(_=>fG(No(_)))),v(e,["setup","tools"],N)}const k=m(a,["sessionResumption"]);e!==void 0&&k!=null&&v(e,["setup","sessionResumption"],gG(k));const E=m(a,["inputAudioTranscription"]);e!==void 0&&E!=null&&v(e,["setup","inputAudioTranscription"],E);const I=m(a,["outputAudioTranscription"]);e!==void 0&&I!=null&&v(e,["setup","outputAudioTranscription"],I);const P=m(a,["realtimeInputConfig"]);e!==void 0&&P!=null&&v(e,["setup","realtimeInputConfig"],P);const R=m(a,["contextWindowCompression"]);e!==void 0&&R!=null&&v(e,["setup","contextWindowCompression"],R);const D=m(a,["proactivity"]);if(e!==void 0&&D!=null&&v(e,["setup","proactivity"],D),m(a,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function hG(a,e){const t={},n=m(e,["model"]);n!=null&&v(t,["setup","model"],en(a,n));const i=m(e,["config"]);return i!=null&&v(t,["config"],dG(i,t)),t}function AG(a){const e={},t=m(a,["mediaResolution"]);t!=null&&v(e,["mediaResolution"],t);const n=m(a,["codeExecutionResult"]);n!=null&&v(e,["codeExecutionResult"],n);const i=m(a,["executableCode"]);i!=null&&v(e,["executableCode"],i);const s=m(a,["fileData"]);s!=null&&v(e,["fileData"],oG(s));const l=m(a,["functionCall"]);l!=null&&v(e,["functionCall"],lG(l));const c=m(a,["functionResponse"]);c!=null&&v(e,["functionResponse"],c);const h=m(a,["inlineData"]);h!=null&&v(e,["inlineData"],aG(h));const d=m(a,["text"]);d!=null&&v(e,["text"],d);const A=m(a,["thought"]);A!=null&&v(e,["thought"],A);const f=m(a,["thoughtSignature"]);f!=null&&v(e,["thoughtSignature"],f);const p=m(a,["videoMetadata"]);return p!=null&&v(e,["videoMetadata"],p),e}function gG(a){const e={},t=m(a,["handle"]);if(t!=null&&v(e,["handle"],t),m(a,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function fG(a){const e={};if(m(a,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=m(a,["computerUse"]);t!=null&&v(e,["computerUse"],t);const n=m(a,["fileSearch"]);n!=null&&v(e,["fileSearch"],n);const i=m(a,["codeExecution"]);if(i!=null&&v(e,["codeExecution"],i),m(a,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=m(a,["functionDeclarations"]);if(s!=null){let A=s;Array.isArray(A)&&(A=A.map(f=>f)),v(e,["functionDeclarations"],A)}const l=m(a,["googleMaps"]);l!=null&&v(e,["googleMaps"],cG(l));const c=m(a,["googleSearch"]);c!=null&&v(e,["googleSearch"],uG(c));const h=m(a,["googleSearchRetrieval"]);h!=null&&v(e,["googleSearchRetrieval"],h);const d=m(a,["urlContext"]);return d!=null&&v(e,["urlContext"],d),e}function pG(a){const e=[];for(const t in a)if(Object.prototype.hasOwnProperty.call(a,t)){const n=a[t];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const i=Object.keys(n).map(s=>`${t}.${s}`);e.push(...i)}else e.push(t)}return e.join(",")}function mG(a,e){let t=null;const n=a.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const s=n.setup;typeof s=="object"&&s!==null?(a.bidiGenerateContentSetup=s,t=s):delete a.bidiGenerateContentSetup}else n!==void 0&&delete a.bidiGenerateContentSetup;const i=a.fieldMask;if(t){const s=pG(t);if(Array.isArray(e?.lockAdditionalFields)&&e?.lockAdditionalFields.length===0)s?a.fieldMask=s:delete a.fieldMask;else if(e?.lockAdditionalFields&&e.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const l=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];i.length>0&&(c=i.map(d=>l.includes(d)?`generationConfig.${d}`:d));const h=[];s&&h.push(s),c.length>0&&h.push(...c),h.length>0?a.fieldMask=h.join(","):delete a.fieldMask}else delete a.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?a.fieldMask=i.join(","):delete a.fieldMask;return a}class vG extends sr{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=sG(this.apiClient,e);s=$e("auth_tokens",c._url),l=c._query,delete c.config,delete c._url,delete c._query;const h=mG(c,e.config);return i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),i.then(d=>d)}}}function yG(a,e){const t={},n=m(a,["force"]);return e!==void 0&&n!=null&&v(e,["_query","force"],n),t}function bG(a){const e={},t=m(a,["name"]);t!=null&&v(e,["_url","name"],t);const n=m(a,["config"]);return n!=null&&yG(n,e),e}function CG(a){const e={},t=m(a,["name"]);return t!=null&&v(e,["_url","name"],t),e}function SG(a,e){const t={},n=m(a,["pageSize"]);e!==void 0&&n!=null&&v(e,["_query","pageSize"],n);const i=m(a,["pageToken"]);return e!==void 0&&i!=null&&v(e,["_query","pageToken"],i),t}function wG(a){const e={},t=m(a,["parent"]);t!=null&&v(e,["_url","parent"],t);const n=m(a,["config"]);return n!=null&&SG(n,e),e}function TG(a){const e={},t=m(a,["sdkHttpResponse"]);t!=null&&v(e,["sdkHttpResponse"],t);const n=m(a,["nextPageToken"]);n!=null&&v(e,["nextPageToken"],n);const i=m(a,["documents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(l=>l)),v(e,["documents"],s)}return e}class kG extends sr{constructor(e){super(),this.apiClient=e,this.list=async t=>new vs(ir.PAGED_ITEM_DOCUMENTS,n=>this.listInternal({parent:t.parent,config:n.config}),await this.listInternal(t),t)}async get(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=CG(e);return s=$e("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async delete(e){var t,n;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=bG(e);i=$e("{name}",l._url),s=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=wG(e);return s=$e("{parent}/documents",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i.then(h=>{const d=TG(h),A=new i1;return Object.assign(A,d),A})}}}class EG extends sr{constructor(e,t=new kG(e)){super(),this.apiClient=e,this.documents=t,this.list=async(n={})=>new vs(ir.PAGED_ITEM_FILE_SEARCH_STORES,i=>this.listInternal(i),await this.listInternal(n),n)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=pN(e);return s=$e("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async get(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=yN(e);return s=$e("{name}",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i.then(h=>h)}}async delete(e){var t,n;let i="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=vN(e);i=$e("{name}",l._url),s=l._query,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:s,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=kN(e);return s=$e("fileSearchStores",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i.then(h=>{const d=EN(h),A=new r1;return Object.assign(A,d),A})}}async uploadToFileSearchStoreInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=xN(e);return s=$e("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i.then(h=>{const d=PN(h),A=new s1;return Object.assign(A,d),A})}}async importFile(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=SN(e);return s=$e("{file_search_store_name}:importFile",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json()),i.then(h=>{const d=CN(h),A=new qf;return Object.assign(A,d),A})}}}let Xw=function(){const{crypto:a}=globalThis;if(a?.randomUUID)return Xw=a.randomUUID.bind(a),a.randomUUID();const e=new Uint8Array(1),t=a?()=>a.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^t()&15>>+n/4).toString(16))};const xG=()=>Xw();function nf(a){return typeof a=="object"&&a!==null&&("name"in a&&a.name==="AbortError"||"message"in a&&String(a.message).includes("FetchRequestCanceledException"))}const af=a=>{if(a instanceof Error)return a;if(typeof a=="object"&&a!==null){try{if(Object.prototype.toString.call(a)==="[object Error]"){const e=new Error(a.message,a.cause?{cause:a.cause}:{});return a.stack&&(e.stack=a.stack),a.cause&&!e.cause&&(e.cause=a.cause),a.name&&(e.name=a.name),e}}catch{}try{return new Error(JSON.stringify(a))}catch{}}return new Error(a)};class oi extends Error{}class Sa extends oi{constructor(e,t,n,i){super(`${Sa.makeMessage(e,t,n)}`),this.status=e,this.headers=i,this.error=t}static makeMessage(e,t,n){const i=t?.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&i?`${e} ${i}`:e?`${e} status code (no body)`:i||"(no status code or body)"}static generate(e,t,n,i){if(!e||!i)return new Bd({message:n,cause:af(t)});const s=t;return e===400?new $w(e,s,n,i):e===401?new Jw(e,s,n,i):e===403?new Zw(e,s,n,i):e===404?new eT(e,s,n,i):e===409?new tT(e,s,n,i):e===422?new nT(e,s,n,i):e===429?new aT(e,s,n,i):e>=500?new iT(e,s,n,i):new Sa(e,s,n,i)}}class rf extends Sa{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Bd extends Sa{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Ww extends Bd{constructor({message:e}={}){super({message:e??"Request timed out."})}}class $w extends Sa{}class Jw extends Sa{}class Zw extends Sa{}class eT extends Sa{}class tT extends Sa{}class nT extends Sa{}class aT extends Sa{}class iT extends Sa{}const PG=/^[a-z][a-z0-9+.-]*:/i,MG=a=>PG.test(a);let sf=a=>(sf=Array.isArray,sf(a));const IG=sf;let DG=IG;const mC=DG;function _G(a){if(!a)return!0;for(const e in a)return!1;return!0}function RG(a,e){return Object.prototype.hasOwnProperty.call(a,e)}const NG=(a,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new oi(`${a} must be an integer`);if(e<0)throw new oi(`${a} must be a positive integer`);return e},GG=a=>{try{return JSON.parse(a)}catch{return}};const LG=a=>new Promise(e=>setTimeout(e,a));const ro="0.0.1";function BG(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const FG=()=>{var a,e,t,n,i;const s=BG();if(s==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ro,"X-Stainless-OS":yC(Deno.build.os),"X-Stainless-Arch":vC(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(a=Deno.version)===null||a===void 0?void 0:a.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ro,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(s==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ro,"X-Stainless-OS":yC((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":vC((n=globalThis.process.arch)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(i=globalThis.process.version)!==null&&i!==void 0?i:"unknown"};const l=UG();return l?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ro,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${l.browser}`,"X-Stainless-Runtime-Version":l.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":ro,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function UG(){if(typeof navigator>"u"||!navigator)return null;const a=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of a){const n=t.exec(navigator.userAgent);if(n){const i=n[1]||0,s=n[2]||0,l=n[3]||0;return{browser:e,version:`${i}.${s}.${l}`}}}return null}const vC=a=>a==="x32"?"x32":a==="x86_64"||a==="x64"?"x64":a==="arm"?"arm":a==="aarch64"||a==="arm64"?"arm64":a?`other:${a}`:"unknown",yC=a=>(a=a.toLowerCase(),a.includes("ios")?"iOS":a==="android"?"Android":a==="darwin"?"MacOS":a==="win32"?"Windows":a==="freebsd"?"FreeBSD":a==="openbsd"?"OpenBSD":a==="linux"?"Linux":a?`Other:${a}`:"Unknown");let xu;const KG=()=>xu??(xu=FG());function zG(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function rT(...a){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...a)}function OG(a){let e=Symbol.asyncIterator in a?a[Symbol.asyncIterator]():a[Symbol.iterator]();return rT({start(){},async pull(t){const{done:n,value:i}=await e.next();n?t.close():t.enqueue(i)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function sT(a){if(a[Symbol.asyncIterator])return a;const e=a.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function HG(a){var e,t;if(a===null||typeof a!="object")return;if(a[Symbol.asyncIterator]){await((t=(e=a[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const n=a.getReader(),i=n.cancel();n.releaseLock(),await i}const VG=({headers:a,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});const oT=()=>{var a;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((a=e?.versions)===null||a===void 0?void 0:a.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Ag(a,e,t){return oT(),new File(a,e??"unknown_file",t)}function jG(a){return(typeof a=="object"&&a!==null&&("name"in a&&a.name&&String(a.name)||"url"in a&&a.url&&String(a.url)||"filename"in a&&a.filename&&String(a.filename)||"path"in a&&a.path&&String(a.path))||"").split(/[\\/]/).pop()||void 0}const QG=a=>a!=null&&typeof a=="object"&&typeof a[Symbol.asyncIterator]=="function";const lT=a=>a!=null&&typeof a=="object"&&typeof a.size=="number"&&typeof a.type=="string"&&typeof a.text=="function"&&typeof a.slice=="function"&&typeof a.arrayBuffer=="function",qG=a=>a!=null&&typeof a=="object"&&typeof a.name=="string"&&typeof a.lastModified=="number"&&lT(a),YG=a=>a!=null&&typeof a=="object"&&typeof a.url=="string"&&typeof a.blob=="function";async function XG(a,e,t){if(oT(),a=await a,qG(a))return a instanceof File?a:Ag([await a.arrayBuffer()],a.name);if(YG(a)){const i=await a.blob();return e||(e=new URL(a.url).pathname.split(/[\\/]/).pop()),Ag(await of(i),e,t)}const n=await of(a);if(e||(e=jG(a)),!t?.type){const i=n.find(s=>typeof s=="object"&&"type"in s&&s.type);typeof i=="string"&&(t=Object.assign(Object.assign({},t),{type:i}))}return Ag(n,e,t)}async function of(a){var e,t,n,i,s;let l=[];if(typeof a=="string"||ArrayBuffer.isView(a)||a instanceof ArrayBuffer)l.push(a);else if(lT(a))l.push(a instanceof Blob?a:await a.arrayBuffer());else if(QG(a))try{for(var c=!0,h=fi(a),d;d=await h.next(),e=d.done,!e;c=!0){i=d.value,c=!1;const A=i;l.push(...await of(A))}}catch(A){t={error:A}}finally{try{!c&&!e&&(n=h.return)&&await n.call(h)}finally{if(t)throw t.error}}else{const A=(s=a?.constructor)===null||s===void 0?void 0:s.name;throw new Error(`Unexpected data type: ${typeof a}${A?`; constructor: ${A}`:""}${WG(a)}`)}return l}function WG(a){return typeof a!="object"||a===null?"":`; props: [${Object.getOwnPropertyNames(a).map(t=>`"${t}"`).join(", ")}]`}class cT{constructor(e){this._client=e}}cT._key=[];function uT(a){return a.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const bC=Object.freeze(Object.create(null)),$G=(a=uT)=>(function(t,...n){if(t.length===1)return t[0];let i=!1;const s=[],l=t.reduce((A,f,p)=>{var b,w,S;/[?#]/.test(f)&&(i=!0);const k=n[p];let E=(i?encodeURIComponent:a)(""+k);return p!==n.length&&(k==null||typeof k=="object"&&k.toString===((S=Object.getPrototypeOf((w=Object.getPrototypeOf((b=k.hasOwnProperty)!==null&&b!==void 0?b:bC))!==null&&w!==void 0?w:bC))===null||S===void 0?void 0:S.toString))&&(E=k+"",s.push({start:A.length+f.length,length:E.length,error:`Value of type ${Object.prototype.toString.call(k).slice(8,-1)} is not a valid path parameter`})),A+f+(p===n.length?"":E)},""),c=l.split(/[?#]/,1)[0],h=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let d;for(;(d=h.exec(c))!==null;)s.push({start:d.index,length:d[0].length,error:`Value "${d[0]}" can't be safely passed as a path parameter`});if(s.sort((A,f)=>A.start-f.start),s.length>0){let A=0;const f=s.reduce((p,b)=>{const w=" ".repeat(b.start-A),S="^".repeat(b.length);return A=b.start+b.length,p+w+S},"");throw new oi(`Path parameters result in path with invalid segments:
${s.map(p=>p.error).join(`
`)}
${l}
${f}`)}return l}),Pu=$G(uT);class dT extends cT{create(e,t){var n;const{api_version:i=this._client.apiVersion}=e,s=id(e,["api_version"]);if("model"in s&&"agent_config"in s)throw new oi("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in s&&"generation_config"in s)throw new oi("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(Pu`/${i}/interactions`,Object.assign(Object.assign({body:s},t),{stream:(n=e.stream)!==null&&n!==void 0?n:!1}))}delete(e,t={},n){const{api_version:i=this._client.apiVersion}=t??{};return this._client.delete(Pu`/${i}/interactions/${e}`,n)}cancel(e,t={},n){const{api_version:i=this._client.apiVersion}=t??{};return this._client.post(Pu`/${i}/interactions/${e}/cancel`,n)}get(e,t={},n){var i;const s=t??{},{api_version:l=this._client.apiVersion}=s,c=id(s,["api_version"]);return this._client.get(Pu`/${l}/interactions/${e}`,Object.assign(Object.assign({query:c},n),{stream:(i=t?.stream)!==null&&i!==void 0?i:!1}))}}dT._key=Object.freeze(["interactions"]);class hT extends dT{}function JG(a){let e=0;for(const i of a)e+=i.length;const t=new Uint8Array(e);let n=0;for(const i of a)t.set(i,n),n+=i.length;return t}let Mu;function ep(a){let e;return(Mu??(e=new globalThis.TextEncoder,Mu=e.encode.bind(e)))(a)}let Iu;function CC(a){let e;return(Iu??(e=new globalThis.TextDecoder,Iu=e.decode.bind(e)))(a)}class Fd{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?ep(e):e;this.buffer=JG([this.buffer,t]);const n=[];let i;for(;(i=ZG(this.buffer,this.carriageReturnIndex))!=null;){if(i.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=i.index;continue}if(this.carriageReturnIndex!=null&&(i.index!==this.carriageReturnIndex+1||i.carriage)){n.push(CC(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const s=this.carriageReturnIndex!==null?i.preceding-1:i.preceding,l=CC(this.buffer.subarray(0,s));n.push(l),this.buffer=this.buffer.subarray(i.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode(`
`):[]}}Fd.NEWLINE_CHARS=new Set([`
`,"\r"]);Fd.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function ZG(a,e){for(let i=e??0;i<a.length;i++){if(a[i]===10)return{preceding:i,index:i+1,carriage:!1};if(a[i]===13)return{preceding:i,index:i+1,carriage:!0}}return null}function eL(a){for(let n=0;n<a.length-1;n++){if(a[n]===10&&a[n+1]===10||a[n]===13&&a[n+1]===13)return n+2;if(a[n]===13&&a[n+1]===10&&n+3<a.length&&a[n+2]===13&&a[n+3]===10)return n+4}return-1}const rd={off:0,error:200,warn:300,info:400,debug:500},SC=(a,e,t)=>{if(a){if(RG(rd,a))return a;ya(t).warn(`${e} was set to ${JSON.stringify(a)}, expected one of ${JSON.stringify(Object.keys(rd))}`)}};function Bl(){}function Du(a,e,t){return!e||rd[a]>rd[t]?Bl:e[a].bind(e)}const tL={error:Bl,warn:Bl,info:Bl,debug:Bl};let wC=new WeakMap;function ya(a){var e;const t=a.logger,n=(e=a.logLevel)!==null&&e!==void 0?e:"off";if(!t)return tL;const i=wC.get(t);if(i&&i[0]===n)return i[1];const s={error:Du("error",t,n),warn:Du("warn",t,n),info:Du("info",t,n),debug:Du("debug",t,n)};return wC.set(t,[n,s]),s}const os=a=>(a.options&&(a.options=Object.assign({},a.options),delete a.options.headers),a.headers&&(a.headers=Object.fromEntries((a.headers instanceof Headers?[...a.headers]:Object.entries(a.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in a&&(a.retryOfRequestLogID&&(a.retryOf=a.retryOfRequestLogID),delete a.retryOfRequestLogID),a);class go{constructor(e,t,n){this.iterator=e,this.controller=t,this.client=n}static fromSSEResponse(e,t,n){let i=!1;const s=n?ya(n):console;function l(){return gi(this,arguments,function*(){var h,d,A,f;if(i)throw new oi("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let p=!1;try{try{for(var b=!0,w=fi(nL(e,t)),S;S=yield Tt(w.next()),h=S.done,!h;b=!0){f=S.value,b=!1;const k=f;if(!p)if(k.data.startsWith("[DONE]")){p=!0;continue}else try{yield yield Tt(JSON.parse(k.data))}catch(E){throw s.error("Could not parse message into JSON:",k.data),s.error("From chunk:",k.raw),E}}}catch(k){d={error:k}}finally{try{!b&&!h&&(A=w.return)&&(yield Tt(A.call(w)))}finally{if(d)throw d.error}}p=!0}catch(k){if(nf(k))return yield Tt(void 0);throw k}finally{p||t.abort()}})}return new go(l,t,n)}static fromReadableStream(e,t,n){let i=!1;function s(){return gi(this,arguments,function*(){var h,d,A,f;const p=new Fd,b=sT(e);try{for(var w=!0,S=fi(b),k;k=yield Tt(S.next()),h=k.done,!h;w=!0){f=k.value,w=!1;const E=f;for(const I of p.decode(E))yield yield Tt(I)}}catch(E){d={error:E}}finally{try{!w&&!h&&(A=S.return)&&(yield Tt(A.call(S)))}finally{if(d)throw d.error}}for(const E of p.flush())yield yield Tt(E)})}function l(){return gi(this,arguments,function*(){var h,d,A,f;if(i)throw new oi("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");i=!0;let p=!1;try{try{for(var b=!0,w=fi(s()),S;S=yield Tt(w.next()),h=S.done,!h;b=!0){f=S.value,b=!1;const k=f;p||k&&(yield yield Tt(JSON.parse(k)))}}catch(k){d={error:k}}finally{try{!b&&!h&&(A=w.return)&&(yield Tt(A.call(w)))}finally{if(d)throw d.error}}p=!0}catch(k){if(nf(k))return yield Tt(void 0);throw k}finally{p||t.abort()}})}return new go(l,t,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),i=s=>({next:()=>{if(s.length===0){const l=n.next();e.push(l),t.push(l)}return s.shift()}});return[new go(()=>i(e),this.controller,this.client),new go(()=>i(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return rT({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:i,done:s}=await t.next();if(s)return n.close();const l=ep(JSON.stringify(i)+`
`);n.enqueue(l)}catch(i){n.error(i)}},async cancel(){var n;await((n=t.return)===null||n===void 0?void 0:n.call(t))}})}}function nL(a,e){return gi(this,arguments,function*(){var n,i,s,l;if(!a.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new oi("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new oi("Attempted to iterate over a response with no body");const c=new iL,h=new Fd,d=sT(a.body);try{for(var A=!0,f=fi(aL(d)),p;p=yield Tt(f.next()),n=p.done,!n;A=!0){l=p.value,A=!1;const b=l;for(const w of h.decode(b)){const S=c.decode(w);S&&(yield yield Tt(S))}}}catch(b){i={error:b}}finally{try{!A&&!n&&(s=f.return)&&(yield Tt(s.call(f)))}finally{if(i)throw i.error}}for(const b of h.flush()){const w=c.decode(b);w&&(yield yield Tt(w))}})}function aL(a){return gi(this,arguments,function*(){var t,n,i,s;let l=new Uint8Array;try{for(var c=!0,h=fi(a),d;d=yield Tt(h.next()),t=d.done,!t;c=!0){s=d.value,c=!1;const A=s;if(A==null)continue;const f=A instanceof ArrayBuffer?new Uint8Array(A):typeof A=="string"?ep(A):A;let p=new Uint8Array(l.length+f.length);p.set(l),p.set(f,l.length),l=p;let b;for(;(b=eL(l))!==-1;)yield yield Tt(l.slice(0,b)),l=l.slice(b)}}catch(A){n={error:A}}finally{try{!c&&!t&&(i=h.return)&&(yield Tt(i.call(h)))}finally{if(n)throw n.error}}l.length>0&&(yield yield Tt(l))})}class iL{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,i]=rL(e,":");return i.startsWith(" ")&&(i=i.substring(1)),t==="event"?this.event=i:t==="data"&&this.data.push(i),null}}function rL(a,e){const t=a.indexOf(e);return t!==-1?[a.substring(0,t),e,a.substring(t+e.length)]:[a,"",""]}async function sL(a,e){const{response:t,requestLogID:n,retryOfRequestLogID:i,startTime:s}=e,l=await(async()=>{var c;if(e.options.stream)return ya(a).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,a):go.fromSSEResponse(t,e.controller,a);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const h=t.headers.get("content-type"),d=(c=h?.split(";")[0])===null||c===void 0?void 0:c.trim();return d?.includes("application/json")||d?.endsWith("+json")?await t.json():await t.text()})();return ya(a).debug(`[${n}] response parsed`,os({retryOfRequestLogID:i,url:t.url,status:t.status,body:l,durationMs:Date.now()-s})),l}class tp extends Promise{constructor(e,t,n=sL){super(i=>{i(null)}),this.responsePromise=t,this.parseResponse=n,this.client=e}_thenUnwrap(e){return new tp(this.client,this.responsePromise,async(t,n)=>e(await this.parseResponse(t,n),n))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}const AT=Symbol("brand.privateNullableHeaders");function*oL(a){if(!a)return;if(AT in a){const{values:n,nulls:i}=a;yield*n.entries();for(const s of i)yield[s,null];return}let e=!1,t;a instanceof Headers?t=a.entries():mC(a)?t=a:(e=!0,t=Object.entries(a??{}));for(let n of t){const i=n[0];if(typeof i!="string")throw new TypeError("expected header name to be a string");const s=mC(n[1])?n[1]:[n[1]];let l=!1;for(const c of s)c!==void 0&&(e&&!l&&(l=!0,yield[i,null]),yield[i,c])}}const _l=a=>{const e=new Headers,t=new Set;for(const n of a){const i=new Set;for(const[s,l]of oL(n)){const c=s.toLowerCase();i.has(c)||(e.delete(s),i.add(c)),l===null?(e.delete(s),t.add(c)):(e.append(s,l),t.delete(c))}}return{[AT]:!0,values:e,nulls:t}};const gg=a=>{var e,t,n,i,s,l;if(typeof globalThis.process<"u")return(n=(t=(e=RI)===null||e===void 0?void 0:e[a])===null||t===void 0?void 0:t.trim())!==null&&n!==void 0?n:void 0;if(typeof globalThis.Deno<"u")return(l=(s=(i=globalThis.Deno.env)===null||i===void 0?void 0:i.get)===null||s===void 0?void 0:s.call(i,a))===null||l===void 0?void 0:l.trim()};var gT;class Ud{constructor(e){var t,n,i,s,l,c,h,{baseURL:d=gg("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:A=(t=gg("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:f="v1beta"}=e,p=id(e,["baseURL","apiKey","apiVersion"]);const b=Object.assign(Object.assign({apiKey:A,apiVersion:f},p),{baseURL:d||"https://generativelanguage.googleapis.com"});this.baseURL=b.baseURL,this.timeout=(n=b.timeout)!==null&&n!==void 0?n:Ud.DEFAULT_TIMEOUT,this.logger=(i=b.logger)!==null&&i!==void 0?i:console;const w="warn";this.logLevel=w,this.logLevel=(l=(s=SC(b.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:SC(gg("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&l!==void 0?l:w,this.fetchOptions=b.fetchOptions,this.maxRetries=(c=b.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(h=b.fetch)!==null&&h!==void 0?h:zG(),this.encoder=VG,this._options=b,this.apiKey=A,this.apiVersion=f,this.clientAdapter=b.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=_l([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return _l([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return _l([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new oi(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${ro}`}defaultIdempotencyKey(){return`stainless-node-retry-${xG()}`}makeStatusError(e,t,n,i){return Sa.generate(e,t,n,i)}buildURL(e,t,n){const i=!this.baseURLOverridden()&&n||this.baseURL,s=MG(e)?new URL(e):new URL(i+(i.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),l=this.defaultQuery();return _G(l)||(t=Object.assign(Object.assign({},l),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(s.search=this.stringifyQuery(t)),s.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(i=>Object.assign({method:e,path:t},i)))}request(e,t=null){return new tp(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var i,s,l;const c=await e,h=(i=c.maxRetries)!==null&&i!==void 0?i:this.maxRetries;t==null&&(t=h),await this.prepareOptions(c);const{req:d,url:A,timeout:f}=await this.buildRequest(c,{retryCount:h-t});await this.prepareRequest(d,{url:A,options:c});const p="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),b=n===void 0?"":`, retryOf: ${n}`,w=Date.now();if(ya(this).debug(`[${p}] sending request`,os({retryOfRequestLogID:n,method:c.method,url:A,options:c,headers:d.headers})),!((s=c.signal)===null||s===void 0)&&s.aborted)throw new rf;const S=new AbortController,k=await this.fetchWithTimeout(A,d,f,S).catch(af),E=Date.now();if(k instanceof globalThis.Error){const P=`retrying, ${t} attempts remaining`;if(!((l=c.signal)===null||l===void 0)&&l.aborted)throw new rf;const R=nf(k)||/timed? ?out/i.test(String(k)+("cause"in k?String(k.cause):""));if(t)return ya(this).info(`[${p}] connection ${R?"timed out":"failed"} - ${P}`),ya(this).debug(`[${p}] connection ${R?"timed out":"failed"} (${P})`,os({retryOfRequestLogID:n,url:A,durationMs:E-w,message:k.message})),this.retryRequest(c,t,n??p);throw ya(this).info(`[${p}] connection ${R?"timed out":"failed"} - error; no more retries left`),ya(this).debug(`[${p}] connection ${R?"timed out":"failed"} (error; no more retries left)`,os({retryOfRequestLogID:n,url:A,durationMs:E-w,message:k.message})),R?new Ww:new Bd({cause:k})}const I=`[${p}${b}] ${d.method} ${A} ${k.ok?"succeeded":"failed"} with status ${k.status} in ${E-w}ms`;if(!k.ok){const P=await this.shouldRetry(k);if(t&&P){const G=`retrying, ${t} attempts remaining`;return await HG(k.body),ya(this).info(`${I} - ${G}`),ya(this).debug(`[${p}] response error (${G})`,os({retryOfRequestLogID:n,url:k.url,status:k.status,headers:k.headers,durationMs:E-w})),this.retryRequest(c,t,n??p,k.headers)}const R=P?"error; no more retries left":"error; not retryable";ya(this).info(`${I} - ${R}`);const D=await k.text().catch(G=>af(G).message),N=GG(D),_=N?void 0:D;throw ya(this).debug(`[${p}] response error (${R})`,os({retryOfRequestLogID:n,url:k.url,status:k.status,headers:k.headers,message:_,durationMs:Date.now()-w})),this.makeStatusError(k.status,N,_,k.headers)}return ya(this).info(I),ya(this).debug(`[${p}] response start`,os({retryOfRequestLogID:n,url:k.url,status:k.status,headers:k.headers,durationMs:E-w})),{response:k,options:c,controller:S,requestLogID:p,retryOfRequestLogID:n,startTime:w}}async fetchWithTimeout(e,t,n,i){const s=t||{},{signal:l,method:c}=s,h=id(s,["signal","method"]);l&&l.addEventListener("abort",()=>i.abort());const d=setTimeout(()=>i.abort(),n),A=globalThis.ReadableStream&&h.body instanceof globalThis.ReadableStream||typeof h.body=="object"&&h.body!==null&&Symbol.asyncIterator in h.body,f=Object.assign(Object.assign(Object.assign({signal:i.signal},A?{duplex:"half"}:{}),{method:"GET"}),h);c&&(f.method=c.toUpperCase());try{return await this.fetch.call(void 0,e,f)}finally{clearTimeout(d)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n,i){var s;let l;const c=i?.get("retry-after-ms");if(c){const d=parseFloat(c);Number.isNaN(d)||(l=d)}const h=i?.get("retry-after");if(h&&!l){const d=parseFloat(h);Number.isNaN(d)?l=Date.parse(h)-Date.now():l=d*1e3}if(!(l&&0<=l&&l<60*1e3)){const d=(s=e.maxRetries)!==null&&s!==void 0?s:this.maxRetries;l=this.calculateDefaultRetryTimeoutMillis(t,d)}return await LG(l),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){const s=t-e,l=Math.min(.5*Math.pow(2,s),8),c=1-Math.random()*.25;return l*c*1e3}async buildRequest(e,{retryCount:t=0}={}){var n,i,s;const l=Object.assign({},e),{method:c,path:h,query:d,defaultBaseURL:A}=l,f=this.buildURL(h,d,A);"timeout"in l&&NG("timeout",l.timeout),l.timeout=(n=l.timeout)!==null&&n!==void 0?n:this.timeout;const{bodyHeaders:p,body:b}=this.buildBody({options:l}),w=await this.buildHeaders({options:e,method:c,bodyHeaders:p,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:w},l.signal&&{signal:l.signal}),globalThis.ReadableStream&&b instanceof globalThis.ReadableStream&&{duplex:"half"}),b&&{body:b}),(i=this.fetchOptions)!==null&&i!==void 0?i:{}),(s=l.fetchOptions)!==null&&s!==void 0?s:{}),url:f,timeout:l.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:i}){let s={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=e.idempotencyKey);const l=await this.authHeaders(e);let c=_l([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(i)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),KG()),this._options.defaultHeaders,n,e.headers,l]);return this.validateHeaders(c),c.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const n=_l([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&n.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:OG(e)}:this.encoder({body:e,headers:n})}}Ud.DEFAULT_TIMEOUT=6e4;class ia extends Ud{constructor(){super(...arguments),this.interactions=new hT(this)}}gT=ia;ia.GeminiNextGenAPIClient=gT;ia.GeminiNextGenAPIClientError=oi;ia.APIError=Sa;ia.APIConnectionError=Bd;ia.APIConnectionTimeoutError=Ww;ia.APIUserAbortError=rf;ia.NotFoundError=eT;ia.ConflictError=tT;ia.RateLimitError=aT;ia.BadRequestError=$w;ia.AuthenticationError=Jw;ia.InternalServerError=iT;ia.PermissionDeniedError=Zw;ia.UnprocessableEntityError=nT;ia.toFile=XG;ia.Interactions=hT;function lL(a,e){const t={},n=m(a,["name"]);return n!=null&&v(t,["_url","name"],n),t}function cL(a,e){const t={},n=m(a,["name"]);return n!=null&&v(t,["_url","name"],n),t}function uL(a,e){const t={},n=m(a,["sdkHttpResponse"]);return n!=null&&v(t,["sdkHttpResponse"],n),t}function dL(a,e){const t={},n=m(a,["sdkHttpResponse"]);return n!=null&&v(t,["sdkHttpResponse"],n),t}function hL(a,e,t){const n={};if(m(a,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const i=m(a,["tunedModelDisplayName"]);if(e!==void 0&&i!=null&&v(e,["displayName"],i),m(a,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=m(a,["epochCount"]);e!==void 0&&s!=null&&v(e,["tuningTask","hyperparameters","epochCount"],s);const l=m(a,["learningRateMultiplier"]);if(l!=null&&v(n,["tuningTask","hyperparameters","learningRateMultiplier"],l),m(a,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(m(a,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(m(a,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=m(a,["batchSize"]);e!==void 0&&c!=null&&v(e,["tuningTask","hyperparameters","batchSize"],c);const h=m(a,["learningRate"]);if(e!==void 0&&h!=null&&v(e,["tuningTask","hyperparameters","learningRate"],h),m(a,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(m(a,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return n}function AL(a,e,t){const n={};let i=m(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const b=m(a,["validationDataset"]);e!==void 0&&b!=null&&v(e,["supervisedTuningSpec"],TC(b))}else if(i==="PREFERENCE_TUNING"){const b=m(a,["validationDataset"]);e!==void 0&&b!=null&&v(e,["preferenceOptimizationSpec"],TC(b))}const s=m(a,["tunedModelDisplayName"]);e!==void 0&&s!=null&&v(e,["tunedModelDisplayName"],s);const l=m(a,["description"]);e!==void 0&&l!=null&&v(e,["description"],l);let c=m(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const b=m(a,["epochCount"]);e!==void 0&&b!=null&&v(e,["supervisedTuningSpec","hyperParameters","epochCount"],b)}else if(c==="PREFERENCE_TUNING"){const b=m(a,["epochCount"]);e!==void 0&&b!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],b)}let h=m(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const b=m(a,["learningRateMultiplier"]);e!==void 0&&b!=null&&v(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],b)}else if(h==="PREFERENCE_TUNING"){const b=m(a,["learningRateMultiplier"]);e!==void 0&&b!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],b)}let d=m(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const b=m(a,["exportLastCheckpointOnly"]);e!==void 0&&b!=null&&v(e,["supervisedTuningSpec","exportLastCheckpointOnly"],b)}else if(d==="PREFERENCE_TUNING"){const b=m(a,["exportLastCheckpointOnly"]);e!==void 0&&b!=null&&v(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],b)}let A=m(t,["config","method"]);if(A===void 0&&(A="SUPERVISED_FINE_TUNING"),A==="SUPERVISED_FINE_TUNING"){const b=m(a,["adapterSize"]);e!==void 0&&b!=null&&v(e,["supervisedTuningSpec","hyperParameters","adapterSize"],b)}else if(A==="PREFERENCE_TUNING"){const b=m(a,["adapterSize"]);e!==void 0&&b!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],b)}if(m(a,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(m(a,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const f=m(a,["labels"]);e!==void 0&&f!=null&&v(e,["labels"],f);const p=m(a,["beta"]);return e!==void 0&&p!=null&&v(e,["preferenceOptimizationSpec","hyperParameters","beta"],p),n}function gL(a,e){const t={},n=m(a,["baseModel"]);n!=null&&v(t,["baseModel"],n);const i=m(a,["preTunedModel"]);i!=null&&v(t,["preTunedModel"],i);const s=m(a,["trainingDataset"]);s!=null&&kL(s);const l=m(a,["config"]);return l!=null&&hL(l,t),t}function fL(a,e){const t={},n=m(a,["baseModel"]);n!=null&&v(t,["baseModel"],n);const i=m(a,["preTunedModel"]);i!=null&&v(t,["preTunedModel"],i);const s=m(a,["trainingDataset"]);s!=null&&EL(s,t,e);const l=m(a,["config"]);return l!=null&&AL(l,t,e),t}function pL(a,e){const t={},n=m(a,["name"]);return n!=null&&v(t,["_url","name"],n),t}function mL(a,e){const t={},n=m(a,["name"]);return n!=null&&v(t,["_url","name"],n),t}function vL(a,e,t){const n={},i=m(a,["pageSize"]);e!==void 0&&i!=null&&v(e,["_query","pageSize"],i);const s=m(a,["pageToken"]);e!==void 0&&s!=null&&v(e,["_query","pageToken"],s);const l=m(a,["filter"]);return e!==void 0&&l!=null&&v(e,["_query","filter"],l),n}function yL(a,e,t){const n={},i=m(a,["pageSize"]);e!==void 0&&i!=null&&v(e,["_query","pageSize"],i);const s=m(a,["pageToken"]);e!==void 0&&s!=null&&v(e,["_query","pageToken"],s);const l=m(a,["filter"]);return e!==void 0&&l!=null&&v(e,["_query","filter"],l),n}function bL(a,e){const t={},n=m(a,["config"]);return n!=null&&vL(n,t),t}function CL(a,e){const t={},n=m(a,["config"]);return n!=null&&yL(n,t),t}function SL(a,e){const t={},n=m(a,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const i=m(a,["nextPageToken"]);i!=null&&v(t,["nextPageToken"],i);const s=m(a,["tunedModels"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>fT(c))),v(t,["tuningJobs"],l)}return t}function wL(a,e){const t={},n=m(a,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const i=m(a,["nextPageToken"]);i!=null&&v(t,["nextPageToken"],i);const s=m(a,["tuningJobs"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>lf(c))),v(t,["tuningJobs"],l)}return t}function TL(a,e){const t={},n=m(a,["name"]);n!=null&&v(t,["model"],n);const i=m(a,["name"]);return i!=null&&v(t,["endpoint"],i),t}function kL(a,e){const t={};if(m(a,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(a,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=m(a,["examples"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>s)),v(t,["examples","examples"],i)}return t}function EL(a,e,t){const n={};let i=m(t,["config","method"]);if(i===void 0&&(i="SUPERVISED_FINE_TUNING"),i==="SUPERVISED_FINE_TUNING"){const l=m(a,["gcsUri"]);e!==void 0&&l!=null&&v(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(i==="PREFERENCE_TUNING"){const l=m(a,["gcsUri"]);e!==void 0&&l!=null&&v(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}let s=m(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const l=m(a,["vertexDatasetResource"]);e!==void 0&&l!=null&&v(e,["supervisedTuningSpec","trainingDatasetUri"],l)}else if(s==="PREFERENCE_TUNING"){const l=m(a,["vertexDatasetResource"]);e!==void 0&&l!=null&&v(e,["preferenceOptimizationSpec","trainingDatasetUri"],l)}if(m(a,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function fT(a,e){const t={},n=m(a,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const i=m(a,["name"]);i!=null&&v(t,["name"],i);const s=m(a,["state"]);s!=null&&v(t,["state"],Mw(s));const l=m(a,["createTime"]);l!=null&&v(t,["createTime"],l);const c=m(a,["tuningTask","startTime"]);c!=null&&v(t,["startTime"],c);const h=m(a,["tuningTask","completeTime"]);h!=null&&v(t,["endTime"],h);const d=m(a,["updateTime"]);d!=null&&v(t,["updateTime"],d);const A=m(a,["description"]);A!=null&&v(t,["description"],A);const f=m(a,["baseModel"]);f!=null&&v(t,["baseModel"],f);const p=m(a,["_self"]);return p!=null&&v(t,["tunedModel"],TL(p)),t}function lf(a,e){const t={},n=m(a,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const i=m(a,["name"]);i!=null&&v(t,["name"],i);const s=m(a,["state"]);s!=null&&v(t,["state"],Mw(s));const l=m(a,["createTime"]);l!=null&&v(t,["createTime"],l);const c=m(a,["startTime"]);c!=null&&v(t,["startTime"],c);const h=m(a,["endTime"]);h!=null&&v(t,["endTime"],h);const d=m(a,["updateTime"]);d!=null&&v(t,["updateTime"],d);const A=m(a,["error"]);A!=null&&v(t,["error"],A);const f=m(a,["description"]);f!=null&&v(t,["description"],f);const p=m(a,["baseModel"]);p!=null&&v(t,["baseModel"],p);const b=m(a,["tunedModel"]);b!=null&&v(t,["tunedModel"],b);const w=m(a,["preTunedModel"]);w!=null&&v(t,["preTunedModel"],w);const S=m(a,["supervisedTuningSpec"]);S!=null&&v(t,["supervisedTuningSpec"],S);const k=m(a,["preferenceOptimizationSpec"]);k!=null&&v(t,["preferenceOptimizationSpec"],k);const E=m(a,["tuningDataStats"]);E!=null&&v(t,["tuningDataStats"],E);const I=m(a,["encryptionSpec"]);I!=null&&v(t,["encryptionSpec"],I);const P=m(a,["partnerModelTuningSpec"]);P!=null&&v(t,["partnerModelTuningSpec"],P);const R=m(a,["customBaseModel"]);R!=null&&v(t,["customBaseModel"],R);const D=m(a,["experiment"]);D!=null&&v(t,["experiment"],D);const N=m(a,["labels"]);N!=null&&v(t,["labels"],N);const _=m(a,["outputUri"]);_!=null&&v(t,["outputUri"],_);const K=m(a,["pipelineJob"]);K!=null&&v(t,["pipelineJob"],K);const G=m(a,["serviceAccount"]);G!=null&&v(t,["serviceAccount"],G);const L=m(a,["tunedModelDisplayName"]);L!=null&&v(t,["tunedModelDisplayName"],L);const O=m(a,["veoTuningSpec"]);return O!=null&&v(t,["veoTuningSpec"],O),t}function xL(a,e){const t={},n=m(a,["sdkHttpResponse"]);n!=null&&v(t,["sdkHttpResponse"],n);const i=m(a,["name"]);i!=null&&v(t,["name"],i);const s=m(a,["metadata"]);s!=null&&v(t,["metadata"],s);const l=m(a,["done"]);l!=null&&v(t,["done"],l);const c=m(a,["error"]);return c!=null&&v(t,["error"],c),t}function TC(a,e){const t={},n=m(a,["gcsUri"]);n!=null&&v(t,["validationDatasetUri"],n);const i=m(a,["vertexDatasetResource"]);return i!=null&&v(t,["validationDatasetUri"],i),t}class PL extends sr{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new vs(ir.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var n;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const i={tunedModelName:t.baseModel};!((n=t.config)===null||n===void 0)&&n.preTunedModelCheckpointId&&(i.checkpointId=t.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},t),{preTunedModel:i});return s.baseModel=void 0,await this.tuneInternal(s)}else{const i=Object.assign({},t);return await this.tuneInternal(i)}else{const i=Object.assign({},t),s=await this.tuneMldevInternal(i);let l="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?l=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(l=s.name.split("/operations/")[0]),{name:l,state:Xg.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=mL(e);return c=$e("{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>lf(A))}else{const d=pL(e);return c=$e("{name}",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>fT(A))}}async listInternal(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=CL(e);return c=$e("tuningJobs",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=wL(A),p=new W0;return Object.assign(p,f),p})}else{const d=bL(e);return c=$e("tunedModels",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=SL(A),p=new W0;return Object.assign(p,f),p})}}async cancel(e){var t,n,i,s;let l,c="",h={};if(this.apiClient.isVertexAI()){const d=cL(e);return c=$e("{name}:cancel",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=dL(A),p=new $0;return Object.assign(p,f),p})}else{const d=lL(e);return c=$e("{name}:cancel",d._url),h=d._query,delete d._url,delete d._query,l=this.apiClient.request({path:c,queryParams:h,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=e.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(A=>A.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:A.headers},p})),l.then(A=>{const f=uL(A),p=new $0;return Object.assign(p,f),p})}}async tuneInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI()){const c=fL(e,e);return s=$e("tuningJobs",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(d=>{const A=d;return A.sdkHttpResponse={headers:h.headers},A})),i.then(h=>lf(h))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let i,s="",l={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=gL(e);return s=$e("tunedModels",c._url),l=c._query,delete c._url,delete c._query,i=this.apiClient.request({path:s,queryParams:l,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(h=>h.json().then(d=>{const A=d;return A.sdkHttpResponse={headers:h.headers},A})),i.then(h=>xL(h))}}}class ML{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const IL=1024*1024*8,DL=3,_L=1e3,RL=2,sd="x-goog-upload-status";async function NL(a,e,t){var n;const i=await pT(a,e,t),s=await i?.json();if(((n=i?.headers)===null||n===void 0?void 0:n[sd])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function GL(a,e,t){var n;const i=await pT(a,e,t),s=await i?.json();if(((n=i?.headers)===null||n===void 0?void 0:n[sd])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const l=ww(s),c=new Yf;return Object.assign(c,l),c}async function pT(a,e,t){var n,i;let s=0,l=0,c=new Wg(new Response),h="upload";for(s=a.size;l<s;){const d=Math.min(IL,s-l),A=a.slice(l,l+d);l+d>=s&&(h+=", finalize");let f=0,p=_L;for(;f<DL&&(c=await t.request({path:"",body:A,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(l),"Content-Length":String(d)}}}),!(!((n=c?.headers)===null||n===void 0)&&n[sd]));)f++,await BL(p),p=p*RL;if(l+=d,((i=c?.headers)===null||i===void 0?void 0:i[sd])!=="active")break;if(s<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return c}async function LL(a){return{size:a.size,type:a.type}}function BL(a){return new Promise(e=>setTimeout(e,a))}class FL{async upload(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await NL(e,t,n)}async uploadToFileSearchStore(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await GL(e,t,n)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await LL(e)}}class UL{create(e,t,n){return new KL(e,t,n)}}class KL{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}const kC="x-goog-api-key";class zL{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(kC)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(kC,this.apiKey)}}}const OL="gl-node/";class Kd{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e?.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new ia({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e?.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const n=BI(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const i=new zL(this.apiKey);this.apiClient=new LN({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:OL+"web",uploader:new FL,downloader:new ML}),this.models=new tG(this.apiClient),this.live=new XN(this.apiClient,i,new UL),this.batches=new hD(this.apiClient),this.chats=new qD(this.models,this.apiClient),this.caches=new VD(this.apiClient),this.files=new a_(this.apiClient),this.operations=new nG(this.apiClient),this.authTokens=new vG(this.apiClient),this.tunings=new PL(this.apiClient),this.fileSearchStores=new EG(this.apiClient)}}var Mo;(function(a){a.Unimplemented="UNIMPLEMENTED",a.Unavailable="UNAVAILABLE"})(Mo||(Mo={}));let fg=class extends Error{constructor(e,t,n){super(e),this.message=e,this.code=t,this.data=n}};const HL=a=>{var e,t;return a?.androidBridge?"android":!((t=(e=a?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},VL=a=>{const e=a.CapacitorCustomPlatform||null,t=a.Capacitor||{},n=t.Plugins=t.Plugins||{},i=()=>e!==null?e.name:HL(a),s=()=>i()!=="web",l=f=>{const p=d.get(f);return!!(p?.platforms.has(i())||c(f))},c=f=>{var p;return(p=t.PluginHeaders)===null||p===void 0?void 0:p.find(b=>b.name===f)},h=f=>a.console.error(f),d=new Map,A=(f,p={})=>{const b=d.get(f);if(b)return console.warn(`Capacitor plugin "${f}" already registered. Cannot register plugins twice.`),b.proxy;const w=i(),S=c(f);let k;const E=async()=>(!k&&w in p?k=typeof p[w]=="function"?k=await p[w]():k=p[w]:e!==null&&!k&&"web"in p&&(k=typeof p.web=="function"?k=await p.web():k=p.web),k),I=(K,G)=>{var L,O;if(S){const q=S?.methods.find($=>G===$.name);if(q)return q.rtype==="promise"?$=>t.nativePromise(f,G.toString(),$):($,Q)=>t.nativeCallback(f,G.toString(),$,Q);if(K)return(L=K[G])===null||L===void 0?void 0:L.bind(K)}else{if(K)return(O=K[G])===null||O===void 0?void 0:O.bind(K);throw new fg(`"${f}" plugin is not implemented on ${w}`,Mo.Unimplemented)}},P=K=>{let G;const L=(...O)=>{const q=E().then($=>{const Q=I($,K);if(Q){const Z=Q(...O);return G=Z?.remove,Z}else throw new fg(`"${f}.${K}()" is not implemented on ${w}`,Mo.Unimplemented)});return K==="addListener"&&(q.remove=async()=>G()),q};return L.toString=()=>`${K.toString()}() { [capacitor code] }`,Object.defineProperty(L,"name",{value:K,writable:!1,configurable:!1}),L},R=P("addListener"),D=P("removeListener"),N=(K,G)=>{const L=R({eventName:K},G),O=async()=>{const $=await L;D({eventName:K,callbackId:$},G)},q=new Promise($=>L.then(()=>$({remove:O})));return q.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await O()},q},_=new Proxy({},{get(K,G){switch(G){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return S?N:R;case"removeListener":return D;default:return P(G)}}});return n[f]=_,d.set(f,{name:f,proxy:_,platforms:new Set([...Object.keys(p),...S?[w]:[]])}),_};return t.convertFileSrc||(t.convertFileSrc=f=>f),t.getPlatform=i,t.handleError=h,t.isNativePlatform=s,t.isPluginAvailable=l,t.registerPlugin=A,t.Exception=fg,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},jL=a=>a.Capacitor=VL(a),rr=jL(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Or=rr.registerPlugin;let zd=class{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(t);const s=this.windowListeners[e];s&&!s.registered&&this.addWindowListener(s),n&&this.sendRetainedArgumentsForEvent(e);const l=async()=>this.removeListener(e,t);return Promise.resolve({remove:l})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,n){const i=this.listeners[e];if(!i){if(n){let s=this.retainedEventArguments[e];s||(s=[]),s.push(t),this.retainedEventArguments[e]=s}return}i.forEach(s=>s(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:n=>{this.notifyListeners(t,n)}}}unimplemented(e="not implemented"){return new rr.Exception(e,Mo.Unimplemented)}unavailable(e="not available"){return new rr.Exception(e,Mo.Unavailable)}async removeListener(e,t){const n=this.listeners[e];if(!n)return;const i=n.indexOf(t);this.listeners[e].splice(i,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(n=>{this.notifyListeners(e,n)}))}};const EC=a=>encodeURIComponent(a).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),xC=a=>a.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);let QL=class extends zd{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(n=>{if(n.length<=0)return;let[i,s]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");i=xC(i).trim(),s=xC(s).trim(),t[i]=s}),t}async setCookie(e){try{const t=EC(e.key),n=EC(e.value),i=`; expires=${(e.expires||"").replace("expires=","")}`,s=(e.path||"/").replace("path=",""),l=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${n||""}${i}; path=${s}; ${l};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}};Or("CapacitorCookies",{web:()=>new QL});const qL=async a=>new Promise((e,t)=>{const n=new FileReader;n.onload=()=>{const i=n.result;e(i.indexOf(",")>=0?i.split(",")[1]:i)},n.onerror=i=>t(i),n.readAsDataURL(a)}),YL=(a={})=>{const e=Object.keys(a);return Object.keys(a).map(i=>i.toLocaleLowerCase()).reduce((i,s,l)=>(i[s]=a[e[l]],i),{})},XL=(a,e=!0)=>a?Object.entries(a).reduce((n,i)=>{const[s,l]=i;let c,h;return Array.isArray(l)?(h="",l.forEach(d=>{c=e?encodeURIComponent(d):d,h+=`${s}=${c}&`}),h.slice(0,-1)):(c=e?encodeURIComponent(l):l,h=`${s}=${c}`),`${n}&${h}`},"").substr(1):null,WL=(a,e={})=>{const t=Object.assign({method:a.method||"GET",headers:a.headers},e),i=YL(a.headers)["content-type"]||"";if(typeof a.data=="string")t.body=a.data;else if(i.includes("application/x-www-form-urlencoded")){const s=new URLSearchParams;for(const[l,c]of Object.entries(a.data||{}))s.set(l,c);t.body=s.toString()}else if(i.includes("multipart/form-data")||a.data instanceof FormData){const s=new FormData;if(a.data instanceof FormData)a.data.forEach((c,h)=>{s.append(h,c)});else for(const c of Object.keys(a.data))s.append(c,a.data[c]);t.body=s;const l=new Headers(t.headers);l.delete("content-type"),t.headers=l}else(i.includes("application/json")||typeof a.data=="object")&&(t.body=JSON.stringify(a.data));return t};let $L=class extends zd{async request(e){const t=WL(e,e.webFetchExtra),n=XL(e.params,e.shouldEncodeUrlParams),i=n?`${e.url}?${n}`:e.url,s=await fetch(i,t),l=s.headers.get("content-type")||"";let{responseType:c="text"}=s.ok?e:{};l.includes("application/json")&&(c="json");let h,d;switch(c){case"arraybuffer":case"blob":d=await s.blob(),h=await qL(d);break;case"json":h=await s.json();break;default:h=await s.text()}const A={};return s.headers.forEach((f,p)=>{A[p]=f}),{data:h,headers:A,status:s.status,url:s.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}};Or("CapacitorHttp",{web:()=>new $L});var PC;(function(a){a.Dark="DARK",a.Light="LIGHT",a.Default="DEFAULT"})(PC||(PC={}));var MC;(function(a){a.StatusBar="StatusBar",a.NavigationBar="NavigationBar"})(MC||(MC={}));class JL extends zd{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}Or("SystemBars",{web:()=>new JL});const ZL="modulepreload",eB=function(a){return"/"+a},IC={},hs=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){let h=function(d){return Promise.all(d.map(A=>Promise.resolve(A).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");i=h(t.map(d=>{if(d=eB(d),d in IC)return;IC[d]=!0;const A=d.endsWith(".css"),f=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${f}`))return;const p=document.createElement("link");if(p.rel=A?"stylesheet":ZL,A||(p.as="script"),p.crossOrigin="",p.href=d,c&&p.setAttribute("nonce",c),document.head.appendChild(p),A)return new Promise((b,w)=>{p.addEventListener("load",b),p.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return i.then(l=>{for(const c of l||[])c.status==="rejected"&&s(c.reason);return e().catch(s)})};var Io;(function(a){a.Unimplemented="UNIMPLEMENTED",a.Unavailable="UNAVAILABLE"})(Io||(Io={}));class pg extends Error{constructor(e,t,n){super(e),this.message=e,this.code=t,this.data=n}}const tB=a=>{var e,t;return a?.androidBridge?"android":!((t=(e=a?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},nB=a=>{const e=a.CapacitorCustomPlatform||null,t=a.Capacitor||{},n=t.Plugins=t.Plugins||{},i=()=>e!==null?e.name:tB(a),s=()=>i()!=="web",l=f=>{const p=d.get(f);return!!(p?.platforms.has(i())||c(f))},c=f=>{var p;return(p=t.PluginHeaders)===null||p===void 0?void 0:p.find(b=>b.name===f)},h=f=>a.console.error(f),d=new Map,A=(f,p={})=>{const b=d.get(f);if(b)return console.warn(`Capacitor plugin "${f}" already registered. Cannot register plugins twice.`),b.proxy;const w=i(),S=c(f);let k;const E=async()=>(!k&&w in p?k=typeof p[w]=="function"?k=await p[w]():k=p[w]:e!==null&&!k&&"web"in p&&(k=typeof p.web=="function"?k=await p.web():k=p.web),k),I=(K,G)=>{var L,O;if(S){const q=S?.methods.find($=>G===$.name);if(q)return q.rtype==="promise"?$=>t.nativePromise(f,G.toString(),$):($,Q)=>t.nativeCallback(f,G.toString(),$,Q);if(K)return(L=K[G])===null||L===void 0?void 0:L.bind(K)}else{if(K)return(O=K[G])===null||O===void 0?void 0:O.bind(K);throw new pg(`"${f}" plugin is not implemented on ${w}`,Io.Unimplemented)}},P=K=>{let G;const L=(...O)=>{const q=E().then($=>{const Q=I($,K);if(Q){const Z=Q(...O);return G=Z?.remove,Z}else throw new pg(`"${f}.${K}()" is not implemented on ${w}`,Io.Unimplemented)});return K==="addListener"&&(q.remove=async()=>G()),q};return L.toString=()=>`${K.toString()}() { [capacitor code] }`,Object.defineProperty(L,"name",{value:K,writable:!1,configurable:!1}),L},R=P("addListener"),D=P("removeListener"),N=(K,G)=>{const L=R({eventName:K},G),O=async()=>{const $=await L;D({eventName:K,callbackId:$},G)},q=new Promise($=>L.then(()=>$({remove:O})));return q.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await O()},q},_=new Proxy({},{get(K,G){switch(G){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return S?N:R;case"removeListener":return D;default:return P(G)}}});return n[f]=_,d.set(f,{name:f,proxy:_,platforms:new Set([...Object.keys(p),...S?[w]:[]])}),_};return t.convertFileSrc||(t.convertFileSrc=f=>f),t.getPlatform=i,t.handleError=h,t.isNativePlatform=s,t.isPluginAvailable=l,t.registerPlugin=A,t.Exception=pg,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},aB=a=>a.Capacitor=nB(a),cf=aB(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),np=cf.registerPlugin;class mT{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(t);const s=this.windowListeners[e];s&&!s.registered&&this.addWindowListener(s),n&&this.sendRetainedArgumentsForEvent(e);const l=async()=>this.removeListener(e,t);return Promise.resolve({remove:l})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,n){const i=this.listeners[e];if(!i){if(n){let s=this.retainedEventArguments[e];s||(s=[]),s.push(t),this.retainedEventArguments[e]=s}return}i.forEach(s=>s(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:n=>{this.notifyListeners(t,n)}}}unimplemented(e="not implemented"){return new cf.Exception(e,Io.Unimplemented)}unavailable(e="not available"){return new cf.Exception(e,Io.Unavailable)}async removeListener(e,t){const n=this.listeners[e];if(!n)return;const i=n.indexOf(t);this.listeners[e].splice(i,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(n=>{this.notifyListeners(e,n)}))}}const DC=a=>encodeURIComponent(a).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),_C=a=>a.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class iB extends mT{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(n=>{if(n.length<=0)return;let[i,s]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");i=_C(i).trim(),s=_C(s).trim(),t[i]=s}),t}async setCookie(e){try{const t=DC(e.key),n=DC(e.value),i=`; expires=${(e.expires||"").replace("expires=","")}`,s=(e.path||"/").replace("path=",""),l=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${n||""}${i}; path=${s}; ${l};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}np("CapacitorCookies",{web:()=>new iB});const rB=async a=>new Promise((e,t)=>{const n=new FileReader;n.onload=()=>{const i=n.result;e(i.indexOf(",")>=0?i.split(",")[1]:i)},n.onerror=i=>t(i),n.readAsDataURL(a)}),sB=(a={})=>{const e=Object.keys(a);return Object.keys(a).map(i=>i.toLocaleLowerCase()).reduce((i,s,l)=>(i[s]=a[e[l]],i),{})},oB=(a,e=!0)=>a?Object.entries(a).reduce((n,i)=>{const[s,l]=i;let c,h;return Array.isArray(l)?(h="",l.forEach(d=>{c=e?encodeURIComponent(d):d,h+=`${s}=${c}&`}),h.slice(0,-1)):(c=e?encodeURIComponent(l):l,h=`${s}=${c}`),`${n}&${h}`},"").substr(1):null,lB=(a,e={})=>{const t=Object.assign({method:a.method||"GET",headers:a.headers},e),i=sB(a.headers)["content-type"]||"";if(typeof a.data=="string")t.body=a.data;else if(i.includes("application/x-www-form-urlencoded")){const s=new URLSearchParams;for(const[l,c]of Object.entries(a.data||{}))s.set(l,c);t.body=s.toString()}else if(i.includes("multipart/form-data")||a.data instanceof FormData){const s=new FormData;if(a.data instanceof FormData)a.data.forEach((c,h)=>{s.append(h,c)});else for(const c of Object.keys(a.data))s.append(c,a.data[c]);t.body=s;const l=new Headers(t.headers);l.delete("content-type"),t.headers=l}else(i.includes("application/json")||typeof a.data=="object")&&(t.body=JSON.stringify(a.data));return t};class cB extends mT{async request(e){const t=lB(e,e.webFetchExtra),n=oB(e.params,e.shouldEncodeUrlParams),i=n?`${e.url}?${n}`:e.url,s=await fetch(i,t),l=s.headers.get("content-type")||"";let{responseType:c="text"}=s.ok?e:{};l.includes("application/json")&&(c="json");let h,d;switch(c){case"arraybuffer":case"blob":d=await s.blob(),h=await rB(d);break;case"json":h=await s.json();break;default:h=await s.text()}const A={};return s.headers.forEach((f,p)=>{A[p]=f}),{data:h,headers:A,status:s.status,url:s.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}np("CapacitorHttp",{web:()=>new cB});var RC;(function(a){a.missingKey="missingKey",a.invalidData="invalidData",a.osError="osError",a.unknownError="unknownError"})(RC||(RC={}));var NC;(function(a){a[a.whenUnlocked=0]="whenUnlocked",a[a.whenUnlockedThisDeviceOnly=1]="whenUnlockedThisDeviceOnly",a[a.afterFirstUnlock=2]="afterFirstUnlock",a[a.afterFirstUnlockThisDeviceOnly=3]="afterFirstUnlockThisDeviceOnly",a[a.whenPasscodeSetThisDeviceOnly=4]="whenPasscodeSetThisDeviceOnly"})(NC||(NC={}));class KF extends Error{constructor(e,t){super(e),this.name="StorageError",this.code=t}}const $l=np("SecureStorage",{web:async()=>{const a=await hs(()=>import("./web-8KMa2qRF.js"),__vite__mapDeps([0,1]));return new a.SecureStorageWeb},ios:async()=>{const a=await hs(()=>import("./native-B0PHGN88.js"),__vite__mapDeps([2,1]));return new a.SecureStorageNative($l)},android:async()=>{const a=await hs(()=>import("./native-B0PHGN88.js"),__vite__mapDeps([2,1]));return new a.SecureStorageNative($l)}}),vT=Or("Preferences",{web:()=>hs(()=>import("./web-BTe1bGqb.js"),[]).then(a=>new a.PreferencesWeb)}),Hr="maestro.geminiApiKey.v1";let fo;const od=rr.isNativePlatform(),ap=()=>typeof window<"u"?window:void 0,uB=()=>{try{const a=ap();if(!a?.localStorage)return null;const e=a.localStorage.getItem(Hr);return e||null}catch{return null}},dB=a=>{try{const e=ap();if(!e?.localStorage)return;e.localStorage.setItem(Hr,a)}catch{}},yT=()=>{try{const a=ap();if(!a?.localStorage)return;a.localStorage.removeItem(Hr)}catch{}},Od=a=>a.trim(),bT=a=>!(Od(a).length<20),hB=async()=>{try{const{value:a}=await vT.get({key:Hr});return a||null}catch{return null}},ld=async()=>{try{return await vT.remove({key:Hr}),!0}catch{return!1}},AB=async()=>{try{return await $l.getItem(Hr)??null}catch{return null}},CT=async a=>{try{return await $l.setItem(Hr,a),!0}catch{return!1}},ST=async()=>{try{return await $l.removeItem(Hr),!0}catch{return!1}},ip=async()=>{if(fo!==void 0)return fo;let a=null;if(od){if(a=await AB(),!a){const e=await hB();e&&await CT(e)&&(await ld(),a=e)}}else a=uB();return fo=a||null,fo},gB=async a=>{const e=Od(a);if(fo=e||null,!e){od&&(await ST(),await ld()),yT();return}if(od){if(!await CT(e))throw new Error("Secure storage unavailable");await ld()}else dB(e)},fB=async()=>{fo=null,od&&(await ST(),await ld()),yT()},Hd=async()=>{const a=await ip();if(!a){const e=new Error('Missing API key. Tap "API Key" in the top-right and paste your Gemini key.');throw e.code="MISSING_API_KEY",e}return a};class Jl extends Error{status;code;cooldownSuggestSeconds;constructor(e,t){super(e),this.status=t?.status,this.code=t?.code,this.cooldownSuggestSeconds=t?.cooldownSuggestSeconds}}const pB=async a=>{try{const e=await fetch("https://generativelanguage.googleapis.com/v1beta/models?pageSize=1",{method:"GET",headers:{"x-goog-api-key":a}});if(e.ok)return{valid:!0};const t=await e.json(),n=e.status,i=t.error?.message||"",s=t.error?.status||"";return n===400&&(s==="INVALID_ARGUMENT"||i.includes("API key"))?{valid:!1}:{valid:!0}}catch{return{valid:!0}}},ys=async()=>{try{const a=await Hd();return new Kd({apiKey:a})}catch(a){const e=a?.message||"Missing API key";throw new Jl(e,{code:"MISSING_API_KEY"})}},mg=new Set,mB=a=>a&&(a.includes(";")?a.split(";")[0]:a),vg=10,vB=async(a,e=6e4,t=1e3)=>{const n=await ys();let i=a;const s=/\/files\/([^?\s]+)/.exec(a||"");s&&(i=`files/${s[1]}`);const l=Date.now();let c=0;for(;Date.now()-l<e;)try{const h=await n.files.get({name:i});if(h.state==="ACTIVE")return si.logRequest("files.waitForActive","Files API",{name:i,state:"ACTIVE",waitMs:Date.now()-l}).complete({state:"ACTIVE"}),h;if(h.state==="FAILED"){const d=h.error?JSON.stringify(h.error):"Unknown error";throw new Error(`File processing failed: ${d}`)}await new Promise(d=>setTimeout(d,t))}catch(h){if(h.message?.includes("File processing failed"))throw h;if(c++,console.warn(`Error polling file state (attempt ${c}/${vg}), retrying...`,h.message),c>=vg)throw new Error(`Max retries (${vg}) exceeded while polling file ${i}: ${h.message}`);await new Promise(d=>setTimeout(d,t))}throw new Error(`Timeout waiting for file ${i} to become ACTIVE after ${e}ms`)},rp=async a=>{if(!a||!a.length)return{};const e=await ys(),t={},n=[];for(const i of a)mg.has(i)?t[i]={deleted:!0,active:!1}:n.push(i);return n.length>0&&await Promise.all(n.map(async i=>{try{let s=i;const l=/\/files\/([^?\s]+)/.exec(i||"");l&&(s=`files/${l[1]}`);const c=await e.files.get({name:s});t[i]={deleted:c.state==="FAILED",active:c.state==="ACTIVE"},c.state==="FAILED"&&mg.add(i)}catch(s){s.status===404||s.status===403||Number(s.status)===404||Number(s.status)===403||s.status===void 0&&(s.message?.toLowerCase()==="not found"||s.message?.includes("404")||s.message?.includes("403")||s.message?.toLowerCase().includes("forbidden"))?(t[i]={deleted:!0,active:!1},mg.add(i)):t[i]={deleted:!1,active:!1}}})),t},uf=async a=>{const e=a.map(s=>s.imageFileUri).filter(s=>s);if(e.length===0)return a;const t=await rp(e);let n=0;const i=a.map((s,l)=>{if(s.imageFileUri){const c=t[s.imageFileUri];if(c?.deleted||!c?.active){n++,console.warn(`[sanitizeHistory] Stripping expired/invalid media URI from history item ${l}:`,s.imageFileUri?.slice(0,80));const{imageFileUri:h,imageMimeType:d,...A}=s;return A}}return s});return n>0&&console.warn(`[sanitizeHistory] Total media items stripped due to expired URIs: ${n}/${e.length}`),i},Ai=async(a,e,t)=>{const n=await ys(),i=mB(e),s=a.substring(a.indexOf(",")+1),l=atob(s),c=new Array(l.length);for(let p=0;p<l.length;p++)c[p]=l.charCodeAt(p);const h=new Uint8Array(c),d=new Blob([h],{type:i}),A=new File([d],t||"upload",{type:i}),f=si.logRequest("files.upload","Files API",{mimeType:i,displayName:t,size:d.size});try{const p=await n.files.upload({file:A,config:{displayName:t,mimeType:i}});if(!p)throw new Error("Upload failed: missing result");if(!p.uri||!p.uri.trim())throw new Error("Upload failed: missing uri");if(!p.mimeType||!p.mimeType.trim())throw new Error("Upload failed: missing mimeType");return p.state!=="ACTIVE"&&await vB(p.name||p.uri),f.complete(p),{uri:p.uri,mimeType:p.mimeType}}catch(p){throw f.error(p),p}},yB=async a=>{const e=await ys();let t=a;const n=/\/files\/([^?\s]+)/.exec(a||"");n&&(t=`files/${n[1]}`);try{return await e.files.delete({name:t}),{ok:!0}}catch{return{ok:!1}}};function bB(a){a.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return new Proxy({},{get(n,i){return(s,l,c)=>{const h=a.Capacitor.Plugins[t];if(h===void 0){c(new Error(`Capacitor plugin ${t} not found`));return}if(typeof h[i]!="function"){c(new Error(`Method ${i} not found in Capacitor plugin ${t}`));return}(async()=>{try{const d=await h[i](s);l(d)}catch(d){c(d)}})()}}})}})}function CB(a){a.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return a.cordova.plugins[t]}})}function SB(a=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!a?bB(window):window.cordova!==void 0&&CB(window))}var po;(function(a){a.Documents="DOCUMENTS",a.Data="DATA",a.Library="LIBRARY",a.Cache="CACHE",a.External="EXTERNAL",a.ExternalStorage="EXTERNAL_STORAGE",a.ExternalCache="EXTERNAL_CACHE",a.LibraryNoCloud="LIBRARY_NO_CLOUD",a.Temporary="TEMPORARY"})(po||(po={}));var cd;(function(a){a.UTF8="utf8",a.ASCII="ascii",a.UTF16="utf16"})(cd||(cd={}));const GC=Or("Filesystem",{web:()=>hs(()=>import("./web-Bccbff1Y.js"),[]).then(a=>new a.FilesystemWeb)});SB();const LC=Or("Share",{web:()=>hs(()=>import("./web-BZeW4-yI.js"),[]).then(a=>new a.ShareWeb)}),df="ndjson-v1",hf="ndjson",wB="application/x-ndjson",BC=1e6,FC=200,UC=(a,e)=>{const t=a.replace(/[\\/:*?"<>|]/g,"-").trim(),n=t.length>0?t:e,i=n.toLowerCase();return i.endsWith(".ndjson")||i.endsWith(".jsonl")?n:i.endsWith(".json")?n.slice(0,-5)+`.${hf}`:`${n}.${hf}`},KC=()=>JSON.stringify({type:"header",format:df,version:Sw,createdAt:new Date().toISOString()})+`
`,Zs=a=>JSON.stringify(a)+`
`,zC=(a,e,t,n)=>`{"type":"chatChunk","pairId":${JSON.stringify(a)},"chunkIndex":${e}${t?',"isLast":true':""},"messages":[${n.join(",")}]}
`,eo=a=>{const e=(a instanceof Error?a.message:String(a)).toLowerCase();return e.includes("canceled")||e.includes("cancelled")||e.includes("abort")},OC=(a,e)=>{let t=!1,n;return{write:async s=>{if(!t){n=(await GC.writeFile({path:a,data:s,directory:e,encoding:cd.UTF8}))?.uri,t=!0;return}await GC.appendFile({path:a,data:s,directory:e,encoding:cd.UTF8})},close:async()=>{},getUri:()=>n}},HC=async a=>{const e=typeof window<"u"?window.showSaveFilePicker:void 0;if(typeof e!="function")throw new Error("BROWSER_NOT_SUPPORTED");const n=await(await e({suggestedName:a,types:[{description:"Maestro Backup",accept:{[wB]:[".ndjson",".jsonl"]}}],excludeAcceptAllOption:!1})).createWritable();return{write:async i=>{await n.write(i)},close:async()=>{await n.close()}}},TB=a=>new Promise((e,t)=>{const n=new FileReader;n.onload=i=>e(String(i.target?.result||"")),n.onerror=i=>t(i),n.onabort=i=>t(i),n.readAsText(a)}),_u=async(a,e)=>{if(typeof a.stream!="function"){const c=(await TB(a)).split(/\r?\n/);for(const h of c){const d=h.trim();d&&await e(d)}return}const t=a.stream().getReader(),n=new TextDecoder;let i="";for(;;){const{value:l,done:c}=await t.read();if(c)break;i+=n.decode(l,{stream:!0});let h=i.indexOf(`
`);for(;h>=0;){const d=i.slice(0,h);i=i.slice(h+1);const A=d.trim();A&&await e(A),h=i.indexOf(`
`)}}i+=n.decode();const s=i.trim();s&&await e(s)},kB=({t:a})=>{const e=W(b=>b.setMessages),t=W(b=>b.setTempNativeLangCode),n=W(b=>b.setTempTargetLangCode),i=W(b=>b.setIsLanguageSelectionOpen),s=x.useCallback(async b=>{const w=b?.auto===!0;try{const S=W.getState().settings.selectedLanguagePairId;if(S)try{await er(S,W.getState().messages)}catch{}if(!await r2()){w||alert(a("startPage.noChatsToSave"));return}const E=await l2(),I=await Gr();let P=null;try{P=await Wl()}catch{}const R=new Date().toISOString().slice(0,19).replace("T","_").replace(/:/g,"-"),D=w?"maestro-backup-":"maestro-all-chats-",N=b?.filename&&b.filename.trim().length>0?b.filename.trim():`${D}${R}.${hf}`,_=UC(N,`${D}${R}`),K=async G=>{await G.write(KC()),await G.write(Zs({type:"globalProfile",text:I?.text||null})),await G.write(Zs({type:"assets",maestroProfile:P})),await s2(async(L,O)=>{if(!L)return;if(Array.isArray(O)&&O.length>0){let $=0,Q=[],Z=0;const F=async U=>{Q.length&&(await G.write(zC(L,$,U,Q)),$+=1,Q=[],Z=0)};for(let U=0;U<O.length;U++){const Y=JSON.stringify(O[U]),ge=Q.length?1+Y.length:Y.length;Q.length&&(Z+ge>BC||Q.length>=FC)&&await F(!1),Q.push(Y),Z+=ge,U===O.length-1&&await F(!0)}}const q=E&&E[L]||null;q&&await G.write(Zs({type:"meta",pairId:L,meta:q}))}),await G.close()};if(rr.isNativePlatform()){const G=async L=>{const O=OC(_,L);await K(O);const q=O.getUri();if(!q)throw new Error("Missing file URI for backup");return q};try{let L;try{L=await G(po.Documents)}catch{L=await G(po.Cache)}await LC.share({title:a("startPage.saveChats"),url:L,dialogTitle:a("startPage.saveChats")})}catch(L){if(eo(L))return;const O=L instanceof Error?L.message:String(L);console.error("Failed to save/share backup:",L),w||alert(`${a("startPage.saveError")}
${O}`)}return}try{const G=await HC(_);await K(G)}catch(G){if(eo(G))return;if((G instanceof Error?G.message:String(G))==="BROWSER_NOT_SUPPORTED"){w||alert(a("startPage.browserNotSupported")||"Your browser does not support file saving. Please use Chrome or Edge.");return}throw G}}catch(S){if(eo(S))return;const k=S instanceof Error?S.message:String(S);if(k==="BROWSER_NOT_SUPPORTED"){w||alert(a("startPage.browserNotSupported")||"Your browser does not support file saving. Please use Chrome or Edge.");return}console.error("Failed to save all chats:",S),w||alert(`${a("startPage.saveError")}
${k}`)}},[a]),l=x.useCallback(async b=>{if(b)try{let w={...b};w.uri=void 0,await Po(w);try{window.dispatchEvent(new CustomEvent("maestro-avatar-updated",{detail:w}))}catch{}}catch{}},[]),c=x.useCallback(async b=>{alert(a("startPage.loadSuccess",{count:b}));const w=W.getState().settings.selectedLanguagePairId;if(w){const S=await gf(w);e(S)}else{const S=typeof navigator<"u"&&navigator.language||Ur,k=vw(S)||yw(S)||In.find(E=>E.langCode===Ur);t(k.langCode),n(null),i(!0)}},[a,e,t,n,i]),h=x.useCallback(async b=>{let w=!1,S=0;if(await _u(b,async G=>{let L;try{L=JSON.parse(G)}catch{return}L&&typeof L=="object"&&(S+=1,L.type==="header"&&L.format===df&&(w=!0))}),!w||S<2)throw new Error("INVALID_BACKUP_FORMAT");let k=null,E=null;const I={};let P=null,R=[],D=0;await o2({});const N=async G=>{G&&(await PT(G,R),D+=1,P=null,R=[])};await _u(b,async G=>{let L;try{L=JSON.parse(G)}catch(q){console.warn("Skipping malformed line in backup:",q);return}if(!L||typeof L!="object")return;const O=L.type;if(O!=="header"){if(O==="globalProfile"){k=typeof L.text=="string"?L.text:null;return}if(O==="assets"){if(L.maestroProfile&&typeof L.maestroProfile=="object"){const q=L.maestroProfile;q&&(typeof q.dataUrl=="string"||typeof q.uri=="string")&&(E={dataUrl:typeof q.dataUrl=="string"?q.dataUrl:void 0,mimeType:typeof q.mimeType=="string"?q.mimeType:void 0,uri:typeof q.uri=="string"?q.uri:void 0,updatedAt:typeof q.updatedAt=="number"?q.updatedAt:Date.now()})}return}if(O==="meta"){const q=typeof L.pairId=="string"?L.pairId:"";q&&(I[q]=L.meta||null);return}if(O==="chatChunk"){const q=typeof L.pairId=="string"?L.pairId:"";if(!q)return;P&&P!==q&&await N(P),P=q,Array.isArray(L.messages)&&L.messages.length&&R.push(...L.messages),L.isLast===!0&&await N(q);return}}}),P&&await N(P);const _=Object.entries(I);for(const[G,L]of _)if(L)try{await lp(G,L)}catch{}const K=(k||"").trim();if(K)try{await Vf(K)}catch{}await l(E),await c(D)},[l,c]),d=x.useCallback(async b=>{await s({auto:!0});try{const w=(b.name||"").toLowerCase();if(!w.endsWith(".ndjson")&&!w.endsWith(".jsonl"))throw new Error("UNSUPPORTED_FORMAT");await h(b)}catch(w){const S=w instanceof Error?w.message:String(w);console.error("Failed to load chats:",w),alert(S==="INVALID_BACKUP_FORMAT"||S==="UNSUPPORTED_FORMAT"?a("startPage.invalidBackupFormat")||"Invalid backup file. Please select a valid Maestro backup (.ndjson) file.":a("startPage.loadError"))}},[s,a,h]),A=x.useCallback(async()=>{try{const b=W.getState().settings.selectedLanguagePairId;if(!b){alert(a("startPage.noChatsToSave")||"No chat selected to save.");return}try{await er(b,W.getState().messages)}catch{}const w=await gf(b);if(!w||w.length===0){alert(a("startPage.noChatsToSave")||"No messages in this chat to save.");return}const S=await MT(b),k=new Date().toISOString().slice(0,19).replace("T","_").replace(/:/g,"-"),E=UC(`maestro-${b}-${k}`,`maestro-chat-${k}`),I=async P=>{await P.write(KC()),await P.write(Zs({type:"globalProfile",text:null})),await P.write(Zs({type:"assets",maestroProfile:null}));let R=0,D=[],N=0;const _=async K=>{D.length&&(await P.write(zC(b,R,K,D)),R+=1,D=[],N=0)};for(let K=0;K<w.length;K++){const G=JSON.stringify(w[K]),L=D.length?1+G.length:G.length;D.length&&(N+L>BC||D.length>=FC)&&await _(!1),D.push(G),N+=L,K===w.length-1&&await _(!0)}S&&await P.write(Zs({type:"meta",pairId:b,meta:S})),await P.close()};if(rr.isNativePlatform()){const P=async R=>{const D=OC(E,R);await I(D);const N=D.getUri();if(!N)throw new Error("Missing file URI for backup");return N};try{let R;try{R=await P(po.Documents)}catch{R=await P(po.Cache)}await LC.share({title:a("startPage.saveThisChat")||"Save This Chat",url:R,dialogTitle:a("startPage.saveThisChat")||"Save This Chat"})}catch(R){if(eo(R))return;const D=R instanceof Error?R.message:String(R);console.error("Failed to save/share single chat:",R),alert(`${a("startPage.saveError")}
${D}`)}return}try{const P=await HC(E);await I(P)}catch(P){if(eo(P))return;if((P instanceof Error?P.message:String(P))==="BROWSER_NOT_SUPPORTED"){alert(a("startPage.browserNotSupported")||"Your browser does not support file saving. Please use Chrome or Edge.");return}throw P}}catch(b){if(eo(b))return;const w=b instanceof Error?b.message:String(b);if(w==="BROWSER_NOT_SUPPORTED"){alert(a("startPage.browserNotSupported")||"Your browser does not support file saving. Please use Chrome or Edge.");return}console.error("Failed to save current chat:",b),alert(`${a("startPage.saveError")}
${w}`)}},[a]),f=x.useCallback(async b=>{try{const w=W.getState().settings.selectedLanguagePairId;if(!w){alert(a("startPage.noChatSelected")||"Please select a language pair first.");return}const S=(b.name||"").toLowerCase();if(!S.endsWith(".ndjson")&&!S.endsWith(".jsonl"))throw new Error("UNSUPPORTED_FORMAT");let k=!1,E=0;if(await _u(b,async L=>{let O;try{O=JSON.parse(L)}catch{return}O&&typeof O=="object"&&(E+=1,O.type==="header"&&O.format===df&&(k=!0))}),!k||E<2)throw new Error("INVALID_BACKUP_FORMAT");let I=[];if(await _u(b,async L=>{let O;try{O=JSON.parse(L)}catch{return}!O||typeof O!="object"||O.type==="chatChunk"&&(typeof O.pairId=="string"?O.pairId:"")===w&&Array.isArray(O.messages)&&I.push(...O.messages)}),I.length===0){alert(a("startPage.noPairInBackup")||`The backup file does not contain messages for your current language pair (${w}). Please select a backup that matches your current chat.`);return}const P=W.getState().messages,R=[...P,...I],D=new Map;for(const L of R){const O=D.get(L.id);if(!O)D.set(L.id,L);else{const q=typeof O.timestamp=="number"&&O.timestamp>0,$=typeof L.timestamp=="number"&&L.timestamp>0;(!q&&$||q&&$&&L.timestamp>O.timestamp)&&D.set(L.id,L)}}const N=Array.from(D.values()).sort((L,O)=>{const q=typeof L.timestamp=="number"?L.timestamp:Number.MAX_SAFE_INTEGER,$=typeof O.timestamp=="number"?O.timestamp:Number.MAX_SAFE_INTEGER;return q!==$?q-$:L.id.localeCompare(O.id)}),_=Math.max(0,N.length-P.length),K=R.length-N.length;e(N),await er(w,N);let G;_>0?G=a("startPage.combineSuccess",{added:_,total:N.length})||`Combined chats: ${_} new messages added, ${N.length} total messages.`:K>0?G=a("startPage.combineNoDuplicates",{total:N.length})||`All ${K} messages were already in your chat. No changes made.`:G=a("startPage.combineNoChanges")||"No new messages to add. Your chat is unchanged.",_>0&&K>0&&(G+=` (${K} duplicates skipped)`),alert(G)}catch(w){const S=w instanceof Error?w.message:String(w);console.error("Failed to combine chats:",w),alert(S==="INVALID_BACKUP_FORMAT"||S==="UNSUPPORTED_FORMAT"?a("startPage.invalidBackupFormat")||"Invalid backup file. Please select a valid Maestro backup (.ndjson) file.":a("startPage.loadError"))}},[a,e]),p=x.useCallback(async()=>{try{const b=W.getState().settings.selectedLanguagePairId,w=W.getState().settings.historyBookmarkMessageId;if(!b)return alert(a("startPage.noChatSelected")||"No chat selected."),!1;if(!w)return alert(a("startPage.noBookmarkSet")||"No bookmark set. Set a bookmark first to trim messages before it."),!1;const S=W.getState().messages,k=S.findIndex(R=>R.id===w);if(k<=0)return alert(a("startPage.noMessagesToTrim")||"No messages before the bookmark to remove."),!1;let E;for(let R=k;R>=0;R--){const D=S[R];if(D.role==="assistant"&&typeof D.chatSummary=="string"&&D.chatSummary.trim()){E=D.chatSummary.trim();break}}const I=S.slice(k);if(E&&I.length>0){const R=I.findIndex(D=>D.role==="assistant");R>=0&&!I[R].chatSummary&&(I[R]={...I[R],chatSummary:E})}e(I),await er(b,I),W.getState().updateSetting("historyBookmarkMessageId",null);const P=k;return alert(a("startPage.trimSuccess",{count:P})||`Removed ${P} messages before the bookmark.`),!0}catch(b){return console.error("Failed to trim before bookmark:",b),alert(a("startPage.trimError")||"Failed to trim messages. Please try again."),!1}},[a,e]);return{handleSaveAllChats:s,handleLoadAllChats:d,handleSaveCurrentChat:A,handleAppendToCurrentChat:f,handleTrimBeforeBookmark:p}},EB="app.title",Mi="image-gen-camera",ud=10,yg=[{id:"Zephyr",description:"Bright"},{id:"Puck",description:"Upbeat"},{id:"Charon",description:"Informative"},{id:"Kore",description:"Firm"},{id:"Fenrir",description:"Excitable"}],xB=()=>{const{t:a}=Ro(),{handleSaveAllChats:e,handleLoadAllChats:t,handleSaveCurrentChat:n,handleAppendToCurrentChat:i,handleTrimBeforeBookmark:s}=kB({t:a}),l=W(Vd),c=W(Ce=>Ce.updateSetting),h=l.tts.voiceName||"Kore",d=W(Ce=>Ce.addActivityToken),A=W(Ce=>Ce.removeActivityToken),f=x.useCallback(Ce=>d(mn.UI,`${Ce}:${Date.now()}:${Math.random().toString(36).slice(2,8)}`),[d]),p=x.useCallback(Ce=>{Ce&&A(Ce)},[A]),[b,w]=x.useState(null),[S,k]=x.useState(!1),[E,I]=x.useState("none"),[P,R]=x.useState(!1),[D,N]=x.useState(""),[_,K]=x.useState("none"),[G,L]=x.useState(""),[O,q]=x.useState(null),$={none:{keyword:"",label:"",description:"",colorClass:"",bgClass:"",borderClass:"",textClass:"",placeholderClass:"",btnClass:"",shadowClass:""},saveAll:{keyword:"SAVE",label:a("sessionControls.saveAll.label")||"Save All",description:a("sessionControls.saveAll.description")||"Export all chats to backup file",colorClass:"text-emerald-300",bgClass:"bg-emerald-950/30",borderClass:"border-emerald-500/30",textClass:"text-emerald-100",placeholderClass:"placeholder-emerald-400/30",btnClass:"bg-emerald-500/80 hover:bg-emerald-500",shadowClass:"shadow-emerald-900/20"},loadAll:{keyword:"LOAD",label:a("sessionControls.loadAll.label")||"Load All",description:a("sessionControls.loadAll.description")||"Replace all chats with backup file",colorClass:"text-blue-300",bgClass:"bg-blue-950/30",borderClass:"border-blue-500/30",textClass:"text-blue-100",placeholderClass:"placeholder-blue-400/30",btnClass:"bg-blue-500/80 hover:bg-blue-500",shadowClass:"shadow-blue-900/20"},reset:{keyword:"DELETE",label:a("sessionControls.reset.label")||"Reset",description:a("sessionControls.reset.description")||"Backup & delete all data",colorClass:"text-red-300",bgClass:"bg-red-950/30",borderClass:"border-red-500/30",textClass:"text-red-100",placeholderClass:"placeholder-red-400/30",btnClass:"bg-red-500/80 hover:bg-red-500",shadowClass:"shadow-red-900/20"},saveThis:{keyword:"SAVE",label:a("sessionControls.saveThis.label")||"Save Chat",description:a("sessionControls.saveThis.description")||"Export this chat only",colorClass:"text-cyan-300",bgClass:"bg-cyan-950/30",borderClass:"border-cyan-500/30",textClass:"text-cyan-100",placeholderClass:"placeholder-cyan-400/30",btnClass:"bg-cyan-500/80 hover:bg-cyan-500",shadowClass:"shadow-cyan-900/20"},combine:{keyword:"COMBINE",label:a("sessionControls.combine.label")||"Combine",description:a("sessionControls.combine.description")||"Merge backup into this chat",colorClass:"text-violet-300",bgClass:"bg-violet-950/30",borderClass:"border-violet-500/30",textClass:"text-violet-100",placeholderClass:"placeholder-violet-400/30",btnClass:"bg-violet-500/80 hover:bg-violet-500",shadowClass:"shadow-violet-900/20"},trim:{keyword:"TRIM",label:a("sessionControls.trim.label")||"Trim",description:a("sessionControls.trim.description")||"Remove messages before bookmark",colorClass:"text-orange-300",bgClass:"bg-orange-950/30",borderClass:"border-orange-500/30",textClass:"text-orange-100",placeholderClass:"placeholder-orange-400/30",btnClass:"bg-orange-500/80 hover:bg-orange-500",shadowClass:"shadow-orange-900/20"}},[Q,Z]=x.useState(!1),[F,U]=x.useState(null),Y=x.useRef(null),ge=x.useRef(null),me=x.useRef(null),z=x.useRef(null),H=x.useRef(null),j=x.useRef(null),le=x.useRef(null),te=x.useRef(null),oe=x.useRef(null),ce=x.useRef(null),Ge=x.useRef(null),ae=x.useRef(null),Le=x.useRef(null);x.useEffect(()=>{let Ce=!0;return(async()=>{try{const lt=await Wl();Ce&&w(lt)}catch{}})(),()=>{Ce=!1}},[]),x.useEffect(()=>()=>{me.current&&clearTimeout(me.current)},[]),x.useEffect(()=>{const Ce=lt=>{try{const ht=lt?.detail||{};ht&&(typeof ht.dataUrl=="string"||typeof ht.uri=="string")?w(wt=>({dataUrl:typeof ht.dataUrl=="string"?ht.dataUrl:wt?.dataUrl,mimeType:typeof ht.mimeType=="string"?ht.mimeType:wt?.mimeType,uri:typeof ht.uri=="string"?ht.uri:wt?.uri,updatedAt:Date.now()})):Wl().then(wt=>w(wt)).catch(()=>{})}catch{}};return window.addEventListener("maestro-avatar-updated",Ce),()=>window.removeEventListener("maestro-avatar-updated",Ce)},[]);const De=x.useCallback(()=>{const Ce=yg.findIndex(ht=>ht.id===h),lt=yg[(Ce+1)%yg.length];c("tts",{...l.tts,voiceName:lt.id})},[h,c,l.tts]),ue=async()=>{try{const Ce=(await Gr())?.text??"";N(Ce),R(!0)}catch{N(""),R(!0)}},ne=async()=>{try{await Vf(D.trim());try{window.dispatchEvent(new CustomEvent("globalProfileUpdated"))}catch{}}finally{R(!1)}},fe=x.useCallback(async()=>{try{await new Promise(Ce=>{let lt=!1;try{const ht=indexedDB.deleteDatabase(Cw);ht.onsuccess=()=>{lt=!0,Ce()},ht.onerror=()=>{Ce()},ht.onblocked=()=>{Ce()}}catch{Ce()}setTimeout(()=>{lt||Ce()},1500)})}catch{}},[]),Te=async()=>{try{k(!0),oe.current||(oe.current=f(_t.MAESTRO_AVATAR))}catch{}try{const Ce=b?.uri;if(Ce)try{await yB(Ce)}catch{}try{await II()}catch{}w(null);try{window.dispatchEvent(new CustomEvent("maestro-avatar-updated",{detail:{}}))}catch{}}catch{}try{const Ce=await fetch("/maestro-avatars/manifest.json",{cache:"force-cache"});let lt=!1;if(Ce.ok){const ht=await Ce.json();if(Array.isArray(ht))for(const wt of ht)try{const tn=await fetch(`/maestro-avatars/${wt}`,{cache:"force-cache"});if(tn.ok){const Sn=await tn.blob(),wn=Sn.type||"image/png",cn=await new Promise((_e,He)=>{const Ke=new FileReader;Ke.onloadend=()=>_e(Ke.result),Ke.onerror=()=>He(Ke.error||new Error("DataURL conversion failed")),Ke.readAsDataURL(Sn)});let bt,Wt=wn;try{const _e=await Ai(cn,wn,"maestro-avatar");bt=_e.uri,Wt=_e.mimeType}catch{}const se={dataUrl:cn,mimeType:Wt,uri:bt,updatedAt:Date.now()};try{await Po(se)}catch{}w(se);try{window.dispatchEvent(new CustomEvent("maestro-avatar-updated",{detail:se}))}catch{}lt=!0;break}}catch{}}if(!lt){w(null);try{window.dispatchEvent(new CustomEvent("maestro-avatar-updated",{detail:{}}))}catch{}}}catch{w(null);try{window.dispatchEvent(new CustomEvent("maestro-avatar-updated",{detail:{}}))}catch{}}finally{try{k(!1)}catch{}try{Le.current&&(Le.current.value="",Le.current.click())}catch{}oe.current&&(p(oe.current),oe.current=null)}},pe=async Ce=>{ce.current&&(p(ce.current),ce.current=null);const lt=Ce.target.files?.[0];if(!lt){Ce.target.value="";return}if(!lt.type.startsWith("image/")){Ce.target.value="";return}try{k(!0),oe.current||(oe.current=f(_t.MAESTRO_AVATAR));const ht=await new Promise((wn,cn)=>{const bt=new FileReader;bt.onload=()=>wn(String(bt.result)),bt.onerror=Wt=>cn(Wt),bt.readAsDataURL(lt)});let wt,tn=lt.type;try{const wn=await Ai(ht,lt.type,"maestro-avatar");wt=wn.uri,tn=wn.mimeType}catch{}const Sn={dataUrl:ht,mimeType:tn,uri:wt,updatedAt:Date.now()};await Po(Sn),w(Sn);try{window.dispatchEvent(new CustomEvent("maestro-avatar-updated",{detail:{uri:wt,mimeType:tn,dataUrl:ht}}))}catch{}}catch(ht){console.error("Failed to save Maestro avatar:",ht)}finally{k(!1),Ce.target.value="",oe.current&&(p(oe.current),oe.current=null)}},ye=async Ce=>{const lt=Ce.target.files?.[0];Ce.target.value="",lt&&(q(lt),K("loadAll"),L(""))},Ie=async Ce=>{const lt=Ce.target.files?.[0];Ce.target.value="",lt&&(q(lt),K("combine"),L(""))},qe=()=>{K("none"),L(""),q(null)},Re=async()=>{const Ce=$[_];if(G.toUpperCase()===Ce.keyword){try{switch(_){case"saveAll":z.current||(z.current=f(_t.SAVE_POPUP));try{await e()}finally{z.current&&(p(z.current),z.current=null)}break;case"loadAll":if(O&&t){H.current||(H.current=f(_t.LOAD_POPUP));try{await t(O)}finally{H.current&&(p(H.current),H.current=null)}}break;case"reset":{const lt=`backup-before-reset-${new Date().toISOString().slice(0,10)}`;e&&await e({filename:`${lt}.ndjson`,auto:!0}),await new Promise(ht=>setTimeout(ht,500)),await fe(),window.location.reload();return}case"saveThis":j.current||(j.current=f(_t.SAVE_POPUP));try{await n()}finally{j.current&&(p(j.current),j.current=null)}break;case"combine":if(O&&i){le.current||(le.current=f(_t.LOAD_POPUP));try{await i(O)}finally{le.current&&(p(le.current),le.current=null)}}break;case"trim":te.current||(te.current=f(_t.SAVE_POPUP));try{await s()}finally{te.current&&(p(te.current),te.current=null)}break}}catch(lt){console.error("Action failed:",lt)}qe()}},et="data-avatar-action",Ye=x.useCallback(Ce=>{let lt=Ce;for(;lt&&lt!==document.body;){const ht=lt.getAttribute(et);if(ht)return ht;lt=lt.parentElement}return null},[]),Qe=x.useCallback(()=>{me.current&&(clearTimeout(me.current),me.current=null)},[]),st=x.useCallback((Ce=300)=>{Qe(),me.current=setTimeout(()=>{Z(!1),U(null)},Ce)},[Qe]),yt=x.useCallback(Ce=>{Ce==="swap"&&!S?Te():Ce==="voice"&&De(),st(200)},[S,De,st]),ft=x.useCallback(Ce=>{if(Y.current=Ce.pointerType,ge.current=Ce.pointerId,Qe(),Y.current==="touch"||Y.current==="pen"){Z(!0);const lt=Ye(Ce.target);U(lt==="swap"?"left":lt==="voice"?"right":null),Ce.target.setPointerCapture?.(Ce.pointerId)}},[Ye,Qe]),Ue=x.useCallback(Ce=>{if(ge.current===Ce.pointerId&&(Y.current==="touch"||Y.current==="pen")){const lt=document.elementFromPoint(Ce.clientX,Ce.clientY),ht=Ye(lt);U(ht==="swap"?"left":ht==="voice"?"right":null)}},[Ye]),Be=x.useCallback(Ce=>{if(ge.current!==Ce.pointerId)return;Ce.target.releasePointerCapture?.(Ce.pointerId);const lt=document.elementFromPoint(Ce.clientX,Ce.clientY),ht=Ye(lt);Y.current==="touch"||Y.current==="pen"?(ht&&yt(ht),U(null),Z(!1)):(ht&&yt(ht),U(null)),ge.current=null},[Ye,yt]),it=x.useCallback(Ce=>{ge.current===Ce.pointerId&&(U(null),Z(!1),ge.current=null)},[]),mt=x.useCallback(()=>{Y.current!=="touch"&&Y.current!=="pen"&&(Qe(),Z(!0))},[Qe]),Rt=x.useCallback(()=>{Y.current!=="touch"&&Y.current!=="pen"&&st(300)},[st]),Qt=Ce=>({Zephyr:SS,Puck:TS,Charon:kS,Kore:Yu,Fenrir:wS})[Ce]||Yu,dt=Ce=>({Zephyr:"ring-cyan-300/50 bg-cyan-900/40",Puck:"ring-amber-300/50 bg-amber-900/40",Charon:"ring-emerald-300/50 bg-emerald-900/40",Kore:"ring-blue-300/50 bg-blue-900/40",Fenrir:"ring-rose-300/50 bg-rose-900/40"})[Ce]||"ring-blue-300/50 bg-blue-900/40",Mt=Qt(h),Bt=dt(h).split(" ")[1]||"bg-blue-900/40";return T.jsx("div",{className:"w-full py-3 px-4 min-h-[64px] flex items-center justify-between gap-2",children:_!=="none"?T.jsxs("div",{className:"flex-1 flex items-start animate-fade-in gap-2 min-w-0",children:[T.jsxs("div",{className:"flex flex-col flex-1 min-w-0 gap-1",children:[T.jsxs("span",{className:`text-xs font-bold uppercase tracking-wider ${$[_].colorClass}`,children:[$[_].label,":"]}),T.jsx("input",{className:`w-full ${$[_].bgClass} border ${$[_].borderClass} rounded px-2 py-1 text-sm ${$[_].textClass} ${$[_].placeholderClass} focus:outline-none focus:border-opacity-60 transition-colors`,placeholder:(a("sessionControls.typeToConfirm")||'Type "{keyword}" to confirm').replace("{keyword}",$[_].keyword),value:G,onChange:Ce=>L(Ce.target.value),onKeyDown:Ce=>Ce.key==="Enter"&&Re(),autoFocus:!0}),T.jsx("span",{className:"text-xs text-muted-foreground break-words",children:$[_].description})]}),T.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[T.jsx("button",{type:"button",onClick:Re,disabled:G.toUpperCase()!==$[_].keyword,className:`p-2 ${$[_].btnClass} rounded-full text-white disabled:opacity-30 disabled:cursor-not-allowed transition-all shadow-lg ${$[_].shadowClass}`,children:T.jsx(As,{className:"w-4 h-4"})}),T.jsx("button",{type:"button",onClick:qe,className:"p-2 bg-primary/50 hover:bg-primary/70 rounded-full text-primary-foreground/70 transition-colors",children:T.jsx(Nr,{className:"w-4 h-4"})})]})]}):P?T.jsxs("div",{className:"flex-1 flex items-start justify-between animate-fade-in gap-2",children:[T.jsxs("div",{className:"flex flex-col gap-1 flex-1 min-w-0",children:[T.jsx("span",{className:"text-xs font-bold text-watercolor uppercase tracking-wider",children:a("sessionControls.profile")||"Profile:"}),T.jsx("input",{className:"w-full max-w-[520px] bg-watercolor/10 border border-watercolor/30 rounded px-2 py-1.5 text-sm text-primary-foreground/80 placeholder-watercolor/30 focus:outline-none focus:border-watercolor/60 focus:bg-watercolor/15 transition-colors",placeholder:a("sessionControls.profilePlaceholder")||"Your name or details...",value:D,onChange:Ce=>N(Ce.target.value),autoFocus:!0,onKeyDown:Ce=>Ce.key==="Enter"&&ne()})]}),T.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[T.jsx("button",{type:"button",onClick:ne,className:"p-2 bg-green-500/80 hover:bg-green-500 rounded-full text-white transition-all shadow-lg shadow-green-900/20",children:T.jsx(As,{className:"w-4 h-4"})}),T.jsx("button",{type:"button",onClick:()=>R(!1),className:"p-2 bg-primary/50 hover:bg-primary/70 rounded-full text-primary-foreground/70 transition-colors",children:T.jsx(Nr,{className:"w-4 h-4"})})]})]}):T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"flex items-center",children:T.jsx("button",{type:"button",onClick:ue,className:"group p-2.5 rounded-full text-muted-foreground hover:text-white hover:bg-white/10 transition-all",title:a("sessionControls.editProfile")||"Edit User Profile",children:T.jsx(tr,{className:"w-4 h-4 opacity-70 group-hover:opacity-100"})})}),T.jsx("div",{className:"flex items-center bg-primary/60 backdrop-blur-sm rounded-full p-1 border border-white/5 shadow-inner",children:E==="none"?T.jsxs(T.Fragment,{children:[T.jsxs("button",{type:"button",onClick:()=>I("all"),className:"px-3 py-1.5 hover:bg-white/10 rounded-full text-primary-foreground/70 hover:text-white transition-colors text-xs font-medium flex items-center gap-1",title:a("sessionControls.allChatsControls")||"All Chats Controls",children:[T.jsx(Mg,{className:"w-3.5 h-3.5"}),T.jsx(xS,{className:"w-3.5 h-3.5"}),T.jsx(Dg,{className:"w-3.5 h-3.5"})]}),T.jsx("div",{className:"w-px h-4 bg-white/10 mx-0.5"}),T.jsxs("button",{type:"button",onClick:()=>I("this"),className:"px-3 py-1.5 hover:bg-white/10 rounded-full text-primary-foreground/70 hover:text-white transition-colors text-xs font-medium flex items-center gap-1",title:a("sessionControls.thisChatsControls")||"This Chat Controls",children:[T.jsx(Mg,{className:"w-3.5 h-3.5"}),T.jsx(PS,{className:"w-3.5 h-3.5"}),T.jsx(Dg,{className:"w-3.5 h-3.5"})]})]}):E==="all"?T.jsxs(T.Fragment,{children:[T.jsx("button",{type:"button",onClick:()=>I("none"),className:"p-2 hover:bg-white/10 rounded-full text-muted-foreground hover:text-white transition-colors",title:a("sessionControls.back")||"Back",children:T.jsx(Nr,{className:"w-4 h-4"})}),T.jsx("div",{className:"w-px h-4 bg-white/10 mx-0.5"}),T.jsx("button",{type:"button",onClick:()=>{K("saveAll"),L("")},className:"p-2 hover:bg-white/10 rounded-full text-primary-foreground/70 hover:text-white transition-colors",title:a("startPage.saveChats")||"Save All Chats",children:T.jsx(AS,{className:"w-4 h-4"})}),T.jsx("div",{className:"w-px h-4 bg-white/10 mx-0.5"}),T.jsx("button",{type:"button",onClick:()=>Ge.current?.click(),className:"p-2 hover:bg-white/10 rounded-full text-primary-foreground/70 hover:text-white transition-colors",title:a("startPage.loadChats")||"Load All Chats",children:T.jsx(gS,{className:"w-4 h-4"})}),T.jsx("div",{className:"w-px h-4 bg-white/10 mx-0.5"}),T.jsx("button",{type:"button",onClick:()=>{K("reset"),L("")},className:"p-2 hover:bg-red-500/20 rounded-full text-primary-foreground/70 hover:text-red-200 transition-colors",title:a("sessionControls.backupAndReset")||"Backup & Reset",children:T.jsx(yd,{className:"w-4 h-4"})})]}):T.jsxs(T.Fragment,{children:[T.jsx("button",{type:"button",onClick:()=>I("none"),className:"p-2 hover:bg-white/10 rounded-full text-muted-foreground hover:text-white transition-colors",title:a("sessionControls.back")||"Back",children:T.jsx(Nr,{className:"w-4 h-4"})}),T.jsx("div",{className:"w-px h-4 bg-white/10 mx-0.5"}),T.jsx("button",{type:"button",onClick:()=>{K("saveThis"),L("")},className:"p-2 hover:bg-white/10 rounded-full text-primary-foreground/70 hover:text-white transition-colors",title:a("startPage.saveThisChat")||"Save This Chat",children:T.jsx(qu,{className:"w-4 h-4"})}),T.jsx("div",{className:"w-px h-4 bg-white/10 mx-0.5"}),T.jsx("button",{type:"button",onClick:()=>ae.current?.click(),className:"p-2 hover:bg-white/10 rounded-full text-primary-foreground/70 hover:text-white transition-colors",title:a("startPage.appendToChat")||"Combine Chats",children:T.jsx(Qu,{className:"w-4 h-4"})}),T.jsx("div",{className:"w-px h-4 bg-white/10 mx-0.5"}),T.jsx("button",{type:"button",onClick:()=>{K("trim"),L("")},className:"p-2 hover:bg-orange-500/20 rounded-full text-primary-foreground/70 hover:text-orange-200 transition-colors",title:a("startPage.trimBeforeBookmark")||"Trim Before Bookmark",children:T.jsx(ES,{className:"w-4 h-4"})})]})}),T.jsx("input",{type:"file",ref:Ge,onChange:ye,accept:".ndjson,.jsonl",className:"hidden"}),T.jsx("input",{type:"file",ref:ae,onChange:Ie,accept:".ndjson,.jsonl",className:"hidden"}),T.jsxs("div",{className:"relative flex items-center justify-center w-14 h-10 select-none",onPointerDown:ft,onPointerMove:Ue,onPointerUp:Be,onPointerCancel:it,onMouseEnter:mt,onMouseLeave:Rt,style:{touchAction:"none"},children:[T.jsxs("button",{type:"button",[et]:"swap",className:`absolute left-1/2 -translate-x-[24px] top-1/2 -translate-y-1/2 w-8 h-8 rounded-full bg-primary border border-border flex items-center justify-center text-muted-foreground hover:text-white hover:bg-primary/80 hover:border-border transition-all duration-200 shadow-lg z-0 ${Q?"-translate-x-[36px]":""} ${F==="left"?"text-white bg-primary/80 border-border z-20 scale-110 ring-2 ring-white/30":"hover:z-20 hover:scale-105"}`,title:a("general.clear")+" / "+(a("sessionControls.changeAvatar")||"Change Avatar"),children:[T.jsx(Ig,{className:"w-3.5 h-3.5"}),T.jsx(Ig,{className:`absolute left-0 top-1/2 -translate-y-1/2 -translate-x-2.5 w-3 h-3 text-muted-foreground transition-opacity duration-200 ${Q?"opacity-0":"opacity-100"}`})]}),T.jsxs("button",{type:"button",[et]:"voice",className:`absolute right-1/2 translate-x-[24px] top-1/2 -translate-y-1/2 w-8 h-8 rounded-full border flex items-center justify-center transition-all duration-200 shadow-lg z-0 ${dt(h)} ring-1 border-white/10 ${Q?"translate-x-[36px]":""} ${F==="right"?"z-20 scale-110 ring-2 ring-white/30":"hover:z-20 hover:scale-105"}`,title:`Voice: ${h}`,children:[T.jsx("div",{className:"absolute inset-0 pointer-events-none",children:T.jsx("div",{className:`absolute inset-0 rounded-full ${Bt} animate-voice-ripple`},h)}),T.jsx(Mt,{className:"w-3.5 h-3.5 text-white/90 animate-voice-swap"},h),T.jsx(pd,{className:`absolute right-0 top-1/2 -translate-y-1/2 translate-x-2.5 w-3 h-3 text-white/70 transition-opacity duration-200 ${Q?"opacity-0":"opacity-100"}`})]}),T.jsx("div",{className:"relative z-10 w-10 h-10 pointer-events-none",children:T.jsxs("div",{className:`w-full h-full rounded-full overflow-hidden border-2 flex items-center justify-center bg-primary transition-all duration-300
                    ${b?.dataUrl?"border-accent/60 shadow-[0_0_15px_rgba(191,106,58,0.5)]":"border-border border-dashed opacity-80"}`,children:[b?.dataUrl?T.jsx("img",{src:b.dataUrl,alt:a("startPage.maestroAvatar")||"Maestro avatar",className:"w-full h-full object-cover"}):T.jsx(Qu,{className:"w-4 h-4 text-muted-foreground"}),S&&T.jsx("div",{className:"absolute inset-0 bg-black/60 flex items-center justify-center backdrop-blur-[1px]",children:T.jsx(Ii,{className:"w-4 h-4 text-white"})})]})}),T.jsx("input",{type:"file",ref:Le,onChange:pe,accept:"image/*",className:"hidden"})]})]})})},aa=(a,e)=>({get current(){return e(a())},set current(t){}}),Ru=(a,e,t)=>({get current(){return e(a())},set current(n){t(n)}}),PB=({isLoadingHistory:a,selectedLanguagePairId:e,activityTokens:t,isVisualContextActive:n,triggerReengagementSequence:i,addActivityToken:s,removeActivityToken:l})=>{const c=W(Q=>Q.reengagementPhase),h=W(Q=>Q.setReengagementPhase),d=W(Q=>Q.setReengagementDeadline),A=W(Q=>Q.setIsUserActive),f=x.useRef({waitTimer:null,countdownTimer:null}),p=x.useRef({waitToken:null,countdownToken:null}),b=x.useRef(null),w=x.useRef(!1),S=x.useRef(null),k=x.useRef(()=>{}),E=x.useRef(()=>{}),I=x.useRef(()=>{}),P=x.useRef(()=>!1),R=x.useRef(i),D=x.useRef(s),N=x.useRef(l),_=x.useMemo(()=>aa(W.getState,Q=>Q.settings),[]);x.useEffect(()=>{R.current=i},[i]),x.useEffect(()=>{D.current=s},[s]),x.useEffect(()=>{N.current=l},[l]);const K=x.useCallback(()=>a||!e||n?!1:![...t].some(Z=>!ed(Z)),[a,e,n,t]);x.useEffect(()=>{P.current=K},[K]);const G=x.useCallback(()=>{const Q=f.current;Q.waitTimer&&(clearTimeout(Q.waitTimer),Q.waitTimer=null),Q.countdownTimer&&(clearTimeout(Q.countdownTimer),Q.countdownTimer=null);const Z=p.current;Z.waitToken&&(N.current(Z.waitToken),Z.waitToken=null),Z.countdownToken&&(N.current(Z.countdownToken),Z.countdownToken=null),b.current=null,d(null),h("idle")},[d,h]);x.useEffect(()=>{E.current=G},[G]);const L=x.useCallback((Q,Z)=>{if(!P.current()){E.current();return}const F=f.current;F.waitTimer&&(clearTimeout(F.waitTimer),F.waitTimer=null),F.countdownTimer&&(clearTimeout(F.countdownTimer),F.countdownTimer=null);const U=p.current;U.countdownToken&&(N.current(U.countdownToken),U.countdownToken=null),U.waitToken&&(N.current(U.waitToken),U.waitToken=null);const Y=Math.max(0,Math.floor(Number.isFinite(Q)?Q:0)),ge=D.current(mn.UI,`${_t.REENGAGE_WAIT}:${Z}`);if(U.waitToken=ge,Y>1e4){const z=Math.floor(Y*.6),H=Y-z;b.current=Date.now()+Y,d(b.current),h("waiting"),F.waitTimer=window.setTimeout(()=>{h("watching"),F.waitTimer=window.setTimeout(()=>{F.waitTimer=null,I.current("timer-elapsed")},H)},z)}else b.current=Date.now()+Y,d(b.current),h("watching"),F.waitTimer=window.setTimeout(()=>{F.waitTimer=null,I.current("timer-elapsed")},Y)},[d,h]),O=x.useCallback((Q,Z)=>{const F=_.current.smartReengagement.thresholdSeconds*1e3,U=typeof Z=="number"&&Number.isFinite(Z)?Z:F;if(!P.current()){E.current();return}L(U,Q)},[L]);x.useEffect(()=>{k.current=O},[O]);const q=x.useCallback(Q=>{if(w.current){k.current("user-active-during-countdown");return}if(!P.current()){k.current("countdown-blocked");return}const Z=f.current;Z.waitTimer&&(clearTimeout(Z.waitTimer),Z.waitTimer=null);const F=p.current;F.waitToken&&(N.current(F.waitToken),F.waitToken=null),F.countdownToken&&(N.current(F.countdownToken),F.countdownToken=null),Z.countdownTimer&&(clearTimeout(Z.countdownTimer),Z.countdownTimer=null);const U=D.current(mn.UI,`${_t.REENGAGE_COUNTDOWN}:${Q}`);F.countdownToken=U,b.current=null,d(null),h("countdown"),Z.countdownTimer=window.setTimeout(async()=>{if(Z.countdownTimer=null,w.current){k.current("user-active-during-countdown");return}if(!P.current()){k.current("countdown-blocked");return}E.current(),await R.current()},5e3)},[d,h]);x.useEffect(()=>{I.current=q},[q]);const $=x.useCallback(()=>{w.current=!0,A(!0),E.current(),S.current!==null&&window.clearTimeout(S.current),S.current=window.setTimeout(()=>{S.current=null,w.current=!1,A(!1)},3e3)},[A]);return x.useEffect(()=>()=>{S.current!==null&&(window.clearTimeout(S.current),S.current=null),w.current&&(w.current=!1,A(!1))},[A]),{reengagementPhase:c,scheduleReengagement:O,cancelReengagement:G,isReengagementToken:ed,handleUserActivity:$,setReengagementPhase:h}},MB=({isSettingsLoaded:a,settings:e,languagePairs:t,handleSettingsChange:n,isLanguageSelectionOpen:i,tempNativeLangCode:s,tempTargetLangCode:l,languageSelectorLastInteraction:c,setIsLanguageSelectionOpen:h,setTempNativeLangCode:d,setTempTargetLangCode:A})=>{const f=x.useCallback(()=>{const S=W.getState();if(nr(S))return;h(!0);const k=S.settings.selectedLanguagePairId;if(k){const E=Rd(k);E?(d(E.nativeCode),A(E.targetCode)):(d(null),A(null))}},[h,d,A]),p=x.useCallback(S=>{d(S),S&&S===l&&A(null)},[d,l,A]),b=x.useCallback(S=>{A(S)},[A]),w=x.useCallback(async()=>{if(!s||!l)return;const S=`${l}-${s}`,k=W.getState(),E=k.settings.selectedLanguagePairId;if(S!==E&&E)try{await er(E,k.messages)}catch(P){console.error(`[useLanguageSelectionController] Failed to save chat history for pairId=${E}:`,P)}if(t.some(P=>P.id===S)){const P=k.settings.isSuggestionMode,R=ha(P?s:l);n("stt",{...k.settings.stt,language:R}),n("selectedLanguagePairId",S)}h(!1)},[s,l,t,n,h]);return x.useEffect(()=>{if(a&&!e.selectedLanguagePairId){const S=typeof navigator<"u"&&navigator.language||Ur,k=vw(S)||yw(S)||In.find(E=>E.langCode===Ur);d(k.langCode),A(null),h(!0)}},[a,e.selectedLanguagePairId,d,A,h]),x.useEffect(()=>{let S;return i&&s&&l&&(S=window.setTimeout(()=>{Date.now()-c>=4500&&w()},5e3)),()=>clearTimeout(S)},[i,s,l,w,c]),{handleShowLanguageSelector:f,handleTempNativeSelect:p,handleTempTargetSelect:b,handleConfirmLanguageSelection:w}},wT="singleton";async function IB(){const a=await ma();return new Promise((e,t)=>{const s=a.transaction(xo,"readonly").objectStore(xo).get(wT);s.onerror=()=>t(new Error("Error reading app settings from DB")),s.onsuccess=()=>e(s.result?s.result.settings:null)})}async function zl(a){const e=await ma();return new Promise((t,n)=>{const l=e.transaction(xo,"readwrite").objectStore(xo).put({key:wT,settings:a});l.onerror=()=>n(new Error("Error saving app settings to DB")),l.onsuccess=()=>t()})}const VC=JM(),sp=50,bg={selectedLanguagePairId:null,selectedCameraId:Mi,sendWithSnapshotEnabled:!0,tts:{provider:"gemini-live",speakNative:!0,voiceName:"Kore"},stt:{enabled:!1,language:ha(In.find(a=>a.langCode===Ur)?.code||QM[0].code),provider:"gemini"},smartReengagement:{thresholdSeconds:45,useVisualContext:!0},enableGoogleSearch:!0,imageGenerationModeEnabled:!0,imageFocusedModeEnabled:!0,isSuggestionMode:!1,historyBookmarkMessageId:null,maxVisibleMessages:void 0},Vd=a=>a.settings,lr=a=>a.languagePairs.find(e=>e.id===a.settings.selectedLanguagePairId),TT=a=>{const e=a.settings.selectedLanguagePairId;if(e&&typeof e=="string"){const t=Rd(e);if(t)return t}return{targetCode:Hf,nativeCode:Ur}},kT=(a,e)=>In.find(t=>t.langCode===a)||In.find(t=>t.langCode===e)||In[0],jd=a=>{const{targetCode:e}=TT(a);return kT(e,Hf)},op=a=>{const{nativeCode:e}=TT(a);return kT(e,Ur)},DB=(a,e)=>({settings:bg,languagePairs:VC,isSettingsLoaded:!1,needsLanguageSelection:!1,selectedLanguagePair:void 0,currentSystemPromptText:"",currentReplySuggestionsPromptText:"",getSelectedLanguagePair:()=>{const t=e();return t.languagePairs.find(n=>n.id===t.settings.selectedLanguagePairId)},getCurrentSystemPromptText:()=>e().getSelectedLanguagePair()?.baseSystemPrompt||"",getCurrentReplySuggestionsPromptText:()=>e().getSelectedLanguagePair()?.baseReplySuggestionsPrompt||"",initSettings:async()=>{try{let n=await IB()||bg;(!n.tts||n.tts.provider!=="gemini-live")&&(n={...n,tts:{...n.tts,provider:"gemini-live"}}),n.tts?.voiceName||(n={...n,tts:{...n.tts,voiceName:"Kore"}}),(!n.stt||n.stt.provider!=="gemini")&&(n={...n,stt:{...n.stt,provider:"gemini"}}),(!n.selectedLanguagePairId||!VC.some(i=>i.id===n.selectedLanguagePairId))&&(n={...n,selectedLanguagePairId:null},a({needsLanguageSelection:!0})),a({settings:n,isSettingsLoaded:!0});try{await zl(n)}catch{}}catch(t){console.error("Failed to load settings:",t),a({settings:bg,isSettingsLoaded:!0})}},updateSetting:(t,n)=>{a(i=>{const s={...i.settings,[t]:n};return zl(s).catch(()=>{}),{settings:s}})},setSettings:t=>{a(n=>{const i=typeof t=="function"?t(n.settings):t;return zl(i).catch(()=>{}),{settings:i}})},setNeedsLanguageSelection:t=>{a({needsLanguageSelection:t})},setIsSettingsLoaded:t=>{a({isSettingsLoaded:t})}}),dd=a=>(a.role==="user"||a.role==="assistant")&&!a.thinking,_B=async()=>{try{const a=await fetch("/maestro-avatars/manifest.json",{cache:"force-cache"});if(a.ok){const e=await a.json();if(Array.isArray(e))for(const t of e){const n=`/maestro-avatars/${t}`;try{const i=await fetch(n,{cache:"force-cache"});if(i.ok)return await i.blob()}catch{}}}}catch{}return null},RB=2e6,NB=4e6,GB=8e6,Do=1e7,hd=80,LB=a=>{const e={...a},t=l=>{if(!l||typeof l!="string")return;const c=l.match(/^data:([^;]+);base64,/i);return c?c[1]:void 0},n=l=>{const c=l.toLowerCase();return c.startsWith("video/")?NB:c.startsWith("image/")?RB:GB},i=l=>{if(!Array.isArray(l)||l.length===0)return;const c=new Set,h=[];if(l.forEach(d=>{if(!d)return;const A=typeof d.key=="string"?d.key:"",f=typeof d.audioDataUrl=="string"?d.audioDataUrl:"";!A||!f||f.length>Do||c.has(A)||(c.add(A),h.push({key:A,langCode:d.langCode||"",provider:d.provider||"gemini-live",audioDataUrl:f,updatedAt:typeof d.updatedAt=="number"?d.updatedAt:Date.now(),voiceName:d.voiceName,voiceId:d.voiceId}))}),!!h.length)return h.length>hd?h.slice(-hd):h},s=l=>{const c={...l};if(Array.isArray(c.ttsAudioCache)){const h=i(c.ttsAudioCache);h&&h.length?c.ttsAudioCache=h:delete c.ttsAudioCache}return c};if(typeof e.storageOptimizedImageUrl=="string"&&e.storageOptimizedImageUrl&&(e.imageUrl=e.storageOptimizedImageUrl,e.imageMimeType=e.storageOptimizedImageMimeType||e.imageMimeType,delete e.storageOptimizedImageUrl,delete e.storageOptimizedImageMimeType),typeof e.imageUrl=="string"){const l=e.imageMimeType||t(e.imageUrl)||"image/*",c=n(l);if(e.imageUrl.length>c){const h=!!e.uploadedFileUri;console.warn(`[sanitizeForPersistence] Image exceeds ${Math.round(c/1e3)}KB cap (${Math.round(e.imageUrl.length/1e3)}KB). Deleting from persistence.${h?" uploadedFileUri exists (valid for 48h).":" WARNING: No uploadedFileUri - media will be lost!"}`),e.imageUrl=void 0,e.imageMimeType=void 0}}if("storageOptimizedImageUrl"in e&&delete e.storageOptimizedImageUrl,"storageOptimizedImageMimeType"in e&&delete e.storageOptimizedImageMimeType,typeof e.rawAssistantResponse=="string"&&e.rawAssistantResponse.length>2e5&&(e.rawAssistantResponse=e.rawAssistantResponse.slice(0,2e5)),Array.isArray(e.ttsAudioCache)){const l=i(e.ttsAudioCache);l&&l.length?e.ttsAudioCache=l:delete e.ttsAudioCache}if(Array.isArray(e.replySuggestions)&&(e.replySuggestions=e.replySuggestions.map(s)),e.recordedUtterance){const l=typeof e.recordedUtterance.dataUrl=="string"?e.recordedUtterance.dataUrl:"";if(!l||l.length>Do)delete e.recordedUtterance;else{const h=e.recordedUtterance.provider==="gemini"?"gemini":"browser";e.recordedUtterance={dataUrl:l,provider:h,langCode:e.recordedUtterance.langCode,transcript:e.recordedUtterance.transcript,sampleRate:e.recordedUtterance.sampleRate}}}return e},BB=a=>{let e=0;for(let t=0;t<a.length;t++)e=(e<<5)-e+a.charCodeAt(t),e|=0;return Math.abs(e).toString(36)},Af=(a,e,t,n)=>{const i=`${t}::${n||""}::${e||""}::${a}`;return`${BB(i)}-${i.length.toString(36)}`},Cg=(a,e)=>{if(!Array.isArray(a)||!e)return;const t=a.find(n=>n&&n.key===e);return t?t.audioDataUrl:void 0},Sg=(a,e)=>{const t=Array.isArray(a)?a.filter(s=>s&&s.key!==e.key):[],n={...e,langCode:e.langCode,provider:e.provider,updatedAt:e.updatedAt||Date.now()},i=[...t,n];return i.length>hd?i.slice(-hd):i},FB=a=>a.messages,ET=a=>a.replySuggestions,UB=a=>a.latestGroundingChunks,KB=(a,e)=>({messages:[],isLoadingHistory:!0,replySuggestions:[],lastFetchedSuggestionsFor:null,sendPrep:null,latestGroundingChunks:void 0,imageLoadDurations:[],attachedImageBase64:null,attachedImageMimeType:null,loadHistoryForPair:async(t,n)=>{a({isLoadingHistory:!0,messages:[],replySuggestions:[]});try{const i=await gf(t),s=(i||[]).map(c=>{if(c.isGeneratingImage||c.thinking){const h={...c};return h.isGeneratingImage&&(h.isGeneratingImage=!1,h.imageGenError=n("chat.error.imageGenInterrupted")),h.thinking&&(h.thinking=!1,!h.text&&!h.translations?.length&&!h.rawAssistantResponse&&(h.role="error",h.text=n("chat.error.thinkingInterrupted"))),h}return c}),l=(i||[]).length>0&&JSON.stringify(i)!==JSON.stringify(s);a({messages:s}),l&&await er(t,s);try{const c=await MT(t);c&&c.bookmarkMessageId?e().updateSetting("historyBookmarkMessageId",c.bookmarkMessageId):e().updateSetting("historyBookmarkMessageId",null)}catch{}}catch(i){console.error("Failed to load history from IndexedDB",i),a({messages:[]})}finally{a({isLoadingHistory:!1})}},addMessage:t=>{const n={...t,id:crypto.randomUUID(),timestamp:Date.now()};return a(i=>({messages:[...i.messages,n]})),n.id},updateMessage:(t,n)=>{a(i=>({messages:i.messages.map(s=>s.id===t?{...s,...n,timestamp:Date.now()}:s)}))},deleteMessage:t=>{a(n=>({messages:n.messages.filter(i=>i.id!==t)}))},setMessages:t=>{a(n=>({messages:typeof t=="function"?t(n.messages):t}))},setReplySuggestions:t=>{a(n=>({replySuggestions:typeof t=="function"?t(n.replySuggestions):t}))},setLastFetchedSuggestionsFor:t=>{a({lastFetchedSuggestionsFor:t})},setSendPrep:t=>{a(n=>({sendPrep:typeof t=="function"?t(n.sendPrep):t}))},setLatestGroundingChunks:t=>{a({latestGroundingChunks:t})},addImageLoadDuration:t=>{a(i=>{const s=[...i.imageLoadDurations,t];return{imageLoadDurations:s.length>100?s.slice(-100):s}})},setAttachedImage:(t,n)=>{a({attachedImageBase64:t,attachedImageMimeType:n})},upsertMessageTtsCache:(t,n)=>{!n||typeof n.audioDataUrl!="string"||n.audioDataUrl.length===0||n.audioDataUrl.length>Do||a(i=>({messages:i.messages.map(s=>{if(s.id!==t)return s;const l=Sg(s.ttsAudioCache,n);return{...s,ttsAudioCache:l}})}))},upsertSuggestionTtsCache:(t,n,i)=>{!i||typeof i.audioDataUrl!="string"||i.audioDataUrl.length===0||i.audioDataUrl.length>Do||a(s=>{const l=s.messages.map(h=>{if(h.id!==t||!Array.isArray(h.replySuggestions))return h;const d=h.replySuggestions.map((A,f)=>{if(f!==n)return A;const p=Sg(A.ttsAudioCache,i);return{...A,ttsAudioCache:p}});return{...h,replySuggestions:d}});let c=s.replySuggestions;return s.lastFetchedSuggestionsFor===t&&(c=s.replySuggestions.map((h,d)=>{if(d!==n)return h;const A=Sg(h.ttsAudioCache,i);return{...h,ttsAudioCache:A}})),{messages:l,replySuggestions:c}})},trimHistoryByBookmark:t=>{const n=e().settings.historyBookmarkMessageId;if(!n||!t.some(s=>s.id===n))return t;const i=t.findIndex(s=>s.id===n&&!s.thinking);return i===-1?t:t.slice(i+1)},getHistoryRespectingBookmark:t=>e().settings.historyBookmarkMessageId?e().trimHistoryByBookmark(t):t,computeMaxMessagesForArray:t=>{const n=e().settings,i=t.filter(dd);if(n.historyBookmarkMessageId){const s=i.findIndex(l=>l.id===n.historyBookmarkMessageId);if(s!==-1)return Math.max(0,i.length-(s+1))}},getMessages:()=>e().messages}),zB=a=>a.speakingUtteranceText,OB=(a,e)=>({transcript:"",sttError:null,isSpeechRecognitionSupported:typeof navigator<"u"&&!!navigator.mediaDevices?.getUserMedia,recordedUtterancePending:null,pendingRecordedAudioMessageId:null,sttInterruptedBySend:!1,speakingUtteranceText:null,isSpeechSynthesisSupported:typeof window<"u"&&(!!(window.AudioContext||window.webkitAudioContext)||typeof Audio<"u"),setTranscript:t=>{a({transcript:t})},clearTranscript:()=>{a({transcript:""})},setSttError:t=>{a({sttError:t})},setIsSpeechRecognitionSupported:t=>{a({isSpeechRecognitionSupported:t})},setRecordedUtterancePending:t=>{a({recordedUtterancePending:t})},setPendingRecordedAudioMessageId:t=>{a({pendingRecordedAudioMessageId:t})},setSttInterruptedBySend:t=>{a({sttInterruptedBySend:t})},setSpeakingUtteranceText:t=>{a({speakingUtteranceText:t})},setIsSpeechSynthesisSupported:t=>{a({isSpeechSynthesisSupported:t})},claimRecordedUtterance:()=>{const t=e().recordedUtterancePending;return t&&a({recordedUtterancePending:null}),t}}),HB=(a,e)=>({availableCameras:[],currentCameraFacingMode:"unknown",liveVideoStream:null,visualContextStream:null,visualContextCameraError:null,snapshotUserError:null,microphoneApiAvailable:typeof window<"u"&&!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),isCurrentlyPerformingVisualContextCapture:!1,setAvailableCameras:t=>{a({availableCameras:t})},setCurrentCameraFacingMode:t=>{a({currentCameraFacingMode:t})},setLiveVideoStream:t=>{const n=e().liveVideoStream;n&&n.getTracks().forEach(i=>i.stop()),a({liveVideoStream:t})},setVisualContextStream:t=>{const n=e().visualContextStream;n&&n.getTracks().forEach(i=>i.stop()),a({visualContextStream:t})},setVisualContextCameraError:t=>{a({visualContextCameraError:t})},setSnapshotUserError:t=>{a({snapshotUserError:t})},setIsCurrentlyPerformingVisualContextCapture:t=>{a({isCurrentlyPerformingVisualContextCapture:t})},cleanupStreams:()=>{const{liveVideoStream:t,visualContextStream:n}=e();t&&t.getTracks().forEach(i=>i.stop()),n&&n.getTracks().forEach(i=>i.stop()),a({liveVideoStream:null,visualContextStream:null})}}),VB=a=>({reengagementPhase:"idle",isUserActive:!1,reengagementDeadline:null,setReengagementPhase:e=>{a({reengagementPhase:e})},setIsUserActive:e=>{a({isUserActive:e})},setReengagementDeadline:e=>{a({reengagementDeadline:e})},markUserActive:()=>{a({isUserActive:!0,reengagementPhase:"idle",reengagementDeadline:null})}}),jB=a=>({liveSessionState:"idle",liveSessionError:null,setLiveSessionState:e=>{a(t=>({...t,liveSessionState:e,liveSessionError:e==="connecting"?null:t.liveSessionError}))},setLiveSessionError:e=>{a({liveSessionError:e})},resetLiveSession:()=>{a({liveSessionState:"idle",liveSessionError:null})}}),QB=a=>({showDebugLogs:!1,setShowDebugLogs:e=>{a({showDebugLogs:e})},toggleDebugLogs:()=>{a(e=>({showDebugLogs:!e.showDebugLogs}))}}),qB=typeof import.meta<"u"&&!1,W=kM()(_M(IM((...a)=>({...DB(...a),...KB(...a),...OB(...a),...HB(...a),...VB(...a),...jB(...a),...UM(...a),...QB(...a)}),{name:"MaestroStore",enabled:qB}))),YB=W.subscribe,xT=ti.memo(({message:a,isFocusedMode:e,speakingUtteranceText:t,estimatedLoadTime:n,loadingAnimations:i,t:s,onToggleSpeakNativeLang:l,handleSpeakWholeMessage:c,handleSpeakLine:h,handlePlayUserMessage:d,speakText:A,stopSpeaking:f,onToggleImageFocusedMode:p,transitioningImageId:b,onSetAttachedImage:w,onUserInputActivity:S,onQuotaSetupBilling:k,onQuotaStartLive:E,onImageGenDisable:I,onImageGenViewCost:P,registerBubbleEl:R})=>{const D=a.role==="user",N=W(Vd),_=W(lr),K=W(jd),G=W(op),L=W(_o),O=W(nr),q=N.tts.speakNative,$=x.useMemo(()=>ha(_?.targetLanguageCode||K?.code||"es"),[_,K]),Q=x.useMemo(()=>ha(_?.nativeLanguageCode||G?.code||"en"),[_,G]),[Z,F]=x.useState(!1),[U,Y]=x.useState(null),[ge,me]=x.useState(null),z=Z&&e,H=a.role==="assistant",j=a.role==="error",le=a.role==="status",[te,oe]=x.useState(null),[ce,Ge]=x.useState(!1),ae=x.useRef(null),Le=x.useRef(null),De=x.useRef(null),[ue,ne]=x.useState(null),[fe,Te]=x.useState(!1),pe=x.useRef(null),ye=x.useRef(null),Ie=x.useRef(null),qe=x.useRef(null),Re=x.useRef(null),et=x.useRef(!1),Ye=x.useRef(null),Qe=x.useRef([]),st=x.useRef(null),yt=x.useRef(0),ft=x.useRef(!0),[Ue,Be]=x.useState([]),[it,mt]=x.useState(1),[Rt,Qt]=x.useState({x:0,y:0}),dt=x.useRef(null),Mt=W(re=>re.addActivityToken),Bt=W(re=>re.removeActivityToken),Ce=x.useCallback(re=>Mt(mn.UI,`${re}:${Date.now()}:${Math.random().toString(36).slice(2,8)}`),[Mt]),lt=x.useCallback(re=>{re.stopPropagation();const Xe=re.currentTarget;Xe.setPointerCapture(re.pointerId);const V={x:re.clientX,y:re.clientY},Se=40,Ee=8;let We=!1;const nt=Ut=>{const Jn=Ut.clientX-V.x,Bn=Ut.clientY-V.y;We||(e?(Jn<-Se||Bn<-Se)&&(We=!0,p(),St(Ut)):(Jn>Se||Bn>Se)&&(We=!0,p(),St(Ut)))},St=Ut=>{if(!We){const Jn=Math.abs(Ut.clientX-V.x),Bn=Math.abs(Ut.clientY-V.y);Jn<=Ee&&Bn<=Ee&&p()}try{Xe.hasPointerCapture(Ut.pointerId)&&Xe.releasePointerCapture(Ut.pointerId)}catch{}window.removeEventListener("pointermove",nt),window.removeEventListener("pointerup",St),window.removeEventListener("pointercancel",St)};window.addEventListener("pointermove",nt),window.addEventListener("pointerup",St),window.addEventListener("pointercancel",St)},[e,p]),ht=x.useCallback(re=>{if(!e||!re)return;dt.current||(dt.current=Ce(_t.BUBBLE_ANNOTATE));let Xe=1;if(Ie.current&&Ie.current.naturalWidth>0){const V=Ie.current;Xe=V.getBoundingClientRect().width/V.naturalWidth}else if(ye.current&&ye.current.videoWidth>0){const V=ye.current;Xe=V.getBoundingClientRect().width/V.videoWidth,me(V.videoWidth/V.videoHeight)}else Re.current&&(Xe=1);mt(Xe),Qt({x:0,y:0}),Y(re),Be([]),ft.current=!0,S(),F(!0)},[e,S,Ce]),{pdfPageNum:wt,pdfPageCount:tn,startPdfAnnotation:Sn,changePdfPage:wn,resetPdfState:cn}=hw({editCanvasRef:qe,onStartAnnotation:ht,setAnnotationSourceUrl:Y,setUndoStack:Be,isNewStrokeRef:ft}),bt=()=>{const re=ye.current;if(!re)return;if(!re.paused){alert(s("chat.error.pauseVideoToAnnotate"));return}if(re.videoWidth===0||re.videoHeight===0)return;me(re.videoWidth/re.videoHeight);const Xe=document.createElement("canvas");Xe.width=re.videoWidth,Xe.height=re.videoHeight;const V=Xe.getContext("2d");if(V){V.drawImage(re,0,0,Xe.width,Xe.height);const Se=Xe.toDataURL("image/jpeg",.92);ht(Se)}},Wt=async()=>{!Pe||!ct||await Sn(Pe)},se=re=>{De.current={x:re.clientX,y:re.clientY}},_e=(re,Xe,V,Se,Ee)=>{if(De.current){const We=Math.abs(re.clientX-De.current.x),nt=Math.abs(re.clientY-De.current.y);We<10&&nt<10&&(re.preventDefault(),L?f():O||h(Xe,V,Se,Ee,a.id))}De.current=null},He=()=>{De.current=null},Ke=re=>{if(!a.text){De.current=null;return}if(De.current){const Xe=Math.abs(re.clientX-De.current.x),V=Math.abs(re.clientY-De.current.y);Xe<10&&V<10&&(re.preventDefault(),L?f():O||d(a))}De.current=null};x.useEffect(()=>{let re;if(a.isGeneratingImage&&a.imageGenerationStartTime&&n>0){const Xe=()=>{const V=Date.now()-a.imageGenerationStartTime,Se=n*1e3,Ee=Math.max(0,Se-V);oe(`Est: ${(Ee/1e3).toFixed(0)}s`),Ee===0&&V>Se+5e3&&oe(s("chat.generatingImageLoadingSlow"))};Xe(),re=window.setInterval(Xe,1e3)}else oe(null);return()=>{re&&clearInterval(re)}},[a.isGeneratingImage,a.imageGenerationStartTime,n,s]),x.useEffect(()=>()=>{ae.current&&(Bt(ae.current),ae.current=null)},[Bt]);const je=x.useCallback(()=>{Y(null),F(!1),et.current=!1,Ye.current=null,mt(1),Qt({x:0,y:0}),Qe.current=[],Be([]),ft.current=!0,cn(),dt.current&&(Bt(dt.current),dt.current=null)},[Bt,cn]),X=()=>{if(!qe.current||!Ie.current||!Re.current)return;const re=Ie.current,Xe=qe.current,Se=Re.current.getBoundingClientRect(),Ee=document.createElement("canvas");Ee.width=Se.width,Ee.height=Se.height;const We=Ee.getContext("2d");We.save(),We.translate(Se.width/2,Se.height/2),We.translate(Rt.x,Rt.y),We.scale(it,it),We.drawImage(re,-re.naturalWidth/2,-re.naturalHeight/2,re.naturalWidth,re.naturalHeight),We.drawImage(Xe,-re.naturalWidth/2,-re.naturalHeight/2,re.naturalWidth,re.naturalHeight),We.restore();const nt=Ee.toDataURL("image/jpeg",.9);w(nt,"image/jpeg"),S(),je(),dt.current&&(Bt(dt.current),dt.current=null)},xe=x.useCallback(()=>{const re=qe.current,Xe=re?.getContext("2d");!re||!Xe||Be(V=>{if(V.length===0)return[];const Se=V.slice(0,-1);return Xe.clearRect(0,0,re.width,re.height),Xe.putImageData(V[V.length-1],0,0),Se})},[]),Fe=x.useCallback(re=>{const Xe=qe.current;if(!Xe)return null;const V=Xe.getBoundingClientRect(),Se=(re.clientX-V.left)*(Xe.width/V.width),Ee=(re.clientY-V.top)*(Xe.height/V.height);return{x:Se,y:Ee}},[]),Me=x.useCallback(re=>{if(re.stopPropagation(),re.preventDefault(),Qe.current.push(re),document.body.style.overscrollBehavior="none",re.currentTarget.setPointerCapture(re.pointerId),Qe.current.length===1)et.current=!0,Ye.current=Fe(re),ft.current=!0;else if(Qe.current.length===2){if(!ft.current){const Ee=qe.current,We=Ee?.getContext("2d");Ee&&We&&Be(nt=>nt.length===0?nt:(We.clearRect(0,0,Ee.width,Ee.height),We.putImageData(nt[nt.length-1],0,0),nt.slice(0,-1)))}et.current=!1,Ye.current=null;const Xe=Re.current?.getBoundingClientRect();if(!Xe)return;const V=Qe.current[0],Se=Qe.current[1];yt.current=Math.hypot(V.clientX-Se.clientX,V.clientY-Se.clientY),st.current={x:(V.clientX+Se.clientX)/2-Xe.left,y:(V.clientY+Se.clientY)/2-Xe.top}}},[Fe]),at=x.useCallback(re=>{re.preventDefault();const Xe=Qe.current.findIndex(V=>V.pointerId===re.pointerId);if(Xe!==-1){if(Qe.current[Xe]=re,Qe.current.length===1&&et.current&&Ye.current){const V=Fe(re),Se=qe.current,Ee=Se?.getContext("2d");if(Ee&&V){if(ft.current&&Se){const We=Ee.getImageData(0,0,Se.width,Se.height);Be(nt=>[...nt,We]),ft.current=!1}Ee.beginPath(),Ee.moveTo(Ye.current.x,Ye.current.y),Ee.lineTo(V.x,V.y),Ee.stroke(),Ye.current=V}}else if(Qe.current.length===2){const V=Re.current?.getBoundingClientRect();if(!V)return;const Se=Qe.current[0],Ee=Qe.current[1],We=Math.hypot(Se.clientX-Ee.clientX,Se.clientY-Ee.clientY),nt={x:(Se.clientX+Ee.clientX)/2-V.left,y:(Se.clientY+Ee.clientY)/2-V.top},St=st.current?nt.x-st.current.x:0,Ut=st.current?nt.y-st.current.y:0,Jn=yt.current>0?We/yt.current:1;Qt(Bn=>{const Aa={x:Bn.x+St,y:Bn.y+Ut},ga={x:nt.x-V.width/2,y:nt.y-V.height/2};return{x:ga.x-(ga.x-Aa.x)*Jn,y:ga.y-(ga.y-Aa.y)*Jn}}),mt(Bn=>Math.max(.2,Math.min(Bn*Jn,15))),yt.current=We,st.current=nt}}},[Fe]),Ve=x.useCallback(re=>{re.preventDefault(),re.currentTarget.releasePointerCapture(re.pointerId),Qe.current=Qe.current.filter(Xe=>Xe.pointerId!==re.pointerId),Qe.current.length<2&&(yt.current=0,st.current=null),Qe.current.length<1&&(et.current=!1,Ye.current=null,document.body.style.overscrollBehavior="auto")},[]),Oe=x.useCallback(re=>{re.preventDefault();const Xe=re.deltaY>0?.9:1.1,V=re.currentTarget.getBoundingClientRect(),Se={x:re.clientX-V.left,y:re.clientY-V.top};mt(Ee=>{const We=Math.max(.2,Math.min(Ee*Xe,15));return Qt(nt=>({x:Se.x-(Se.x-nt.x)*(We/Ee),y:Se.y-(Se.y-nt.y)*(We/Ee)})),We})},[]);x.useEffect(()=>{if(!Z||!U)return;const re=qe.current,Xe=re?.getContext("2d"),V=Ie.current;if(!re||!Xe||!V)return;const Se=()=>{V.naturalWidth>0&&V.naturalHeight>0&&(re.width=V.naturalWidth,re.height=V.naturalHeight,Xe.strokeStyle="#EF4444",Xe.lineWidth=Math.max(5,V.naturalWidth*.01),Xe.lineCap="round",Xe.lineJoin="round")};return V.complete&&V.naturalWidth>0?Se():V.addEventListener("load",Se),()=>{V&&V.removeEventListener("load",Se)}},[Z,U]);const Pe=a.imageUrl||a.storageOptimizedImageUrl,Ne=a.imageMimeType||a.storageOptimizedImageMimeType,Je=!!Ne?.startsWith("image/"),qt=!!Ne?.startsWith("video/"),xt=!!Ne?.startsWith("audio/"),vn=Ne==="application/pdf",Yt=Je&&Pe&&!a.isGeneratingImage&&!a.imageGenError,Xt=qt&&Pe,yn=xt&&Pe&&!a.isGeneratingImage&&!a.imageGenError,ct=vn&&Pe&&!a.isGeneratingImage&&!a.imageGenError,vt=!Je&&!qt&&!xt&&!vn&&Pe&&!a.isGeneratingImage&&!a.imageGenError,Lt=x.useMemo(()=>{const re=i&&i.length>0?i:[];if(!a.isGeneratingImage||re.length===0)return null;const Xe=`${a.id||""}|${a.imageGenerationStartTime||0}`;let V=0;for(let Ee=0;Ee<Xe.length;Ee++)V=(V<<5)-V+Xe.charCodeAt(Ee),V|=0;const Se=Math.abs(V)%re.length;return re[Se]},[a.id,a.imageGenerationStartTime,a.isGeneratingImage,i]),[Rn,qn]=x.useState(!1);x.useEffect(()=>{qn(!1)},[Lt,a.id,a.isGeneratingImage]);const Nt=e&&(Yt||a.isGeneratingImage||vt||Xt||yn||ct);if(a.thinking&&!a.isGeneratingImage)return T.jsx("div",{className:"flex justify-start mb-3 animate-pulse",children:T.jsx("div",{className:"bg-secondary rounded-sketchy p-3 max-w-xl sketchy-border-thin",children:T.jsx("p",{className:"text-sm text-muted-foreground font-hand",children:s("chat.thinking")})})});const li=D?"justify-end":"justify-start",Ha=a.text||a.translations&&a.translations.some(re=>re.target||re.native)||a.rawAssistantResponse,$n=a.text?a.text.replace(/\*/g,""):"",ze=D&&$n&&t===$n;let Ct="shadow relative overflow-hidden rounded-sketchy transition-all duration-300 ease-in-out";Nt?(Ct+=" w-full",!Yt&&!a.isGeneratingImage&&!vt&&!Xt&&(Ct+=" p-3",D?Ct+=" bg-primary bg-opacity-90 text-primary-foreground":j?Ct+=" bg-destructive/10 bg-opacity-90 text-destructive":le?Ct+=" bg-accent/10 bg-opacity-90 text-accent":Ct+=" bg-card bg-opacity-90 text-foreground")):(Ct+=" p-3 max-w-[90%] sm:max-w-[80%] md:max-w-[70%] lg:max-w-[65%]",D?Ct+=" bg-primary bg-opacity-90 text-primary-foreground":j?Ct+=" bg-destructive/10 bg-opacity-90 text-destructive":le?Ct+=" bg-accent/10 bg-opacity-90 text-accent":Ct+=" bg-card bg-opacity-90 text-foreground sketchy-border-thin");const Ft="relative rounded-lg group transition-all duration-300 ease-in-out";let un="",En="",tt="flex items-center justify-center";Nt?(un="w-full max-h-[75vh]",a.isGeneratingImage||vt?En="aspect-square":(Yt||Xt)&&(z?(En="bg-primary",tt=""):En="")):(un="w-full max-w-[250px] mx-auto my-2",En="aspect-square");const $t=a.isGeneratingImage?Nt?D?"bg-primary/40":"bg-pencil/50":D?"bg-primary/30":"bg-secondary/50":"",bn={};return(Yt||Xt)&&a.id===b&&(bn.viewTransitionName=`image-transition-${a.id}`,bn.contain="layout"),(z||e&&Yt)&&ge&&(bn.aspectRatio=`${ge}`),T.jsx("div",{className:`flex mb-4 ${li}`,children:T.jsxs("div",{className:Ct,style:{touchAction:"pan-y",containerType:"inline-size",width:"100%"},ref:R,children:[(a.isGeneratingImage||Yt||vt||Xt||yn||ct)&&T.jsxs("div",{ref:Re,className:`${Ft} ${un} ${En} ${$t} ${tt}`,style:{...bn,overflow:"hidden",touchAction:z?"none":"auto",position:"relative"},onPointerDown:z?Me:void 0,onPointerMove:z?at:void 0,onPointerUp:z?Ve:void 0,onPointerCancel:z?Ve:void 0,onWheel:z?Oe:void 0,children:[a.isGeneratingImage&&T.jsxs("div",{className:"absolute top-2 right-2 flex flex-col items-end z-20",children:[T.jsx("div",{className:"w-8 h-8 rounded-full overflow-hidden bg-black/30 drop-shadow-md flex items-center justify-center",children:Lt&&!Rn?T.jsx("video",{src:Lt,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover opacity-90",onError:()=>qn(!0)}):T.jsx(Ii,{className:"w-full h-full text-primary-foreground"})}),te&&T.jsx("p",{className:`mt-1 text-right text-xs px-1.5 py-0.5 rounded ${Nt?"text-primary-foreground/70 bg-primary/60":"text-muted-foreground bg-secondary/70"}`,children:te})]}),(Yt||z&&U)&&T.jsxs(T.Fragment,{children:[T.jsxs("div",{style:z?{width:Ie.current?.naturalWidth,height:Ie.current?.naturalHeight,position:"absolute",top:"50%",left:"50%",transform:`translate(-50%, -50%) translate(${Rt.x}px, ${Rt.y}px) scale(${it})`,transition:Qe.current.length>0?"none":"transform 0.1s ease-out"}:{position:"relative",width:"100%",height:"100%"},children:[T.jsx("img",{ref:Ie,src:z?U:Pe,alt:s(z?"chat.annotateModal.editingPreviewAlt":"chat.imagePreview.alt"),className:`block w-full h-full pointer-events-none ${z?"":"object-contain"}`,style:{opacity:1},onLoad:re=>{const Xe=re.currentTarget;if(Xe.naturalWidth>0&&Xe.naturalHeight>0&&(me(Xe.naturalWidth/Xe.naturalHeight),z&&Re.current)){const V=Re.current.clientWidth;mt(V/Xe.naturalWidth),Qt({x:0,y:0})}}}),z&&T.jsx("canvas",{ref:qe,className:"absolute top-0 left-0 w-full h-full cursor-crosshair"})]}),!z&&e&&Yt&&T.jsx("button",{onClick:()=>ht(Pe),className:"absolute top-2 right-2 z-20 p-2 bg-black/50 text-white rounded-full hover:bg-black/75 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-black/50 focus:ring-white transition-colors",title:s("chat.annotateImage"),"aria-label":s("chat.annotateImage"),children:T.jsx(tr,{className:"w-5 h-5"})}),z&&T.jsxs(T.Fragment,{children:[tn>1&&T.jsxs("div",{className:"absolute top-2 left-2 z-30 pointer-events-auto flex items-center space-x-1",onPointerDown:re=>{re.stopPropagation(),re.preventDefault()},onPointerUp:re=>{re.stopPropagation(),re.preventDefault()},onPointerCancel:re=>{re.stopPropagation(),re.preventDefault()},onClick:re=>{re.stopPropagation(),re.preventDefault()},children:[T.jsx("button",{onClick:()=>wn(-1),disabled:wt<=1,className:"p-1.5 bg-black/60 text-white rounded-full hover:bg-black/80 disabled:opacity-40 disabled:cursor-default focus:outline-none transition-colors",children:T.jsx(md,{className:"w-4 h-4"})}),T.jsxs("span",{className:"text-white text-xs font-medium tabular-nums bg-black/60 rounded px-1.5 py-0.5 select-none",children:[wt,"/",tn]}),T.jsx("button",{onClick:()=>wn(1),disabled:wt>=tn,className:"p-1.5 bg-black/60 text-white rounded-full hover:bg-black/80 disabled:opacity-40 disabled:cursor-default focus:outline-none transition-colors",children:T.jsx(vd,{className:"w-4 h-4"})})]}),T.jsx("div",{className:"absolute top-2 right-2 z-30 pointer-events-auto",onPointerDown:re=>{re.stopPropagation(),re.preventDefault()},onPointerUp:re=>{re.stopPropagation(),re.preventDefault()},onPointerCancel:re=>{re.stopPropagation(),re.preventDefault()},onClick:re=>{re.stopPropagation(),re.preventDefault()},children:T.jsx("button",{onClick:je,className:"p-2 bg-black/60 text-white rounded-full hover:bg-black/80 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-black/50 focus:ring-white transition-colors",title:s("chat.annotateModal.cancel"),"aria-label":s("chat.annotateModal.cancel"),children:T.jsx(Pi,{className:"w-5 h-5"})})}),T.jsx("div",{className:"absolute bottom-2 left-2 z-30 pointer-events-auto",onPointerDown:re=>{re.stopPropagation(),re.preventDefault()},onPointerUp:re=>{re.stopPropagation(),re.preventDefault()},onPointerCancel:re=>{re.stopPropagation(),re.preventDefault()},onClick:re=>{re.stopPropagation(),re.preventDefault()},children:T.jsx("button",{onClick:xe,disabled:Ue.length===0,className:"p-2 bg-black/60 text-white rounded-full hover:bg-black/80 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-black/50 focus:ring-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:s("chat.annotateModal.undo"),"aria-label":s("chat.annotateModal.undo"),"aria-disabled":Ue.length===0,children:T.jsx(Nr,{className:"w-5 h-5"})})}),T.jsx("div",{className:"absolute bottom-2 right-2 z-30 pointer-events-auto",onPointerDown:re=>{re.stopPropagation(),re.preventDefault()},onPointerUp:re=>{re.stopPropagation(),re.preventDefault()},onPointerCancel:re=>{re.stopPropagation(),re.preventDefault()},onClick:re=>{re.stopPropagation(),re.preventDefault()},children:T.jsx("button",{onClick:X,className:"p-2 bg-card text-foreground rounded-full hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-black/50 focus:ring-card transition-colors",title:s("chat.annotateModal.saveAndAttach"),"aria-label":s("chat.annotateModal.saveAndAttach"),children:T.jsx(As,{className:"w-5 h-5"})})})]})]}),Xt&&!z&&T.jsxs("div",{className:"relative",children:[T.jsx("video",{ref:ye,src:Pe,controls:!0,onPlay:()=>{Ge(!0),ae.current||(ae.current=Ce(_t.VIDEO_PLAY))},onPause:()=>{Ge(!1),ae.current&&(Bt(ae.current),ae.current=null)},onEnded:()=>{Ge(!1),ae.current&&(Bt(ae.current),ae.current=null)},className:"block w-full h-full object-contain rounded-lg bg-black",children:s("chat.videoNotSupported")}),T.jsx("button",{onClick:bt,disabled:ce,className:"absolute top-2 right-2 z-20 p-1.5 bg-black/50 text-white rounded-full hover:bg-black/75 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-black/50 focus:ring-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:s(ce?"chat.error.pauseVideoToAnnotate":"chat.annotateVideoFrame"),"aria-label":s(ce?"chat.error.pauseVideoToAnnotate":"chat.annotateVideoFrame"),children:T.jsx(tr,{className:"w-4 h-4"})})]}),(Yt||Xt||ct)&&!z&&T.jsx("div",{ref:Le,onPointerDown:lt,className:"absolute bottom-0 right-0 cursor-se-resize p-2 touch-none z-30 opacity-100",title:s(e?"chat.image.dragToShrink":"chat.image.dragToEnlarge"),children:T.jsx("div",{style:{filter:"drop-shadow(0 1px 1px rgba(0,0,0,0.7))"},children:T.jsx(bS,{className:"w-4 h-4 text-white"})})}),vt&&T.jsxs("div",{className:`p-4 flex flex-col items-center justify-center text-center rounded-lg h-full ${D?"bg-primary/80":"bg-secondary"}`,children:[T.jsx(Zl,{className:`w-10 h-10 ${D?"text-primary-foreground/70":"text-muted-foreground"}`}),T.jsx("p",{className:`mt-2 text-xs font-mono break-all ${D?"text-primary-foreground":"text-foreground"}`,children:a.imageMimeType}),T.jsx("p",{className:`mt-1 text-xs ${D?"text-primary-foreground/70":"text-muted-foreground"}`,children:s("chat.fileAttachment")})]}),ct&&T.jsxs("div",{className:`relative w-full ${z?"hidden":""}`,children:[T.jsx(Kf,{src:Pe,variant:D?"user":"assistant"}),e&&!z&&T.jsx("button",{onClick:Wt,className:"absolute top-2 right-2 z-20 p-1.5 bg-black/50 text-white rounded-full hover:bg-black/75 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-black/50 focus:ring-white transition-colors",title:s("chat.annotateImage"),"aria-label":s("chat.annotateImage"),children:T.jsx(tr,{className:"w-4 h-4"})})]}),yn&&!z&&T.jsx("div",{className:"relative w-full",children:T.jsx(wf,{src:Pe,variant:D?"user":"assistant"})})]}),a.imageGenError&&!a.isGeneratingImage&&T.jsxs("div",{className:`flex flex-col items-center justify-center p-2 rounded-lg 
                  ${Nt?"absolute inset-0 bg-black/60 z-20":`my-2 ${D?"bg-primary/60":"bg-secondary/60"}`}
               `,children:[T.jsx(Pi,{className:"w-8 h-8 text-red-300 mb-1"}),T.jsxs("p",{className:`text-xs text-center ${Nt?"text-red-200":"text-red-700"}`,children:[s("chat.imageGenError"),": ",a.imageGenError]})]}),Ha&&T.jsxs("div",{className:`transition-opacity duration-300
                ${Nt&&!yn?"absolute inset-x-0 bottom-0 p-3 bg-gradient-to-t from-black/80 via-black/60 to-transparent text-white rounded-b-lg z-10":"relative z-10 mt-1"}
                ${z?"opacity-0 pointer-events-none":"opacity-100"}
            `,children:[T.jsx("style",{children:`
        @keyframes pop-fade-speak { 0% { transform: scale(0.85); opacity: 0; } 20% { transform: scale(1.15); opacity: 1; } 80% { transform: scale(1.0); opacity: 1; } 100% { transform: scale(0.95); opacity: 0; } }
        .animate-speak-flash { animation: pop-fade-speak 900ms ease-out both; }
        `}),H&&Nt&&a.translations&&a.translations.length>0?T.jsx(T.Fragment,{children:T.jsx(IS,{translations:a.translations,speakingUtteranceText:t,currentTargetLangCode:$,currentNativeLangCode:Q,t:s,isSpeaking:L,isSending:O,speakText:A,stopSpeaking:f,speakNativeLang:q,onToggleSpeakNativeLang:l,messageId:a.id})}):T.jsxs(T.Fragment,{children:[D&&a.text&&T.jsx("p",{className:`mb-1 whitespace-pre-wrap rounded-sm px-1 -mx-1 cursor-pointer transition-colors text-white ${ze?"bg-white/20 text-white":"hover:bg-white/10"}`,style:{fontSize:"3.8cqw",lineHeight:1.35},onPointerDown:se,onPointerUp:Ke,onPointerLeave:He,role:"button",tabIndex:O&&!L?-1:0,onKeyDown:re=>{(re.key==="Enter"||re.key===" ")&&(re.preventDefault(),L?f():O||d(a))},"aria-label":ze?s("chat.stopSpeaking")||"Stop playback":s("chat.speakThisLine")?`${s("chat.speakThisLine")}: ${$n}`:"Play message audio","aria-disabled":O&&!L,children:a.text}),H&&a.translations&&a.translations.length>0&&a.translations.map((re,Xe)=>{const V=t?.replace(/\*/g,"")??null,Se=re.target&&V===re.target.replace(/\*/g,""),Ee=re.native&&V===re.native.replace(/\*/g,""),We=Se||Ee;return T.jsxs("div",{className:Xe>0&&!Nt?"mt-2":"",children:[re.target&&T.jsx("p",{className:`font-semibold whitespace-pre-wrap cursor-pointer transition-colors rounded-sm px-1 -mx-1 ${Nt?We?"bg-sky-400 text-sky-900":"hover:text-sky-200 text-white":We?"bg-sky-100 text-sky-800":"hover:text-accent text-foreground"}`,style:{fontSize:"4cqw",lineHeight:1.3},onPointerDown:se,onPointerUp:nt=>{if(De.current){const St=Math.abs(nt.clientX-De.current.x),Ut=Math.abs(nt.clientY-De.current.y);if(St<10&&Ut<10){if(nt.preventDefault(),L){f(),De.current=null;return}if(O){De.current=null;return}const Jn=Xe,Bn=[],Aa={source:"message",messageId:a.id};for(let ga=Jn;ga<(a.translations?.length||0);ga++){const Ri=a.translations[ga],wa=Ri.target?.trim(),sc=Ri.native?.trim();wa&&Bn.push({text:wa,langCode:$,context:Aa}),q&&sc&&Bn.push({text:sc,langCode:Q,context:Aa})}Bn.length&&A(Bn,Bn[0].langCode)}}De.current=null},onPointerLeave:He,onKeyDown:nt=>{(nt.key==="Enter"||nt.key===" ")&&(nt.preventDefault(),L?f():O||h(re.target,$,re.native,Q,a.id))},role:"button",tabIndex:O&&!L?-1:0,"aria-label":`${s(L?"chat.stopSpeaking":"chat.speakThisLine")}: ${re.target.replace(/\*/g,"")}`,"aria-disabled":O&&!L,children:re.target}),re.native&&T.jsxs("p",{className:`italic mt-0.5 whitespace-pre-wrap pl-2 border-l-2 rounded-sm px-1 -mx-1 ${Nt?We?"bg-primary/60 text-primary-foreground/80":"text-primary-foreground/50 border-primary-foreground/30":We?"bg-secondary text-foreground":"text-muted-foreground border-border"}`,style:{fontSize:"3.55cqw",lineHeight:1.3},onPointerDown:se,onPointerUp:nt=>{if(De.current){const St=Math.abs(nt.clientX-De.current.x),Ut=Math.abs(nt.clientY-De.current.y);if(St<10&&Ut<10){nt.preventDefault();const Jn=!q;ne(Xe),Te(Jn),pe.current&&clearTimeout(pe.current),pe.current=window.setTimeout(()=>{ne(null)},900),l()}}De.current=null},onPointerLeave:He,children:[re.native,ue===Xe&&T.jsx("span",{className:"ml-1 inline-block align-middle animate-speak-flash",children:fe?T.jsx(pd,{className:"w-3 h-3 inline"}):T.jsx(Sf,{className:"w-3 h-3 inline"})})]})]},Xe)}),H&&(!a.translations||a.translations.length===0)&&a.rawAssistantResponse&&(()=>{const re=a.rawAssistantResponse&&(t?.replace(/\*/g,"")??null)===a.rawAssistantResponse.replace(/\*/g,"");return T.jsx("p",{className:`whitespace-pre-wrap cursor-pointer transition-colors rounded-sm px-1 -mx-1 ${Nt?re?"bg-sky-400 text-sky-900":"hover:text-sky-200 text-white":re?"bg-sky-100 text-sky-800":"hover:text-accent text-foreground"}`,style:{fontSize:"4cqw",lineHeight:1.3},onPointerDown:se,onPointerUp:Xe=>_e(Xe,a.rawAssistantResponse,$),onPointerLeave:He,onKeyDown:Xe=>{(Xe.key==="Enter"||Xe.key===" ")&&(Xe.preventDefault(),L?f():O||h(a.rawAssistantResponse,$,void 0,void 0,a.id))},role:"button",tabIndex:O&&!L?-1:0,"aria-label":`${s(L?"chat.stopSpeaking":"chat.speakThisLine")}: ${a.rawAssistantResponse.replace(/\*/g,"")}`,"aria-disabled":O&&!L,children:a.rawAssistantResponse})})(),(j||le)&&a.text&&T.jsx("p",{className:`${Nt?j?"text-red-200 font-semibold":"text-yellow-200 font-semibold":""}`,style:{fontSize:"3.2cqw",lineHeight:1.25},children:a.text}),j&&a.errorAction==="quota"&&T.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[k&&T.jsx("button",{type:"button",onClick:k,className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-accent-foreground bg-accent hover:bg-accent/80 sketchy-border-thin",style:{fontSize:"2.8cqw",lineHeight:1.25},children:s("error.quotaSetupBilling")}),E&&T.jsx("button",{type:"button",onClick:E,className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-foreground bg-card hover:bg-muted sketchy-border-thin",style:{fontSize:"2.8cqw",lineHeight:1.25},children:s("error.quotaStartLive")})]}),j&&a.errorAction==="imageGenCost"&&T.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[I&&T.jsx("button",{type:"button",onClick:I,className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-accent-foreground bg-accent hover:bg-accent/80 sketchy-border-thin",style:{fontSize:"2.8cqw",lineHeight:1.25},children:s("error.imageGenDisable")}),P&&T.jsx("button",{type:"button",onClick:P,className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-foreground bg-card hover:bg-muted sketchy-border-thin",style:{fontSize:"2.8cqw",lineHeight:1.25},children:s("error.imageGenViewCost")})]}),H&&!a.translations?.length&&!a.rawAssistantResponse&&!a.imageUrl&&!a.isGeneratingImage&&a.text&&T.jsx("p",{className:`whitespace-pre-wrap ${Nt?"text-white":"text-foreground"}`,style:{fontSize:"3.6cqw",lineHeight:1.35},children:a.text})]})]})]})})});xT.displayName="ChatMessageBubble";const XB=({t:a,onToggleSuggestionMode:e,onSuggestionClick:t,stopSpeaking:n})=>{const i=W(ET),s=W(_d),l=W(Of),c=W(_o),d=W(Vd).isSuggestionMode,f=W(R=>R.microphoneApiAvailable),[p,b]=x.useState(null),[w,S]=x.useState(null),[k,E]=x.useState(null);x.useEffect(()=>{E(null)},[i]);const I=R=>{if(c){p&&(clearTimeout(p),b(null)),S(null),E(null),n();return}const D=Date.now();if(p&&(clearTimeout(p),b(null)),w&&w.suggestion.target===R.target&&D-w.timestamp<300)t(R,"native"),E(R.target),S(null);else{S({suggestion:R,timestamp:D});const N=window.setTimeout(()=>{t(R,"target"),E(null),S(null),b(null)},300);b(N),k!==null&&k!==R.target&&E(null)}};return T.jsx("div",{className:"pt-2 max-w-2xl w-full",role:"toolbar","aria-label":a("chat.suggestionsAriaLabel"),style:{containerType:"inline-size"},children:T.jsxs("div",{className:"flex flex-wrap gap-2 justify-end",children:[s&&T.jsx("span",{className:"inline-block px-3 py-1.5 text-muted-foreground italic",style:{fontSize:"2.8cqw"},children:a("chat.loadingSuggestions")}),!s&&i.map((R,D)=>T.jsx("button",{onClick:N=>{N.stopPropagation(),I(R)},className:`inline-block px-3 py-1.5 transition-colors text-foreground bg-secondary hover:bg-paper-dark sketchy-border-thin ${k===R.target?"focus:outline-none focus:ring-2 focus:ring-watercolor":"focus:outline-none focus:ring-2 focus:ring-accent"}`,style:{fontSize:"3.1cqw"},title:a("chat.suggestion.speak",{suggestion:R.target}),"aria-label":a("chat.suggestion.ariaLabel",{suggestion:R.target}),tabIndex:0,children:R.target},D)),!s&&f&&i.length>0&&T.jsx("button",{onClick:R=>{R.stopPropagation(),e()},className:`inline-flex items-center justify-center w-[34px] h-[34px] text-sm transition-colors disabled:opacity-50 sketchy-border-thin
                        ${d?"bg-accent text-accent-foreground animate-pulse":"text-foreground bg-secondary hover:bg-paper-dark"}
                        focus:outline-none focus:ring-2 focus:ring-accent`,style:{fontSize:"3cqw"},title:a("chat.suggestion.toggleCreateMode"),"aria-label":a("chat.suggestion.toggleCreateMode"),"aria-pressed":d,disabled:l,children:l?T.jsx(Ii,{className:"w-5 h-5 text-accent-foreground/70"}):T.jsx(yS,{className:"w-5 h-5"})})]})})},WB=({t:a,liveSessionState:e,isSuggestionMode:t,onStartLiveSession:n,onStopLiveSession:i})=>{const s=e==="active",l=e==="connecting",c=e==="error",h=a(s?"chat.liveSession.stop":c?"chat.liveSession.retry":"chat.liveSession.start"),d=s?"bg-red-600/80 hover:bg-red-500 text-white":c?"bg-yellow-500/80 hover:bg-yellow-500 text-foreground":t?"bg-primary/80 hover:bg-primary text-primary-foreground":"bg-black/60 hover:bg-black/80 text-white",A=x.useCallback(()=>{s?i():Promise.resolve(n()).catch(f=>{console.error("Failed to start live session:",f)})},[s,n,i]);return T.jsxs("div",{className:"absolute top-1 right-1 flex items-center gap-2 z-30",children:[l&&T.jsx(Ii,{className:"w-5 h-5 text-white drop-shadow"}),T.jsx("button",{type:"button",onClick:A,disabled:l,className:`px-2 py-1 text-xs font-semibold rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-white/50 ${d} ${l?"opacity-70 cursor-wait":""}`,children:h})]})},$B=({t:a,isSuggestionMode:e,attachedImageBase64:t,attachedImageMimeType:n,showLiveFeed:i,isTwoUp:s,liveVideoStream:l,liveSessionState:c,liveSessionError:h,onStartLiveSession:d,onStopLiveSession:A,onRemoveAttachment:f,onAnnotateImage:p,onAnnotateVideo:b,onAnnotatePdf:w,onSetAttachedImage:S,onUserInputActivity:k,attachedPreviewVideoRef:E})=>{const I=W(ce=>ce.addActivityToken),P=W(ce=>ce.removeActivityToken),R=x.useCallback(ce=>I(mn.UI,`${ce}:${Date.now()}:${Math.random().toString(36).slice(2,8)}`),[I]),D=x.useCallback(ce=>{ce&&P(ce)},[P]),N=x.useRef(null),[_,K]=x.useState(!1),G=x.useRef(null),[L,O]=x.useState(!1),q=x.useRef(null),$=x.useRef([]),Q=x.useRef(null),Z=x.useRef(null),F=x.useRef(null),U=x.useRef(null),Y=()=>{const ce=["video/webm;codecs=vp9,opus","video/webm;codecs=vp8,opus","video/webm"];for(const Ge of ce)if(window.MediaRecorder?.isTypeSupported?.(Ge))return Ge;return""},ge=x.useCallback(()=>{const ce=q.current;ce&&ce.state==="recording"&&ce.stop(),U.current&&(U.current.getTracks().forEach(Ge=>Ge.stop()),U.current=null),Q.current&&(clearTimeout(Q.current),Q.current=null),O(!1),Z.current&&(D(Z.current),Z.current=null)},[D]);x.useEffect(()=>()=>{const ce=q.current;if(ce&&ce.state==="recording")try{ce.stop()}catch{}U.current&&(U.current.getTracks().forEach(Ge=>Ge.stop()),U.current=null),Q.current&&(clearTimeout(Q.current),Q.current=null),F.current&&(clearTimeout(F.current),F.current=null),Z.current&&(D(Z.current),Z.current=null)},[D]);const me=x.useCallback(async()=>{if(!(L||!l))try{Z.current||(Z.current=R(_t.VIDEO_RECORD));let ce=l;try{const De=await navigator.mediaDevices.getUserMedia({audio:!0});U.current=De,ce=new MediaStream([...l.getVideoTracks(),...De.getAudioTracks()])}catch{}const Ge=Y(),ae=Ge?{mimeType:Ge}:{},Le=new MediaRecorder(ce,ae);q.current=Le,$.current=[],Le.ondataavailable=De=>{De.data&&De.data.size>0&&$.current.push(De.data)},Le.onstop=()=>{const De=(Le.mimeType||Ge||"video/webm").split(";")[0],ue=$.current;if($.current=[],!ue.length)return;const ne=new Blob(ue,{type:De}),fe=new FileReader;fe.onloadend=()=>{S(fe.result,De),k()},fe.readAsDataURL(ne),Z.current&&(D(Z.current),Z.current=null)},Le.start(),O(!0),Q.current=window.setTimeout(()=>{q.current?.state==="recording"&&(ge(),alert(a("chat.error.recordingTimeExceeded",{maxMinutes:15})))},900*1e3)}catch(ce){console.error("Failed to start media recorder:",ce),U.current&&(U.current.getTracks().forEach(Ge=>Ge.stop()),U.current=null),Z.current&&(D(Z.current),Z.current=null)}},[L,l,S,k,a,ge,R,D]),z=x.useCallback(()=>{if(!N.current||!l||!N.current.srcObject||N.current.videoWidth===0||N.current.videoHeight===0)return;const ce=N.current,Ge=document.createElement("canvas");Ge.width=ce.videoWidth,Ge.height=ce.videoHeight;const ae=Ge.getContext("2d");if(ae){ae.drawImage(ce,0,0,Ge.width,Ge.height);const Le=Ge.toDataURL("image/jpeg",.9);S(Le,"image/jpeg"),k()}},[l,S,k]),H=()=>{F.current&&clearTimeout(F.current),F.current=window.setTimeout(()=>{me(),F.current=null},500)},j=()=>{F.current&&(clearTimeout(F.current),F.current=null,z())},le=()=>{F.current&&(clearTimeout(F.current),F.current=null)};if(x.useEffect(()=>{N.current&&l?N.current.srcObject!==l?(N.current.srcObject=l,N.current.play().catch(ce=>console.error("Error playing live preview:",ce))):N.current.paused&&N.current.play().catch(ce=>console.error("Error playing live preview:",ce)):N.current&&!l&&(N.current.srcObject=null)},[l,t]),!t&&!i)return null;const te=c==="active",oe=c==="connecting";return T.jsxs("div",{className:"flex flex-wrap justify-center items-start gap-2 w-full",children:[t&&T.jsxs("div",{className:`relative ${s?"w-[calc(50%-0.25rem)] sm:w-48":"w-48"} min-w-0 ${e?"bg-secondary":"bg-accent/80"} p-1 rounded-md`,children:[n?.startsWith("image/")?T.jsxs("div",{className:"relative",children:[T.jsx("img",{src:t,alt:a("chat.imagePreview.alt"),className:"h-24 w-full object-cover rounded"}),T.jsx("button",{type:"button",onClick:p,className:"absolute top-1.5 right-1.5 p-1.5 bg-black/60 text-white rounded-full hover:bg-black",title:a("chat.annotateImage"),children:T.jsx(tr,{className:"w-4 h-4"})})]}):n?.startsWith("video/")?T.jsxs("div",{className:"relative",children:[T.jsx("video",{ref:E,src:t,controls:!0,className:"h-24 w-full object-contain rounded bg-black",onPlay:()=>{K(!0),G.current||(G.current=R(_t.VIDEO_PLAY))},onPause:()=>{K(!1),G.current&&(D(G.current),G.current=null)},onEnded:()=>{K(!1),G.current&&(D(G.current),G.current=null)}}),T.jsx("button",{type:"button",onClick:b,disabled:_,className:"absolute top-1.5 right-1.5 p-1.5 bg-black/60 text-white rounded-full hover:bg-black disabled:opacity-50",title:a(_?"chat.error.pauseVideoToAnnotate":"chat.annotateVideoFrame"),children:T.jsx(tr,{className:"w-4 h-4"})})]}):n?.startsWith("audio/")?T.jsx("div",{className:"relative",children:T.jsx(wf,{src:t,variant:"preview",compact:!0})}):n==="application/pdf"?T.jsxs("div",{className:"relative",children:[T.jsx(Kf,{src:t,variant:"preview",compact:!0}),T.jsx("button",{type:"button",onClick:w,className:"absolute top-1.5 right-1.5 p-1.5 bg-black/60 text-white rounded-full hover:bg-black",title:a("chat.annotateImage"),children:T.jsx(tr,{className:"w-4 h-4"})})]}):T.jsxs("div",{className:`h-24 w-full flex flex-col items-center justify-center ${e?"bg-muted":"bg-accent/60"} rounded`,children:[T.jsx(Zl,{className:`w-8 h-8 ${e?"text-muted-foreground":"text-accent-foreground/70"}`}),T.jsx("span",{className:`text-xs mt-1 truncate max-w-full px-1 ${e?"text-muted-foreground":"text-accent-foreground"}`,children:n})]}),T.jsx("div",{className:"absolute -top-2 -right-2 flex items-center space-x-1",children:T.jsx("button",{type:"button",onClick:f,className:"p-1 bg-red-500/80 text-white rounded-full hover:bg-red-500","aria-label":a("chat.removeAttachedImage"),children:T.jsx(Pi,{className:"w-4 h-4"})})})]}),i&&T.jsxs("div",{className:`relative ${s?"w-[calc(50%-0.25rem)] sm:w-48":"w-48"} min-w-0 ${e?"bg-secondary":"bg-accent/80"} p-1 rounded-md`,children:[T.jsxs("div",{className:"relative group",children:[T.jsx("video",{ref:N,autoPlay:!0,playsInline:!0,muted:!0,className:"h-24 w-full object-cover rounded pointer-events-none"}),T.jsx(WB,{t:a,liveSessionState:c,isSuggestionMode:e,onStartLiveSession:d,onStopLiveSession:A}),T.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 group-hover:bg-black/40 transition-colors",children:te?T.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 rounded-full bg-red-600/80 text-white uppercase text-xs font-semibold tracking-wide",children:[T.jsx("span",{className:"inline-flex h-2 w-2 rounded-full bg-white animate-pulse","aria-hidden":!0}),a("chat.liveSession.liveBadge")||"Live"]}):oe?T.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 rounded-full bg-black/60 text-white text-xs",children:[T.jsx(Ii,{className:"w-4 h-4 text-white"}),T.jsx("span",{children:a("chat.liveSession.connecting")||"Connecting"})]}):L?T.jsx("button",{type:"button",onClick:ge,className:"p-2 rounded-full bg-red-500/80 text-white group-hover:bg-red-500 transition-colors","aria-label":a("chat.camera.stopRecording"),children:T.jsx("div",{className:"w-4 h-4 bg-white rounded-sm"})}):T.jsx("button",{type:"button",onPointerDown:H,onPointerUp:j,onPointerLeave:le,onContextMenu:ce=>ce.preventDefault(),className:"p-2 rounded-full bg-white/30 text-white group-hover:bg-white/50 transition-colors","aria-label":a("chat.camera.captureOrRecord"),children:T.jsx(ju,{className:"w-6 h-6"})})}),L&&!te&&!oe&&T.jsxs("div",{className:"absolute top-1 left-1 flex items-center space-x-1 p-1 bg-black/50 rounded-lg z-20",children:[T.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),T.jsx("span",{className:"text-white text-xs font-mono",children:"REC"})]})]}),h&&T.jsx("div",{className:`mt-1 px-2 py-1 text-xs rounded ${e?"bg-destructive/10 text-destructive":"bg-red-600/20 text-red-100"}`,children:h})]})]})},JB=({t:a,inputText:e,placeholder:t,isDisabled:n,onChange:i,onKeyDown:s,bubbleTextAreaRef:l,prepDisplay:c})=>T.jsxs("div",{className:"relative w-full",children:[T.jsx("textarea",{ref:l,rows:1,className:"w-full py-3 px-4 bg-transparent border-none focus:ring-0 resize-none overflow-hidden placeholder-inherit min-h-[50px]",style:{fontSize:"3.6cqw",lineHeight:1.35},placeholder:t,value:e,onChange:i,onKeyDown:s,disabled:n,"aria-label":a("chat.messageInputAriaLabel")}),c&&T.jsx("output",{className:"sr-only","aria-live":"polite",children:c})]}),ZB=({t:a,isLanguageSelectionOpen:e,isSttSupported:t,isSttGloballyEnabled:n,isListening:i,isSending:s,isSpeaking:l,targetLanguageDef:c,nativeLanguageDef:h,isSuggestionMode:d,onSttToggle:A,onSetAttachedImage:f,onUserInputActivity:p})=>{const b=W(H=>H.addActivityToken),w=W(H=>H.removeActivityToken),S=x.useCallback(H=>b(mn.UI,`${H}:${Date.now()}:${Math.random().toString(36).slice(2,8)}`),[b]),k=x.useCallback(H=>{H&&w(H)},[w]),[E,I]=x.useState(!1),P=x.useRef(null),R=x.useRef([]),D=x.useRef(null),N=x.useRef(null),_=x.useRef(null),K=x.useRef(!1),G=()=>{const H=["audio/webm;codecs=opus","audio/ogg;codecs=opus","audio/mp4","audio/webm"];for(const j of H)if(window.MediaRecorder?.isTypeSupported?.(j))return j;return""},L=x.useCallback(async()=>{if(!(E||n))try{const H=await navigator.mediaDevices.getUserMedia({audio:!0});D.current=H;const j=G(),le=j?{mimeType:j}:{},te=new MediaRecorder(H,le);P.current=te,R.current=[],te.ondataavailable=oe=>{oe.data&&oe.data.size&&R.current.push(oe.data)},te.onstop=()=>{const oe=te.mimeType||j||"audio/webm",ce=R.current;if(R.current=[],D.current){try{D.current.getTracks().forEach(Le=>Le.stop())}catch{}D.current=null}if(N.current&&(k(N.current),N.current=null),!ce.length)return;const Ge=new Blob(ce,{type:oe}),ae=new FileReader;ae.onloadend=()=>{f(ae.result,oe),p()},ae.readAsDataURL(Ge)},te.onerror=()=>{try{D.current?.getTracks()?.forEach(oe=>oe.stop())}catch{}D.current=null,I(!1),N.current&&(k(N.current),N.current=null)},N.current||(N.current=S(_t.AUDIO_NOTE)),te.start(250),I(!0)}catch(H){console.error("Failed to start audio note recording:",H),I(!1),K.current=!1}},[E,n,f,p,S,k]),O=x.useCallback(()=>{const H=P.current;if(H&&H.state==="recording"){try{H.requestData()}catch{}H.stop()}I(!1),N.current&&(k(N.current),N.current=null)},[k]),q=x.useCallback(H=>{n||s||l||(H.preventDefault(),H.stopPropagation(),K.current=!1,_.current&&(clearTimeout(_.current),_.current=null),_.current=window.setTimeout(async()=>{_.current=null,K.current=!0,await L()},450))},[n,s,l,L]),$=x.useCallback(H=>{_.current&&(clearTimeout(_.current),_.current=null),!n&&K.current&&(O(),H.preventDefault(),H.stopPropagation(),window.setTimeout(()=>{K.current=!1},200))},[n,O]),Q=x.useCallback(()=>{_.current&&(clearTimeout(_.current),_.current=null),!n&&K.current&&(O(),K.current=!1)},[n,O]),Z=x.useCallback(H=>{if(K.current){K.current=!1,H.preventDefault(),H.stopPropagation();return}_.current&&(clearTimeout(_.current),_.current=null),A()},[A]);x.useEffect(()=>()=>{_.current&&(clearTimeout(_.current),_.current=null);const H=P.current;if(H&&H.state==="recording")try{H.stop()}catch{}if(P.current=null,D.current){try{D.current.getTracks().forEach(j=>j.stop())}catch{}D.current=null}N.current&&(k(N.current),N.current=null)},[k]);const F=()=>{if(E){try{const H=a("chat.mic.recordingAudioNote");if(H!=="chat.mic.recordingAudioNote")return H}catch{}return"Recording audio... release to attach"}return a(i?"chat.mic.listening":n?"chat.mic.disableStt":"chat.mic.enableStt")},U=W(H=>H.setIsLanguageSelectionOpen),Y=W(H=>H.setTempNativeLangCode),ge=W(H=>H.setTempTargetLangCode),me=W(H=>H.settings.selectedLanguagePairId),z=x.useCallback(()=>{const H=W.getState();if(nr(H))return;U(!0);const j=me;if(j&&typeof j=="string"){const le=Rd(j);le?(ge(le.targetCode),Y(le.nativeCode)):(Y(null),ge(null))}else Y(null),ge(null)},[U,Y,ge,me]);return T.jsxs("div",{className:"flex items-center space-x-1",children:[!e&&T.jsxs("button",{type:"button",onClick:z,className:`flex flex-col items-center justify-center p-1 rounded-full transition-colors ${d?"hover:bg-secondary":"hover:bg-white/20"}`,title:a("chat.languageSelector.openGlobe"),disabled:s||l,children:[T.jsxs("span",{className:"flex items-center gap-0.5 leading-none",style:{fontSize:"10px"},children:[h.flag,td(h)&&T.jsx("span",{className:`text-[7px] font-bold ${d?"text-muted-foreground":"text-accent-foreground/70"}`,children:h.shortCode})]}),T.jsxs("span",{className:"flex items-center gap-0.5 leading-none",style:{fontSize:"14px"},children:[c.flag,td(c)&&T.jsx("span",{className:`text-[9px] font-bold ${d?"text-muted-foreground":"text-accent-foreground/70"}`,children:c.shortCode})]})]}),!e&&t&&T.jsxs("button",{type:"button",onClick:Z,onPointerDown:q,onPointerUp:$,onPointerCancel:Q,onPointerLeave:Q,onContextMenu:H=>{H.preventDefault(),H.stopPropagation()},style:{WebkitTouchCallout:"none"},className:`relative overflow-visible p-2 rounded-full transition-colors touch-manipulation select-none ${E?"bg-red-500 text-white ring-2 ring-red-300":i?"bg-red-500/80 text-white":d?"text-muted-foreground hover:text-foreground hover:bg-secondary":"text-accent-foreground/70 hover:text-accent-foreground hover:bg-white/20"} disabled:opacity-50`,title:F(),disabled:s||l||e,"aria-pressed":i,children:[E&&T.jsxs(T.Fragment,{children:[T.jsx("span",{className:"pointer-events-none absolute -inset-4 rounded-full bg-red-400/30 animate-ping"}),T.jsx("span",{className:"pointer-events-none absolute -inset-6 rounded-full bg-red-400/15 animate-ping",style:{animationDuration:"2s"}})]}),T.jsx(dS,{className:`relative z-10 w-5 h-5 ${E?"drop-shadow-[0_0_6px_rgba(239,68,68,0.8)]":""}`})]})]})},Nu="data-camera-action",jC="data-device-id",wg="__camera_off__",e2=({t:a,isLanguageSelectionOpen:e,isSuggestionMode:t,fileInputRef:n,onImageAttach:i,onPaperclipClick:s,availableCameras:l,selectedCameraId:c,currentCameraFacingMode:h,isImageGenCameraSelected:d,sendWithSnapshotEnabled:A,useVisualContextForReengagementEnabled:f,imageGenerationModeEnabled:p,onSelectCamera:b,onToggleSendWithSnapshot:w,onToggleUseVisualContextForReengagement:S,onToggleImageGenerationMode:k,iconButtonStyle:E})=>{const I=A||f,[P,R]=x.useState(!1),[D,N]=x.useState(null),[_,K]=x.useState(!1),G=x.useRef(null),L=x.useRef(null),O=x.useRef(!1),q=x.useRef(null),$=x.useRef(!1),Q=x.useRef(null),Z=x.useRef(null);x.useEffect(()=>()=>{Q.current&&clearTimeout(Q.current),Z.current&&clearTimeout(Z.current)},[]);const F=x.useCallback(ue=>{let ne=ue;for(;ne&&ne!==document.body;){const fe=ne.getAttribute(Nu);if(fe){const Te=ne.getAttribute(jC)||void 0;return{action:fe,deviceId:Te}}ne=ne.parentElement}return null},[]),U=x.useCallback((ue,ne)=>document.elementFromPoint(ue,ne),[]),Y=x.useCallback(()=>{Q.current&&(clearTimeout(Q.current),Q.current=null),Z.current&&(clearTimeout(Z.current),Z.current=null)},[]),ge=x.useCallback(()=>{Y(),K(!0),setTimeout(()=>K(!1),250),Q.current=setTimeout(()=>{R(!1),N(null)},600)},[Y]),me=x.useCallback((ue=2e3)=>{Z.current&&clearTimeout(Z.current),Z.current=setTimeout(()=>{R(!1),N(null)},ue)},[]),z=x.useCallback((ue,ne)=>{switch(ue){case"expand":Y(),R(!0),me();break;case"book-toggle":k(),ge();break;case"camera-select":ne===wg?(A&&w(),f&&S(),ge()):ne&&(ne!==c&&b(ne),A||w(),f||S(),ge());break}},[Y,me,ge,k,b,c,A,f,w,S]),H=x.useCallback(ue=>{G.current=ue.pointerType,L.current=ue.pointerId,O.current=!1,q.current={x:ue.clientX,y:ue.clientY};const ne=F(ue.target);G.current==="touch"||G.current==="pen"?($.current=P,Y(),R(!0),ne&&N(ne.deviceId?`camera-${ne.deviceId}`:ne.action),ue.target.setPointerCapture?.(ue.pointerId)):ne?.action==="expand"&&(Y(),R(!0),me())},[F,Y,me,P]),j=x.useCallback(ue=>{if(L.current===ue.pointerId){if(q.current){const ne=ue.clientX-q.current.x,fe=ue.clientY-q.current.y;(Math.abs(ne)>5||Math.abs(fe)>5)&&(O.current=!0)}if(G.current==="touch"||G.current==="pen"){const ne=U(ue.clientX,ue.clientY),fe=F(ne);N(fe?fe.deviceId?`camera-${fe.deviceId}`:fe.action:null)}}},[U,F]),le=x.useCallback(ue=>{if(L.current!==ue.pointerId)return;ue.target.releasePointerCapture?.(ue.pointerId);const ne=U(ue.clientX,ue.clientY),fe=F(ne);if(G.current==="touch"||G.current==="pen"){const Te=!O.current,pe=!$.current;Te&&pe&&fe?.action==="expand"?(N(null),me()):Te&&!pe?(fe&&fe.action!=="expand"?z(fe.action,fe.deviceId):(Y(),R(!1)),N(null)):(fe&&z(fe.action,fe.deviceId),N(null),(!fe||fe.action==="expand")&&R(!1))}else fe&&!O.current&&z(fe.action,fe.deviceId),N(null);L.current=null,O.current=!1,q.current=null},[U,F,z,Y,me]),te=x.useCallback(ue=>{L.current===ue.pointerId&&(N(null),R(!1),L.current=null,O.current=!1,q.current=null)},[]),oe=x.useCallback(()=>{G.current!=="touch"&&G.current!=="pen"&&(Y(),R(!0))},[Y]),ce=x.useCallback(()=>{G.current!=="touch"&&G.current!=="pen"&&(_||me(300))},[_,me]),Ge=x.useMemo(()=>{const ue=[{deviceId:wg,label:a("chat.camera.turnOff"),facingMode:"unknown"}];return ue.push(...l),p&&ue.push({deviceId:Mi,label:a("chat.camera.imageGenCameraLabel"),facingMode:"unknown"}),ue},[l,p,a]),ae=x.useMemo(()=>d?vo:h==="user"?xg:ju,[d,h]),Le=t?{bg:"bg-secondary/80",activeBg:"bg-card",activeText:"text-accent",inactiveText:"text-muted-foreground"}:{bg:"bg-accent/40",activeBg:"bg-card",activeText:"text-accent",inactiveText:"text-accent-foreground/60"},De=x.useCallback((ue,ne)=>D?ne?D===`camera-${ne}`:D===ue:!1,[D]);return T.jsx("div",{className:"flex items-center space-x-1",children:!e&&T.jsxs(T.Fragment,{children:[T.jsx("input",{type:"file",accept:"image/*,video/*,audio/*,application/pdf,text/plain,text/csv,text/markdown",ref:n,onChange:i,className:"hidden",id:"imageUpload"}),T.jsx("button",{type:"button",className:`p-2 cursor-pointer rounded-full transition-colors ${E}`,title:a("chat.attachImageFromFile"),onClick:s,children:T.jsx(Zl,{className:"w-5 h-5"})}),T.jsxs("div",{className:`relative flex items-center transition-all duration-200 ${_?"brightness-125 scale-105":""}`,onPointerDown:H,onPointerMove:j,onPointerUp:le,onPointerCancel:te,onMouseEnter:oe,onMouseLeave:ce,style:{touchAction:"none"},children:[T.jsx("button",{type:"button",[Nu]:"book-toggle",className:`absolute right-full top-1/2 -translate-y-1/2 p-2 rounded-full flex items-center justify-center shadow-md z-0 transition-all duration-200 ${P?"opacity-100 -translate-x-0 pointer-events-auto":"opacity-0 translate-x-6 scale-75 pointer-events-none"} ${p?`${Le.activeBg} text-purple-600`:`${Le.bg} ${Le.inactiveText}`} ${De("book-toggle")?"scale-125 z-20 ring-2 ring-purple-400":"hover:scale-110"}`,title:a("chat.bookIcon.toggleImageGen"),children:T.jsx(hS,{className:"w-5 h-5"})}),T.jsx("button",{type:"button",[Nu]:"expand",className:`p-2 cursor-pointer rounded-full transition-colors relative z-10 ${E} ${De("expand")?"scale-110":""}`,title:a("chat.camera.selectCamera"),children:I?T.jsx(ae,{className:`w-5 h-5 ${d?"text-purple-400":""}`}):T.jsx(Pg,{className:"w-5 h-5"})}),Ge.length>0&&T.jsx("div",{className:`absolute left-full top-1/2 -translate-y-1/2 flex items-center transition-all duration-200 ${P?"opacity-100 translate-x-1 pointer-events-auto":"opacity-0 -translate-x-6 pointer-events-none"}`,children:Ge.map((ue,ne)=>{const fe=ue.deviceId===wg,Te=fe?!I:I&&ue.deviceId===c;let pe;fe?pe=Pg:ue.deviceId===Mi?pe=vo:ue.facingMode==="user"?pe=xg:pe=ju;const ye=ue.deviceId===Mi,Ie=De("camera-select",ue.deviceId);return T.jsx("button",{type:"button",[Nu]:"camera-select",[jC]:ue.deviceId,className:`p-2 -ml-2 rounded-full flex items-center justify-center shadow-md transition-all duration-200 ${Te?`${Le.activeBg} ${ye?"text-purple-600":Le.activeText}`:`${Le.bg} ${ye?"text-purple-300":Le.inactiveText}`} ${Ie?"scale-125 z-30 ring-2 ring-white/50":"hover:scale-110 hover:z-20"}`,title:ue.label,style:{zIndex:Ie?30:Ge.length-ne},children:T.jsx(pe,{className:"w-5 h-5"})},ue.deviceId)})})]})]})})},t2=({onSttToggle:a,onSendMessage:e,onUserInputActivity:t,onStartLiveSession:n,onStopLiveSession:i,onToggleSuggestionMode:s,onCreateSuggestion:l,onToggleSendWithSnapshot:c,onToggleUseVisualContextForReengagement:h,onToggleImageGenerationMode:d})=>{const{t:A}=Ro(),f=W(V=>V.settings),p=W(jd)||In[0],b=W(op)||In[0],w=W(V=>V.attachedImageBase64),S=W(V=>V.attachedImageMimeType),k=W(V=>V.sendPrep),E=W(V=>V.transcript),I=W(V=>V.sttError),P=W(V=>V.liveVideoStream),R=W(V=>V.liveSessionState),D=W(V=>V.liveSessionError),N=W(V=>V.availableCameras),_=W(V=>V.currentCameraFacingMode),K=W(V=>V.visualContextCameraError),G=W(V=>V.snapshotUserError),L=W(V=>V.isSettingsLoaded),O=W(V=>V.languagePairs),q=W(V=>V.isLanguageSelectionOpen),$=W(V=>V.tempNativeLangCode),Q=W(V=>V.tempTargetLangCode),Z=W(V=>V.languageSelectorLastInteraction),F=W(V=>V.setIsLanguageSelectionOpen),U=W(V=>V.setTempNativeLangCode),Y=W(V=>V.setTempTargetLangCode),ge=W(V=>V.updateSetting),me=W(V=>V.setAttachedImage),z=W(V=>V.microphoneApiAvailable),H=W(Of);x.useMemo(()=>({get current(){return W.getState().settings},set current(V){}}),[]),x.useMemo(()=>({get current(){return W.getState().messages},set current(V){}}),[]),x.useMemo(()=>({get current(){return nr(W.getState())},set current(V){}}),[]);const j=f.isSuggestionMode,le=f.stt.enabled,te=f.stt.language,oe=z,ce=f.sendWithSnapshotEnabled,Ge=f.smartReengagement.useVisualContext,ae=f.imageGenerationModeEnabled,Le=f.selectedCameraId,De=Le===Mi,ue=x.useCallback((V,Se)=>{me(V,Se)},[me]),ne=x.useCallback(V=>{ge("selectedCameraId",V)},[ge]),{handleShowLanguageSelector:fe}=MB({isSettingsLoaded:L,settings:f,languagePairs:O,handleSettingsChange:ge,isLanguageSelectionOpen:q,tempNativeLangCode:$,tempTargetLangCode:Q,languageSelectorLastInteraction:Z,setIsLanguageSelectionOpen:F,setTempNativeLangCode:U,setTempTargetLangCode:Y}),[Te,pe]=x.useState(""),[ye,Ie]=x.useState(""),qe=x.useRef(null),Re=x.useRef(null),et=x.useRef(""),Ye=x.useRef(null),Qe=x.useRef(null),st=!!q,yt=W(nr),ft=W(_o),Ue=W(LM),Be=W(V=>V.addActivityToken),it=W(V=>V.removeActivityToken),mt=x.useCallback(V=>Be(mn.UI,`${V}:${Date.now()}:${Math.random().toString(36).slice(2,8)}`),[Be]),Rt=x.useCallback(V=>{V&&it(V)},[it]),[Qt,dt]=x.useState(!1),[Mt,Bt]=x.useState(null),[Ce,lt]=x.useState(null),[ht,wt]=x.useState(1),[tn,Sn]=x.useState({x:0,y:0}),[wn,cn]=x.useState([]),bt=x.useRef(null),Wt=x.useRef(null),se=x.useRef(null),_e=x.useRef(null),He=x.useRef(!1),Ke=x.useRef(null),je=x.useRef([]),X=x.useRef(null),xe=x.useRef(0),Fe=x.useRef(!0),Me=!!(P&&(Ge||ce)&&!De&&!st),at=!!(w&&Me);x.useEffect(()=>{if(E===et.current)return;if(le||Ue){const Se=E||"",Ee=Se.match(/\[[^\]]*\]/g)||[],We=Ee.length?Ee[Ee.length-1].trim():"";Ie(We);const nt=Se.replace(/\[[^\]]*\]/g," ").replace(/\s+/g," ").trimStart();(nt.length>0||le)&&(pe(nt),nt.trim().length>=2&&t())}et.current=E},[E,le,Ue,t]),x.useEffect(()=>{qe.current&&(qe.current.style.height="auto",qe.current.style.height=`${qe.current.scrollHeight}px`)},[Te]);const Ve=V=>{const Se=V.target.value;pe(Se),Se.replace(/\[[^\]]*\]/g," ").trim().length>=2&&t()},Oe=async()=>{if(st){fe();return}if(j){if(!Te.trim()||H){Te.trim()||s();return}const Ee=Te.trim();pe(""),await l(Ee);return}if(yt||ft||!Te.trim()&&!w)return;const V=Te.trim();pe(""),await e(V,w||void 0,S||void 0)&&(ue(null,null),Re.current&&(Re.current.value=""))},Pe=V=>{V.key==="Enter"&&!V.shiftKey&&(V.preventDefault(),Oe())},Ne=x.useCallback(V=>{_e.current||(_e.current=mt(_t.COMPOSER_ANNOTATE)),Bt(V),setTimeout(()=>{if(Wt.current){const Se=Wt.current;if(Se.naturalWidth>0)if(lt(Se.naturalWidth/Se.naturalHeight),bt.current){const Ee=bt.current.clientWidth;wt(Ee/Se.naturalWidth)}else wt(1)}Sn({x:0,y:0}),cn([]),Fe.current=!0,dt(!0)},0)},[mt]),Je=x.useCallback(()=>{w&&Ne(w)},[w,Ne]),qt=x.useCallback(()=>{const V=Ye.current;if(!V)return;if(!V.paused){alert(A("chat.error.pauseVideoToAnnotate"));return}if(V.videoWidth===0||V.videoHeight===0)return;const Se=document.createElement("canvas");Se.width=V.videoWidth,Se.height=V.videoHeight;const Ee=Se.getContext("2d");if(!Ee)return;Ee.drawImage(V,0,0,Se.width,Se.height);const We=Se.toDataURL("image/jpeg",.92);Ne(We)},[A,Ne]),{pdfPageNum:xt,pdfPageCount:vn,startPdfAnnotation:Yt,changePdfPage:Xt,resetPdfState:yn}=hw({editCanvasRef:se,onStartAnnotation:Ne,setAnnotationSourceUrl:Bt,setUndoStack:cn,isNewStrokeRef:Fe}),ct=x.useCallback(async()=>{!w||S!=="application/pdf"||await Yt(w)},[w,S,Yt]),vt=x.useCallback(V=>{const Se=se.current;if(!Se)return null;const Ee=Se.getBoundingClientRect();return{x:(V.clientX-Ee.left)*(Se.width/Ee.width),y:(V.clientY-Ee.top)*(Se.height/Ee.height)}},[]),Lt=x.useCallback(V=>{if(V.preventDefault(),je.current.push(V),V.currentTarget.setPointerCapture(V.pointerId),document.body.style.overscrollBehavior="none",je.current.length===1)He.current=!0,Ke.current=vt(V),Fe.current=!0;else if(je.current.length===2){if(!Fe.current){const nt=se.current,St=nt?.getContext("2d");nt&&St&&cn(Ut=>Ut.length===0?Ut:(St.clearRect(0,0,nt.width,nt.height),St.putImageData(Ut[Ut.length-1],0,0),Ut.slice(0,-1)))}He.current=!1,Ke.current=null;const Se=bt.current?.getBoundingClientRect();if(!Se)return;const[Ee,We]=je.current;xe.current=Math.hypot(Ee.clientX-We.clientX,Ee.clientY-We.clientY),X.current={x:(Ee.clientX+We.clientX)/2-Se.left,y:(Ee.clientY+We.clientY)/2-Se.top}}},[vt]),Rn=x.useCallback(V=>{V.preventDefault();const Se=je.current.findIndex(Ee=>Ee.pointerId===V.pointerId);if(Se!==-1){if(je.current[Se]=V,je.current.length===1&&He.current&&Ke.current){const Ee=vt(V),We=se.current,nt=We?.getContext("2d");if(nt&&Ee){if(Fe.current){const St=nt.getImageData(0,0,We.width,We.height);cn(Ut=>[...Ut,St]),Fe.current=!1}nt.beginPath(),nt.moveTo(Ke.current.x,Ke.current.y),nt.lineTo(Ee.x,Ee.y),nt.stroke(),Ke.current=Ee}}else if(je.current.length===2){const Ee=bt.current?.getBoundingClientRect();if(!Ee)return;const[We,nt]=je.current,St=Math.hypot(We.clientX-nt.clientX,We.clientY-nt.clientY),Ut={x:(We.clientX+nt.clientX)/2-Ee.left,y:(We.clientY+nt.clientY)/2-Ee.top},Jn=X.current?Ut.x-X.current.x:0,Bn=X.current?Ut.y-X.current.y:0,Aa=xe.current>0?St/xe.current:1;Sn(ga=>{const Ri={x:ga.x+Jn,y:ga.y+Bn},wa={x:Ut.x-Ee.width/2,y:Ut.y-Ee.height/2};return{x:wa.x-(wa.x-Ri.x)*Aa,y:wa.y-(wa.y-Ri.y)*Aa}}),wt(ga=>Math.max(.2,Math.min(ga*Aa,15))),xe.current=St,X.current=Ut}}},[vt]),qn=x.useCallback(V=>{V.preventDefault(),V.currentTarget.releasePointerCapture(V.pointerId),je.current=je.current.filter(Se=>Se.pointerId!==V.pointerId),je.current.length<2&&(xe.current=0,X.current=null),je.current.length<1&&(He.current=!1,Ke.current=null,document.body.style.overscrollBehavior="auto")},[]),Nt=x.useCallback(V=>{V.preventDefault();const Se=V.deltaY>0?.9:1.1,Ee=V.currentTarget.getBoundingClientRect(),We={x:V.clientX-Ee.left,y:V.clientY-Ee.top};wt(nt=>{const St=Math.max(.2,Math.min(nt*Se,15));return Sn(Ut=>({x:We.x-(We.x-Ut.x)*(St/nt),y:We.y-(We.y-Ut.y)*(St/nt)})),St})},[]),li=x.useCallback(()=>{const V=se.current,Se=V?.getContext("2d");!V||!Se||cn(Ee=>{if(Ee.length===0)return Ee;const We=Ee.slice(0,-1);return Se.clearRect(0,0,V.width,V.height),Se.putImageData(Ee[Ee.length-1],0,0),We})},[]),Ha=x.useCallback(()=>{dt(!1),Bt(null),He.current=!1,Ke.current=null,wt(1),Sn({x:0,y:0}),je.current=[],cn([]),Fe.current=!0,yn(),_e.current&&(Rt(_e.current),_e.current=null)},[Rt,yn]),$n=x.useCallback(()=>{if(!se.current||!Wt.current||!bt.current)return;const V=Wt.current,Se=se.current,We=bt.current.getBoundingClientRect(),nt=document.createElement("canvas");nt.width=We.width,nt.height=We.height;const St=nt.getContext("2d");St.save(),St.translate(nt.width/2,nt.height/2),St.translate(tn.x,tn.y),St.scale(ht,ht),St.drawImage(V,-V.naturalWidth/2,-V.naturalHeight/2),St.drawImage(Se,-V.naturalWidth/2,-V.naturalHeight/2),St.restore();const Ut=nt.toDataURL("image/jpeg",.9);ue(Ut,"image/jpeg"),t(),Ha()},[tn.x,tn.y,ht,ue,t,Ha]);x.useEffect(()=>{if(!Qt||!Mt)return;const V=se.current,Se=V?.getContext("2d"),Ee=Wt.current;if(!V||!Se||!Ee)return;const We=()=>{Ee.naturalWidth>0&&(V.width=Ee.naturalWidth,V.height=Ee.naturalHeight,Se.strokeStyle="#EF4444",Se.lineWidth=Math.max(5,Ee.naturalWidth*.01),Se.lineCap="round",Se.lineJoin="round")};return Ee.complete&&Ee.naturalWidth>0?We():Ee.addEventListener("load",We),()=>Ee.removeEventListener("load",We)},[Qt,Mt]);const ze=V=>{Qe.current&&(Rt(Qe.current),Qe.current=null);const Se=V.target.files?.[0];if(Se)if(Se.type.startsWith("video/")){const Ee=document.createElement("video");Ee.preload="metadata",Ee.onloadedmetadata=()=>{window.URL.revokeObjectURL(Ee.src);const We=new FileReader;We.onloadend=()=>{ue(We.result,Se.type)},We.readAsDataURL(Se)},Ee.onerror=()=>{window.URL.revokeObjectURL(Ee.src),console.error(A("chat.error.videoMetadataError")),Re.current&&(Re.current.value="")},Ee.src=URL.createObjectURL(Se)}else{const Ee=new FileReader;Ee.onloadend=()=>{ue(Ee.result,Se.type)},Ee.readAsDataURL(Se)}},Ct=()=>{ue(null,null),Re.current&&(Re.current.value="")};x.useEffect(()=>{const V=()=>{Qe.current&&(Rt(Qe.current),Qe.current=null)};return window.addEventListener("focus",V),()=>window.removeEventListener("focus",V)},[Rt]);const Ft=x.useMemo(()=>{if(!k||!k.active)return null;const V=[];if(V.push(k.label||"Preparing..."),typeof k.done=="number"&&typeof k.total=="number"&&k.total>0&&V.push(`${k.done}/${k.total}`),typeof k.etaMs=="number"){const Se=Math.ceil(k.etaMs/1e3);isFinite(Se)&&V.push(`~${Se}s`)}return V.join("  ")},[k]),un=x.useMemo(()=>te===p?.langCode?p.flag:te===b?.langCode?b.flag:p?.flag,[te,p,b]),En=()=>st?"":Ft||(j?H?A("chat.suggestion.creating"):Ue?ye?`${A("chat.placeholder.suggestion.listening",{language:un})}  ${ye}`:A("chat.placeholder.suggestion.listening",{language:un}):le?ye?`${A("chat.placeholder.suggestion.sttActive",{language:un})}  ${ye}`:A("chat.placeholder.suggestion.sttActive",{language:un}):A("chat.placeholder.suggestion.sttInactive",{language:un}):Ue?ye?`${A("chat.placeholder.normal.listening",{language:un})}  ${ye}`:A("chat.placeholder.normal.listening",{language:un}):le?ye?`${A("chat.placeholder.normal.sttActive",{language:un})}  ${ye}`:A("chat.placeholder.normal.sttActive",{language:un}):A("chat.placeholder.normal.sttInactive",{language:un})),tt=j?"bg-card text-foreground shadow-sm sketchy-border focus-within:ring-2 focus-within:ring-pencil-light":"bg-primary text-primary-foreground shadow-sm sketchy-border focus-within:ring-2 focus-within:ring-pencil-light",$t=j?"bg-primary text-primary-foreground hover:bg-primary/80 focus:ring-ring":"bg-card text-primary hover:bg-secondary focus:ring-primary",bn=j?"text-muted-foreground hover:text-foreground hover:bg-secondary":"text-primary-foreground/70 hover:text-primary-foreground hover:bg-white/20",re=()=>{Qe.current||(Qe.current=mt(_t.ATTACH_FILE)),Re.current?.click()},Xe=j?"bg-secondary text-foreground":"bg-accent text-accent-foreground";return T.jsxs(T.Fragment,{children:[T.jsx("style",{children:`
        @keyframes fade-in-up {
          from { opacity: 0; transform: translateY(8px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up {
          animation: fade-in-up 220ms ease-out both;
        }
      `}),T.jsxs(T.Fragment,{children:[T.jsxs("div",{className:`transition-colors duration-300 rounded-sketchy p-3 shadow-lg w-full max-w-2xl sketchy-border ${Xe} relative`,style:{containerType:"inline-size"},children:[T.jsxs("div",{className:`relative w-full flex flex-col overflow-hidden transition-colors ${tt}`,children:[st?T.jsx(xB,{}):T.jsx(JB,{t:A,inputText:Te,placeholder:En(),isDisabled:yt||Ue&&le||j&&H,onChange:Ve,onKeyDown:Pe,bubbleTextAreaRef:qe,prepDisplay:Ft}),T.jsxs("div",{className:"flex items-center justify-between px-2 pb-2",children:[T.jsx(e2,{t:A,isLanguageSelectionOpen:st,isSuggestionMode:j,fileInputRef:Re,onImageAttach:ze,onPaperclipClick:re,availableCameras:N,selectedCameraId:Le,currentCameraFacingMode:_,isImageGenCameraSelected:De,sendWithSnapshotEnabled:ce,useVisualContextForReengagementEnabled:Ge,imageGenerationModeEnabled:ae,onSelectCamera:ne,onToggleSendWithSnapshot:c,onToggleUseVisualContextForReengagement:h,onToggleImageGenerationMode:d,iconButtonStyle:bn}),T.jsxs("div",{className:"flex items-center space-x-1",children:[T.jsx(ZB,{t:A,isLanguageSelectionOpen:st,isSttSupported:oe,isSttGloballyEnabled:le,isListening:Ue,isSending:yt,isSpeaking:ft,targetLanguageDef:p,nativeLanguageDef:b,isSuggestionMode:j,onSttToggle:a,onSetAttachedImage:ue,onUserInputActivity:t}),T.jsx("button",{type:"button",onClick:Oe,className:`p-2 focus:outline-none focus:ring-2 transition-colors disabled:opacity-50 shadow-sm sketchy-border-thin ${$t}`,disabled:yt||!Te.trim()&&!w&&!st||ft||j&&H,"aria-label":st?"Confirm language selection":j?A(H?"chat.suggestion.creating":"chat.suggestion.createAction"):k&&k.active?k.label||A("chat.sendPrep.finalizing"):A("chat.sendMessage"),children:st?T.jsx(Nr,{className:"w-5 h-5"}):j?H?T.jsx(Ii,{className:"w-5 h-5"}):T.jsx(Qu,{className:"w-5 h-5"}):k&&k.active?T.jsx(Ii,{className:"w-5 h-5"}):T.jsx(fS,{className:"w-5 h-5"})})]})]})]}),I&&T.jsx("p",{className:`w-full max-w-2xl p-1 rounded mt-1 ${j?"text-destructive bg-destructive/10":"text-red-200 bg-red-900/50"}`,style:{fontSize:"0.75rem"},role:"alert",children:A("chat.error.sttError",{error:I})}),K&&T.jsx("p",{className:`w-full max-w-2xl p-1 rounded mt-1 ${j?"text-destructive bg-destructive/10":"text-red-200 bg-red-900/50"}`,style:{fontSize:"0.75rem"},role:"alert",children:A("chat.error.autoCaptureCameraError",{error:K})}),G&&T.jsx("p",{className:`w-full max-w-2xl p-1 rounded mt-1 ${j?"text-primary bg-primary/10":"text-yellow-200 bg-yellow-900/50"}`,style:{fontSize:"0.75rem"},role:"alert",children:A("chat.error.snapshotUserError",{error:G})})]}),!st&&T.jsx("div",{className:"animate-fade-in-up mt-3 w-full max-w-2xl",children:T.jsx($B,{t:A,isSuggestionMode:j,attachedImageBase64:w,attachedImageMimeType:S,showLiveFeed:Me,isTwoUp:at,liveVideoStream:P,liveSessionState:R,liveSessionError:D,onStartLiveSession:n,onStopLiveSession:i,onRemoveAttachment:Ct,onAnnotateImage:Je,onAnnotateVideo:qt,onAnnotatePdf:ct,onSetAttachedImage:ue,onUserInputActivity:t,attachedPreviewVideoRef:Ye})}),Qt&&T.jsx("div",{className:"mt-3 w-full max-w-2xl animate-fade-in-up",children:T.jsxs("div",{ref:bt,className:"relative w-full max-h-[75vh] bg-black rounded-md overflow-hidden transition-all duration-300",style:{aspectRatio:Ce||void 0,touchAction:"none"},onPointerDown:Lt,onPointerMove:Rn,onPointerUp:qn,onPointerCancel:qn,onWheel:Nt,children:[T.jsxs("div",{style:{width:Wt.current?.naturalWidth,height:Wt.current?.naturalHeight,position:"absolute",top:"50%",left:"50%",transform:`translate(-50%,-50%) translate(${tn.x}px, ${tn.y}px) scale(${ht})`,transition:je.current.length>0?"none":"transform 0.1s ease-out"},children:[T.jsx("img",{ref:Wt,src:Mt,alt:A("chat.annotateModal.editingPreviewAlt"),className:"block w-full h-full object-contain pointer-events-none",style:{opacity:1},onLoad:V=>{const Se=V.currentTarget;if(Se.naturalWidth>0&&(lt(Se.naturalWidth/Se.naturalHeight),bt.current)){const Ee=bt.current.clientWidth;wt(Ee/Se.naturalWidth),Sn({x:0,y:0})}}}),T.jsx("canvas",{ref:se,className:"absolute top-0 left-0 w-full h-full cursor-crosshair"})]}),T.jsxs("div",{className:"absolute inset-0 pointer-events-none",children:[vn>1&&T.jsxs("div",{className:"absolute top-2 left-2 pointer-events-auto flex items-center space-x-1",onPointerDown:V=>{V.stopPropagation(),V.preventDefault()},onPointerUp:V=>{V.stopPropagation(),V.preventDefault()},onPointerCancel:V=>{V.stopPropagation(),V.preventDefault()},onClick:V=>{V.stopPropagation(),V.preventDefault()},children:[T.jsx("button",{type:"button",onClick:()=>Xt(-1),disabled:xt<=1,className:"p-1.5 rounded-full bg-black/60 text-white hover:bg-black disabled:opacity-40 disabled:cursor-default focus:outline-none",children:T.jsx(md,{className:"w-4 h-4"})}),T.jsxs("span",{className:"text-white text-xs font-medium tabular-nums bg-black/60 rounded px-1.5 py-0.5 select-none",children:[xt,"/",vn]}),T.jsx("button",{type:"button",onClick:()=>Xt(1),disabled:xt>=vn,className:"p-1.5 rounded-full bg-black/60 text-white hover:bg-black disabled:opacity-40 disabled:cursor-default focus:outline-none",children:T.jsx(vd,{className:"w-4 h-4"})})]}),T.jsx("div",{className:"absolute top-2 right-2 pointer-events-auto",onPointerDown:V=>{V.stopPropagation(),V.preventDefault()},onPointerUp:V=>{V.stopPropagation(),V.preventDefault()},onPointerCancel:V=>{V.stopPropagation(),V.preventDefault()},onClick:V=>{V.stopPropagation(),V.preventDefault()},children:T.jsx("button",{type:"button",onClick:Ha,className:"p-2 rounded-full bg-black/60 text-white hover:bg-black focus:outline-none focus:ring-2 focus:ring-white/40",title:A("chat.annotateModal.cancel"),"aria-label":A("chat.annotateModal.cancel"),children:T.jsx(Pi,{className:"w-5 h-5"})})}),T.jsx("div",{className:"absolute bottom-2 left-2 pointer-events-auto",onPointerDown:V=>{V.stopPropagation(),V.preventDefault()},onPointerUp:V=>{V.stopPropagation(),V.preventDefault()},onPointerCancel:V=>{V.stopPropagation(),V.preventDefault()},onClick:V=>{V.stopPropagation(),V.preventDefault()},children:T.jsx("button",{type:"button",onClick:li,disabled:wn.length===0,className:"p-2 rounded-full bg-black/60 text-white hover:bg-black disabled:opacity-50 disabled:cursor-default focus:outline-none focus:ring-2 focus:ring-white/40",title:A("chat.annotateModal.undo"),"aria-label":A("chat.annotateModal.undo"),"aria-disabled":wn.length===0,children:T.jsx(Nr,{className:"w-5 h-5"})})}),T.jsx("div",{className:"absolute bottom-2 right-2 pointer-events-auto",onPointerDown:V=>{V.stopPropagation(),V.preventDefault()},onPointerUp:V=>{V.stopPropagation(),V.preventDefault()},onPointerCancel:V=>{V.stopPropagation(),V.preventDefault()},onClick:V=>{V.stopPropagation(),V.preventDefault()},children:T.jsx("button",{type:"button",onClick:$n,className:"p-2 rounded-full bg-green-500 text-white hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-300",title:A("chat.annotateModal.saveAndAttach"),"aria-label":A("chat.annotateModal.saveAndAttach"),children:T.jsx(As,{className:"w-5 h-5"})})})]})]})})]})]})},ea=100,n2=a=>(a.role==="user"||a.role==="assistant")&&!a.thinking,a2=a=>{const{onDeleteMessage:e,bubbleWrapperRefs:t,onChangeMaxVisibleMessages:n,onSetAttachedImage:i,onSttToggle:s,speakText:l,stopSpeaking:c,onToggleSpeakNativeLang:h,onUserInputActivity:d,onToggleSendWithSnapshot:A,onToggleUseVisualContextForReengagement:f,onSuggestionClick:p,onToggleImageGenerationMode:b,onToggleImageFocusedMode:w,onStartLiveSession:S,onStopLiveSession:k,onToggleSuggestionMode:E,onCreateSuggestion:I,onBookmarkAt:P,onSendMessage:R,onQuotaSetupBilling:D,onQuotaStartLive:N,onImageGenDisable:_,onImageGenViewCost:K}=a,{t:G}=Ro(),L=W(FB),O=W(ET),q=W(_d),$=W(_o),Q=W(UB),Z=W(Vd),F=W(lr),U=W(jd)||In[0],Y=W(op)||In[0],ge=W(X=>X.loadingAnimations),me=W(X=>X.transitioningImageId),z=W(zB),H=W(X=>X.imageLoadDurations),j=W(X=>X.isLanguageSelectionOpen),le=W(X=>X.tempNativeLangCode),te=W(X=>X.tempTargetLangCode),oe=W(X=>X.setTempNativeLangCode),ce=W(X=>X.setTempTargetLangCode),Ge=W(X=>X.updateLanguageSelectorInteraction),ae=x.useCallback(X=>{oe(X),X&&X===te&&ce(null)},[oe,te,ce]),Le=x.useCallback(X=>{ce(X)},[ce]),De=Z.isSuggestionMode,ue=Z.tts.speakNative,ne=Z.imageFocusedModeEnabled,fe=Z.historyBookmarkMessageId??null,Te=Z.maxVisibleMessages??sp,pe=x.useMemo(()=>ha(F?.targetLanguageCode||U?.code||"es"),[F,U]),ye=x.useMemo(()=>ha(F?.nativeLanguageCode||Y?.code||"en"),[F,Y]),Ie=x.useMemo(()=>H.length>0?H.reduce((xe,Fe)=>xe+Fe,0)/H.length/1e3:15,[H]),qe=x.useMemo(()=>Math.max(1,Te)+2,[Te]),Re=W(X=>X.addActivityToken),et=W(X=>X.removeActivityToken),Ye=x.useCallback(X=>Re(mn.UI,`${X}:${Date.now()}:${Math.random().toString(36).slice(2,8)}`),[Re]),Qe=x.useMemo(()=>{const X=new Set;let xe=0;for(let Fe=L.length-1;Fe>=0;Fe--){const Me=L[Fe];n2(Me)&&(xe++,Me.role==="assistant"&&!Me.thinking&&xe<=qe&&X.add(Me.id))}return X},[L,qe]),st=x.useRef(null),yt=x.useRef(null),ft=x.useRef(!0),Ue=x.useCallback(()=>{const X=st.current;if(!X)return;const xe=X.scrollHeight-X.scrollTop-X.clientHeight;ft.current=xe<500},[]);x.useEffect(()=>{ft.current&&yt.current?.scrollIntoView({behavior:"smooth"})},[L]);const[Be,it]=x.useState("below"),[mt,Rt]=x.useState(0);x.useEffect(()=>{it("below"),Rt(0),ht(null)},[fe]);const Qt=x.useRef(null);x.useEffect(()=>(Be==="above"?Qt.current||(Qt.current=Ye(_t.VIEWING_ABOVE)):Qt.current&&(et(Qt.current),Qt.current=null),()=>{Qt.current&&(et(Qt.current),Qt.current=null)}),[Be,Ye,et]);const dt=x.useRef({messageId:null,startX:0,startY:0,isUser:!1,isSwiping:!1,trayWidth:0}),[Mt,Bt]=x.useState(null),Ce=x.useRef(null),[lt,ht]=x.useState(null);x.useEffect(()=>(Ce.current&&(clearTimeout(Ce.current),Ce.current=null),Mt&&(Ce.current=setTimeout(()=>{const X=t.current.get(Mt);X&&(X.style.transition="transform 0.25s ease-out",X.style.transform="translateX(0px)"),Bt(null),Ce.current=null},3e3)),()=>{Ce.current&&(clearTimeout(Ce.current),Ce.current=null)}),[Mt]);const wt=x.useCallback((X,xe,Fe)=>{const Me=G(X,Fe);return Me===X?xe:Me},[G]),tn=(X,xe,Fe)=>{if(!(dt.current.messageId||!X.isPrimary)){if(Mt&&Mt!==xe){const Me=t.current.get(Mt);Me&&(Me.style.transition="transform 0.2s ease-out",Me.style.transform="translateX(0px)"),Bt(null)}dt.current={messageId:xe,startX:X.clientX,startY:X.clientY,isUser:Fe,isSwiping:!1,trayWidth:56}}},Sn=X=>{if(!dt.current.messageId||!X.isPrimary)return;const{startX:xe,startY:Fe,isUser:Me,messageId:at}=dt.current,Ve=t.current.get(at);if(!Ve)return;const Oe=X.clientX-xe,Pe=X.clientY-Fe;if(!dt.current.isSwiping&&(Math.abs(Oe)>10||Math.abs(Pe)>10))if(Math.abs(Oe)>Math.abs(Pe))dt.current.isSwiping=!0,Ve.style.touchAction="none",Ve.style.cursor="grabbing";else{dt.current={messageId:null,startX:0,startY:0,isUser:!1,isSwiping:!1,trayWidth:0};return}if(dt.current.isSwiping){const Ne=dt.current.trayWidth+12;let Je;Me?(Je=Math.min(0,Oe),Je=Math.max(Je,-Ne)):(Je=Math.max(0,Oe),Je=Math.min(Je,Ne)),Ve.style.transition="none",Ve.style.transform=`translateX(${Je}px)`}},wn=X=>{if(!dt.current.messageId||!X.isPrimary)return;const{messageId:xe,startX:Fe,isUser:Me,isSwiping:at,trayWidth:Ve}=dt.current,Oe=t.current.get(xe);if(Oe&&(Oe.style.touchAction="pan-y",Oe.style.cursor="auto"),!at||!Oe){dt.current={messageId:null,startX:0,startY:0,isUser:!1,isSwiping:!1,trayWidth:0},Bt(null);return}const Pe=X.clientX-Fe,Ne=Me?Pe<-Ve/2:Pe>Ve/2;Oe.style.transition="transform 0.2s ease-out",Oe.style.transform=Ne?`translateX(${Me?-Ve:Ve}px)`:"translateX(0px)",Bt(Ne?xe:null),dt.current={messageId:null,startX:0,startY:0,isUser:!1,isSwiping:!1,trayWidth:0}},cn=X=>{if(!dt.current.messageId||!X.isPrimary)return;const{messageId:xe}=dt.current,Fe=t.current.get(xe);Fe&&(Fe.style.transition="transform 0.3s ease-out",Fe.style.transform="translateX(0px)",Fe.style.touchAction="pan-y",Fe.style.cursor="auto"),Bt(null),dt.current={messageId:null,startX:0,startY:0,isUser:!1,isSwiping:!1,trayWidth:0}},bt=x.useMemo(()=>{if(!fe)return{hasBookmark:!1,bookmarkIdx:-1,pre:[],post:L,hiddenCount:0};const X=L.findIndex(Me=>Me.id===fe);if(X===-1)return{hasBookmark:!1,bookmarkIdx:-1,pre:[],post:L,hiddenCount:0};const xe=L.slice(0,X),Fe=L.slice(X);return{hasBookmark:!0,bookmarkIdx:X,pre:xe,post:Fe,hiddenCount:xe.length}},[L,fe]);x.useEffect(()=>{if(Be!=="above")return;const X=Math.ceil(bt.hiddenCount/ea);if(X<=0){it("below"),mt!==0&&Rt(0);return}const xe=X-1;mt>xe&&Rt(xe)},[Be,mt,bt.hiddenCount]);let Wt=L,se=bt.hiddenCount,_e=null;if(bt.hasBookmark&&bt.bookmarkIdx>=0)if(Be==="above"&&se>0){const X=Math.ceil(se/ea);if(X>0){const xe=X-1,Fe=Math.min(Math.max(mt,0),xe),Me=se-Fe*ea,at=Math.max(0,Me-ea);Wt=bt.pre.slice(at,Me),_e={chunkCount:X,chunkIndex:Fe,chunkStart:at,chunkEnd:Me,displayStart:at+1,displayEnd:Me}}else Wt=bt.post}else Wt=bt.post;const He=x.useCallback(X=>{if($){c();return}if(X.role==="assistant"){const xe=[];let Fe=pe||"es";if(X.translations&&X.translations.length>0)ue?X.translations.forEach(Me=>{Me.target&&Me.target.trim()&&xe.push({text:Me.target,langCode:pe,context:{source:"message",messageId:X.id}}),Me.native&&Me.native.trim()&&xe.push({text:Me.native,langCode:ye,context:{source:"message",messageId:X.id}})}):X.translations.forEach(Me=>{Me.target&&Me.target.trim()&&xe.push({text:Me.target,langCode:pe,context:{source:"message",messageId:X.id}})});else if(X.rawAssistantResponse){let Me=X.rawAssistantResponse,at=pe;!Me.match(/[]/i)&&ye.startsWith("en")&&Me.match(/[a-zA-Z]/)&&ue&&(at=ye),Me.trim()&&(xe.push({text:Me.trim(),langCode:at,context:{source:"message",messageId:X.id}}),Fe=at)}else if(X.text){let Me=X.text,at=pe;!Me.match(/[]/i)&&ye.startsWith("en")&&Me.match(/[a-zA-Z]/)&&ue&&(at=ye),Me.trim()&&(xe.push({text:Me.trim(),langCode:at,context:{source:"message",messageId:X.id}}),Fe=at)}if(xe.length>0){l(xe,Fe);return}}else if(X.text&&(X.role==="error"||X.role==="status")){const xe=X.text,Fe=ye||"en";xe.trim()&&l([{text:xe.trim(),langCode:Fe,context:{source:"adHoc"}}],Fe);return}},[$,c,ue,pe,ye,l]),Ke=x.useCallback((X,xe,Fe,Me,at)=>{if($){c();return}if(!X||!xe)return;const Ve=at?{source:"message",messageId:at}:{source:"adHoc"},Oe=[];Oe.push({text:X,langCode:xe,context:Ve}),ue&&Fe&&Me&&Fe.trim()&&Oe.push({text:Fe,langCode:Me,context:Ve}),Oe.length>0&&l(Oe,Oe[0].langCode)},[$,c,ue,l]),je=x.useCallback(X=>{if(!X?.text)return;if($){c();return}const xe=X.recordedUtterance;if(xe&&typeof xe.dataUrl=="string"&&xe.dataUrl.length>0){const Me=xe.langCode||pe||"es",at=[{text:X.text,langCode:Me,cachedAudio:xe.dataUrl,context:{source:"message",messageId:X.id}}];l(at,Me);return}let Fe=pe||"es";X.text&&ye&&ye.startsWith("en")&&!X.text.match(/[]/i)&&/[a-zA-Z]/.test(X.text)&&(Fe=ye),l([{text:X.text,langCode:Fe,context:{source:"message",messageId:X.id}}],Fe)},[$,c,pe,ye,l]);return T.jsx("div",{className:"flex flex-col h-full bg-background notebook-lines",children:T.jsxs("div",{ref:st,className:"flex-grow overflow-y-auto p-4",onScroll:Ue,onPointerMove:Sn,onPointerUp:wn,onPointerCancel:cn,children:[T.jsx("div",{className:"shrink-0",style:{height:"calc(100vh - 200px)"},"aria-hidden":!0}),T.jsxs("div",{className:"space-y-2",children:[bt.hasBookmark&&se>0&&T.jsxs("div",{className:"my-1 px-2 py-1 bg-secondary border border-border rounded-sketchy flex items-center gap-2",role:"region","aria-label":G("chat.bookmark.hiddenHeaderAria")||"Hidden messages above",style:{containerType:"inline-size"},children:[T.jsx(Vu,{className:"w-4 h-4 text-pencil-light"}),T.jsx("span",{className:"text-foreground",style:{fontSize:"2.8cqw"},children:Be==="above"&&_e?wt("chat.bookmark.showingAboveRange",`Showing messages above ${_e.displayStart}-${_e.displayEnd} of ${se}`,{start:_e.displayStart,end:_e.displayEnd,total:se}):wt("chat.bookmark.hiddenCount",`${se} above messages hidden`,{count:se})}),T.jsx("div",{className:"ml-auto flex items-center gap-2",style:{fontSize:"2.8cqw"},children:Be==="above"&&_e?T.jsx("button",{className:"px-2 py-1 rounded-sketchy bg-card hover:bg-secondary text-foreground border border-border disabled:opacity-50",onClick:()=>{_e&&_e.chunkIndex<_e.chunkCount-1&&Rt(X=>Math.min(X+1,_e.chunkCount-1))},disabled:_e.chunkIndex>=_e.chunkCount-1,title:wt("chat.bookmark.showNextChunk",`Show ${ea} above`,{count:ea}),children:wt("chat.bookmark.showNextChunk",`Show ${ea} above`,{count:ea})}):T.jsx("button",{className:"px-2 py-1 rounded-sketchy bg-card hover:bg-secondary text-foreground border border-border",onClick:()=>{se>0&&(it("above"),Rt(0))},title:wt("chat.bookmark.showAboveChunk",se>ea?`Show ${ea} above`:"Show messages above",{count:Math.min(se,ea)}),children:wt("chat.bookmark.showAboveChunk",se>ea?`Show ${ea} above`:"Show messages above",{count:Math.min(se,ea)})})})]}),Wt.map((X,xe)=>{if(X.role==="system_selection")return null;const Fe=X.role==="status",Me=X.role==="user",at=X.role==="assistant",Ve=X.role==="error",Oe=(Me||at||Ve||Fe)&&!X.thinking&&!X.isGeneratingImage;return T.jsxs("div",{style:{touchAction:"pan-y",position:"relative"},onPointerDown:Mt===X.id?void 0:Oe?Pe=>tn(Pe,X.id,Me):void 0,children:[fe===X.id&&T.jsxs("div",{className:`absolute top-1 ${Me?"right-1":"left-1"} z-40 flex items-center gap-2`,onPointerDown:Pe=>{Pe.stopPropagation()},children:[Me&&lt===X.id&&T.jsx("div",{className:"mr-1",children:T.jsx(rb,{t:G,message:X,maxVisibleMessages:Te,onChangeMaxVisibleMessages:n,updateMessage:a.updateMessage})}),T.jsx("button",{className:"p-1 bg-accent/80 text-accent-foreground hover:bg-accent shadow-sm sketchy-border-thin",onClick:Pe=>{Pe.stopPropagation(),ht(Ne=>Ne===X.id?null:X.id)},title:G("chat.bookmark.actionsToggleTitle")||"Bookmark options","aria-expanded":lt===X.id,children:T.jsx(qu,{className:"w-4 h-4"})}),!Me&&lt===X.id&&T.jsx("div",{className:"ml-1",children:T.jsx(rb,{t:G,message:X,maxVisibleMessages:Te,onChangeMaxVisibleMessages:n,updateMessage:a.updateMessage})})]}),Oe&&T.jsxs("div",{className:`absolute ${Me?"right-0":"left-0"} top-1/2 -translate-y-1/2 flex flex-col items-center gap-2`,style:{width:56,zIndex:50,pointerEvents:Mt===X.id?"auto":"none",opacity:Mt===X.id?1:0,transform:`translateY(-50%) ${Mt===X.id?"translateX(0)":`translateX(${Me?"8px":"-8px"})`}`,transition:"opacity 120ms ease, transform 120ms ease",touchAction:"none"},onPointerDown:Pe=>{Pe.stopPropagation()},"aria-hidden":Mt===X.id?void 0:!0,children:[at&&(X.id===fe||Qe.has(X.id))&&T.jsx("button",{className:`p-2 ${De?"bg-secondary text-foreground":"bg-accent text-accent-foreground"} shadow sketchy-border-thin`,onPointerDown:Pe=>{Pe.stopPropagation()},onClick:Pe=>{Pe.stopPropagation(),X.id!==fe&&P(X.id)},title:X.id===fe?G("chat.bookmark.isHere")||"Bookmark is here":G("chat.bookmark.setHere")||"Set bookmark here","aria-pressed":X.id===fe,children:T.jsx(qu,{className:`w-5 h-5 ${X.id===fe?"opacity-100":"opacity-90"}`})}),T.jsx("button",{className:`p-2 ${De?"bg-secondary text-foreground":"bg-eraser text-accent-foreground"} shadow sketchy-border-thin`,onPointerDown:Pe=>{Pe.stopPropagation()},onClick:Pe=>{Pe.stopPropagation(),e(X.id)},title:"Delete message",children:T.jsx(yd,{className:"w-5 h-5"})})]}),T.jsx(xT,{message:X,isFocusedMode:ne,speakingUtteranceText:z,estimatedLoadTime:Ie,loadingAnimations:ge,t:G,onToggleSpeakNativeLang:h,handleSpeakWholeMessage:He,handleSpeakLine:Ke,handlePlayUserMessage:je,speakText:l,stopSpeaking:c,onToggleImageFocusedMode:()=>w(X.id),transitioningImageId:me,onSetAttachedImage:i,onUserInputActivity:d,onQuotaSetupBilling:D,onQuotaStartLive:N,onImageGenDisable:_,onImageGenViewCost:K,registerBubbleEl:Pe=>{Pe?t.current.set(X.id,Pe):t.current.delete(X.id)}},X.id)]},X.id)}),Q&&Q.length>0&&T.jsxs("div",{className:"mt-4 p-3 bg-secondary rounded-sketchy shadow sketchy-border-thin",style:{containerType:"inline-size"},children:[T.jsx("h4",{className:"font-semibold text-muted-foreground mb-1 font-sketch",style:{fontSize:"2.9cqw"},children:G("chat.retrievedFromWeb")}),T.jsx("ul",{className:"space-y-1",children:Q.map((X,xe)=>(X.web||X.retrievedContext)&&T.jsx("li",{children:T.jsx("a",{href:X.web?.uri||X.retrievedContext?.uri,target:"_blank",rel:"noopener noreferrer",className:"text-watercolor hover:underline truncate block",style:{fontSize:"2.8cqw"},title:X.web?.title||X.retrievedContext?.title||X.web?.uri||X.retrievedContext?.uri,children:X.web?.title||X.retrievedContext?.title?X.web?.title||X.retrievedContext?.title:X.web?.uri||X.retrievedContext?.uri})},xe))})]}),bt.hasBookmark&&Be==="above"&&T.jsxs("div",{className:"my-1 px-2 py-1 bg-secondary border border-border rounded-sketchy flex items-center gap-2",role:"region","aria-label":G("chat.bookmark.hiddenBelowHeaderAria")||"Hidden messages below",style:{containerType:"inline-size"},children:[T.jsx(Vu,{className:"w-4 h-4 text-pencil-light"}),T.jsx("span",{className:"text-foreground",style:{fontSize:"2.8cqw"},children:_e?wt("chat.bookmark.showingAboveRange",`Showing messages above ${_e.displayStart}-${_e.displayEnd} of ${se}`,{start:_e.displayStart,end:_e.displayEnd,total:se}):wt("chat.bookmark.hiddenBelow","Messages are hidden below")}),T.jsxs("div",{className:"ml-auto flex items-center gap-2",style:{fontSize:"2.8cqw"},children:[_e&&_e.chunkIndex>0&&T.jsx("button",{className:"px-2 py-1 rounded-sketchy bg-card hover:bg-secondary text-foreground border border-border",onClick:()=>Rt(X=>Math.max(X-1,0)),title:wt("chat.bookmark.showPreviousChunk",`Show ${ea} below`,{count:ea}),children:wt("chat.bookmark.showPreviousChunk",`Show ${ea} below`,{count:ea})}),T.jsx("button",{className:"px-2 py-1 rounded bg-card hover:bg-secondary text-foreground border border-border",onClick:()=>it("below"),title:wt("chat.bookmark.returnToRecent","Back to messages below"),children:wt("chat.bookmark.returnToRecent","Back to messages below")})]})]}),T.jsxs("div",{className:"flex flex-col items-end mt-2",children:[T.jsx(t2,{onSttToggle:s,onSendMessage:R,onUserInputActivity:d,onStartLiveSession:S,onStopLiveSession:k,onToggleSuggestionMode:E,onCreateSuggestion:I,onToggleSendWithSnapshot:A,onToggleUseVisualContextForReengagement:f,onToggleImageGenerationMode:b}),j&&T.jsx("div",{className:"mt-3 w-full max-w-2xl animate-fade-in-up",children:T.jsx(xI,{nativeLangCode:le||null,targetLangCode:te||null,onSelectNative:ae,onSelectTarget:Le,onConfirm:()=>{},onCancel:()=>ce(null),t:G,onInteract:Ge})}),(q||O.length>0)&&T.jsx(XB,{t:G,onToggleSuggestionMode:()=>E(),onSuggestionClick:p,stopSpeaking:c})]}),T.jsx("div",{ref:yt})]})]})})},i2=ti.memo(a2),gf=async a=>{const e=await ma();return new Promise((t,n)=>{const l=e.transaction(ri,"readonly").objectStore(ri).get(a);l.onerror=()=>n(new Error("Error fetching history from DB")),l.onsuccess=()=>{t(l.result?l.result.messages:[])}})},PT=async(a,e)=>{if(!a)return;const t=e.filter(i=>i.role!=="system_selection").map(LB),n=await ma();return new Promise((i,s)=>{const h=n.transaction(ri,"readwrite").objectStore(ri).put({pairId:a,messages:t});h.onerror=()=>s(new Error("Error saving history to DB")),h.onsuccess=()=>i()})},er=async(a,e,t=1)=>{try{return await PT(a,e),!0}catch(n){return t>0?(await Promise.resolve(),er(a,e,t-1)):(console.warn("IndexedDB save failed for pair:",a,n),!1)}},r2=async()=>{const a=await ma();return new Promise((e,t)=>{const s=a.transaction(ri,"readonly").objectStore(ri).openCursor();s.onerror=()=>t(new Error("Error checking for chat histories")),s.onsuccess=l=>{const c=l.target.result;e(!!c)}})},s2=async a=>{const e=await ma();return new Promise((t,n)=>{const l=e.transaction(ri,"readonly").objectStore(ri).openCursor();let c=Promise.resolve(),h=!1;l.onerror=()=>n(new Error("Error iterating chat histories")),l.onsuccess=d=>{const A=d.target.result;if(!A){c.then(()=>{h||(h=!0,t())}).catch(w=>{h||(h=!0,n(w instanceof Error?w:new Error(String(w))))});return}const f=A.value||{},p=typeof f.pairId=="string"?f.pairId:"",b=Array.isArray(f.messages)?f.messages:[];c=c.then(()=>a(p,b)),A.continue()}})},o2=async(a,e,t,n)=>{const i=await ma();return new Promise((s,l)=>{const c=i.transaction([ri,ni,Kr],"readwrite"),h=c.objectStore(ri),d=c.objectStore(ni),A=c.objectStore(Kr);c.oncomplete=()=>s(),c.onerror=()=>l(new Error("Transaction error during bulk save"));const f=h.clear(),p=d.clear(),b=A.clear();f.onerror=()=>l(new Error("Error clearing store before bulk save")),p.onerror=()=>l(new Error("Error clearing meta store before bulk save")),b.onerror=()=>l(new Error("Error clearing profile store before bulk save")),p.onsuccess=()=>{},b.onsuccess=()=>{},f.onsuccess=()=>{for(const S in a)if(Object.prototype.hasOwnProperty.call(a,S)){const k=a[S].filter(E=>E.role!=="system_selection");h.add({pairId:S,messages:k})}const w="".trim();if(w)try{A.put({key:"singleton",text:w,updatedAt:Date.now(),fingerprint:""})}catch{}}})},MT=async a=>{const e=await ma();return new Promise((t,n)=>{const l=e.transaction(ni,"readonly").objectStore(ni).get(a);l.onerror=()=>n(new Error("Error fetching chat meta from DB")),l.onsuccess=()=>t(l.result?l.result.meta:null)})},l2=async()=>{const a=await ma(),e=()=>new Promise((t,n)=>{const s=a.transaction(ni,"readonly").objectStore(ni);if(typeof s.getAll=="function"){const l=s.getAll();l.onerror=()=>n(l.error||new Error("getAll() failed for metas")),l.onsuccess=()=>t(l.result||[])}else n(new Error("getAll not supported"))});try{const t=await e(),n={};return(t||[]).forEach(i=>{n[i.pairId]=i.meta}),n}catch{return await new Promise((n,i)=>{const l=a.transaction(ni,"readonly").objectStore(ni),c={},h=l.openCursor();h.onerror=()=>i(new Error("Error fetching all chat metas from DB")),h.onsuccess=d=>{const A=d.target.result;if(A){const f=A.value;f&&typeof f.pairId=="string"&&(c[f.pairId]=f.meta),A.continue()}else n(c)}})}},lp=async(a,e)=>{const t=await ma();return new Promise((n,i)=>{const l=t.transaction(ni,"readwrite").objectStore(ni);if(e){const c=l.get(a);c.onerror=()=>i(new Error("Error reading chat meta to merge")),c.onsuccess=()=>{const d={...c.result?.meta||{},...e},A=l.put({pairId:a,meta:d});A.onerror=()=>i(new Error("Error saving chat meta to DB")),A.onsuccess=()=>n()}}else{const c=l.delete(a);c.onerror=()=>i(new Error("Error deleting chat meta from DB")),c.onsuccess=()=>n()}})},Ad=(a,e)=>{const{roles:t=["user","assistant"],maxMessages:n,maxMediaToKeep:i=ud,contextSummary:s,globalProfileText:l,placeholderLatestUserMessage:c,avatarOverlayFileUri:h,avatarOverlayMimeType:d}=e||{},A=new Set(t);let f=a.filter(w=>A.has(w.role)?w.role==="user"||w.role==="assistant"?!w.thinking:!0:!1);typeof n=="number"&&n>=0&&f.length>n&&(f=n>0?f.slice(-n):[]);const p=f.map(w=>{const S=w.uploadedFileUri||w.imageFileUri||void 0,k=S&&(w.uploadedFileMimeType||w.imageMimeType)||void 0;return{role:w.role==="user"||w.role==="assistant"?w.role:"user",text:w.text,rawAssistantResponse:w.rawAssistantResponse,imageFileUri:S,imageMimeType:k,chatSummary:w.chatSummary}});if(p.length>0&&Number.isFinite(i)&&i>=0){const w=[];for(let k=0;k<p.length;k++)p[k].imageFileUri&&w.push(k);const S=new Set(w.slice(-i));for(let k=0;k<p.length;k++)p[k].imageFileUri&&!S.has(k)&&(p[k].imageFileUri=void 0,p[k].imageMimeType=void 0)}const b=[];if(l&&l.trim()){const w=l.trim().slice(0,1e4);b.push(`Learner Profile (global):
${w}
END OF GLOBAL PROFILE MEMORY.`)}if(s&&s.trim()&&b.push(`Conversation Summary:
${s.trim().slice(0,1e4)}`),b.length>0){const w=b.join(`

`);p.length>0&&p[0].role==="user"?p[0].text=`${w}

${p[0].text||""}`:p.unshift({role:"user",text:w})}return h&&d&&p.length>0&&p[0].role==="user"&&(p[0].avatarFileUri=h,p[0].avatarMimeType=d),c&&c.trim()&&p.push({role:"user",text:c.trim().slice(0,1e4)}),p},IT="maestro_gemini_models_v1",DT="maestro_gemini_models_url",c2="https://chatwithmaestro.com/gemini-models.json",so={text:{default:"gemini-3-flash-preview",aux:"gemini-3-flash-preview",translation:"gemini-3-flash-preview"},image:{generation:"gemini-2.5-flash-image"},audio:{live:"gemini-2.5-flash-native-audio-preview-12-2025"}};let _T={...so};const u2=()=>{const a="https://ronitervo.github.io/MaestroTutor/gemini-models.json";return oo(a)?a:null},oo=a=>typeof a=="string"&&a.trim().length>0,RT=a=>!a||typeof a!="object"?!1:oo(a?.text?.default)&&oo(a?.text?.aux)&&oo(a?.text?.translation)&&oo(a?.image?.generation)&&oo(a?.audio?.live),d2=a=>({text:{default:a?.text?.default??so.text.default,aux:a?.text?.aux??so.text.aux,translation:a?.text?.translation??so.text.translation},image:{generation:a?.image?.generation??so.image.generation},audio:{live:a?.audio?.live??so.audio.live}}),xi=()=>_T,NT=a=>{_T=d2(a)},GT=a=>{try{return localStorage.getItem(a)}catch{return null}},LT=(a,e)=>{try{localStorage.setItem(a,e)}catch{}},h2=()=>GT(DT),A2=a=>{LT(DT,a)},g2=()=>u2()||h2()||c2,f2=()=>{const a=GT(IT);if(!a)return!1;try{const e=JSON.parse(a);if(RT(e))return NT(e),!0}catch{}return!1},p2=async a=>{const e=f2(),t=a?.url,n=new AbortController,i=window.setTimeout(()=>n.abort(),a?.timeoutMs??5e3);try{const s=await fetch(t,{signal:n.signal,cache:"no-store"});if(!s.ok)throw new Error(`Model registry fetch failed (${s.status})`);const l=await s.json();if(!RT(l))throw new Error("Model registry is missing required fields");return NT(l),LT(IT,JSON.stringify(l)),{updated:!0,source:"remote"}}catch(s){return{updated:!1,source:e?"cache":"default",error:s}}finally{window.clearTimeout(i)}},BT=12e4,FT=(a,e)=>{let t;const n=new Promise((i,s)=>{t=setTimeout(()=>s(new Error(`Request timed out after ${e/1e3}s`)),e)});return Promise.race([a,n]).finally(()=>clearTimeout(t))},QC=async(a,e,t,n,i,s,l,c,h,d=BT)=>{const A=await ys(),f=[];t.forEach(E=>{const I=[],P=E.rawAssistantResponse||E.text;if(P&&I.push({text:P}),E.imageFileUri)I.push({fileData:{fileUri:E.imageFileUri,mimeType:E.imageMimeType||"image/jpeg"}});else if(E.imageUrl&&E.imageMimeType){const R=E.imageUrl.substring(E.imageUrl.indexOf(",")+1);R&&I.push({inlineData:{data:R,mimeType:E.imageMimeType}})}if(E.avatarFileUri&&I.push({fileData:{fileUri:E.avatarFileUri,mimeType:E.avatarMimeType||"image/jpeg"}}),I.length>0){const R=E.role==="assistant"?"model":"user";f.push({role:R,parts:I})}});const p=[{text:e}];l&&p.push({fileData:{fileUri:l,mimeType:s||"image/jpeg"}}),f.push({role:"user",parts:p});const b={...h};n&&(b.systemInstruction=n),c&&(b.tools=[{googleSearch:{}}]);const w=E=>{if(!E||typeof E!="object")return E;if(Array.isArray(E))return E.map(w);const I={};for(const P of Object.keys(E))P==="inlineData"?I[P]="[REDACTED]":I[P]=w(E[P]);return I},S=w(f),k=si.logRequest("generateContent",a,{contents:S,config:b});try{const E=await FT(A.models.generateContent({model:a,contents:f,config:b}),d);return k.complete({text:E.text,usage:E.usageMetadata}),{text:E.text,candidates:E.candidates,usageMetadata:E.usageMetadata}}catch(E){throw console.error("Gemini API Error:",E),k.error(E),new Jl(E.message||"Gemini API failed",{status:E.status||500,code:E.code})}},m2=async(a,e,t)=>{const n=await ys(),i=`Translate the following text from ${e} to ${t}. Return ONLY the translation. Text: "${a}"`,s=xi().text.translation,l=si.logRequest("translateText",s,{prompt:i});try{const c=await FT(n.models.generateContent({model:s,contents:i}),BT);return l.complete({text:c.text,usage:c.usageMetadata}),{translatedText:c.text||"",usageMetadata:c.usageMetadata}}catch(c){throw l.error(c),new Jl(c.message||"Translation failed",{status:c.status||500,code:c.code})}},v2=12e4,y2=(a,e)=>{let t;const n=new Promise((i,s)=>{t=setTimeout(()=>s(new Error(`Request timed out after ${e/1e3}s`)),e)});return Promise.race([a,n]).finally(()=>clearTimeout(t))},qC=a=>{const e=Date.now(),t=Math.random().toString(36).substring(2,8);return`${a} <!-- ${e}_${t} -->`},Fl=async a=>{const e=await ys(),{prompt:t,latestMessageText:n,history:i,systemInstruction:s,maestroAvatarUri:l,maestroAvatarMimeType:c}=a,h=[];let d=i?i.map(E=>({...E})):[],A=-1,f=0;for(let E=d.length-1;E>=0;E--){const I=d[E],P=(I.imageMimeType||"").toLowerCase(),R=P.startsWith("image/");if(I.imageFileUri)if(R)if(f>=3){I.imageFileUri=void 0;const D=" [Previous image context omitted]";I.rawAssistantResponse?I.rawAssistantResponse+=D:I.text=(I.text||"")+D}else f++,A=E;else{I.imageFileUri=void 0;const N=` [${P.split("/")[0]||"File"} context omitted]`;I.rawAssistantResponse?I.rawAssistantResponse+=N:I.text=(I.text||"")+N}}let p;if(A>0&&f>=3){for(let E=A;E>=0;E--){const I=d[E];if(I.role==="assistant"&&typeof I.chatSummary=="string"&&I.chatSummary.trim()){p=I.chatSummary.trim();break}}d=d.slice(A)}if(d.length>0&&d.forEach((E,I)=>{let P=E.rawAssistantResponse||E.text;const R=E.imageFileUri&&(E.imageMimeType||"").toLowerCase().startsWith("image/");p&&I===0&&E.role==="user"&&(P=`[Conversation Summary from earlier context]
${p}

`+(P||"")),E.role==="user"?(P&&h.push({role:"user",parts:[{text:P}]}),R&&h.push({role:"model",parts:[{fileData:{fileUri:E.imageFileUri,mimeType:E.imageMimeType||"image/jpeg"}}]})):E.role==="assistant"&&(P&&h.push({role:"user",parts:[{text:P}]}),R&&h.push({role:"model",parts:[{fileData:{fileUri:E.imageFileUri,mimeType:E.imageMimeType||"image/jpeg"}}]}))}),p&&d.length>0&&d[0]?.role!=="user"){const E=`[Conversation Summary from earlier context]
${p}`;h.unshift({role:"user",parts:[{text:E}]})}const b=[];if(t?b.push({text:qC(t)}):n&&b.push({text:qC(n)}),l){const E=(c||"").toLowerCase();(!E||E.startsWith("image/"))&&b.push({fileData:{fileUri:l,mimeType:c||"image/png"}})}b.length&&h.push({role:"user",parts:b});const w=xi().image.generation,S={responseModalities:["IMAGE"],systemInstruction:s},k=si.logRequest("generateImage",w,{contents:h,config:S});try{const E=await y2(e.models.generateContent({model:w,contents:h,config:S}),v2);k.complete({candidates:E.candidates?.length});const I=E.candidates||[];for(const D of I)for(const N of D.content?.parts||[]){const _=N.inlineData;if(_&&_.mimeType?.startsWith("image/")&&typeof _.data=="string"&&_.data.trim()!=="")return{base64Image:`data:${_.mimeType};base64,${_.data}`,mimeType:_.mimeType}}let P="";for(const D of I)for(const N of D.content?.parts||[])N.text&&(P+=N.text);const R=P?`No image generated. Model responded: ${P}`:"No image generated";return k.error(new Error(R)),{error:R}}catch(E){return k.error(E),{error:E.message}}},b2=a=>{const e=a.toLowerCase();return e.includes("front")||e.includes("user")?"user":e.includes("back")||e.includes("rear")||e.includes("environment")?"environment":"unknown"},C2=async(a,e)=>{const{maxDim:t=768,quality:n=.6,outputMime:i="image/jpeg"}=e||{},s=new Image;await new Promise((w,S)=>{s.onload=()=>w(),s.onerror=()=>S(new Error("Image load failed")),s.src=a});const l=s.naturalWidth||1,c=s.naturalHeight||1,h=Math.min(1,t/Math.max(l,c)),d=Math.max(1,Math.round(l*h)),A=Math.max(1,Math.round(c*h)),f=document.createElement("canvas");f.width=d,f.height=A;const p=f.getContext("2d");if(!p)throw new Error("Canvas 2D context not available");return p.drawImage(s,0,0,d,A),{dataUrl:f.toDataURL(i,n),mimeType:i}},S2=async(a,e)=>{const{fps:t=1,maxWidth:n=1920,mimeType:i="video/webm;codecs=vp9,opus"}=e||{},s=document.createElement("video");s.preload="metadata",s.muted=!0,await new Promise((_,K)=>{s.onloadedmetadata=()=>_(),s.onerror=()=>K(new Error("Video metadata load failed")),s.src=a});const l=s.videoWidth||n,c=s.videoHeight||n,h=Math.min(n,l),d=l>0?h/l:1,A=Math.max(1,Math.round(c*d)),f=document.createElement("canvas");f.width=h,f.height=A;const p=f.getContext("2d");if(!p)throw new Error("Canvas 2D context not available for video");const b=Number.isFinite(s.duration)&&s.duration>0?Math.round(s.duration*1e3):NaN;try{e?.onProgress&&e.onProgress(0,Number.isFinite(b)?b:0,Number.isFinite(b)?b:void 0)}catch{}const w=f.captureStream(Math.max(1,t));let S=w;try{let _=[];if(s.captureStream&&(_=s.captureStream().getAudioTracks()),!_.length){const K=window.AudioContext||window.webkitAudioContext,G=new K;try{await G.resume()}catch{}const L=G.createMediaElementSource(s),O=G.createMediaStreamDestination();L.connect(O),_=O.stream.getAudioTracks()}S=new MediaStream([...w.getVideoTracks(),..._])}catch{S=w}const k=new MediaRecorder(S,{mimeType:i}),E=[];k.ondataavailable=_=>{_.data&&_.data.size&&E.push(_.data)};const I=new Promise(_=>{k.onstop=()=>{const K=new Blob(E,{type:i}),G=new FileReader;G.onloadend=()=>_(G.result),G.readAsDataURL(K)}});await s.play().catch(()=>{}),k.start();const P=Math.max(250,Math.round(1e3/Math.max(1,t))),R=window.setInterval(()=>{try{p.drawImage(s,0,0,h,A)}catch{}},P),D=window.setInterval(()=>{try{const _=Math.max(0,Math.round((s.currentTime||0)*1e3)),K=Number.isFinite(b)?b:_||0,G=Number.isFinite(b)?Math.max(0,b-_):void 0;e?.onProgress?.(_,K,G)}catch{}},Math.min(1e3,P));return await new Promise(_=>{s.onended=()=>_(),s.onerror=()=>_()}),window.clearInterval(R),window.clearInterval(D),k.stop(),{dataUrl:await I,mimeType:i}},w2=async(a,e)=>{const{at:t="start",maxDim:n=768,quality:i=.7,outputMime:s="image/jpeg",startOffsetSec:l=.12,endOffsetSec:c=.05}=e||{},h=document.createElement("video");h.preload="metadata",h.muted=!0,await new Promise((N,_)=>{h.onloadedmetadata=()=>N(),h.onerror=()=>_(new Error("Video metadata load failed")),h.src=a});const d=Number.isFinite(h.duration)?h.duration:0,A=.001,f=N=>Math.max(0,d>0?Math.min(N,Math.max(0,d-A)):0),p=()=>t==="middle"?d>0?d*.5:0:t==="end"?d>0?f(d-c):0:f(l),b=async N=>{try{await new Promise(_=>{const K=()=>{h.removeEventListener("seeked",K),_()};h.addEventListener("seeked",K);try{h.currentTime=N}catch{h.play().then(()=>{h.pause();try{h.currentTime=N}catch{}}).catch(()=>{_()})}})}catch{}};await b(p());const w=h.videoWidth||1,S=h.videoHeight||1,k=Math.min(1,n/Math.max(w,S)),E=Math.max(1,Math.round(w*k)),I=Math.max(1,Math.round(S*k)),P=document.createElement("canvas");P.width=E,P.height=I;const R=P.getContext("2d");if(!R)throw new Error("Canvas 2D context not available for keyframe");try{R.drawImage(h,0,0,E,I)}catch{}if(t==="start")try{const N=R.getImageData(0,0,Math.min(32,E),Math.min(32,I));let _=0;const K=N.data;for(let O=0;O<K.length;O+=64){const q=K[O],$=K[O+1],Q=K[O+2];_+=.2126*q+.7152*$+.0722*Q}const G=Math.ceil(K.length/64);if((G>0?_/G:255)<8&&d>0){const O=[f(l+.15),f(l+.3)];for(const q of O){await b(q);try{R.drawImage(h,0,0,E,I)}catch{}const $=R.getImageData(0,0,Math.min(32,E),Math.min(32,I));let Q=0;const Z=$.data;for(let Y=0;Y<Z.length;Y+=64){const ge=Z[Y],me=Z[Y+1],z=Z[Y+2];Q+=.2126*ge+.7152*me+.0722*z}const F=Math.ceil(Z.length/64);if((F>0?Q/F:255)>=8)break}}}catch{}return{dataUrl:P.toDataURL(s,i),mimeType:s}},T2=async(a,e)=>{const{maxDim:t=512,quality:n=.7,overlayText:i="This is you Gemini, Maestro. When you see this avatar in images it is not the user, it is you."}={},s=new Image;await new Promise((E,I)=>{s.onload=()=>E(),s.onerror=()=>I(new Error("Avatar image load failed")),s.src=a});const l=s.naturalWidth||1,c=s.naturalHeight||1,h=Math.min(1,t/Math.max(l,c)),d=Math.max(1,Math.round(l*h)),A=Math.max(1,Math.round(c*h)),f=document.createElement("canvas");f.width=d,f.height=A;const p=f.getContext("2d");if(!p)throw new Error("Canvas 2D context not available");p.drawImage(s,0,0,d,A);const b=Math.max(14,Math.round(A*.06));p.font=`bold ${b}px sans-serif`,p.textAlign="center";const w=Math.round(b*.4),S=b+w*2;return p.fillStyle="rgba(0, 0, 0, 0.6)",p.fillRect(0,A-S,d,S),p.fillStyle="#ffffff",p.fillText(i,d/2,A-w,d-w*2),{dataUrl:f.toDataURL("image/jpeg",n),mimeType:"image/jpeg"}};async function mo(a,e,t){const n=t?.t?t.t("chat.sendPrep.optimizingImage"):"Optimizing image",i=t?.t?t.t("chat.sendPrep.optimizingVideo"):"Optimizing video";try{if(e.startsWith("image/")){t?.onProgress&&t.onProgress(n);const s=await C2(a,{maxDim:768,quality:.6,outputMime:"image/jpeg"});return{dataUrl:s.dataUrl,mimeType:s.mimeType,isOptimized:!0}}else if(e.startsWith("video/")){const s=await S2(a,{fps:1,maxWidth:1920,mimeType:"video/webm",onProgress:(l,c,h)=>{if(t?.onProgress){const d=Math.floor(l/1e3),A=Math.max(d,Math.floor((c||0)/1e3));t.onProgress(i,d,A,h)}}});return{dataUrl:s.dataUrl,mimeType:s.mimeType,isOptimized:!0}}}catch(s){console.warn("Media optimization failed, falling back to original",s)}return{dataUrl:a,mimeType:e,isOptimized:!1}}const k2=a=>{const{t:e,sendWithSnapshotEnabled:t,useVisualContext:n,selectedCameraId:i}=a,s=W(L=>L.setAvailableCameras),l=W(L=>L.setCurrentCameraFacingMode),c=W(L=>L.setLiveVideoStream),h=W(L=>L.setVisualContextCameraError),d=W(L=>L.setSnapshotUserError),A=x.useRef(null),f=x.useRef(null),p=x.useRef([]),[b,w]=x.useState([]),[S,k]=x.useState("unknown"),[E,I]=x.useState(null),[P,R]=x.useState(null),[D,N]=x.useState(null);x.useEffect(()=>{p.current=b,s(b)},[b,s]),x.useEffect(()=>{l(S)},[S,l]),x.useEffect(()=>{c(E)},[E,c]),x.useEffect(()=>{h(P)},[P,h]),x.useEffect(()=>{d(D)},[D,d]),x.useEffect(()=>{const L=i;if(!L){k("unknown");return}const O=p.current.find(q=>q.deviceId===L);k(O?.facingMode||"unknown")},[i]);const _=typeof window<"u"&&!!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),K=x.useCallback(async()=>{try{if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)try{(await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(O=>O.stop())}catch(L){console.warn("Could not get temporary video stream for robust device enumeration:",L)}if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){const q=(await navigator.mediaDevices.enumerateDevices()).filter(Q=>Q.kind==="videoinput").map((Q,Z)=>({deviceId:Q.deviceId,label:Q.label||`Camera ${Z+1}`,facingMode:b2(Q.label)}));w(q);const $=i;if($){const Q=q.find(Z=>Z.deviceId===$);Q?.facingMode&&k(Q.facingMode)}}}catch(L){console.error("Error enumerating video devices:",L),w([])}},[i]);x.useEffect(()=>(K(),navigator.mediaDevices&&navigator.mediaDevices.addEventListener("devicechange",K),()=>{navigator.mediaDevices&&navigator.mediaDevices.removeEventListener("devicechange",K)}),[K]),x.useEffect(()=>{(t||n)&&K()},[t,n,K]),x.useEffect(()=>{const L=async()=>{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){R(e("error.cameraAccessNotSupported"));return}try{f.current&&f.current.getTracks().forEach(Z=>Z.stop());const $=i?{deviceId:{exact:i}}:!0,Q=await navigator.mediaDevices.getUserMedia({video:$});f.current=Q,I(Q),A.current&&(A.current.srcObject=Q,A.current.muted=!0,A.current.playsInline=!0,A.current.play().catch(Z=>{console.error("Error playing visual context video:",Z),R(e("error.visualContextStreamPlayback",{details:Z.message}))})),R(null)}catch($){console.error("Error accessing camera for visual context:",$);let Q=e("error.cameraUnknown");$ instanceof Error&&($.name==="NotAllowedError"||$.name==="PermissionDeniedError"?Q=e("error.cameraPermissionDenied"):$.name==="NotFoundError"||$.name==="DevicesNotFoundError"?Q=e("error.cameraNotFound"):$.name==="OverconstrainedError"?Q=e("error.cameraOverconstrained",{errorMessage:$.message}):Q=e("error.visualContextCameraGeneric",{details:$.message})),R(Q),I(null)}},O=()=>{f.current&&(f.current.getTracks().forEach($=>$.stop()),f.current=null),I(null),A.current&&A.current.srcObject&&(A.current.srcObject=null,A.current.load())};return(n||t)&&i!==Mi?L():(O(),R(null)),()=>{O()}},[n,t,i,e]);const G=x.useCallback(async(L=!1)=>{const O=L?R:N;O(null);const q=A.current;if(!q)return O(e(L?"error.visualContextVideoElementNotReady":"error.snapshotVideoElementNotReady")),null;let $=null,Q=!1;try{let Z=E&&E.active?E:f.current&&f.current.active?f.current:null;if(Z&&q.srcObject===Z&&q.readyState>=HTMLMediaElement.HAVE_ENOUGH_DATA&&q.videoWidth>0&&q.videoHeight>0)$=Z;else{if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)return O(e(L?"error.visualContextCameraAccessNotSupported":"error.snapshotCameraAccessNotSupported")),null;const ge=i?{deviceId:{exact:i}}:!0;$=await navigator.mediaDevices.getUserMedia({video:ge}),Q=!0,q.srcObject=$,q.muted=!0,q.playsInline=!0,await q.play(),await new Promise((me,z)=>{const H=L?"error.visualContextTimeout":"error.snapshotTimeout",j=L?"error.visualContextVideoDimensionsZero":"error.snapshotVideoDimensionsZero",le=L?"error.visualContextVideoError":"error.snapshotVideoError",te=setTimeout(()=>z(new Error(e(H))),3e3),oe=()=>{clearTimeout(te),q.videoWidth>0&&q.videoHeight>0?me(void 0):z(new Error(e(j)))};q.onloadeddata=oe,q.onerror=()=>{clearTimeout(te),z(new Error(e(le)))},q.readyState>=HTMLMediaElement.HAVE_ENOUGH_DATA&&q.videoWidth>0&&q.videoHeight>0&&(clearTimeout(te),me(void 0))})}const F=document.createElement("canvas");F.width=q.videoWidth,F.height=q.videoHeight;const U=F.getContext("2d");if(!U)throw new Error(e(L?"error.visualContext2DContext":"error.snapshot2DContext"));U.drawImage(q,0,0,F.width,F.height);const Y=F.toDataURL("image/jpeg",.9);return{base64:Y,mimeType:"image/jpeg",storageOptimizedBase64:Y,storageOptimizedMimeType:"image/jpeg"}}catch(Z){console.error(`Error capturing image (${L?"re-engagement":"snapshot"}):`,Z);const F=Z instanceof Error?Z.message:e("error.imageCaptureGeneric"),U=L?"error.visualContextCaptureFailed":"error.snapshotCaptureFailed";return F.includes("Permission")||F.includes("NotAllowedError")?O(e(`${U}Permission`)):F.includes("NotFoundError")||F.includes("DevicesNotFoundError")?O(e(`${U}NotFound`)):F.includes("Timeout")||F.includes("dimensions zero")||F.includes("Video element error")?O(e(`${U}NotReady`,{details:F})):O(e(`${U}Generic`,{details:F})),null}finally{$&&Q&&($.getTracks().forEach(Z=>Z.stop()),q.srcObject===$&&!((n||E)&&f.current===$)&&(q.srcObject=null,q.load()))}},[e,E,i,n]);return{availableCameras:b,availableCamerasRef:p,currentCameraFacingMode:S,liveVideoStream:E,setLiveVideoStream:I,visualContextVideoRef:A,visualContextStreamRef:f,visualContextCameraError:P,setVisualContextCameraError:R,snapshotUserError:D,setSnapshotUserError:N,captureSnapshot:G,fetchAvailableCameras:K,microphoneApiAvailable:_}},E2=({videoRef:a})=>T.jsx("video",{ref:a,playsInline:!0,muted:!0,className:"hidden w-px h-px"}),YC=2880*60*1e3-300*1e3;let ff=null,pf=null,Ou=0,mf=null,vf=null,Hu=0;const x2={rawUri:null,rawMimeType:null,overlayUri:null,overlayMimeType:null},P2=()=>{ff=null,pf=null,Ou=0,mf=null,vf=null,Hu=0},M2=async()=>{const a=await Wl();if(!a?.dataUrl)return x2;const e=a.mimeType||"image/png";let t=ff,n=pf;const i=Ou>0?Date.now()-Ou:Number.POSITIVE_INFINITY;if(!t||i>YC){let h=!0;if(a.uri)try{const A=(await rp([a.uri]))[a.uri];A&&!A.deleted&&A.active&&(t=a.uri,n=e,h=!1)}catch{}if(h){const d=await Ai(a.dataUrl,e,"maestro-avatar");t=d.uri,n=d.mimeType||e,await Po({dataUrl:a.dataUrl,mimeType:n,uri:t,updatedAt:Date.now()});try{window.dispatchEvent(new CustomEvent("maestro-avatar-updated",{detail:{dataUrl:a.dataUrl,mimeType:n,uri:t}}))}catch{}}ff=t,pf=n,Ou=Date.now()}let s=mf,l=vf;const c=Hu>0?Date.now()-Hu:Number.POSITIVE_INFINITY;if(!s||c>YC){const h=await T2(a.dataUrl),d=await Ai(h.dataUrl,h.mimeType,"maestro-avatar-overlay");s=d.uri,l=d.mimeType||h.mimeType,mf=s,vf=l,Hu=Date.now()}return{rawUri:t,rawMimeType:n,overlayUri:s,overlayMimeType:l}},cp="maestro_costTracking",up="maestro_costWarningShown",I2="https://console.cloud.google.com/billing",D2=[{pattern:"gemini-3-flash",pricing:{inputPerMillion:.5,outputPerMillion:3}},{pattern:"gemini-2.5-flash",pricing:{inputPerMillion:.3,outputPerMillion:2.5}},{pattern:"gemini-2.0-flash",pricing:{inputPerMillion:.1,outputPerMillion:.4}}],_2={inputPerMillion:.5,outputPerMillion:3},R2=.039,N2=a=>{const e=a.toLowerCase();for(const t of D2)if(e.includes(t.pattern))return t.pricing;return _2},dp=()=>{try{const a=localStorage.getItem(cp);if(!a)return{inputTokens:0,outputTokens:0,imageGenCount:0,totalCostUsd:0};const e=JSON.parse(a);return{inputTokens:e.inputTokens||0,outputTokens:e.outputTokens||0,imageGenCount:e.imageGenCount||0,totalCostUsd:e.totalCostUsd||0}}catch{return{inputTokens:0,outputTokens:0,imageGenCount:0,totalCostUsd:0}}},UT=a=>{try{localStorage.setItem(cp,JSON.stringify(a))}catch{}},Tg=(a,e)=>{if(!e)return;const t=e.promptTokenCount||0,n=e.candidatesTokenCount||0;if(t===0&&n===0)return;const i=N2(a),s=t/1e6*i.inputPerMillion+n/1e6*i.outputPerMillion,l=dp();l.inputTokens+=t,l.outputTokens+=n,l.totalCostUsd+=s,UT(l)},XC=()=>{const a=dp();a.imageGenCount+=1,a.totalCostUsd+=R2,UT(a)},G2=()=>dp(),L2=()=>{try{localStorage.removeItem(cp),localStorage.removeItem(up)}catch{}},WC=()=>{try{return localStorage.getItem(up)==="1"}catch{return!1}},$C=()=>{try{localStorage.setItem(up,"1")}catch{}},KT=a=>{if(!a)return"";const e=a.trim();if(!e)return"";try{const n=JSON.parse(e)?.error?.message;if(typeof n=="string"&&n.trim())return n.trim()}catch{}return e},JC=a=>{if(a.status===429)return!0;const e=(a.code??"").toString().toLowerCase();if(e==="429"||e.includes("resource_exhausted")||e.includes("quota"))return!0;const t=KT(a.message).toLowerCase();return t.includes("resource_exhausted")||t.includes("exceeded your current quota")||t.includes("rate limit")||t.includes("quota")},B2=a=>{const e=(a.message||"").toLowerCase();return e.includes("api_key_invalid")||e.includes("api key not valid")},F2=a=>{const{t:e,setSettings:t,addMessage:n,updateMessage:i,setMessages:s,getHistoryRespectingBookmark:l,computeMaxMessagesForArray:c,captureSnapshot:h,speakMessage:d,isSpeechSynthesisSupported:A,isListening:f,stopListening:p,startListening:b,clearTranscript:w,hasPendingQueueItems:S,claimRecordedUtterance:k,scheduleReengagementRef:E,cancelReengagementRef:I,transcript:P,currentSystemPromptText:R,currentReplySuggestionsPromptText:D,setReplySuggestions:N,handleToggleSuggestionModeRef:_,maestroAvatarUriRef:K,maestroAvatarMimeTypeRef:G,setSnapshotUserError:L,onApiKeyGateOpen:O}=a,q=W(se=>se.setLastFetchedSuggestionsFor),$=W(se=>se.setRecordedUtterancePending),Q=W(se=>se.setPendingRecordedAudioMessageId),Z=W(se=>se.setSttInterruptedBySend),F=x.useMemo(()=>aa(W.getState,se=>se.settings),[]),U=x.useMemo(()=>aa(W.getState,lr),[]),Y=x.useMemo(()=>aa(W.getState,se=>se.messages),[]),ge=x.useMemo(()=>aa(W.getState,se=>se.isLoadingHistory),[]),me=x.useMemo(()=>aa(W.getState,_o),[]),z=x.useMemo(()=>({get current(){return W.getState().lastFetchedSuggestionsFor},set current(se){q(se)}}),[q]),H=x.useMemo(()=>({get current(){return W.getState().recordedUtterancePending},set current(se){$(se)}}),[$]),j=x.useMemo(()=>({get current(){return W.getState().pendingRecordedAudioMessageId},set current(se){Q(se)}}),[Q]),le=x.useMemo(()=>({get current(){return W.getState().sttInterruptedBySend},set current(se){Z(se)}}),[Z]),{sendPrep:te,latestGroundingChunks:oe,maestroActivityStage:ce,imageLoadDurations:Ge,attachedImageBase64:ae,attachedImageMimeType:Le}=W(zf(se=>({sendPrep:se.sendPrep,latestGroundingChunks:se.latestGroundingChunks,maestroActivityStage:se.maestroActivityStage,imageLoadDurations:se.imageLoadDurations,attachedImageBase64:se.attachedImageBase64,attachedImageMimeType:se.attachedImageMimeType}))),De=W(nr),ue=W(_d),ne=W(Of),fe=W(se=>se.setSendPrep),Te=W(se=>se.setLatestGroundingChunks),pe=W(se=>se.addImageLoadDuration),ye=W(se=>se.setAttachedImage),Ie=W(se=>se.setMaestroActivityStage),qe=W(se=>se.addActivityToken),Re=W(se=>se.removeActivityToken),et=x.useRef(!1),Ye=x.useRef(!1),Qe=x.useRef(null),st=x.useRef(null),yt=x.useRef(!0),ft=x.useRef(null),Ue=x.useRef(null),Be=x.useRef(null);x.useEffect(()=>{et.current=De},[De]),x.useEffect(()=>{st.current=te},[te]),x.useEffect(()=>()=>{yt.current=!1},[]),x.useEffect(()=>{const se=()=>{P2()};return window.addEventListener("maestro-avatar-updated",se),()=>window.removeEventListener("maestro-avatar-updated",se)},[]);const it=x.useCallback(se=>typeof se!="string"?"":se.replace(/\[[^\]]*\]/g," ").replace(/\s+/g," ").trim(),[]),mt=x.useCallback(se=>{if(typeof se!="string"||!se.trim()||!U.current)return[];const _e=se.split(`
`).map(je=>je.trim()).filter(je=>je),He=[],Ke=`[${mw(U.current.nativeLanguageCode)}]`;for(let je=0;je<_e.length;je++){const X=_e[je];if(X.startsWith(Ke))He.push({target:"",native:X.substring(Ke.length).trim()});else{let xe=X,Fe="";je+1<_e.length&&_e[je+1].startsWith(Ke)&&(Fe=_e[je+1].substring(Ke.length).trim(),je++),He.push({target:xe,native:Fe})}}return He.length===0&&se.trim()&&He.push({target:se.trim(),native:""}),He},[U]),Rt=x.useCallback(()=>{const se=F.current.historyBookmarkMessageId;if(!se)return null;const _e=Y.current,He=_e.findIndex(je=>je.id===se);if(He===-1)return null;let Ke=_e[He]&&typeof _e[He].chatSummary=="string"?_e[He].chatSummary.trim():void 0;if(!Ke)for(let je=He;je>=0;je--){const X=_e[je];if(X.role==="assistant"&&typeof X.chatSummary=="string"&&X.chatSummary.trim()){Ke=X.chatSummary.trim();break}}return!Ke||!Ke.trim()?null:Ke.trim()},[F,Y]),Qt=x.useCallback(se=>{let _e=l(se).filter(dd);const He=c(_e);return typeof He=="number"&&(_e=_e.slice(-Math.max(0,He))),_e},[l,c]),dt=x.useCallback(async(se,_e)=>{const He=Qt(se),Ke=[];for(let Pe=0;Pe<He.length;Pe++){const Ne=He[Pe];(Ne.storageOptimizedImageUrl&&Ne.storageOptimizedImageMimeType||Ne.imageUrl&&Ne.imageMimeType||Ne.uploadedFileUri&&Ne.uploadedFileMimeType)&&Ke.push(Pe)}const je=new Set(Ke.slice(-10)),X=[];for(let Pe=0;Pe<He.length;Pe++){if(!je.has(Pe))continue;const Ne=He[Pe],Je=Ne.uploadedFileUri,qt=Ne.uploadedFileMimeType;Je&&qt&&X.push(Je)}let xe={};try{const Pe=Array.from(new Set(X));Pe.length&&(xe=await rp(Pe))}catch{xe={}}let Fe=0;for(let Pe=0;Pe<He.length;Pe++){if(!je.has(Pe))continue;const Ne=He[Pe],Je=Ne.storageOptimizedImageUrl,qt=Ne.storageOptimizedImageMimeType,xt=Ne.imageUrl,vn=Ne.imageMimeType,Yt=Ne.uploadedFileUri,Xt=Ne.uploadedFileMimeType,yn=!!(Je&&qt||xt&&vn),ct=!(Yt&&Xt),vt=!!(Yt&&xe[Yt]?.deleted);(ct||vt)&&yn&&Fe++}let Me=0;const at=Date.now(),Ve=()=>{if(!_e)return;const Pe=Date.now()-at,Ne=Me>0?Pe/Me:void 0,Je=Math.max(0,Fe-Me),qt=Ne!==void 0?Math.round(Ne*Je):void 0;_e(Me,Fe,qt)},Oe={};for(let Pe=0;Pe<He.length;Pe++){if(!je.has(Pe))continue;const Ne=He[Pe],Je=Ne.storageOptimizedImageUrl,qt=Ne.storageOptimizedImageMimeType,xt=Ne.imageUrl,vn=Ne.imageMimeType,Yt=Ne.uploadedFileUri,Xt=Ne.uploadedFileMimeType,yn=!!(Je&&qt)||!!(xt&&vn);let ct=!1;if(Yt&&Xt)try{const Lt=xe&&xe[Yt];ct=!!(Lt&&Lt.deleted)}catch{ct=!1}if(ct&&!yn){console.warn(`[ensureUris] Message ${Ne.id} has expired uploadedFileUri but no data URL to re-upload. Media will be omitted from API payload.`);continue}if(!yn||Yt&&Xt&&!ct)continue;let vt=null;try{if(Je&&qt)vt={dataUrl:Je,mimeType:qt};else if(xt&&vn){vt={dataUrl:xt,mimeType:vn};try{const Lt=await mo(xt,vn,{t:e});i(Ne.id,{storageOptimizedImageUrl:Lt.dataUrl,storageOptimizedImageMimeType:Lt.mimeType})}catch{}}if(vt){const Lt=await Ai(vt.dataUrl,vt.mimeType,"send-history");i(Ne.id,{uploadedFileUri:Lt.uri,uploadedFileMimeType:Lt.mimeType}),Ne.uploadedFileUri=Lt.uri,Ne.uploadedFileMimeType=Lt.mimeType,Oe[Ne.id]={oldUri:Yt,newUri:Lt.uri}}}catch(Lt){console.warn("Pre-send URI ensure failed for message",Ne.id,Lt)}try{Me++,Ve()}catch{}await new Promise(Lt=>setTimeout(Lt,0))}return Oe},[Qt,i,e]),Mt=x.useCallback(se=>{t(_e=>{const He={..._e,smartReengagement:{..._e.smartReengagement,thresholdSeconds:se}};return zl(He).catch(()=>{}),He})},[t]),Bt=x.useCallback(()=>Ge.length>0?Ge.reduce((_e,He)=>_e+He,0)/Ge.length/1e3:15,[Ge]),Ce=x.useCallback(async(se,_e,He)=>{if(ue){N([]),Ue.current&&(Re(Ue.current),Ue.current=null);return}if(!_e.trim()||!U.current){N([]);return}{const at=Y.current,Ve=at.findIndex(Oe=>Oe.id===se);if(Ve!==-1){const Oe=at[Ve];if(Oe&&Array.isArray(Oe.replySuggestions)&&Oe.replySuggestions.length>0){N(Oe.replySuggestions),Ue.current&&(Re(Ue.current),Ue.current=null);return}}}Ue.current=qe(mn.GEN,_t.SUGGESTIONS),N([]);const Ke=l(He).filter(at=>at.role==="user"||at.role==="assistant").slice(-6).map(at=>at.role==="user"?`User: ${at.text||"(sent an image)"}`:`Tutor: ${at.translations?.[0]?.target||at.rawAssistantResponse||at.text||"(sent an image)"}`).join(`
`),je=Y.current;let X="";{const at=je.findIndex(Oe=>Oe.id===se),Ve=at===-1?je.length-1:at-1;for(let Oe=Ve;Oe>=0;Oe--){const Pe=je[Oe];if(Pe.role==="assistant"&&typeof Pe.chatSummary=="string"&&Pe.chatSummary.trim()){X=Pe.chatSummary.trim();break}}}let xe="";try{xe=(await Gr())?.text||""}catch{xe=""}let Fe=D.replace("{tutor_message_placeholder}",_e).replace("{conversation_history_placeholder}",Ke||"No history yet.").replace("{previous_chat_summary_placeholder}",X||"").replace("{existing_global_profile_placeholder}",xe||"(none)");const Me=2;for(let at=0;at<=Me;at++)try{const Ve=await QC(xi().text.aux,Fe,[],void 0,void 0,void 0,void 0,!1,{responseMimeType:"application/json"});Tg(xi().text.aux,Ve.usageMetadata);let Oe=(Ve.text||"").trim();const Pe=/^```(\w*)?\s*\n?(.*?)\n?\s*```$/s,Ne=Oe.match(Pe);if(Ne&&Ne[2])Oe=Ne[2].trim();else{const xt=Oe.indexOf("{"),vn=Oe.lastIndexOf("}");xt!==-1&&vn!==-1&&(Oe=Oe.substring(xt,vn+1))}const Je=JSON.parse(Oe);if(Array.isArray(Je.suggestions)&&Je.suggestions.every(xt=>typeof xt=="object"&&xt!==null&&"target"in xt&&"native"in xt&&typeof xt.target=="string"&&typeof xt.native=="string")){const xt=Je.suggestions;N(xt),i(se,{replySuggestions:xt});try{const vn=F.current.selectedLanguagePairId;vn&&await er(vn,Y.current)}catch{}}else console.warn("Parsed suggestions not in expected format:",Je.suggestions),N([]);typeof Je.reengagementSeconds=="number"&&Je.reengagementSeconds>=5&&Mt(Je.reengagementSeconds);const qt=typeof Je.chatSummary=="string"?Je.chatSummary.trim():"";qt&&i(se,{chatSummary:qt});try{const xt=typeof Je.globalProfile=="string"?Je.globalProfile.trim().slice(0,1e4):"";if(xt){await Vf(xt);try{window.dispatchEvent(new CustomEvent("globalProfileUpdated"))}catch{}}}catch(xt){console.warn("Failed to update global profile:",xt)}break}catch(Ve){console.error(`Error fetching reply suggestions (attempt ${at+1}/${Me+1}):`,Ve),at<Me?await new Promise(Oe=>setTimeout(Oe,500*(at+1))):N([])}Ue.current&&(Re(Ue.current),Ue.current=null)},[D,Mt,l,Y,U,F,ue,qe,Re,N,i]),lt=x.useCallback(async se=>{const _e=it(se);if(!_e||!U.current)return;Be.current=qe(mn.GEN,_t.CREATE_SUGGESTION);const He=F.current.stt.language,Ke=Xl(He),je=Xl(U.current.targetLanguageCode);let X,xe,Fe;Ke===je?(X=U.current.targetLanguageName,xe=U.current.nativeLanguageName,Fe=!0):(X=U.current.nativeLanguageName,xe=U.current.targetLanguageName,Fe=!1);try{const{translatedText:Me,usageMetadata:at}=await m2(_e,X,xe);Tg(xi().text.translation,at);const Ve={target:Fe?_e:Me,native:Fe?Me:_e},Oe=Ne=>Ne.target===Ve.target&&Ne.native===Ve.native;N(Ne=>Ne.some(Oe)?Ne:[Ve,...Ne]);const Pe=z.current||Y.current.slice().reverse().find(Ne=>Ne.role==="assistant"&&!Ne.thinking)?.id;Pe&&(z.current||(z.current=Pe),s(Ne=>Ne.map(Je=>{if(Je.id===Pe){const qt=Je.replySuggestions||[];return qt.some(Oe)?Je:{...Je,replySuggestions:[Ve,...qt]}}return Je})))}catch(Me){console.error("Failed to create suggestion via translation:",Me),n({role:"error",text:e("error.translationFailed")})}finally{Be.current&&(Re(Be.current),Be.current=null),_?.current&&_.current(!1)}},[n,e,it,U,F,z,Y,s,N,_,qe,Re]),ht=x.useCallback((se,_e)=>{U.current&&(me.current||!se.target&&se.native)},[U,me]),wt=x.useCallback((se,_e,He)=>{Ce(se,_e,He),z.current=se},[Ce,z]),tn=x.useCallback(async se=>{const _e=await mo(se.dataUrl,se.mimeType,{t:e,onProgress:se.onProgress});Ye.current=!0,se.setUploadPrepLabel!==!1&&fe(Ke=>Ke&&Ke.active?{...Ke,label:e("chat.sendPrep.uploadingMedia")||"Uploading media..."}:{active:!0,label:e("chat.sendPrep.uploadingMedia")||"Uploading media..."});const He=await Ai(se.dataUrl,se.mimeType,se.displayName);return{optimized:_e,upload:He}},[e,fe]),Sn=x.useCallback(async se=>{let _e=null,He=se.sanitizedText,Ke=null,je=typeof se.passedImageBase64=="string"&&se.passedImageBase64?se.passedImageBase64:void 0,X=typeof se.passedImageMimeType=="string"&&se.passedImageMimeType?se.passedImageMimeType:void 0,xe,Fe;if(se.messageType!=="user")return{userMessageId:_e,userMessageText:He,recordedSpeechForMessage:Ke,userImageToProcessBase64:je,userImageToProcessMimeType:X,userImageToProcessStorageOptimizedBase64:xe,userImageToProcessStorageOptimizedMimeType:Fe};for(let Ve=0;Ve<2;Ve++){const Oe=typeof k=="function"?k():null;if(Oe&&typeof Oe.dataUrl=="string"&&Oe.dataUrl.length>0){Ke=Oe,H.current=null;break}if(H.current&&typeof H.current.dataUrl=="string"&&H.current.dataUrl.length>0){Ke=H.current,H.current=null;break}Ve===0&&await new Promise(Pe=>setTimeout(Pe,60))}if(Ke&&Ke.dataUrl.length>Do&&(Ke=null),se.currentSettingsVal.sendWithSnapshotEnabled&&!je&&!se.shouldGenerateUserImage){const Ve=await h(!1);Ve&&(je=Ve.base64,X=Ve.mimeType,xe=Ve.storageOptimizedBase64,Fe=Ve.storageOptimizedMimeType)}const Me=typeof se.passedImageBase64=="string"&&se.passedImageBase64?se.passedImageBase64:ae,at=typeof se.passedImageMimeType=="string"&&se.passedImageMimeType?se.passedImageMimeType:Le;if(Me&&at&&at.startsWith("video/"))try{const Ve=await w2(Me,{at:"start",maxDim:768,quality:.75,outputMime:"image/jpeg"}),Oe=n({role:"user",text:He,imageUrl:Ve.dataUrl,imageMimeType:Ve.mimeType});try{Ye.current||(Ye.current=!0),i(Oe,{storageOptimizedImageUrl:Ve.dataUrl,storageOptimizedImageMimeType:Ve.mimeType});const Pe=await Ai(Ve.dataUrl,Ve.mimeType,"keyframe-image");i(Oe,{uploadedFileUri:Pe.uri,uploadedFileMimeType:Pe.mimeType})}catch{}He="",je=Me,X=at}catch(Ve){console.warn("Failed to create keyframe from video; proceeding without keyframe image message",Ve)}if(!xe&&ae&&Le)try{Ye.current||(Ye.current=!0),fe({active:!0,label:e("chat.sendPrep.optimizingImage")||"Optimizing..."});const Ve=await mo(ae,Le,{t:e,onProgress:(Oe,Pe,Ne,Je)=>{fe({active:!0,label:Oe,done:Pe,total:Ne,etaMs:Je})}});xe=Ve.dataUrl,Fe=Ve.mimeType}catch{}return _e=n({role:"user",text:He,recordedUtterance:Ke||void 0,imageUrl:je,imageMimeType:X,storageOptimizedImageUrl:xe,storageOptimizedImageMimeType:Fe}),{userMessageId:_e,userMessageText:He,recordedSpeechForMessage:Ke,userImageToProcessBase64:je,userImageToProcessMimeType:X,userImageToProcessStorageOptimizedBase64:xe,userImageToProcessStorageOptimizedMimeType:Fe}},[n,ae,Le,h,k,H,Ye,fe,e,i]),wn=x.useCallback(async se=>{const _e=await QC(xi().text.default,se.geminiPromptText,se.sanitizedDerivedHistory,se.systemInstructionForGemini,void 0,se.imageForGeminiContextMimeType,se.imageForGeminiContextFileUri,se.currentSettingsVal.enableGoogleSearch,void 0);Tg(xi().text.default,_e.usageMetadata);const He=_e.text||"",Ke=mt(He),je=_e.candidates?.[0]?.groundingMetadata?.groundingChunks;je?.length&&Te(je);const X={thinking:!1,translations:Ke.length>0?Ke:void 0,rawAssistantResponse:He,text:Ke.length===0?He:void 0};return i(se.thinkingMessageId,X),{accumulatedFullText:He,finalMessageUpdates:X}},[mt,Te,i]),cn=x.useCallback(async se=>{if(!se.shouldGenerateUserImage||!se.currentSettingsVal.imageGenerationModeEnabled||!se.currentSettingsVal.sendWithSnapshotEnabled||se.messageType!=="user"||!se.userMessageText.trim()||!se.userMessageId||se.userImageToProcessBase64)return{};const _e=Date.now();i(se.userMessageId,{isGeneratingImage:!0,imageGenerationStartTime:_e,imageUrl:void 0,imageMimeType:void 0});const He=se.sanitizedDerivedHistory;let Ke=null;for(let je=0;je<7;je++){const X=qg.replace("{TEXT}",se.userMessageText),xe=await Fl({history:He,latestMessageText:X,systemInstruction:Qg,maestroAvatarUri:K.current||void 0,maestroAvatarMimeType:G.current||void 0});if(Ke=xe,"base64Image"in xe)break;je<6&&await new Promise(Fe=>setTimeout(Fe,1500))}if(Ke&&"base64Image"in Ke){const je=Date.now()-_e;pe(je),XC(),WC()||($C(),n({role:"error",text:e("error.imageGenCostWarning"),errorAction:"imageGenCost"}));try{const{optimized:X,upload:xe}=await tn({dataUrl:Ke.base64Image,mimeType:Ke.mimeType,displayName:"user-generated"});return i(se.userMessageId,{imageUrl:Ke.base64Image,imageMimeType:Ke.mimeType,storageOptimizedImageUrl:X.dataUrl,storageOptimizedImageMimeType:X.mimeType,uploadedFileUri:xe.uri,uploadedFileMimeType:xe.mimeType,isGeneratingImage:!1,imageGenError:null,imageGenerationStartTime:void 0}),{imageForGeminiContextFileUri:xe.uri,imageForGeminiContextMimeType:xe.mimeType}}catch{i(se.userMessageId,{imageUrl:Ke.base64Image,imageMimeType:Ke.mimeType,isGeneratingImage:!1,imageGenError:null,imageGenerationStartTime:void 0})}finally{fe(X=>X&&X.active?{...X,label:e("chat.sendPrep.preparingMedia")||"Preparing media..."}:X)}}else i(se.userMessageId,{isGeneratingImage:!1,imageGenerationStartTime:void 0});return{}},[n,Fl,G,K,tn,pe,fe,e,i]),bt=x.useCallback(async se=>{if(!se.currentSettingsVal.imageGenerationModeEnabled||!se.accumulatedFullText.trim())return;const _e=Date.now();i(se.thinkingMessageId,{isGeneratingImage:!0,imageGenerationStartTime:_e});const He=l(Y.current).filter(je=>je.id!==se.thinkingMessageId);let Ke;try{Ye.current=!0,fe({active:!0,label:e("chat.sendPrep.preparingMedia")||"Preparing media...",done:0,total:0});const je=await dt(He,(X,xe,Fe)=>{fe({active:!0,label:e("chat.sendPrep.preparingMedia")||"Preparing media...",done:X,total:xe,etaMs:Fe})});Ke=He.map(X=>{const xe=je[X.id];return xe&&xe.newUri&&X.uploadedFileUri!==xe.newUri?{...X,uploadedFileUri:xe.newUri}:X}),await new Promise(X=>setTimeout(X,0))}catch{}for(let je=0;je<7;je++){const X=Ke||He;let xe;try{xe=(await Gr())?.text||void 0}catch{}const Fe=Ad(X,{maxMessages:c(He.filter(Oe=>Oe.role==="user"||Oe.role==="assistant")),maxMediaToKeep:ud,contextSummary:Rt()||void 0,globalProfileText:xe,placeholderLatestUserMessage:pw}),Me=await uf(Fe),at=qg.replace("{TEXT}",se.accumulatedFullText),Ve=await Fl({history:Me,latestMessageText:at,systemInstruction:Qg,maestroAvatarUri:K.current||void 0,maestroAvatarMimeType:G.current||void 0});if("base64Image"in Ve){const Oe=Date.now()-_e;pe(Oe),XC(),WC()||($C(),n({role:"error",text:e("error.imageGenCostWarning"),errorAction:"imageGenCost"}));try{const{optimized:Pe,upload:Ne}=await tn({dataUrl:Ve.base64Image,mimeType:Ve.mimeType,displayName:"assistant-generated",setUploadPrepLabel:!1});i(se.thinkingMessageId,{imageUrl:Ve.base64Image,imageMimeType:Ve.mimeType,storageOptimizedImageUrl:Pe.dataUrl,storageOptimizedImageMimeType:Pe.mimeType,uploadedFileUri:Ne.uri,uploadedFileMimeType:Ne.mimeType,isGeneratingImage:!1,imageGenError:null,imageGenerationStartTime:void 0})}catch{i(se.thinkingMessageId,{imageUrl:Ve.base64Image,imageMimeType:Ve.mimeType,isGeneratingImage:!1,imageGenError:null,imageGenerationStartTime:void 0})}break}else je<6?await new Promise(Oe=>setTimeout(Oe,1500)):i(se.thinkingMessageId,{isGeneratingImage:!1,imageGenerationStartTime:void 0})}},[n,c,dt,Fl,l,G,K,Y,tn,Rt,pe,fe,e,i]),Wt=x.useCallback(async(se,_e,He,Ke="user")=>{if(ge.current)return!1;const je=it(se);if(!je&&!_e&&Ke==="user")return!1;if(!U.current)return console.error("No language pair selected, cannot send message."),n({role:"error",text:e("error.noLanguagePair")}),!1;if(et.current||me.current)return!1;if(ft.current=qe(mn.GEN,_t.RESPONSE),F.current.stt.enabled&&f){try{p()}catch{}le.current=!0,w()}else le.current=!1;Ye.current=!0,N([]),Ue.current&&(Re(Ue.current),Ue.current=null),z.current=null,Ke==="user"&&L&&L(null),j.current=null;const X=F.current,xe=X.selectedCameraId===Mi,Fe=await Sn({sanitizedText:je,passedImageBase64:_e,passedImageMimeType:He,messageType:Ke,shouldGenerateUserImage:xe,currentSettingsVal:X});let{userMessageId:Me,userMessageText:at,userImageToProcessBase64:Ve,userImageToProcessMimeType:Oe,userImageToProcessStorageOptimizedBase64:Pe,userImageToProcessStorageOptimizedMimeType:Ne}=Fe;const Je=n({role:"assistant",thinking:!0});I.current();let qt=Y.current.filter(ct=>ct.id!==Je);Ke==="user"&&Me&&(qt=qt.filter(ct=>ct.id!==Me));let xt,vn=R;try{await Gr()}finally{vn=WM(vn)}if(Ke==="user"&&Ve&&!Pe&&Oe){Ye.current||(Ye.current=!0);try{fe({active:!0,label:e("chat.sendPrep.preparingMedia")||"Preparing media..."});const ct=await mo(Ve,Oe,{t:e,onProgress:(vt,Lt,Rn,qn)=>fe({active:!0,label:vt,done:Lt,total:Rn,etaMs:qn})});Pe=ct.dataUrl,Ne=ct.mimeType,Ke==="user"&&Me&&i(Me,{storageOptimizedImageUrl:ct.dataUrl,storageOptimizedImageMimeType:ct.mimeType})}catch(ct){console.warn("Failed to derive low-res for current user media, will omit persistence media",ct)}finally{fe(ct=>ct&&ct.active?{...ct,label:e("chat.sendPrep.preparingMedia")||"Preparing media..."}:ct)}}let Yt,Xt;Ke==="user"?Ve?(Yt=Ve,Xt=Oe):(Yt=Pe,Xt=Ne):(Yt=typeof _e=="string"&&_e?_e:void 0,Xt=typeof He=="string"&&He?He:void 0);let yn;switch(Ke){case"image-reengagement":xt="...";break;case"conversational-reengagement":xt="...",Yt=void 0,Xt=void 0;break;default:xt=at;break}if(Ke==="image-reengagement"&&typeof _e=="string"&&_e&&typeof He=="string"&&He&&(Yt=_e,Xt=He),Yt&&Xt)try{Ye.current||(Ye.current=!0),fe({active:!0,label:e("chat.sendPrep.uploadingMedia")||"Uploading media..."});const ct=await Ai(Yt,Xt,"current-user-media");if(Xt=ct.mimeType,Ke==="user"&&Me){const vt=(Y.current||[]).find(Rn=>Rn.id===Me);!!(vt&&typeof vt.uploadedFileUri=="string"&&vt.uploadedFileUri)?(yn=vt.uploadedFileUri,Xt=vt.uploadedFileMimeType||Xt):(i(Me,{uploadedFileUri:ct.uri,uploadedFileMimeType:ct.mimeType}),yn=ct.uri)}else yn=ct.uri}catch{console.warn("Failed to upload current media to Files API; will send without media"),yn=void 0}finally{fe(ct=>ct&&ct.active?{...ct,label:e("chat.sendPrep.preparingMedia")||"Preparing media..."}:ct)}Te(void 0);try{const ct=l(qt);fe({active:!0,label:e("chat.sendPrep.preparingMedia")||"Preparing media...",done:0,total:0});let vt={};try{vt=await dt(ct,(tt,$t,bn)=>{fe({active:!0,label:e("chat.sendPrep.preparingMedia")||"Preparing media...",done:tt,total:$t,etaMs:bn})})}finally{fe(tt=>tt&&tt.active?{...tt,label:e("chat.sendPrep.finalizing")||"Finalizing..."}:tt)}let Lt=Y.current.filter(tt=>tt.id!==Je);Ke==="user"&&Me&&(Lt=Lt.filter(tt=>tt.id!==Me));const Rn=l(Lt).map(tt=>{if(vt[tt.id]?.newUri){const $t=vt[tt.id].newUri;if(tt.uploadedFileUri!==$t)return{...tt,uploadedFileUri:$t}}return tt});try{for(const tt of Rn){const $t=vt[tt.id];$t&&$t.newUri&&tt.uploadedFileUri!==$t.newUri&&(tt.uploadedFileUri=$t.newUri)}}catch{}let qn;try{qn=(await Gr())?.text||void 0}catch{}let Nt,li;try{const tt=await M2();tt.rawUri&&(K.current=tt.rawUri,G.current=tt.rawMimeType),Nt=tt.overlayUri||void 0,li=tt.overlayMimeType||void 0}catch(tt){console.warn("Failed to ensure Maestro avatar URIs:",tt)}const Ha=Ad(Rn,{maxMessages:c(Rn.filter(tt=>tt.role==="user"||tt.role==="assistant")),maxMediaToKeep:ud,contextSummary:Rt()||void 0,globalProfileText:qn,avatarOverlayFileUri:Nt,avatarOverlayMimeType:li}),$n=await uf(Ha),ze=await cn({shouldGenerateUserImage:xe,currentSettingsVal:X,messageType:Ke,userMessageText:at,userMessageId:Me,userImageToProcessBase64:Ve,sanitizedDerivedHistory:$n});ze.imageForGeminiContextFileUri&&(yn=ze.imageForGeminiContextFileUri,Xt=ze.imageForGeminiContextMimeType);const{accumulatedFullText:Ct,finalMessageUpdates:Ft}=await wn({thinkingMessageId:Je,geminiPromptText:xt,sanitizedDerivedHistory:$n,systemInstructionForGemini:vn,imageForGeminiContextMimeType:Xt,imageForGeminiContextFileUri:yn,currentSettingsVal:X});try{const tt=Ft.rawAssistantResponse||Ft.translations?.find($t=>$t.target)?.target||"";if(!Ue.current&&tt.trim()){const $t=Y.current.map(bn=>bn.id===Je?{...bn,...Ft}:bn);wt(Je,tt,l($t))}}catch(tt){console.warn("Failed to prefetch suggestions before TTS:",tt)}const un=Y.current.find(tt=>tt.id===Je);if(un){const tt={...un,...Ft};d(tt)}Ke==="user"&&(ye(null,null),je===it(P||"")&&(P||"").length>0&&w()),await new Promise(tt=>setTimeout(tt,0)),await bt({thinkingMessageId:Je,accumulatedFullText:Ct,currentSettingsVal:X});try{Ye.current=!1}catch{}ft.current&&(Re(ft.current),ft.current=null),fe(null),E.current("send-complete");const En=me.current||typeof S=="function"&&S();if(le.current&&F.current.stt.enabled&&!En)try{b(F.current.stt.language)}finally{le.current=!1}if(!A){const tt=Y.current.find($t=>$t.id===Je);if(tt&&tt.role==="assistant"&&(tt.rawAssistantResponse||tt.translations&&tt.translations.length>0)&&!Ue.current&&tt.id!==z.current){const $t=tt.rawAssistantResponse||tt.translations?.find(bn=>bn.target)?.target||"";$t.trim()&&wt(tt.id,$t,l(Y.current))}}return!0}catch(ct){console.error("Error sending message (stream consumer):",ct);let vt=e("general.error");ct instanceof Jl?ct.code==="MISSING_API_KEY"?(vt=e("error.apiKeyMissing"),O?.({reason:"missing",instructionIndex:0})):B2(ct)?(vt=e("error.apiKeyInvalid"),O?.({reason:"invalid",instructionIndex:0})):JC(ct)?vt=e("error.apiQuotaExceeded"):vt=KT(ct.message)||ct.code||`HTTP ${ct.status}`:ct instanceof Error&&(vt=ct.message);const Lt=ct instanceof Jl&&JC(ct);i(Je,{thinking:!1,role:"error",text:vt,rawAssistantResponse:void 0,translations:void 0,...Lt?{errorAction:"quota"}:{}}),ft.current&&(Re(ft.current),ft.current=null),fe(null);try{Ye.current=!1}catch{}if(le.current&&F.current.stt.enabled&&!me.current)try{b(F.current.stt.language)}finally{le.current=!1}return E.current("send-error"),Ke==="user"&&ye(null,null),N([]),Ue.current&&(Re(Ue.current),Ue.current=null),!1}},[e,n,i,Sn,I,E,l,c,dt,Rt,wn,cn,bt,wt,it,d,A,f,p,b,w,S,R,ae,Le,ye,qe,Re,Te,N,fe,L,O,P]);return x.useEffect(()=>{Qe.current=Wt},[Wt]),{isSending:De,isSendingRef:et,sendPrep:te,latestGroundingChunks:oe,maestroActivityStage:ce,isCreatingSuggestion:ne,imageLoadDurations:Ge,handleSendMessageInternal:Wt,handleSendMessageInternalRef:Qe,fetchAndSetReplySuggestions:Ce,handleCreateSuggestion:lt,handleSuggestionInteraction:ht,setMaestroActivityStage:Ie,parseGeminiResponse:mt,stripBracketedContent:it,resolveBookmarkContextSummary:Rt,ensureUrisForHistoryForSend:dt,computeHistorySubsetForMedia:Qt,handleReengagementThresholdChange:Mt,calculateEstimatedImageLoadTime:Bt}},U2=({isSpeaking:a,fetchAndSetReplySuggestions:e,getHistoryRespectingBookmark:t})=>{const n=x.useRef(!1),i=W(s=>s.setLastFetchedSuggestionsFor);x.useEffect(()=>{const s=n.current;if(n.current=a,s&&!a){const l=W.getState();if(_d(l))return;const c=l.messages,h=c.length>0?c[c.length-1]:null;if(h&&h.role==="assistant"&&!h.thinking&&h.id!==l.lastFetchedSuggestionsFor){const d=h.rawAssistantResponse||h.translations?.find(A=>A.target)?.target||"";d.trim()&&(i(h.id),e(h.id,d,t(c)).catch(()=>{i(null)}))}}},[a,e,t,i])},K2=()=>{x.useEffect(()=>{const a=YB(e=>({messages:e.messages,selectedLanguagePairId:e.settings.selectedLanguagePairId,isLoadingHistory:e.isLoadingHistory,historyBookmarkMessageId:e.settings.historyBookmarkMessageId,maxVisibleMessages:e.settings.maxVisibleMessages}),(e,t)=>{const n=e.selectedLanguagePairId;if(n&&!e.isLoadingHistory&&e.messages!==t?.messages&&er(n,e.messages).catch(()=>{}),!(e.messages!==t?.messages||e.historyBookmarkMessageId!==t?.historyBookmarkMessageId||e.maxVisibleMessages!==t?.maxVisibleMessages||e.isLoadingHistory!==t?.isLoadingHistory||e.selectedLanguagePairId!==t?.selectedLanguagePairId)||!n||e.isLoadingHistory)return;const s=e.messages;if(!s||s.length===0)return;const l=[];for(let P=0;P<s.length;P++)dd(s[P])&&l.push(P);const c=(e.maxVisibleMessages??sp)+2;if(l.length<=c)return;const h=e.historyBookmarkMessageId;let d=-1;h&&(d=s.findIndex(P=>P.id===h));const A=d>=0?d:0;let f=0;for(let P=A;P<s.length;P++)dd(s[P])&&f++;if(f<=c)return;const p=Math.max(0,l.length-c),b=l[p];let w=-1;for(let P=b;P<s.length;P++)if(s[P].role==="assistant"&&!s[P].thinking){w=P;break}if(w===-1)return;const S=s[w].id;if((e.historyBookmarkMessageId||null)===(S||null))return;const k=W.getState();k.setSettings(P=>({...P,historyBookmarkMessageId:S}));const I={...k.settings,historyBookmarkMessageId:S};zl(I).catch(()=>{}),lp(n,{bookmarkMessageId:S}).catch(()=>{})},{equalityFn:Aw});return()=>a()},[])};class z2 extends zd{async write(e){if(typeof navigator>"u"||!navigator.clipboard)throw this.unavailable("Clipboard API not available in this browser");if(e.string!==void 0)await this.writeText(e.string);else if(e.url)await this.writeText(e.url);else if(e.image)if(typeof ClipboardItem<"u")try{const t=await(await fetch(e.image)).blob(),n=new ClipboardItem({[t.type]:t});await navigator.clipboard.write([n])}catch{throw new Error("Failed to write image")}else throw this.unavailable("Writing images to the clipboard is not supported in this browser");else throw new Error("Nothing to write")}async read(){if(typeof navigator>"u"||!navigator.clipboard)throw this.unavailable("Clipboard API not available in this browser");if(typeof ClipboardItem<"u")try{const e=await navigator.clipboard.read(),t=e[0].types[0],n=await e[0].getType(t);return{value:await this._getBlobData(n,t),type:t}}catch{return this.readText()}else return this.readText()}async readText(){if(typeof navigator>"u"||!navigator.clipboard||!navigator.clipboard.readText)throw this.unavailable("Reading from clipboard not supported in this browser");return{value:await navigator.clipboard.readText(),type:"text/plain"}}async writeText(e){if(typeof navigator>"u"||!navigator.clipboard||!navigator.clipboard.writeText)throw this.unavailable("Writting to clipboard not supported in this browser");await navigator.clipboard.writeText(e)}_getBlobData(e,t){return new Promise((n,i)=>{const s=new FileReader;t.includes("image")?s.readAsDataURL(e):s.readAsText(e),s.onloadend=()=>{const l=s.result;n(l)},s.onerror=l=>{i(l)}})}}const O2=Or("Clipboard",{web:()=>new z2}),H2=Or("Browser",{web:()=>hs(()=>import("./web-CaaaGgSc.js"),[]).then(a=>new a.BrowserWeb)}),Gu=async a=>{if(typeof a!="string"||!a.trim())return;const e=a.trim();let t;try{t=new URL(e)}catch{return}if(!(t.protocol!=="https:"&&t.protocol!=="http:")){if(rr.isNativePlatform())try{await H2.open({url:e});return}catch{}typeof window<"u"&&window.open(e,"_blank","noopener,noreferrer")}},V2="thedev",ZC="https://script.google.com/macros/s/AKfycbyYCcKruNccmRqB7YmVFPBLUpC4gvTAMtfOjYJ1oJS-Dp44Am1HJoKJAp-RRtf02eIx/exec",to="maestro_tester_email",eS="maestro_tester_submission_count",kg=100,tS=100,j2="https://aistudio.google.com/app/apikey",Q2="https://chatwithmaestro.com/privacy.html",Eg=Array.from({length:12},(a,e)=>`/api-key-instructions/step-${e+1}.jpg`),q2=3200,ss=9,Y2=({isOpen:a,isBlocking:e,hasKey:t,maskedKey:n,isSaving:i=!1,error:s,keyInvalid:l=!1,instructionFocusIndex:c,onSave:h,onClear:d,onClose:A,onValueChange:f})=>{const{t:p}=Ro(),[b,w]=x.useState(""),[S,k]=x.useState(!1),[E,I]=x.useState(!1),[P,R]=x.useState(0),[D,N]=x.useState(!0),[_,K]=x.useState({inputTokens:0,outputTokens:0,imageGenCount:0,totalCostUsd:0}),[G,L]=x.useState(()=>!rr.isNativePlatform()&&!t),[O,q]=x.useState(""),[$,Q]=x.useState("idle"),[Z,F]=x.useState(""),[U,Y]=x.useState(()=>localStorage.getItem(to)||""),[ge,me]=x.useState(!1),[z,H]=x.useState(!1),j=x.useRef(!1),[le,te]=x.useState("submit"),[oe,ce]=x.useState(""),[Ge,ae]=x.useState(!1),[Le,De]=x.useState(()=>{const Ue=localStorage.getItem(eS);return Ue?parseInt(Ue,10):0}),[ue,ne]=x.useState(!1),[fe,Te]=x.useState(""),pe=!e,ye=Eg.length,Ie=P>=ss,qe=x.useMemo(()=>b.trim().length>=20&&!i,[b,i]);x.useEffect(()=>{a?K(G2()):(I(!1),R(0),N(!0),Q("idle"),q(""),F(""),ne(!1),Te(""))},[a]),x.useEffect(()=>{(async()=>{if(!(!U||!G)){if(j.current){j.current=!1;return}me(!0);try{const it=await(await fetch(`${ZC}?email=${encodeURIComponent(U)}`,{redirect:"follow"})).json();it.found?(H(!!it.approved),ae(!1),localStorage.setItem(to,U)):(Y(""),localStorage.removeItem(to),ae(!0),te("submit"))}catch(Be){console.error("Failed to check approval status",Be),H(!1)}finally{me(!1)}}})()},[U,G]),x.useEffect(()=>{if(!a||typeof c!="number"||ye<=0)return;const Ue=Math.max(0,Math.min(ye-1,c));R(Ue),I(!0),N(!1)},[c,a,ye]),x.useEffect(()=>{if(!E||!D||ye<=1||Ie)return;const Ue=window.setInterval(()=>{R(Be=>Be>=ss-1?0:Be+1)},q2);return()=>window.clearInterval(Ue)},[E,D,ye,Ie]);const Re=Eg[P]||"",et=E||pe,Ye=p(E?"apiKeyGate.closeInstructions":"apiKeyGate.close"),Qe=E?()=>I(!1):A,st=Ue=>{if(ye!==0){if(Ie){const Be=ss,it=ye-Be;if(it<=0)return;const Rt=(P-Be+Ue+it)%it;R(Be+Rt)}else{const Be=ss;R(it=>(it+Ue+Be)%Be)}N(!1)}},yt=Ue=>{R(Ue),N(!1)},ft=async()=>{if(b.trim())return;let Ue="";try{if(rr.isNativePlatform()){const{value:it}=await O2.read();Ue=it||""}else typeof navigator<"u"&&navigator.clipboard?.readText&&(Ue=await navigator.clipboard.readText())}catch{}if(!Ue)return;const Be=Od(Ue);!Be||!bT(Be)||/\s/.test(Be)||(w(Be),f?.(Be))};return a?G?T.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",children:T.jsxs("div",{className:"w-full max-w-sm bg-card shadow-xl sketchy-border p-8 relative",children:[pe&&T.jsx("button",{onClick:A,className:"absolute right-4 top-4 text-muted-foreground hover:text-foreground",children:T.jsx(Pi,{className:"h-5 w-5"})}),T.jsxs("div",{className:"flex flex-col items-center text-center space-y-3",children:[T.jsx("div",{className:"flex h-12 w-12 items-center justify-center bg-accent/15 text-accent sketchy-border-thin rounded-full mb-2",children:T.jsx(vo,{className:"h-6 w-6"})}),ge&&T.jsxs("div",{className:"py-8 space-y-4 w-full flex flex-col items-center",children:[T.jsx("div",{className:"h-8 w-8 animate-spin rounded-full border-b-2 border-accent"}),T.jsx("p",{className:"text-sm text-muted-foreground",children:p("apiKeyGate.testerFormChecking")})]}),!ge&&z&&T.jsxs("div",{className:"w-full space-y-4 animate-in fade-in slide-in-from-bottom-2",children:[T.jsx("h2",{className:"text-2xl font-semibold text-green-600 font-sketch",children:p("apiKeyGate.testerFormApprovedTitle")}),T.jsx("p",{className:"text-sm text-foreground",children:p("apiKeyGate.testerFormApprovedDesc")}),T.jsx("button",{onClick:()=>Gu("https://play.google.com/store/apps/details?id=com.ronitervo.maestrotutor"),className:"w-full bg-green-600 px-4 py-4 mt-2 text-base font-bold text-white hover:bg-green-700 sketchy-border-thin transition-colors rounded-md shadow-md",children:p("apiKeyGate.testerFormDownloadBtn")}),T.jsx("button",{onClick:()=>{Y(""),localStorage.removeItem(to),H(!1),te("submit")},className:"mt-4 text-xs text-muted-foreground hover:text-foreground underline transition-colors",children:p("apiKeyGate.submitAnotherEmail")})]}),!ge&&!z&&U&&T.jsxs("div",{className:"w-full space-y-4 animate-in fade-in slide-in-from-bottom-2",children:[T.jsx("h2",{className:"text-2xl font-semibold text-foreground font-sketch",children:p("apiKeyGate.testerFormPendingTitle")}),T.jsxs("div",{className:"p-4 bg-amber-50 text-amber-900 sketchy-border-thin text-sm space-y-2",children:[T.jsx("p",{children:p("apiKeyGate.testerFormPendingDesc")}),T.jsx("p",{className:"font-medium opacity-80",children:U})]}),T.jsx("button",{onClick:()=>{Y(""),localStorage.removeItem(to),te("submit")},className:"mt-4 text-xs text-muted-foreground hover:text-foreground underline transition-colors",children:p("apiKeyGate.submitAnotherEmail")})]}),!ge&&!z&&!U&&le==="submit"&&T.jsxs("div",{className:"w-full space-y-2 animate-in fade-in",children:[T.jsx("h2",{className:"text-2xl font-semibold text-foreground font-sketch",children:p("apiKeyGate.testerFormTitle")}),T.jsx("p",{className:"text-sm text-muted-foreground pb-4",children:p("apiKeyGate.testerFormDescription")}),Ge&&T.jsx("div",{className:"p-3 mb-4 text-sm bg-red-50 text-red-800 sketchy-border-thin",children:p("apiKeyGate.testerFormNotFound")}),T.jsxs("form",{className:"w-full space-y-4",onSubmit:async Ue=>{Ue.preventDefault();const Be=O.trim().toLowerCase();if(Be){if(Le>=kg){F(p("apiKeyGate.testerFormCapReached"));return}if(!Be.endsWith("@gmail.com")&&!Be.endsWith("@googlemail.com")){F(p("apiKeyGate.testerFormMustBeGmail"));return}if(Be.length<11||Be.length>tS){F(p("apiKeyGate.testerFormError"));return}Q("submitting");try{const it=new URLSearchParams;if(it.append("email",Be),it.append("source","web_tester_form"),(await fetch(ZC,{method:"POST",body:it})).ok){const Rt=Le+1;localStorage.setItem(to,Be),localStorage.setItem(eS,String(Rt)),j.current=!0,ae(!1),H(!1),De(Rt),Q("idle"),Y(Be)}else Q("error")}catch(it){console.error("Form submission failed",it),Q("error")}}},children:[T.jsxs("div",{children:[T.jsx("input",{type:"email",required:!0,value:O,onChange:Ue=>{q(Ue.target.value),$==="error"&&Q("idle"),Z&&F("")},placeholder:"@gmail.com",className:"w-full px-3 py-3 text-sm bg-card text-foreground focus:outline-none focus:ring-2 focus:ring-accent sketchy-border-thin",maxLength:tS,autoFocus:!0}),$==="error"&&T.jsx("p",{className:"text-xs text-destructive text-left mt-1",children:p("apiKeyGate.testerFormError")}),Z&&T.jsx("p",{className:"text-xs text-amber-600 text-left mt-1",children:Z})]}),T.jsx("button",{type:"submit",disabled:$==="submitting"||Le>=kg,className:"w-full bg-accent px-4 py-3 text-sm font-medium text-accent-foreground hover:bg-accent/80 disabled:opacity-50 sketchy-border-thin transition-opacity",children:Le>=kg?p("apiKeyGate.testerFormCapReached"):p($==="submitting"?"apiKeyGate.testerFormSubmitting":"apiKeyGate.testerFormSubmit")})]}),T.jsx("div",{className:"w-full pt-4 mt-2 border-t border-border/40 text-center",children:T.jsx("button",{onClick:()=>{te("check"),ae(!1)},className:"text-xs text-muted-foreground hover:text-accent transition-colors underline decoration-muted-foreground/30 underline-offset-2",children:p("apiKeyGate.checkStatusModeBtn")})})]}),!ge&&!z&&!U&&le==="check"&&T.jsxs("div",{className:"w-full space-y-2 animate-in fade-in",children:[T.jsx("h2",{className:"text-2xl font-semibold text-foreground font-sketch",children:p("apiKeyGate.checkStatusTitle")}),T.jsx("p",{className:"text-sm text-muted-foreground pb-4",children:p("apiKeyGate.checkStatusDesc")}),T.jsxs("form",{className:"w-full space-y-4",onSubmit:Ue=>{Ue.preventDefault();const Be=oe.trim().toLowerCase();Be&&(j.current=!1,ae(!1),Y(Be))},children:[T.jsx("input",{type:"email",required:!0,value:oe,onChange:Ue=>ce(Ue.target.value),placeholder:"@gmail.com",className:"w-full px-3 py-3 text-sm bg-card text-foreground focus:outline-none focus:ring-2 focus:ring-accent sketchy-border-thin",autoFocus:!0}),T.jsx("button",{type:"submit",className:"w-full bg-accent px-4 py-3 text-sm font-medium text-accent-foreground hover:bg-accent/80 sketchy-border-thin transition-opacity",children:p("apiKeyGate.checkStatusSubmit")})]}),T.jsx("div",{className:"w-full pt-4 mt-2 border-t border-border/40 text-center",children:T.jsx("button",{onClick:()=>{te("submit"),ae(!1)},className:"text-xs text-muted-foreground hover:text-accent transition-colors underline decoration-muted-foreground/30 underline-offset-2",children:p("apiKeyGate.submitModeBtn")})})]})]}),T.jsx("div",{className:"absolute bottom-2 right-2 flex flex-col items-end gap-1",children:ue?T.jsx("input",{type:"password",placeholder:"password",value:fe,onChange:Ue=>{const Be=Ue.target.value;Te(Be),Be===V2&&(L(!1),ne(!1),Te(""))},onBlur:()=>{fe||ne(!1)},className:"w-24 px-2 py-1 text-[10px] bg-card text-foreground sketchy-border-thin focus:outline-none",autoFocus:!0}):T.jsx("button",{type:"button",onClick:()=>ne(!0),className:"text-[10px] text-muted-foreground/30 hover:text-muted-foreground transition-colors px-2 py-1",children:p("apiKeyGate.developerLogin")})})]})}):T.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/40 backdrop-blur-sm p-4",children:T.jsxs("div",{className:"w-full max-w-lg bg-card shadow-xl sketchy-border",children:[T.jsxs("div",{className:"flex items-start justify-between px-6 pt-6",children:[T.jsxs("div",{className:"flex items-start gap-3",children:[T.jsx("div",{className:"flex h-10 w-10 items-center justify-center bg-accent/15 text-accent sketchy-border-thin",children:T.jsx(Xu,{className:"h-5 w-5"})}),T.jsxs("div",{children:[T.jsx("h2",{className:"text-lg font-semibold text-foreground font-sketch",children:p(Ie?"apiKeyGate.billingTitle":"apiKeyGate.title")}),T.jsxs("div",{className:"mt-1 space-y-0.5 text-sm text-muted-foreground",children:[T.jsxs("div",{className:"flex items-center gap-1.5",children:[T.jsx(Xu,{className:"h-3.5 w-3.5 shrink-0"}),T.jsx("span",{children:p("apiKeyGate.infoLogin")})]}),T.jsxs("div",{className:"flex items-center gap-1.5",children:[T.jsx(Vu,{className:"h-3.5 w-3.5 shrink-0"}),T.jsx("span",{children:p("apiKeyGate.infoVisibility")})]}),T.jsxs("div",{className:"flex items-center gap-1.5",children:[T.jsx(MS,{className:"h-3.5 w-3.5 shrink-0"}),T.jsx("span",{children:p("apiKeyGate.infoBilling")})]}),T.jsxs("div",{className:"flex items-center gap-1.5",children:[T.jsx(vo,{className:"h-3.5 w-3.5 shrink-0"}),T.jsx("span",{children:p("apiKeyGate.infoCost")})]}),T.jsxs("div",{className:"flex items-center gap-1.5",children:[T.jsx(Yu,{className:"h-3.5 w-3.5 shrink-0"}),T.jsx("span",{children:p("apiKeyGate.infoMore")}),T.jsx("button",{onClick:()=>Gu(Q2),className:"text-accent hover:underline",children:p("apiKeyGate.privacyPolicy")})]})]})]})]}),et&&T.jsx("button",{onClick:Qe,className:"text-muted-foreground hover:text-foreground","aria-label":Ye,children:T.jsx(Pi,{className:"h-5 w-5"})})]}),T.jsx("div",{className:"px-6 py-4 space-y-4",children:E?T.jsx("div",{className:"flex flex-col items-center gap-4",children:T.jsxs("div",{className:"relative w-full max-w-[360px] overflow-hidden bg-card shadow-sm sketchy-border-thin",children:[T.jsx("div",{className:"aspect-[9/16] w-full bg-muted",children:T.jsx("img",{src:Re,alt:p("apiKeyGate.instructionStep",{step:P+1,total:ye}),className:"h-full w-full object-contain",draggable:!1})}),ye>1&&T.jsxs(T.Fragment,{children:[T.jsxs("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-between px-2",children:[T.jsx("button",{type:"button",onClick:()=>st(-1),"aria-label":p("apiKeyGate.previousInstruction"),className:"pointer-events-auto bg-card/90 p-2 text-muted-foreground shadow hover:bg-card sketchy-border-thin",children:T.jsx(md,{className:"h-5 w-5"})}),T.jsx("button",{type:"button",onClick:()=>st(1),"aria-label":p("apiKeyGate.nextInstruction"),className:"pointer-events-auto bg-card/90 p-2 text-muted-foreground shadow hover:bg-card sketchy-border-thin",children:T.jsx(vd,{className:"h-5 w-5"})})]}),!Ie&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"absolute bottom-3 left-1/2 -translate-x-1/2 bg-card/90 px-3 py-1 shadow-sm sketchy-border-thin",children:T.jsx("div",{className:"flex items-center gap-1.5",children:Eg.slice(0,ss).map((Ue,Be)=>T.jsx("button",{type:"button","aria-label":p("apiKeyGate.instructionStep",{step:Be+1,total:ss}),onClick:()=>yt(Be),className:`h-2 w-2 sketchy-border-thin ${Be===P?"bg-accent":"bg-border"}`},`instruction-dot-${Be}`))})}),T.jsxs("div",{className:"absolute right-3 top-3 bg-card/90 px-2 py-1 text-xs text-muted-foreground shadow-sm sketchy-border-thin",children:[P+1," / ",ss]})]})]})]})}):T.jsxs(T.Fragment,{children:[T.jsxs("div",{className:"bg-muted p-4 text-sm text-foreground space-y-2 sketchy-border-thin",children:[T.jsx("div",{className:"font-medium text-foreground font-sketch",children:p("apiKeyGate.stepsTitle")}),T.jsxs("ol",{className:"list-decimal pl-5 space-y-1",children:[T.jsx("li",{children:p("apiKeyGate.stepOne")}),T.jsx("li",{children:p("apiKeyGate.stepTwo")})]}),T.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[T.jsx("button",{className:"inline-flex items-center gap-2 bg-accent px-3 py-2 text-accent-foreground hover:bg-accent/80 sketchy-border-thin",onClick:()=>Gu(j2),children:p("apiKeyGate.openAiStudio")}),T.jsx("button",{type:"button",onClick:()=>{R(0),I(!0),N(!0)},"aria-label":p("apiKeyGate.viewInstructions"),className:"inline-flex h-9 w-9 items-center justify-center bg-card text-muted-foreground hover:bg-muted sketchy-border-thin",children:T.jsx(vS,{className:"h-5 w-5"})})]})]}),T.jsx("label",{className:"block text-sm font-medium text-foreground",children:p("apiKeyGate.keyLabel")}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("input",{type:S?"text":"password",value:b,onChange:Ue=>{const Be=Ue.target.value;w(Be),f?.(Be)},onClick:ft,placeholder:p("apiKeyGate.placeholder"),className:"flex-1 px-3 py-2 text-sm bg-card text-foreground focus:outline-none focus:ring-2 focus:ring-accent sketchy-border-thin",autoFocus:!0}),T.jsx("button",{className:"px-3 py-2 text-sm text-foreground hover:bg-muted sketchy-border-thin",onClick:()=>k(!S),type:"button",children:p(S?"apiKeyGate.hide":"apiKeyGate.show")})]}),s&&T.jsx("div",{className:"text-sm text-destructive",children:s==="apiKeyGate.keyInvalid"?p("apiKeyGate.keyInvalid",{maskedKey:b.length>=8?`${b.slice(0,4)}${b.slice(-4)}`:""}):s}),t&&T.jsxs("div",{className:`p-3 text-sm flex items-center gap-2 sketchy-border-thin ${l?"bg-red-50 text-red-800":"bg-green-50 text-green-800"}`,style:{borderColor:l?"hsl(0 60% 60%)":"hsl(120 40% 60%)"},children:[l?T.jsx(Pi,{className:"h-4 w-4 shrink-0"}):T.jsx(As,{className:"h-4 w-4 shrink-0"}),T.jsx("span",{className:"truncate",children:l?p("apiKeyGate.keyInvalid",{maskedKey:n||""}):p("apiKeyGate.currentKeySaved",{maskedKey:n?`(${n})`:""}).trim()}),_.totalCostUsd>0&&T.jsxs("button",{type:"button",onClick:()=>Gu(I2),className:"ml-auto shrink-0 flex items-center gap-1 text-xs opacity-70 hover:opacity-100","aria-label":p("apiKeyGate.costLabel"),children:[T.jsx(vo,{className:"h-3 w-3"}),T.jsxs("span",{children:["~$",_.totalCostUsd.toFixed(2)]})]})]})]})}),!E&&T.jsxs("div",{className:"flex items-center justify-between px-6 pb-6",children:[T.jsx("button",{className:"text-sm text-muted-foreground hover:text-foreground",onClick:d,disabled:!t,children:p("apiKeyGate.clearSavedKey")}),T.jsxs("div",{className:"flex items-center gap-2",children:[pe&&T.jsx("button",{onClick:A,className:"px-4 py-2 text-sm text-foreground hover:bg-muted sketchy-border-thin",children:p("apiKeyGate.cancel")}),T.jsx("button",{onClick:async()=>{await h(b)&&(w(""),pe&&A())},disabled:!qe,className:"bg-accent px-4 py-2 text-sm font-medium text-accent-foreground hover:bg-accent/80 disabled:opacity-50 sketchy-border-thin",children:p(i?"apiKeyGate.saving":"apiKeyGate.saveKey")})]})]})]})}):null},X2=a=>{x.useEffect(()=>{document.title=a(EB)},[a]),x.useEffect(()=>{const e=document.getElementById("splash-screen");e&&e.remove()},[])},W2=2880*60*1e3-300*1e3,nS="maestro-api-key-changed",$2=a=>{if(!a)return null;const e=a.match(/^data:([^;,]+)[;,]/);return e?e[1]:null},J2=({setLoadingAnimations:a,setMaestroAvatar:e,maestroAvatarUriRef:t,maestroAvatarMimeTypeRef:n})=>{const i=x.useRef(!0);x.useEffect(()=>()=>{i.current=!1},[]);const s=x.useCallback((h,d,A)=>{i.current&&(t.current=A||null,n.current=d,e(h,d))},[n,t,e]),l=x.useCallback(async(h,d,A,f)=>{if(!h?.dataUrl)return;const p=typeof h.updatedAt=="number"?Date.now()-h.updatedAt:Number.POSITIVE_INFINITY;if(!(!(f||!h.uri||p>W2)||!await ip()))try{const S=h.mimeType||A||"image/png",k=await Ai(h.dataUrl,S,"maestro-avatar"),E={dataUrl:h.dataUrl,mimeType:k.mimeType||S,uri:k.uri,updatedAt:Date.now()};await Po(E),s(d||E.dataUrl||k.uri,E.mimeType||null,k.uri);try{window.dispatchEvent(new CustomEvent("maestro-avatar-updated",{detail:E}))}catch{}}catch{}},[s]),c=x.useCallback(async h=>{try{let d=await Wl();if(d&&(d.dataUrl||d.uri)){const A=d?.mimeType&&typeof d.mimeType=="string"?d.mimeType:$2(d?.dataUrl),f=d.dataUrl||d.uri||null,p=!!h?.dropUri||!!h?.forceUpload;s(f,A,p?null:d.uri||null),await l(d,f,A,h?.forceUpload);return}try{const A=await _B();if(A){const f=A.type||"image/png",p=await new Promise((w,S)=>{const k=new FileReader;k.onloadend=()=>w(k.result),k.onerror=()=>S(k.error||new Error("DataURL conversion failed")),k.readAsDataURL(A)}),b={dataUrl:p,mimeType:f,uri:void 0,updatedAt:Date.now()};await Po(b),s(p,f,null);try{window.dispatchEvent(new CustomEvent("maestro-avatar-updated",{detail:{dataUrl:p,mimeType:f,uri:void 0}}))}catch{}await l(b,p,f,h?.forceUpload)}else s(null,null,null)}catch{s(null,null,null)}}catch{s(null,null,null)}},[s,l]);x.useEffect(()=>{c()},[c]),x.useEffect(()=>{if(typeof window>"u")return;const h=d=>{const A=!!d?.detail?.hasKey;c(A?{forceUpload:!0}:{dropUri:!0})};return window.addEventListener(nS,h),()=>window.removeEventListener(nS,h)},[c]),x.useEffect(()=>{const h=d=>{try{const A=d?.detail?.uri,f=d?.detail?.mimeType,p=d?.detail?.dataUrl;t.current=A||null,n.current=f&&typeof f=="string"?f:null,e(p||A||null,f||null)}catch{}};return window.addEventListener("maestro-avatar-updated",h),()=>window.removeEventListener("maestro-avatar-updated",h)},[n,t,e]),x.useEffect(()=>{(async()=>{try{try{await MI()}catch{}let h=[];try{const d=await fetch("/loading-animations/manifest.json",{cache:"force-cache"});d.ok&&(h=await d.json())}catch{}a(h)}catch{}})()},[a])},Z2=({maestroAvatarUriRef:a,maestroAvatarMimeTypeRef:e})=>{const{t}=Ro();X2(t);const n=W(_=>_.setLoadingAnimations),i=W(_=>_.setMaestroAvatar);J2({setLoadingAnimations:n,setMaestroAvatar:i,maestroAvatarUriRef:a,maestroAvatarMimeTypeRef:e});const s=W(_=>_.settings),l=W(lr),c=W(_=>_.isLoadingHistory),h=W(_=>_.replySuggestions),d=W(_=>_.initSettings),A=W(_=>_.updateSetting),f=W(_=>_.setSettings),p=W(_=>_.loadHistoryForPair),b=W(_=>_.addMessage),w=W(_=>_.updateMessage),S=W(_=>_.deleteMessage),k=W(_=>_.setMessages),E=W(_=>_.getHistoryRespectingBookmark),I=W(_=>_.computeMaxMessagesForArray),P=W(_=>_.upsertMessageTtsCache),R=W(_=>_.upsertSuggestionTtsCache),D=W(_=>_.setReplySuggestions),N=x.useRef(null);return x.useEffect(()=>{W.getState().isSettingsLoaded||d()},[d]),x.useEffect(()=>{const _=g2();A2(_),p2({url:_}).then(K=>{console.log(`[GeminiModels] Loaded from ${K.source}`,{url:_,updated:K.updated})}).catch(K=>{console.warn("[GeminiModels] Refresh failed",{url:_,error:K})})},[]),x.useEffect(()=>{const _=s.selectedLanguagePairId;_&&_!==N.current&&(N.current=_,p(_,t))},[s.selectedLanguagePairId,p,t]),{t,settings:s,handleSettingsChange:A,setSettings:f,selectedLanguagePair:l,isLoadingHistory:c,addMessage:b,updateMessage:w,deleteMessage:S,setMessages:k,getHistoryRespectingBookmark:E,computeMaxMessagesForArray:I,upsertMessageTtsCache:P,upsertSuggestionTtsCache:R,replySuggestions:h,setReplySuggestions:D}},eF=({isSpeaking:a,isSending:e,isListening:t,reengagementPhase:n,setMaestroActivityStage:i})=>{const s=x.useRef(i);x.useEffect(()=>{s.current=i},[i]),x.useEffect(()=>{a?s.current("speaking"):e?s.current("typing"):t?s.current("listening"):n==="countdown"||n==="engaging"?s.current("observing_high"):n==="watching"?s.current("observing_medium"):n==="waiting"?s.current("observing_low"):s.current("idle")},[a,e,t,n])},tF=({selectedLanguagePair:a,isBlockingActivity:e,isUserActive:t,reengagementPhase:n,scheduleReengagement:i,cancelReengagement:s})=>{const l=x.useRef(i),c=x.useRef(s);x.useEffect(()=>{l.current=i,c.current=s},[i,s]),x.useEffect(()=>{if(!a){c.current();return}if(e||t){c.current();return}n==="idle"&&l.current("became-idle")},[a,e,t,n])},aS=a=>(a||"").split(",")[0].trim(),nF=ti.memo(({targetLang:a,nativeLang:e,currentSttLangCode:t,onSelectLang:n,t:i,isCollapsed:s,isInSuggestionMode:l})=>{const c=aS(a.code),h=aS(e.code),d=t===c||a.code.includes(t),A=t===h||e.code.includes(t),f=s?l?"p-0.5 bg-secondary/60 sketchy-border-thin":"p-0.5 bg-primary/60 sketchy-border-thin":"p-0.5 bg-secondary sketchy-border-thin",p=s?"p-1.5 sketchy-border-thin":"p-2 sketchy-border-thin",b=s?"text-base leading-none":"text-lg leading-none",w=l?"bg-white/50":"bg-white/30",S="bg-primary",k=l?"hover:bg-black/20":"hover:bg-white/20";return T.jsxs("div",{className:`flex items-center space-x-0.5 ${f}`,children:[T.jsx("button",{onClick:()=>n(c),className:`${p} transition-colors ${d?s?w:S:s?`opacity-70 hover:opacity-100 ${k}`:"hover:bg-secondary"}`,title:i("sttLang.selectLanguage",{language:a.displayName}),"aria-label":i("sttLang.selectLanguage",{language:a.displayName}),"aria-pressed":d,children:T.jsx("span",{className:`${b} ${d&&!s?"text-white":""}`,children:a.flag})}),T.jsx("button",{onClick:()=>n(h),className:`${p} transition-colors ${A?s?w:S:s?`opacity-70 hover:opacity-100 ${k}`:"hover:bg-secondary"}`,title:i("sttLang.selectLanguage",{language:e.displayName}),"aria-label":i("sttLang.selectLanguage",{language:e.displayName}),"aria-pressed":A,children:T.jsx("span",{className:`${b} ${A&&!s?"text-white":""}`,children:e.flag})})]})});nF.displayName="SttLanguageSelector";const iS=24e3,aF="AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD//wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//AAAAAAAA//8AAP///////////v/+//z/+//6//r/+//8//r//P/7//3//P/9//7/AAAAAAAAAQACAAIABAAEAAYABQAHAAkABQAIAAUACgAFAAcABgAFAAcABQAGAAUABQAEAAYAAgAFAAIABQACAAMAAQAAAAAA/f8AAP///v/9//z/+//6//j/+P/0//X/9P/1//b/9f/5//f/+//4//v/+v/+//7///8BAAAAAgAAAAMAAwAEAAUAAgAHAAEABgABAAQAAwACAAMAAAADAAAABAAAAAIAAgACAAIAAQADAAAAAwAAAAIAAAABAAMAAAAFAAIAAwAAAAIAAAAAAP////////3//v/8//7//f8AAP7////9//7////+/////////wAAAAAAAAEAAAABAAAAAAD+//3////8//3/+//+//3//v/9//////8AAAAA//8BAP//AgD//wMAAQACAAEAAQACAAEABAABAAQAAQAFAAMABAAFAAQABAAEAAYABQAHAAQABwAEAAYABAAEAAQAAgAFAAIAAwACAAIAAgAAAAAA///+//7/+f/6//j/9//3//X/9//2//f/9//5//f/+v/4//r/+v/7//z/+v/+//v//f/6//v/+v/7//r//f/6//////8AAAAA//8DAAAABQADAAUABwAGAAoABgAMAAYACgAGAAkABwAHAAYACAAJAAcACAAGAAgAAwAHAAAAAAD///z//v/6//v/+//8//z//f/+////AAABAAEAAgACAAIAAQABAAIAAAAAAAAA/v////v//P/7//r/+//6//v//P/8//////8CAAAABAADAAMAAwADAAUAAwADAAUABgAGAAcACAAJAAgACAAGAAYABgADAAUAAQADAAIAAwABAAMAAAACAAIAAAACAAEABQABAAQAAgACAAEAAQABAAAAAwD+/////v/9//z/+f/4//n/9v/4//T/9v/1//T/8v/x//L/8f/z//L/9P/0//X/9v/1//b/+v/6//3//P////7//v8AAP7//v////////8AAAAAAgAAAAIAAgAEAAcABAAGAAUABgADAAQABwAHAAsADAANAA4ADwAOAA4ADQAOAA8ADgAPAA0ADAALAAkACAAGAAYABgAEAAMAAQAEAAAAAgAAAAAAAgAAAAAA/f/+//v/+f/5//b/9//1//b/9P/0//b/8//1//f/9v/6//f/+f/5//v/+//8//z//v/+//7//f8AAP//AAABAP7/AgABAAEAAgADAAMAAwADAAIAAwADAAMAAQACAAAAAQD+////+//9//v//v/7//z/+//9//z//P/8//z/+//6//j/9//0//X/8f/0//H/8f/x//D/7v/v/+//8P/y//b/9v/8//v/AAAAAAUABQAJAAoACQALAAUACAADAAUABgAGAAsACwAQAA4AEQAOAA8ADgAPAAwADwAPABIAEgARABMAEgAUABIAEgATAA0ADwANAAkACAAGAAkABwAIAAYABwADAAQAAQAAAAAA/f/////////+//v//P/7//v/+//5//j/+v/3//b/9P/1//X/+v/6//3//f////7////6//z/+v/3//b/9v/1//b/9P/2//b/9//4//r//////wAAAwABAAMAAgACAAQAAgADAAMAAgACAAMAAwADAAMAAwACAAEAAQD+//7//v/7//3/+v/6//r/9//5//X/+f/2//n/9f/5//n/AAD+/wQABAAGAAkABgAGAAMAAwAAAPz//P/6//v//P/8////AAADAAMABwAFAAkABwAIAAcABQAFAAUABQAGAAoACQAJAAkACQAKAAcACAAGAAcABwAIAAUABQADAAIAAQAAAP////////7/AAD+/wAA//8DAAIACQAJAAsAEAAOAA8ACAAFAAEAAAD///3//f/8//z/+//9//3//v8AAP//AgD//wEAAAACAAAAAAAAAAEAAgD//wAA/P/8//f/+P/2//X/9f/z//P/8v/x//D/8P/s/+//7//x//L/9P/1//n/9P/5//f/+v/7//r/+//6//r/+P/5//X/9//6//r//v///wAAAgACAAIABAADAAYABgAIAAgACQAIAAYABwAFAAgABgAKAAkADAAKAAsACgAJAAcABwAEAAIAAgAAAAAAAAAAAAIAAQACAAQABAADAAEAAgACAAMABAACAAMAAgACAAIAAQD//wEA/v8AAP3//f/+//7////9/wEAAQAGAAYABwAFAAQABQACAAQABAABAAUAAwAGAAUABgAIAAYACAAHAAYAAwABAAAAAAD///7///8AAAEAAAAAAAAAAAD9//7//P/7//v/+f/4//j/+P/5//j/9//4//X/9f/z/+//8P/s/+7/7//u/+//8P/v//H/8f/w//P/9f/z//f/9v/5//r/+/8AAAEAAwAGAAgACwAMAAoACQAGAAkABAAEAAEABQAEAAoACQANAAsADwAMAA0ACgALAAkADAAOAAsADgAMAA4ADgAQABAAEAAMAA0ACQAHAAQAAgAAAAMAAwAFAAUABQAEAAUAAgACAAEABAAEAAMABAADAAUAAwAEAAQABAAEAAQAAwACAAAA///9//z//P/7//z//f/+//3//v/8//v//P/8//z//f/7//3//P/9//v/+/////7//////wAAAAD///7/+v/5//n/+P/4//X/+P/4//f/+P/4//n/9//3//X/9f/z//T/9P/0//X/9v/3//j/+P/2//f/9v/y//b/9P/1//b/8//z//P/9P/3//f/+f/5//f/+P/2//n/+f/7//7/AAABAAMABAAFAAYACQAJAA4ADAAPAA0ADwAMAAwADwAOAA4ADgANAAsACQAIAAcABwAJAAoACwALAAwACgANAA0ADgAMAA0ACwAMAAsACQAJAAUABgADAAIAAgAAAAAA/f/+//z/+//7//7//P/+//3//v/+//3//v/9//z//P/7//v/+//7//v/+//8//3//P/7//v/+//8//z//f/9//v/+v/3//j/+P/4//r//v/9/wAAAQABAAAAAAACAAEAAgACAAEAAQAAAAAAAAD+/wEAAAACAP/////+//3//P/7//z//P/9///////+//7//v/9//v/+//6//r/+//7//z/+//+//7//f/9//v/+P/4//j/+//6//r/+//6//z//P/8/wAAAwAGAAYABwAFAAMAAQD+/wAA/v8AAAAABQAHAAsADgAQAA8AEgASABMAFAASABQADgARAA8ADgANAA0AEAARABEAEAAPAAwACwAIAAYAAwAJAAQABgADAAQAAwADAAAA///8//j/9v/1//b/9P/3//X/9v/2//n/+P/3//f/+P/2//P/8f/w//L/9P/0//f/9f/5//n/+v/7//v//P/9/////f8AAAIAAgAEAAQABAAGAAQABAACAAIAAQABAAAAAQAAAAMAAwACAAQABQAFAAYABwAEAAUAAAABAAAA/f/8//3/+//8//z////9//z//P/7//v/+P/5//X/9P/0//b/9f/3//n/+f/6//v//f/7//////8AAP//AAABAAIAAwAFAAUACAAGAAcABQAIAAgACAAKAAoACwAMAA4AEQASABQAEgASAA8ACwAIAAMAAQD///7/AAAAAP//AAAAAAAAAgAAAP///v////z//P/6//r/+f/6//n/+P/3//j/+f/4//n/9//2//b/9P/2//T/9//3//j/9//6//j/+v/7//v/+f/6//v/+//9//r//P/6//z/+f/6//j//P/7//7//f/8//7//P8AAAEABQADAAMABAADAAIAAQACAAEAAgACAAIAAAACAAIAAQAAAAAAAQAAAAAAAAD7//z//v/9////AAAAAAAAAAADAAUABQAGAAcABwAJAAgACQAJAAgABgAFAAQABAAFAAgABwAGAAcABgAFAAUABgAFAAYABgAFAAUABQAFAAUABgAEAAUABAAGAAQAAwABAAEAAAD/////AAD//////v/8//z/+v/7//v/+v/6//v/+v/9//7//f/+//z//v/+//3/AAD//wAAAAAAAAEAAQAAAAIAAgABAAAA///8//r/+v/5//f/+f/7//3///8AAAEAAgADAAMABAACAAQAAwACAAQABAAFAAMAAwABAAMAAAAAAP7//f/+//j/+f/3//b/+//6//z//P/8/////P/+//n//f/8//z/+P/4//r/AAAAAAQABQAFAAYABgAGAAYABAAGAAYABQAIAAcABQAIAAcABwAHAAQABgAFAAYABwAGAAcACAAIAAcABwADAAUAAwAAAAEA/v///wAAAAAAAAAAAAAAAP7//v/9//7//v/8//3/+//7//3//P/8//r/+v/5//r/+f/5//r//f/9//7//P/6//v/+v/9//z//P/6//z//P/+////AAAAAAEAAQAAAP////8AAAEAAwAFAAUABQAFAAQABAACAAAA/////wAAAAAAAAAAAgADAAYABAADAAIAAAD///7//P/8//v//////wAAAAD+//v/+f/1//L/7//u//D/8f/w//L/8f/3//r//P/9/wAAAAD9//3//f8AAAMABAAFAAUABQAGAAYABgAGAAcACQAIAAYABwAHAAgACQAKAAsADAAMAAsACgAMAAoACQAJAAkACgAMAA0ADgANAA4ADAAMAAsACgAMAAoACAAGAAQAAgAAAP3//P/5//r/9//3//b/9v/1//T/9P/y//D/8P/u/+3/7v/s/+7/7v/w//H/8f/z//T/8//1//T/9v/2//v//f/9/wAA/v////3//v/9//3////+/wEAAAABAAMABgAHAAoACgANAA0AEAARABYAFQAWABQAEwAQAA0ADQAIAAkABgAFAAQABAACAAEAAAAAAP///P/8//v//f///wAA//8AAP//AAD///7//v/8//7//v/////////+//3//v/7//f/9//2//v//P/8//3//P/9/wAAAAAAAAEABQAGAAkACgAMAA4ADgAPAA0ADgANAAwADAALAAoACwAJAAgABwAIAAkABwAFAAUABQACAAMAAAAAAAAAAAD+/wAA/P/8//v/+v/7//n/9//3//b/9//2//b/9v/3//b/9f/0//L/8P/x//H/8//z//T/9v/1//f/9f/1//j/9v/3//f/9v/3//n//P/8//7///8DAAMABAAGAAkACQAKAAsACwANAAwADAAMAAoACgAKAAoACgAKAAoACgAKAAkACQAGAAUABAAEAAYABAADAAMAAwACAAEAAQAAAAAAAAD+//////////7//P/8//3//P/6//f/8//x/+//7v/u/+7/7//v//H/8P/x//H/8f/z//X/9//6//3/AgAEAAUACAAKAAsADQAQABAAEgASABMAEwARABIAEgARAA4ACwAHAAMAAQAAAP///v/9//z//f/8//z/+//5//n/+f/7//3//f/8//7//P/8//n/9v/0//H/7//s/+3/6v/u/+3/8P/u/+//7v/x//D/8v/0//T/9v/4//n//P/+//7/AgADAAgACAAMAA4AEQASABIAEgAUABMAEwATABIAEQAQAA8ADwARABEAEQASABEAEQASABEAEAAQABEAEAAQAA8AEAAPAAwADAAKAAwABwAEAAEAAAD9//r/+v/6//n/+f/5//X/8v/z//L/8v/y//D/7//u//D/8v/1//j/+v/9//v//v/8//v//f/7//3//P/7//v//v/+/wAA///+////AAAAAAAAAQACAAMABQADAAUABQAIAAYACAAHAAcABgAGAAUABAAFAAMAAgAAAAAA///9//v/+//7//v//P/8//r/+f/5//b/9v/3//n/+////wAAAAADAAEAAwADAAEAAAD///3/+//5//r/+v/6//z//v/7//n/9v/w//D/7P/u//D/9f/3//3/AAADAAQABAAHAAYACgAKAAoADQAOAA8AEQAPABEAEAARAA8ADQANAA4ADgAMAA4ADQAMAA0ADQAMAAwACwALAAkACQAIAAgABwAIAAYABQAEAAUAAQACAP//AAD//wAA/v/8//3/+v/8//r//P/6//n/+P/4//b/9//4//n/+v/6//j/+v/5//n/+P/3//b/9f/1//b/9v/3//r/+v/7//v/+//5//r/+f/8//3//v///wAAAQACAAAAAAAAAAAA/v8AAP//AAAAAAAAAgADAAQAAwABAP//+//5//j/9f/1//T/9f/1//X/9v/3//b/9f/1//T/9P/2//f/+P/8//7//v////7//v/9//r/+f/4//f/+P/4//j/+/8AAAAAAgAEAAYABwAIAAcACAAIAAoACgAMAA4ADwAOAA0ADAALAAkACwAJAAsADQANAA0ADQALAAoABwAHAAUABgAGAAYABwAIAAoADQANAA8ACgAJAAUABgADAAIAAgADAAIAAQAEAAQABgAAAP7/9//3//T/9f/0//b/+P/4//v/+v/5//n/9v/0//P/9P/3//j/+v/7//v//v/9//z//P/9//v/+//7//3//f///wAAAAACAAEAAQABAAEAAAABAAEAAgACAAIABQAGAAkACAAHAAMAAwADAAMAAQADAAIAAQABAP//AAD9//v/9v/1//T/9//3//j/+v/9/wAAAAAAAP//AAD8//v/+v/7//7/AAAAAAMABAACAAIA///+//v/+f/7//v//v///wMAAgAFAAcABQAFAAMAAwAFAAUACAAJAAwADQAOAA0AEAAPAA4ADQANAAsADAAKAAoACQALAAoACgAKAAkABwAGAAYABQAFAAgACQAKAAkACgAJAAgABQAAAP//+//7//j/9//2//f/9//3//f/+P/6//f/9//1//X/9f/2//X/9//6//3//v/9//v/+P/3//P/8f/v/+//7//x//T/+f/7//r/+//4//b/+P/7//z/AwADAAUABwAHAAsACwAMAAsACwALAAwACgALAA0ADQAPAAwACwAJAAYABAAAAAAA/////wAA/f8AAP////////7///////7///////3//v/8//z//P/7//j/+f/2//T/8v/w//P/9f/1//b/9f/1//X/8//x//D/8v/x//L/9v/6////AwAEAAMABgAHAAgABwAHAAgABgAGAAcABQAGAAcABQAGAAcACQAGAAkABQAFAAQABAADAAIABAAGAAcABwAGAAQABAAFAAAAAAD8//3/+f/4//f/+P/4//n/+f/5//n/+P/3//T/9P/y//T/9P/3//f/+//8//v/+//8//v//f/+/wAA/////////P/+//z/+//7//7/AAAAAAIABQAHAAoACQAJAAoADAALAAwACQAJAAgACgAKAAgADAAKAA0ACgALAAkACQAJAAgACAAIAAoACAAJAAgACAAJAAgABgAFAAYABQAEAAQAAQABAAAAAgABAAIAAgACAAAA///8//v/+P/3//f/9v/5//r//P/9//3/+f/4//f/9f/1//X/+P/8////AAD/////AAAAAAAAAAD+/wAA//8AAP//AQABAAIAAgADAAQAAwACAAEAAAACAAAAAQACAAEAAAAAAAAAAAAAAAAAAAACAAEAAwAEAAQAAwADAAAA///9//z//P/7//z//P/+//3//v/+/////f/8//v/+P/4//n/+f/7//z//////wAA/P/7//j/8v/x//D/8f/1//f/+v///wEABgAFAAcABAAGAAQAAwADAAUACQALAA0ADQAOAA8ADgAMAAsACwAJAAkACQAJAAoACgAKAAoACQAIAAYAAgADAAIAAwAFAAUABQAGAAUABAADAAIAAQD//wAAAAADAAMABAADAAQAAAD9//f/9f/x/+//7v/t/+7/8v/y//j/+P/4//j/9v/y//D/7f/s//H/8//4//z/AAAAAAEAAAAAAP7/AAACAAAABAADAAUABAAGAAYABQAHAAcABgAGAAYABQAFAAcABwAHAAYABwAFAAYABwAGAAkACgALAAoACQAKAAQAAwD//wAA/v/9//v/+f/7//v//f/8//z/+//8//n/+v/6//z//f////7///////7/+//6//f/9f/2//b/9//0//b/9v/5//v///8AAAEABQAFAAUABgAGAAgABwAIAAoACwAMAA4ADQAOAA4ADwAPAAwACgAGAAUAAAAAAP//AAAAAP///v/7//z/+f/6//f/9//4//n/+f/7//3//f/+//z//P/6//f/9//y//L/7//w/+//7v/t/+3/8P/v//D/8v/0//b/9//5//v/+//9//3/AAABAAUABgAKAAwADgAPAA8AEQARABAADwAPABAAEAAQAA8ADwAPAA4ADQAPAAsACwAIAAcABAAEAAMAAwACAAMABQAFAAYABwAGAAcABwAHAAQABgAFAAUAAgAAAP/////+//3/+v/6//r/9//2//j/9v/3//f/9//1//T/9v/1//X/9P/1//T/9f/2//j/+P/+//7/AgACAAMAAQACAAIAAgAEAAQABQAEAAQAAwADAAMABAACAAIAAwADAAQABQAHAAYABgAGAAUAAwABAAAA///+/wAA//8AAAAAAAAAAP///v/9//z//P/9//7///////7//f/+//z/+v/2//X/9P/1//f/9v/3//n/+v/8//z//P/7//r/+//9//z//f8AAAIABQAIAAUABwAIAAcABgAFAAYACAAIAAkABwAJAAgACAAGAAUABQAFAAQABgAHAAcABwAHAAYABwAHAAUABQAEAAUABQAGAAYABQAFAAQAAgADAAEAAgAAAAAAAAD9//7//v////7//v/9//3//////wAAAAAAAAAA///+//3//P/5//v/+//7//z/+P/3//P/8v/y//P/8//1//L/9f/6//v/AAAAAAIAAwADAAMAAgADAAMAAwACAAMABgAHAAgABwAGAAYABAAEAAMAAAAAAAAAAAABAAEAAwABAAEAAAD///7//v8AAAAAAAABAAEABAADAAIAAwAEAAQAAwADAAIAAQAAAAAAAAACAAIAAgABAAAAAAD//////v/+//z//P/9//7//v/9//z//P/6//v/+//+////AAAAAAAAAwACAAQAAwAEAAIAAwAEAAIABQAEAAIAAgADAAEAAwACAAIAAgABAAAAAAAAAAAAAQAAAAAAAAACAAAAAQD//wAA//8AAP7//v/9//r/+P/4//n/+P/3//X/9f/y//P/8v/y//T/9P/y//X/9f/3//X/9v/1//n//P///wQAAgAGAAQABQAFAAQAAwABAAAAAAD//wAAAQACAAIABQAHAAkADgALAAwADAANAAsACgALAAoACwALAAsACgALAAwACgAJAAoABwAGAAQAAwACAAIAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQAAAAEAAwACAAMAAQD///7//v/7//n/+f/3//f/9v/3//j/+v/3//n/9//6//v//P////////8AAAAA/v/+//v/+f/2//b/9v/4//v//f/9////AQACAAAA///+/////P/9//v/+v/7////AAABAAAAAgAEAAQABAADAAUABgAEAAYABQACAAAA/v/7//r/9P/1//L/8//z//X/+P/3//n/+f/7//3///8BAAIABgAGAAkACwANAAoACQAHAAMAAwABAAAAAAACAAIABQAHAAoACwAMAAwADQANAAwADwAOABIAFAAUABYAFwAZABgAGAAVABQAEQAPAA4ADgAMAAwACgAIAAUAAgD///7/+//7//z/+//5//z/+//8//r/+v/4//f/9//3//b/9//3//f/9//2//T/8v/w/+z/6v/p/+f/6f/s/+z/8P/y//b/+f/7//v/+//7//v/+v/6//z//P/9/////////wAAAAAAAAAAAAACAAIABAADAAMAAwACAAMAAgD//wAA///+//3//P/9/wAA//8BAAEAAgAEAAQAAwABAAEAAAD///3//P/7//n/+f/4//n//P/8//3//f8AAAAAAwADAAMAAwACAAEAAAD+//3//P/6//n/+f/6//v//v///wAABgAHAAwADQANAA0AEAAPAA4ADAAMAAwADQAMAA0ADAAMAAwADAAMAAsACgAJAAsACQAKAAgABgAGAAQAAwADAAEAAwAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAAAP7//v/9//7//f/8//r//P/8//3/+//5//v/+//9//z//f/+//7//f/+//7//v/8//r/9//3//b/9v/3//v//f/+//7///8AAAIAAAADAAEABAACAAIAAAAAAP///f/6//n/+f/7//v////+/wAAAgAEAAcACAALAAsADAAMAAoABwAFAAEAAAD//////f/7//v/+f/4//v/9//3//b/+f/8//3//P/9////AAAAAP////////7//v/9//7//v////7//v/9/////v/+//7//v/+//7//f/9//v/+v/8//7/AAAAAAMAAgAGAAUABgAIAAcACgAJAAoACwAMAAwACQAHAAUABAABAAEA///+//7/+//8//z//v/+/////v//////AAAAAP///v/+//z//f/8//3//f/7//v/+//8//r/+v/6//j/+f/6//n/+v/5//r/+P/4//X/9v/3//b/9v/3//r//P/+////AAAAAAIABAAEAAYACAAIAAgACQAIAAoACgAIAAoACgAKAAoACQAJAAkACgAJAAsACwAMAAwADAAOAAwADAAIAAYACAAIAAoACQAKAAgABQADAAAA///+//z/+v/3//f/9v/3//j/+v/5//v//P/9//z/+//8//z////9//7//v/+//v/+f/4//f/9//0//T/9P/4//v//f/9//3/AAAAAAAA/v/+//7//v///////v///wAAAAAAAAAAAgAAAAEAAQABAAAAAAAAAAAA/f/7//r/+f/2//b/9f/2//j/+P/7//3/AAABAAUABgAGAAUABQAEAAEAAAD+//z/+v/5//r//f/+//3//v/9/wIAAwAHAAgACgALAAoACgAIAAsACQAKAAkACgAJAAgABwAGAAgABwAIAAgACQAHAAgABwAGAAQABAABAAEAAQABAAAA////////AAD///7////+/wAA/////wAA//8AAAAAAAD//////f/+//3//P/7//n/+f/4//b/9v/0//b/9v/4//j/+f/7//3//v8AAAAAAQAFAAYABwAGAAYABgAFAAUAAgACAAEAAgADAAMAAQACAAAAAQABAAAAAAAAAP//AAAAAP//AAD///////////////8AAP///v/+/wAA//8AAP7//f/7//v/+v/4//j/9v/1//P/8//1//f/+P/5//v///8AAAAAAQACAAIAAgAAAAAAAAAAAP///////wAAAAAAAAIAAQADAAMAAwADAAIAAgACAAEAAQABAAEAAAAAAAAAAAAAAAEAAgADAAEAAwABAAIAAgABAAAAAAABAAAAAgABAAIAAwABAAEAAQACAAMAAwAFAAUABQAFAAcABwAGAAUABAACAAIA//8AAP//AAAAAAAAAgABAAEAAAAAAAAAAgABAAEAAgABAAEAAAAAAP//AAD+//3//P/8//r/+f/3//b/9P/1//X/9v/2//X/9P/2//j/+v/6//v//P/+//7/AAABAAEAAgADAAQABgAIAAgACgAJAAgACQAFAAcABgAEAAMAAwADAAYABQAFAAUABgAIAAcABwAJAAgACAAJAAgACAAJAAkACgAIAAYABAAAAAAAAAD9//7/+//7//3//f/+//3//f/9//3//P/7//v//P/8//3//P/8//3//v/+//3//f/8//7//v/+//7////////////9//7//P/+//3/AAAAAAAAAAD/////AAAAAAAAAgABAAMAAQACAAEAAwACAAEAAQAAAAEAAAD+//3//f/7//r/+f/6//n/+//6//r/+f/6//7//P/8//z/+//7//n/+//8////AAAAAP//AAD+/wAA///9//3/////////AAAAAAIAAgADAAEAAgADAAIABAABAAYABwAKAAwADQAPABAAEAAOAA8ACgANAAkACgAIAAMAAgACAAAAAgAAAAAAAQAAAP7//v////7///8AAAAAAAABAAAA//////7//P/9//v/+v/5//r/+f/6//r/+//7//7//f/9//3/AAD9//7//f//////AAD/////AAAAAAMAAAACAAIAAgADAAIAAQABAAMAAgACAAEAAAABAAMAAQACAAIAAwABAAEA/v/+//3////8//3//P/+//z//v/8//z///8AAAAAAAD+//7/+//7//r/+v/5//r/+P/4//b/9v/y//X/8v/z//P/9//5//z//f8AAAAAAwADAAYABQAGAAYABgAFAAQABgAEAAIAAwABAAQAAgAAAP//AQACAAQABAADAAIABQAFAAYABQAFAAcACAAHAAUABwAFAAgACAAIAAcABwAHAAcABgADAAIAAwADAAUAAwAAAAEAAAD+//3/+//4//n/+f/6//z//P/+/wEABAAGAAQABQAFAAQABQADAAEAAAACAAEAAgACAAEAAgABAAAAAAD9//z//P/+//7/////////AAAAAP///////wAAAAAAAAAA//////////8AAP///v/+//3/+//6//f/9v/2//f/+P/4//j/+//+/wAAAAAAAAAAAQADAAIAAQACAAEABAACAAAAAAAAAAEAAAAAAP//AAAAAAAA//////////8AAAAAAQABAAQAAwAEAAIABQAEAAQAAwACAAIAAQABAAAA///+//7//v/8//r/+f/5//n/9//5//j/+v/7//7//f8AAAIAAgADAAQAAgAEAAYAAwADAAIAAgADAAIAAgADAAMAAQABAAAAAAAAAAAAAQACAAIAAgADAAQAAwACAAMAAgADAAIAAQABAAEAAAAAAP////8AAP7//f/8//z//P/8//v//f/9/////f/8//3//f/+//3//P/8//z/AAAAAAEAAgABAAIAAwD//////f/9//v//P/5//z//P/+//3//f/8//3/+//8//r//f///wIAAwAIAAsADAANAA0ADQAOAAsACQAGAAYABgADAAIAAAAAAP7/AAD7//r/+f/6//v//f/+////AQAEAAUABgAEAAQABAAFAAMAAwADAAIAAQACAAAAAAAAAP/////+//z//f/+//7////+/wAAAAAAAAAAAAAAAAAAAAAAAAAAAgAFAAYABwAIAAcAAwACAAAA/f/7//n/+f/5//r/+//8//3//f/9//z//P/8//v/+//9//7///8AAAAAAgAAAAAA//////3//P/8//r/+v/6//v//P/9//z//f/7//v/+f/7//n//P/+/wAAAgACAAQABgAHAAcABgAFAAQABAADAAEAAQACAAIAAwACAAEAAQAAAAEA//////7/AAABAAQAAwADAAQABAACAAIAAAABAAAAAQAAAAAAAQACAAIAAAAAAAAA/v/7//v//P/7////AAACAAIAAwADAAIAAQABAAAAAwAEAAQABwAJAAsADAAKAAkACAAHAAMAAAD+//7//v/+//v/+v/8//3//f/6//r/+//7//r/+//9//3/AAAAAAAAAAAAAAAA///+//z//P/8//3//P/8//z/+f/5//r/+//9/////v8AAAAAAAAAAAAAAAAAAAAAAQABAAEAAgADAAQABAAEAAQAAgACAAAAAAAAAAAAAAABAAEAAwADAAUABAAFAAQAAwACAAEAAAAAAAIAAQADAAIAAgADAAIAAwABAAEAAAD/////AAD//wAAAAAAAAAAAAD///3//f/9//7/////////AAAAAAAAAAAAAAEAAwAEAAMABQAEAAMAAwABAAEAAAAAAAAAAAD///7/AAAAAAAAAAD+//z/+v/5//j/9f/z//T/9v/5//7//v8AAAAAAAD9//v/+v/4//j/+//9//3///8BAAQABAADAAIAAgACAAAA/v/+//3/AAAAAAIABQAHAAcACAAIAAcABgAGAAYABAAEAAQABQAFAAQABgAEAAQABAACAAAAAAAAAP//AAD/////AAAAAP//AAAAAAIAAgADAAIABAACAAEAAAAAAP/////+///////+/////v/8//r/+f/2//X/9f/1//b/9v/4//n//f///wAAAwADAAMAAgACAAMAAgADAAQABQAFAAUABQAGAAMAAgAAAAAA//////////8AAAAAAAAEAAQABgAHAAcACAAIAAcACAAGAAQAAQD//wAA///9//z/+v/4//n/9v/4//b/+f/6//z//f/9/wAAAAAAAAAAAAAAAAEAAgAAAAAAAAAAAP//AAD//////////wAA//8AAP///v/9//v/+v/4//r/+//+/wAAAgAEAAQABQAEAAUABAABAAEAAAABAAMABQAEAAYABgAHAAUABAADAAEAAQACAAIAAQABAAIAAgADAAMAAgADAAUAAgAAAAAA/v/+//7////9//3//P/7//v/+//6//r/+f/4//j/+P/5//r/+v/5//z//P/9/wAA/v8AAAAAAgABAAUABAAIAAcABwAGAAYABwAFAAQABgAHAAkACgAKAAwACwAMAAgABQADAAMAAQABAAIAAQACAAIAAgAAAP///f/+//z//P/8//3//v////7////+//7//f/7//j/9f/0//X/9v/2//j/+P/6//r/+//7//v//f/9////AAACAAMABAAEAAUABAAFAAQAAgACAAEAAAAAAAAAAQADAAYABgAHAAcACAAHAAcABwAGAAYABQAEAAMAAgABAAEAAAAAAP7//f/9//3//f/8//v/+v/7//z/+v/7//r//P/8//3/////////AAAAAAAAAAD///z//f/9//3///8AAAEAAQACAAEAAAD+//7//f/+//3///8AAP//AAAAAAIAAgABAAEAAwACAAMAAgABAAAA//8AAP//AAAAAAAAAAAAAP7////9//7//f///wAA///+////AAAAAAAAAAAAAAEAAQABAAAAAAD//////v///wAAAAAAAAAA/v/+//7//f/9//v//f/+/wAAAAADAAQABgAGAAUAAwAEAAIAAQAAAAEAAQAEAAMAAgABAAIAAgABAAIAAQABAAEAAQABAAIAAgADAAMAAgABAP/////9//v/+f/5//r/+//9//7/AAACAAUABAAEAAMABAADAAQAAwACAAIAAgACAAIAAgADAAMABQAGAAcABwAGAAUABAACAAIAAAAAAAAA/v/+//7//f/+//7////9//3/+//6//z//P/6//v/+f/7//r/+f/6//j/+P/4//j/9f/1//f/+v/+//3//v8AAAEAAQABAAAAAAAAAAEAAgADAAMAAgACAAMAAgACAAMAAwAEAAIAAgACAAMAAwADAAQABgAHAAkABwAGAAYABQAFAAYABQAEAAMAAgABAAAA///9//v/+//8//z//f/8//3//P/8//z//P/9//z/+//7//r/+v/4//j/+P/3//T/9f/1//f/+f/8//7/AgAFAAUABQAFAAQABQAEAAUABwAGAAcACAAHAAkACAAIAAgABwAIAAgABgAGAAYABwAHAAcABwAGAAUABQAGAAYABgAGAAYABQADAP///v/+//7//P/8//v/+//6//r//P/7//z/+//9//v/+//7//v//P/8//z//P/8//v/+v/5//n/+P/6//n/+f/4//r//f/+////AAABAAAAAQAAAAAAAAAAAAEAAgAEAAQABQAFAAYABQAEAAUABAAEAAMAAwADAAMAAwACAAMAAgACAAMAAwACAAMAAgADAAIAAgADAAMAAgD///3//P/7//n/+P/3//b/8//z//H/8f/v//D/8//0//b/+f/8////AAADAAEAAgADAAIAAgADAAMAAwADAAMABAADAAQABAADAAMAAwADAAMABQAEAAUACAAKAAwADQANAAoACQAGAAYABQAFAAUABgAFAAQABAABAAAA/v/9//3/+//7//v//P/8//z//P/8//v//P/7//r/+f/6//n/+f/4//n/+P/6//f/9//3//r/+f/7//z//P/+//7//f/9//7//v8AAAEAAAAAAAAAAwAFAAgABwAIAAoACgAJAAgABwAGAAYABgAHAAcABwAIAAcABQADAAEAAAAAAAAAAQACAAMAAgADAAMAAwADAAQABAAEAAQAAwADAAIAAwACAAAA/f/7//v//P/7//n/+v/4//n/+f/6//r/+v/7//v/+v/7//v/+//9//7//v///wAA/v/+/////////wAAAAAAAAIAAwADAAQABAAEAAMAAwADAAIABAAEAAUABAAEAAUABgAFAAQAAQABAAIAAQACAAIAAgACAAIAAQD///7//P/7//f/9v/y//H/8P/y//P/9f/3//n//f///wAA///7//z//f8AAAAAAAD//////v////7//v/+/wEAAwADAAQABQAFAAQABAACAAAAAQAAAAEAAQACAAUABQAJAAgACAAIAAgABwAHAAcABwAFAAQABQAEAAMABAAFAAYABQAGAAUABQAFAAUABgAHAAcABwAGAAUABAADAAMAAgACAAIABAAFAAQAAgAAAAAA/v/+//z/+v/4//j/+P/4//n/+P/5//v//P/7//v/+v/6//r/+f/4//j/+f/5//j/+P/4//f/+P/4//f/+v/6//v//P///wEAAQABAAAAAQACAAEAAQABAAAAAgACAAIAAgABAAEAAAAAAAAAAAAAAAAAAAD///7/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAA/v/+//////////7////+//////8AAAAAAAAAAP/////9//7///8AAAMAAQABAAAA///+//z/+f/3//b/+P/8//3//f/8//3//v////7/AAAEAAYABwAHAAcABgAFAAQAAgABAAEAAAD//wAAAAAEAAYABgAGAAcABgAGAAMABAAFAAkACgAMAA0AEAARABIAEAAOAA4ADQALAAYAAQD///7/+//6//j/+P/3//v/+//8//z//f/8//3//f/8//3//f/8//z/+v/7//v/+v/5//n/+f/4//j/9//4//f/9//0//T/8//0//X/9v/3//n//v8AAAMABQAIAAkACgAJAAYABAAEAAIAAwADAAYABQAGAAgABgAGAAYABwAHAAcABwAFAAMAAwACAAIAAAABAAAAAQADAAQAAwABAAEAAgABAP//AAD//wAA//////3//P/9//3//v/9/////v////7//f/7//v/+//7//z/+//9//3//f/9//7//f//////AAAAAAAAAAAAAAEAAgAEAAQABQADAAQABAADAAIAAAAAAAAAAAAAAAAA//8AAAEAAAAAAAEAAgADAAQAAwAEAAMAAQAAAP///v/8//r/9//1//X/+f/+/wAAAAACAAEAAgABAAAAAAAAAAAAAAD/////AQAAAAAA/v/9//7/+//5//f/9v/1//T/8//z//L/9f/2//j/+v/7//7///8AAAEAAgADAAUABwAIAAcACQAJAAgACAAKAAkACgAKAAoADAALAAwACgAJAAsADAAOAA0ADQANAA4ADQAJAAcABwAHAAYAAQD///3//P/7//n/+P/4//j/9f/y/+//7//w//H/8//2//f/+f/6//j/9//5//v//P/+////AQACAAQAAgACAAEAAAABAAAA/v8AAAAAAgAFAAQABQAGAAYABgAEAAIAAgACAAEAAQABAAIAAwADAAIAAQABAAIAAAAAAAAAAQABAAEAAAAAAAAA///+//7//f/+/wAAAAAAAAEAAQACAAAAAAD//////v/+//7//f/9//7////+//7//f/8//z/+//6//r/+P/5//r/+f/8//3///8AAP7///8AAAIAAgACAAMAAwAFAAcABgAIAAsACgAJAAkACAAJAAoACgAJAAcABAADAAEAAAD/////AAAAAP//AAAAAAAAAQABAAIAAQABAAAAAAAAAAAAAAABAAIAAgACAAIAAQABAP7//v/8//v/+v/6//r/+f/4//b/9f/2//f/+f/6//z/AAAAAAAA/////wAAAAD9//3//v/+//////////////8AAAAA/v/9//3///8AAAAAAAAEAAYACQAIAAwADQANAAsACgAJAAcACAAGAAYABAAEAAMAAQAAAAAAAAAAAP3/+//5//n/+f/6//z//f8AAAAAAAAAAAAA//////7//v/9//7//v/8//n/9v/z//H/8//0//b/+f/9/wAAAQACAAQABQAFAAMAAgADAAEAAQAAAAMABgAIAAkACwAKAAsACgAHAAYABQADAAMAAgABAAMAAwADAAIAAQADAAYACAAIAAkACgALAAoABwAEAAUAAwACAAAA///+//7//v/9//3/+//6//r/+f/3//f/9v/3//b/9f/1//f/+v/7//z//P/8//3//P/6//v//P/8//v/+f/6//z//f////3///8AAAIAAAAAAAAAAQABAAAAAAD//wAAAQAAAP////8BAAAAAwAEAAUABgAHAAYABwAGAAYABwAGAAUABQADAAMAAgABAAEAAQACAAAA/v/+//v/+v/5//n/+v/8//7/AAD/////AAAAAAAAAAAAAAEAAAAAAP///////wAA//8AAP//AAABAAAAAAD+//7///8AAAAAAQABAAQAAgABAAEAAAABAAIABAAFAAUABAAEAAMAAgACAAEAAQABAAAAAAD+//7//f///////////wAAAAAAAAAA/////////v/+//////8AAP///f/8//z//P/+//3//v/8//7//f/+//3//f///wAA/v/+////AAAAAAEAAAACAAQABQAFAAQABAADAAIAAAAAAAAAAAABAAAAAAD+////AAAAAP///v///wAAAAAAAP///f////////8AAAEAAgABAAAA//8AAAEAAgADAAEAAQAAAAAA/v/+//7/AAAAAAAAAgACAAQAAgADAAIAAwAEAAQABAAEAAQABAAFAAQAAwADAAMAAgABAAEAAQABAAEAAgACAAIAAAAAAP//AAD//wAAAAAAAAAAAQABAAEAAAAAAAAAAAAAAAAAAAAAAAAA///9//7//f////7//v/9//z/+//7//r/+//8//3//f/9//7//////wAA//8AAAAAAAAAAAAAAAAAAAAAAAAAAP///v/8//z//P/6//v//P/9//7///8AAAEAAwACAAEAAAAAAAEAAAAAAAIAAQACAAIAAAAAAP//AAD///7//v/+/wAA///+/wAAAAACAAEAAAABAAEAAQACAAEAAQADAAQABAAEAAMAAwADAAEAAgABAAEAAQABAAIAAQAAAAAAAAD//////v8AAAAAAAAAAAAAAAAAAAEAAgACAAIAAQABAP///v/9//7//v/+//////8AAAAAAAAAAAAAAAAAAAAAAAACAAIAAQAAAP////8AAAAA/////wAAAAD//wAAAQACAAAA/////////v/+//v/+//7//v/+v/6//z///////3/+//7//7///8AAAAAAAAAAAEAAQABAAIAAgABAAEAAAAAAAAAAAAAAAAA/v/9//3//////////f/9//7/AAAAAAAAAAD//wAA///+////AAAAAAEAAgAEAAYABAADAAQAAgABAAAAAAAAAAEAAQABAAEAAgAFAAUABQAHAAcABwAGAAYABQAGAAYABwAGAAcABgAHAAUABAAFAAQAAwABAAAAAAAAAP/////+//7//f/9//3//v///wAAAAAAAAEAAQAAAAAAAAAAAP///v/+////////////////////AAD///7//v/+//7//v/9//7//v/+//////8AAP//////////////////////////AAAAAP////////3//v/+/////f//////AAAAAP//AAD//wAA//8AAAAAAAAAAAEAAAAAAAAAAAD/////////////////////AAAAAP//AAD//////v/+//3//v/9//3//f///wAAAAAAAAAAAgABAAEAAQAAAAAAAQABAAEAAQABAAAAAAAAAP//AAAAAAAAAAABAAEAAAABAAEAAQABAAEAAAAAAAAAAAABAAEAAgAAAAAAAQABAAAAAAD+//7//v/9//z//f/+/wAA///9//3//f/+//3//v///wAAAQAAAAAAAQADAAMAAgACAAIAAQABAAAAAAAAAAAAAAD//wAAAAD//////v/+//7/AAAAAAAAAQAAAAEAAwAEAAQABAAFAAQABgAGAAYABgAGAAYABgAEAAIAAgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAP//AAD///7//v/+//////8AAP///////////////wAAAAAAAP//AAABAAEAAAABAAEAAQABAAEAAQABAAEAAgABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP//AAD//////v/9//3//f/9//z//P/8//r/+v/5//r/+//8//v/+//8//z//P/9//7///8AAAEAAQABAAAAAQABAAAAAAD/////AAAAAAAAAAAAAAAAAAAAAAAAAQACAAIAAgABAAEAAwAEAAMABAADAAYABgAGAAYABgAGAAUABAAFAAQABQAFAAUABAADAAIAAQABAAAAAAAAAAAAAAAAAAAAAAD//////////////v/+//7//f/9//z/+//8//v/+v/6//n/+v/5//n/+f/6//v/+//8//7///8AAAAAAAACAAMAAwAEAAQABQAGAAUABAAEAAQABAADAAIAAgADAAMAAgACAAIAAgACAAIAAQABAAIAAgACAAMAAwADAAMAAgAAAAEAAAAAAP7//v/9//z/+//5//n/9//3//b/9v/2//b/9//2//b/9//2//f/9v/4//n/+//7//v//f///wAA//8AAAAAAAABAAEAAQACAAIAAgADAAUABwAIAAkACQAKAAkACwAKAAsACgAKAAwACwANAA0ADgAOAA4ADgANAAoACQAKAAkACAAHAAQABgAFAAUAAgACAAEAAAAAAAAA//8AAP///f/8//v/+//6//n/+P/4//j/+f/2//b/9P/0//T/9P/0//T/9v/2//f/9v/2//b/9//4//n/+v/6//v//P/8//z//f/+/wAAAQACAAMAAwACAAIAAAABAAIAAgAEAAQABgAGAAcABwAIAAgACQAIAAkACQALAAsACwALAAwADAAMAAsACgAJAAcABgAEAAMAAQABAAAAAAD//////v/9//3/+v/5//n/+P/5//n/+f/5//j/9//4//f/9v/3//j/9//3//f/+P/4//n/+P/6//v/+//7//v/+//7//3///8AAAIABQAGAAcABgAHAAgACQAKAAoADAAMAAwADgAOAA4ADAANAAsADQAMAAsACAAHAAYABgAEAAQAAwAFAAQABQADAAEAAAD///7//f/8//z//P/6//n/9v/0//T/8//0//P/9P/z//P/8v/y//H/8f/x//H/8f/y//P/8//1//X/9//4//v//f///////////wAAAAABAAMABAAGAAkACQAJAAkACgAJAAkACQAKAAoACgAKAAkACgALAAsACgALAAsACQAJAAgABwAHAAYABQAGAAYABQADAAEAAAD///z//P/7//z/+//8//v/+v/7//r/+f/5//n/+f/5//r/+v/6//r/+v/6//v/+//7//z//P/8//3//f/9//7///8AAAAAAAAAAAAA//////7//////wAAAgAEAAUABgAGAAYABgAFAAYABQAFAAcACAAHAAcABQAEAAMAAgACAAAAAQAAAAAA///9//z//f//////AAAAAP/////+//7//f/8//3//f/+/////v/+//3//v/+/////v/+//7//////wAA/v/+//7//v////7//f/+/wAAAQACAAIAAgACAAMAAgACAAEAAQADAAQABAAEAAQABAAFAAQAAwAEAAMAAwADAAMAAgACAAMAAwADAAMABAADAAMAAwACAAIAAgABAAEAAQABAAAAAAD////////+//7//f/9//3//v/+//7////////////+//7//v///wAAAAAAAAAAAAAAAP//AAAAAAAAAAAAAAEAAAAAAP/////+/////v////////8AAAAAAAAAAP//AAAAAAAA/////////v////7/AAABAAEAAQABAAIAAAABAPz/AwD+/wQAAAADAAIAAwADAAEABAAAAAUAAAAGAAAABAAAAAQAAAAAAAAAAAD///3//f/8//3/+f/9//v//f/8//3/+v/7//r/+v/5//n/+v/8//z//////wAA//8AAP//AAD+//////8BAAAAAAAAAAEAAAADAAIABAADAAUABAAGAAcABwAHAAgACQAKAAoACwALAAkACAAIAAgABwAJAAkACgAIAAcABAADAAIAAQAAAAAA//8AAP/////+//3//P/+//v/+//3//j/9f/2//X/9P/1//X/9f/2//T/8v/x//D/8f/y//T/9f/2//n/+v/7//v//P/8//7/AAABAAMAAwAGAAYACAAHAAgACAAJAAoACgAKAAcABgAFAAcACAAJAAkACgAKAAsACgAIAAYABgAGAAUABgAFAAUABQADAAIAAAAAAP7//f/9//z/+//7//r/+v/4//j/9//2//b/9v/3//f/9//3//j/+P/5//r/+//9//7//v/+//////8AAAAAAwAFAAcACQAKAAsACgAJAAgACQAKAAsADQANAA4ADgANAA0ADAAKAAsACgALAAkACQAHAAcABQADAAIAAAABAP///f/5//j/9f/1//P/9P/z//H/8f/x/+//7f/r/+r/6v/p/+r/6v/s/+z/7v/u/+//8f/y//P/9f/3//f/+P/6//7//v8AAAIABQAHAAgACwALAA0ADAAOAA8AEQARABIAEwAUABQAEgASABIAEgARABEAEQARABAADwANAAsACgAIAAYABQADAAEAAAD///3//v/+//7//P/7//r/+f/1//T/8v/x//H/8v/w//D/8P/w//D/8v/y//L/8//0//X/9//4//r/+//8//7///8AAAIAAwAFAAcACAALAAwADQAPABEAEQASABIAEgATABIAEgASABMAEwATABEADwAOAA4ADgALAAkACAAHAAUABAACAAEAAAAAAP///f/7//r/+P/4//b/9v/1//X/9f/0//P/8v/x/+//7//u/+//8f/x//H/8v/0//T/8//0//T/9v/4//n/+f/5//z//v///wAAAQAEAAMABQAEAAQABAAGAAUABgAGAAgACQAJAAoACQAKAAkACAAIAAgABwAIAAcABwAGAAQABAADAAIAAgABAAAAAAAAAP7//f/8//v/+v/6//n/9//2//X/9f/1//X/9f/2//j/+P/5//n/+P/3//f/+P/5//v//P/9//7//////wEAAAAAAAEAAQADAAIABAACAAQAAwAFAAUABwAGAAcACQAJAAoACQAIAAcACAAHAAcABgAHAAUABAAEAAMAAgAAAAAAAAD+//3//f/7//r/+f/3//f/9//1//X/9P/1//X/9P/z//T/8//0//T/9v/1//b/9f/0//X/9//4//n/+//7//3///8AAAIAAgADAAQABgAGAAgABwAJAAoACQALAAwADAAMAAwADAANAAwADAALAAsACgAKAAoACQAIAAgABwAFAAUABAAEAAQABAAEAAIAAgACAAIAAQABAAAAAAAAAP///v/9//3//P/8//z/+//8//z/+//7//v//P/7//7//f///wAAAAABAAAAAQACAAIAAwADAAQABAAGAAYABgAGAAUABgAGAAYABQAHAAcABwAGAAUABQAEAAQAAwADAAMAAQAAAAEAAAAAAAEAAAABAAAAAAAAAAAA//////7//v/+//3//f/8//3//P/+//3//P/8//z//P/8//z//f/9////AAAAAAAAAAAAAAAAAAAAAAAAAAD///////////7//f/8//z//P/7//v//P/+//3//v8AAAAAAAAAAAEAAAABAAEAAQABAAEAAgACAAIAAgABAAEAAQABAAEAAQAAAAEAAAABAAEAAQACAAIABAAEAAQABAAEAAQABQAFAAUABAAEAAMAAwABAAEA/////////v/+//7//v/+//z//P/7//v/+v/5//n/+v/6//v/+v/5//v/+//6//v/+//7//r/+//7//z//P/+//7////+//7//v/+//7//f/+//7///8AAAAAAQACAAEAAQABAAEAAQACAAIAAQABAAIAAAAAAAAAAAAAAP///v/9//7//P/9//z//P/9//z///8AAAAAAAAAAAAAAAD//wAAAAAAAAAAAAD//wAAAAAAAP//AAAAAAAA//8AAAAAAAAAAAAAAAAAAAAAAAAAAAEAAgABAAIAAwADAAQAAwACAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA///+//7//f/+//7//v/+//7/////////AAAAAAAAAAAAAAAAAAD//wAA//8AAP/////////////+//7/AAAAAAAAAAAAAAAAAQABAAAAAAABAAEAAQACAAIAAgACAAIAAgACAAEAAgACAAAAAAAAAP///v/9//z//f/9//7///8AAAEAAgABAAEAAQABAAEAAQABAAIAAQABAAEAAgADAAMAAgACAAMAAgACAAIAAQABAAAAAAABAAMABQAGAAYABwAGAAcABgAGAAYABQAFAAUABAAFAAQABQAFAAQAAwADAAMAAwACAAEAAQAAAAAA///+//7/AAAAAAAA////////AAD//wAAAAD///7//v/9//3//f/9//3//f/9//3//f/9//3//P/8//v//P/9//7///8AAAAAAAAAAAAAAgADAAMABAAEAAQABQAFAAYABgAGAAYABgAGAAYABQAFAAQABAADAAQABAAFAAUAAwAEAAMAAgACAAEAAAAAAAAAAAAAAP///v/+//3//P/8//v/+v/5//j/9v/1//X/9v/2//f/9//4//X/9v/1//b/9//3//j/+f/6//v//P/8//7//v///wEAAgAEAAQABQAFAAYABgAFAAYACAAJAAkACgALAAsACwAKAAsADAAMAAsACwAKAAkACAAIAAcABwAGAAQAAgABAAAA/v/7//r/+P/2//b/9f/1//T/9P/z//L/8v/y//L/8v/z//L/8v/x//L/8v/0//X/9v/2//b/+P/3//n/+v/7//z//f///wAAAQACAAQABQAHAAcACQAJAAoACgAMAAwADgAOAA4ADgAOAA4ADQALAAsACgAIAAcABQABAAEAAAAAAAAA///9//z/+//7//r/+f/5//j/9//3//X/9P/z//P/8v/y//P/8//0//P/9P/0//T/9P/1//X/+P/4//r/+v/8//z//v///wAAAgAGAAYABgAHAAkACgALAAwADAAMAA0ADQANAA4ADgAOAA0ADgAOAA4ADgAOAA0ADAALAAkACgAJAAkABwAGAAYABgAFAAMAAQAAAP///f/9//z/+//6//n/+P/2//b/9P/3//b/9//3//f/9v/4//b/+P/4//n/+f/7//v//P/9//3//P/+//7///8AAAEAAQABAAMAAgAEAAUABgAIAAkACwALAAsACgANAAwADAAMAAwADAAKAAsACwAKAAoACQAJAAkABwAHAAUABQACAAIAAgABAAAAAAAAAAAA///+//3//P/7//v/+//7//v/+v/5//j/+P/4//j/+P/4//f/9//2//f/+P/4//j/+f/6//z//P/9//3//f/9//////8AAAAAAQABAAIAAgACAAMAAwAEAAQABAAFAAUABQAEAAQABAAEAAYABgAFAAUABQAFAAUABAADAAMAAwADAAMAAQABAAAAAAD////////+//7//v/8//v/+//6//f/9v/3//j/+f/5//n/+f/6//v/+v/6//r/+//7//z/+v/7//z//v/+/wAA//8AAAAAAAAAAAAAAAABAAAAAQABAAIAAgACAAIAAQACAAIAAwADAAMAAwAEAAMAAwADAAQABAAEAAMAAwACAAIAAQABAAIAAgACAAEAAAAAAAAAAAAAAAAA////////AAD//////v/+//7//v/9//7//v/+//3//v/9//3//P/9//z//P/8//z//P/9//3//v/9//7/////////AAD//wAA//8AAP//AAAAAAIAAQACAAEAAgACAAMABAADAAQABAAEAAYABQAFAAUABQAEAAQABAAEAAMAAwADAAMAAwADAAIAAwACAAMAAgABAAEAAAAAAAAAAAD///7//v/+//7//v/9//z//P/8//3/+//8//z//f/8//z//f/+//3//f/+//7//v/+/////////wAAAAAAAAAAAAABAAEAAQACAAMABAAEAAYABAAEAAQABQAFAAUABQAGAAYABgAHAAYABgAGAAYABQAGAAcABQAFAAQABAADAAMAAwACAAIAAgABAAEAAQAAAP//AAD////////////////+//7//v/+//7//v///////v////7//v////////////////8AAP7//v/9//3//f////7//v/+/////v/+/////v///wAA//8AAAAA//8AAP//AAAAAAAA//////////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAQACAAEAAQACAAEAAgACAAEAAQABAAAAAAAAAAAAAAD//////////////v////7//v/+//7//v/8//z//P/7//v/+//7//v/+//7//r/+//6//r/+//7//v/+//7//z//v/+//7//v/+/wAAAAAAAAAAAwADAAQABQAFAAYABwAIAAgACAAIAAgABgAGAAYABQAFAAUAAwAFAAQABAADAAMAAgACAAIAAgACAAEAAAD///7//f/9//z/+//7//r/+//5//n/+f/6//n/+v/5//r/+v/6//v/+//8//z//v/+//7///8AAAAAAAAAAAEAAgADAAMABAAFAAUABgAFAAUABgAHAAYABgAGAAYABwAGAAYABQAFAAUABgAFAAUABQAFAAQABAADAAIAAgABAAEAAQAAAAAAAAAAAP/////+/////v/+//7//////////v/+//7//v/+/////////wAAAAAAAP//AAAAAAAAAAAAAP//AAAAAP//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAEAAQAAAAEAAQABAAEAAQABAAIAAwACAAIAAwACAAIAAQABAAEAAQABAAAAAAAAAP/////////////+///////+//3//f/+//3//f/9//z//P/8//v/+//6//v/+v/8//z//P/7//z//P/8//z//f/+//7///8AAAAAAAAAAAEAAgACAAUABAAEAAUABQAGAAYABgAHAAYABwAHAAYABgAGAAcABgAHAAYABQAFAAQAAwADAAMAAgABAAAAAAD///7////+//3//f/9//z//f/9//z//P/7//v/+v/6//n/+v/6//v/+v/6//n/+v/6//z//P/8//3//f///////////wAAAAAAAAAAAQABAAIAAwADAAQAAwAEAAQABAAFAAUABgAGAAUAAwADAAQAAwACAAIAAgACAAEAAQABAAAAAAAAAAAA//////7//v/+//7//f/9//z/+//7//z//P/7//v/+v/7//v/+//7//z//P/7//r/+//8//3//v/+//7//v/+////AAAAAAEAAQABAAIAAwADAAUABQAFAAUABAAEAAUABQAGAAUABgAGAAYABQAGAAYABgAFAAYABAAFAAQABQAFAAQABAACAAEAAQAAAAAAAAD//////f/9//z/+//6//n/+f/5//j/9//3//f/+P/4//j/+v/5//r/+f/6//v/+//8//z//P/8//3//v8AAAAAAAABAAIAAwAEAAQABQAFAAYABwAGAAgACQAJAAkACgAKAAoACgAKAAoACgAKAAoACgAJAAgACAAHAAYABAAEAAMAAgABAAEAAAAAAP7////9//3//f/9//v/+//6//j/+P/4//j/9//4//f/9//2//f/9//2//b/9v/2//f/+P/5//r/+f/7//v/+//9//7///8AAAEAAQADAAMABAAEAAUABwAGAAcABwAJAAgACQAJAAoACgAJAAkACQAJAAkACAAHAAYABQAFAAQABAADAAIAAQAAAAAAAAD//////v/9//3/+//8//v/+v/5//n/+P/3//b/9P/1//b/9v/3//b/9//3//j/+P/4//j/+v/7//z//P/9//7///8AAP//AAAAAAAAAwAEAAYABQAGAAYABwAGAAgACAAJAAkACQAIAAgACAAIAAgACAAHAAcABwAGAAUABgAEAAYABQAEAAMAAwACAAIAAQAAAAAAAAD//////v/9//3//f/8//v//P/7//v/+//7//v/+//6//r/+v/6//v/+//8//z/+//8//z//P/8//3//f/9//7//v/+////////////AAAAAAAAAAABAAEAAQABAAIAAgACAAMAAwADAAQABAAEAAQABAAFAAUABQAFAAQABQAEAAQAAwADAAIAAwACAAIAAQAAAAAAAAAAAAAAAAD///7////9//7//f/8//z/+//6//r/+f/5//r/+v/7//v//P/7//v/+v/7//z//P/9//3//f/+//3//f////////8AAAEAAQACAAEAAgACAAQABAAEAAUABQAIAAYACAAHAAcABwAIAAcABgAHAAcABgAGAAYABQAFAAUABAAFAAQAAwACAAIAAgABAAEAAAABAAAAAAAAAAAAAAAAAAAAAAD///7//v/9//z//P/8//v/+//7//v/+v/7//v/+//7//v/+//7//v/+v/7//z//P/9//7//v///wAAAAAAAAAAAQACAAEAAgACAAMAAgADAAIAAwADAAMAAwADAAIAAgABAAEAAAACAAEAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAP///v/+//7//v/+//3//f/8//z//P/7//v//P/9//7///8AAAAAAAAAAAAAAAAAAAEAAQABAAIAAgABAAEAAQABAAAAAQAAAAEAAQABAAEAAQACAAEAAgADAAIAAwADAAIAAQACAAIAAQABAAEAAgABAAIAAQACAAIAAQAAAP//AAD//////v/+/wAA//8AAAAA//8AAP////8AAP7//////////////////////////////wAA/////////v/+//7///8AAP//AAD////////+//7//v/9//3//f/9//7//v//////AAAAAAAAAAAAAAAAAQAAAAEAAAABAAEAAQABAAEAAgABAAIAAQABAAEAAQACAAEAAAABAAEAAgACAAMAAwADAAMAAwADAAIAAgACAAEAAQABAAAAAAAAAAAAAAAAAP/////+//7//v///wAA/////////v/+//7//v////7//////////v/+////AAAAAAAAAAAAAAAAAAAAAAAAAQACAAIAAwADAAMAAwADAAQABAADAAQABAAEAAQABAAEAAQABQAGAAYABgAFAAQAAwACAAEAAQABAAAAAAAAAP///////wAA//////7//P/8//v//P/7//v/+//7//n/+f/6//n/+v/6//n/+f/4//f/9//3//f/+P/5//v/+//9//7//v/9//7//v8AAP//AAAAAAAAAAAAAAAAAgAEAAMABQAGAAcABgAGAAYABgAHAAgACAAIAAgACAAIAAgACAAIAAgACAAHAAcABgAGAAUABAAEAAQAAwADAAIAAgABAAAAAAD//////v/+//3//f/9//z//P/8//v/+//7//v/+v/6//r/+f/5//n/+v/6//r/+v/6//v/+//8//z//f/9//z//f/+//7/AAAAAAEAAQACAAIAAgADAAQABAAFAAYABgAGAAcABgAGAAcABwAHAAUABQAEAAQABAADAAMAAgACAAIAAgABAAEAAAAAAAAA//////7//v/9//z/+//6//r/+v/4//n/+P/3//X/9f/1//X/9f/3//f/+P/4//n/+f/6//r/+//7//v//f/9//7///8AAAAAAQADAAQABQAFAAYABgAHAAcABwAHAAgACQAKAAkACgALAAwADAAMAAsACwAKAAoACQAJAAoACQAKAAoACgAIAAgABwAFAAQAAQAAAAAAAAD///7//v/9//3//f/7//v/+//6//r/+f/5//j/9//3//j/+P/3//j/+P/4//j/+f/5//n/+f/6//r/+//9//z//v/+//7///8AAAAAAAAAAAEAAgACAAMABAADAAMABAAFAAQABQAFAAQABQAEAAUABAAFAAQABAACAAMAAwACAAIAAQABAAAAAQAAAAAA/////////v/9//z/+//7//v/+//8//z/+//7//z//P/9//3//v/9//3//P/9//3//v/+//7//////wAAAAAAAAAAAAAAAAEAAgAEAAQAAwAEAAUABQAFAAUABQAFAAUABAAEAAUABAAFAAUABQAFAAUABQAFAAYABQAEAAQABAADAAMAAgACAAMAAwACAAEAAQABAAAA///+//7//f/8//3//P/9//3//f/9//3//f/8//z//P/8//z//P/7//v/+//9//3//f/+//7////+//7//f/9//3//v/+//7/AAAAAP//AAAAAAAAAAAAAP///v///wAAAAABAAEAAQABAAIAAAABAAAAAAAAAP//AAD//wAAAAAAAAAAAgABAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAA//8AAAAAAAAAAAAAAAABAAEAAAABAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAAAAQAAAAAAAAAAAAEAAAAAAAEAAgABAAEAAQAAAAAAAAAAAP//////////AAAAAAAAAAAAAP///v/+//7//f/9//7///////////8AAAAA//8AAAAAAAD//////v/+///////+////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAgABAAIAAgACAAIAAgACAAIAAQACAAIAAQABAAEAAQACAAIAAgACAAEAAgABAAEAAQABAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQAAAAAA//////7//v/+//7//v/+//3//v/+//z//P/7//3//f/9//z//f/+//7//P/9//7//v/+//7//v/+//7//v/+//7///8AAAAAAAAAAAAAAAAAAAAAAQAAAAEAAgACAAQAAwAEAAQAAwAEAAMAAwADAAIAAwADAAQAAwADAAMAAwADAAIAAgADAAIAAgABAAEAAgACAAEAAQABAAEAAQABAAEAAAABAAAAAQACAAEAAQABAAIAAgABAAEAAgABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/////////////+//7////+///////9//3//f/9//3//f/9//3//P/9//z//f/8//v//P/8//3//f////7//v/9//7//v//////AAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAwACAAIABAAFAAQABAAEAAUABAAFAAQABAADAAQAAwADAAMAAgACAAIAAgABAAEAAAAAAAAA//8AAP///v/+//7//v/9//z//f/9//7//v/8//3//f/9//7//f/+//3//f/9//3//v//////AAAAAAAAAAAAAAAAAQACAAIAAwAEAAQABQAFAAYABgAGAAcABwAFAAYABAAEAAQABAAEAAQABQAGAAUABQAEAAMAAgABAAAAAAD+///////+//3//v/9//3//f/8//z/+//6//r/+v/6//r/+//6//r/+v/5//j/+f/5//n/+v/6//v//P/9//7////+//7///8AAAAAAAAAAAEAAgAEAAQABAADAAUABQAFAAUABAAEAAUABQAGAAYABQAFAAQABAAEAAQAAwACAAEAAQABAAEAAAAAAP///v/+//7//f/9//z//P/8//z/+//6//n/+f/4//n/+P/4//n/+v/7//v/+//8//z//f/9//7/AAAAAP//AAAAAAAAAgADAAQABQAGAAcABwAIAAcABwAIAAkACAAJAAoACAAIAAgACAAHAAcABwAHAAcABwAIAAcABgAEAAMAAgACAAAAAAD+//7//f/8//z/+//6//j/+P/3//f/9f/1//X/9v/0//T/9P/1//X/9f/2//f/+P/4//n/+f/7//z//f8AAAAAAQABAAMABAAEAAQABAAHAAcACAAJAAoADAANAA0ADQAMAA0ADQANAAwADQAMAAwACgAJAAkACQAHAAYABQAEAAIAAAAAAAAA///+//3//P/8//v/+//5//n/+P/3//f/9//2//b/9v/1//b/9v/2//b/9v/3//j/+v/6//r/+v/6//z//P/9//3//v///wAAAQABAAIAAwAFAAYABwAHAAgACQAKAAsACwALAAwADAAKAAoACQAJAAgACAAHAAcABwAGAAUAAwACAAAAAAD///3//f/8//r/+v/4//f/9v/2//T/9P/0//T/8//z//L/8P/y//L/8//0//X/9v/3//n/+v/7//v//P/+/wAAAAACAAIAAwADAAQABQAFAAcABwAHAAgACAAKAAkACgAJAAkACgAKAAsACwAKAAoACQAJAAgACAAIAAYABQADAAQAAwADAAEAAAD//////v/9//z//P/8//v/+f/6//j/+P/3//b/+P/3//f/+f/6//v//P/8//3//v/+//3//f/9//7//////wAA//8AAAAAAAAAAAEAAQABAAEAAQABAAEAAgACAAIAAwACAAIAAwADAAQAAwADAAMABAAEAAQAAwADAAIAAwABAAEAAAABAAAA///+///////+//7//v///////v////7//v/9//3//f/8//3//f/9//z//f/+/////v/+//7//v/+//7//v///////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAP////8AAAAAAAD//wAA//////r/9//1//T/9//5//z//f/6//r/9//x/+3/6P/j/93/2//W/9D/yf/H/8b/xf/E/8f/yf/M/9L/0v/T/8z/x//G/8X/yP/O/9H/2v/n//L/9f/y//D/8P/s/+b/6P/p/+v/8f/8/wIACQASAB0AGwAaACAAMAA1ADMAMQA1ADsARABQAGAAYgBqAGsAaABhAFkATABBADcAIgAZACQALQArACQA///M/5P/f/+B/5v/wP/g/woANAAzADMAOAAxACYAAADp/+f/7v8QAFEAuAAvAXEBbgEFAZwAMADi/+P/GgBEAGAAeACKAFkAcQBJAAIAo/8Y/1r+vv1t/aL9M/7P/mz/tf9jAJUAtAAcAVQBOgEwARMBBQHaAAEBAgHtAPkAAgGKAHIALgC9/43/d/8+/w7/Bv/w/v3++/4V/zn/Sf97/5//v//7/zIAKwAnADIANgA+ADcAMQAvAC0ANABAAB8ADwAaABcADQAOAAMA/f8IAAkA+v/s/wkA+//s/+P/7f/v/+X/3P/e//f/EwAKAP7/zP+1/1n/XP8s/2v/Zf+j/9X/EgA8AFEAKgD8/8v/pv+F/4b//P8NALIAzQCEAd0BvQE9AcQAbQAZAEgAEACWAMYA+ABqAdgA6gFAAdwCzAFgBFIDsATjA0cAJwKp/lcDdf5qBSgDAAvDBkMLlQfrBQIFYAGFA90AzwP0/z0A1f1k/qT9Bv0T/gv8L/t++7H5lPhN+Uj5tve3+Un4mfpe+Zb7gvps/dH8/v0o/Sn9X/7T/N/9x/xk/Yv8sP3G/f7+KQG1AMkBswIVA8QDfwOcAuUDZQWoBzcJNguPCmMM/BF+G+MttDm/SD5Bhzu1JLoVTAEl9KLr5ecg37fcpNbS0VTNO8osymfFAsZ8wY6/Gr2hvhLDrMUmzU/TTd7Z6rP5QAh5FRAc5x1CGlkSeAouAYD7svud/ekFuA/AFrIcXh8MHgIcShblD7YJYAM3/7r9wP4k/7kBzQSKB5UKYAySDS8NLQvxBj8DFv0i933yqu7u7FzvxvMT+ev/zQSLB6kI/wVGAqv9VvvQ+l79ewHKBv4LexCXFKsX8BpXHakeax4UHYEa9Re3E6wRxRABEKsRNBJsEqYSwBFmENwOXQ0RC5sIIgXCAFD+wv06/jgBHQLcBO4FkQiGCK8GVwWRAhsBavwBAKH/FgXPBIIIdgekCJAKtwubDPIN6g5XDKsLmQrNCeoHFAk1CyUK+wq4Cp4JxAdsCIkIJwa3BVICEgBW/HD7+Plg+0D+0AL6B6oM0RAKD3oO8Qh+BOb9SPrN9uH1w/U49QD2zfCK7hvq5+W+4ITggN7G2+7czNwg36Tc7+Ci3dLc8Nsy3xvj2uSh6ZPoZOWu41HjjuNA5FPpi+287u7vOvMS84Dy1fO88zDwTPF48pbzLveL/NH/zgHLAhQDQAL9ApMFgQn4DGgSsxafGQAdaB60HjwfYR4TH44g+yF7JAYnRyczJy8lTyJuHtwczRpCGnobARsRGicXgBOJDsAKmwbTBH4DQgIoATEACf7S+kL4JvaL86byN/D97wDukOzW693q2Ohx50Hn0uTl5evlyuZ/5ELjed+4217Ye9aM1czYu9p53U3dytyP2k/Y3dVx1GDVstQw1tbVidWJ0qDQCM5tzU7PGdGj1GLVqNQT1NLSJdPQ1dTZz91P4Z/jyeTK5W3mJOYa6BHoo+qO6nbs2uwa7DLut+888sj0n/eR98H3cvbG9c/2dPkv/Ib+ugCT/rD9fvzo/bYBwgarC48OeA7MCsYG5QMHA+8E8AdSCmcL5QonCpsKwAv0D20X7iH9MLlDLFidapd1KHYNbYVdL05lRqpJBVdHaKB3ZH+pfTJ2jWvQY11gYGA2Ygli6lzxUWFC7jCHI5YdPSBiKZsypzYiMgElBxRbBO/4lPT28/30b/WS81HxRu7K653qBOs17K7tde7S7NXo1eIN3dTZ3Nvw4kDtk/e9AF4GcQlJC2YLeQoqB0ACq/ze+EH5vv1GBUoMPBGEErUPXguJBYMACPxq94HyiO3y58HjUOCX30ripua068XtYetV5KDZ986PxwLFHcf2y0XRjtOS023SiNDxz0XPXdBuz2rNbMkBxaLB+cFlxXfLXtM424nh/uM249bestog1rnUu9WG2TLe6OEG42vjK+NJ5DPmhegd6qjpaebn4AHbPNbo003THNQo1c3VWtbo1YfUqNIe0K/OUc5W0FXVF9706V/4LAhlGYcq8zmIRQdLRUnFQbE4kDIiND8+I04PX/tqFm9pbDBmZGD5XX1eSl//XLJV70htOS4q8h4GG+cdESWjK/MsCSYCF7cE8fLo5jDh5t/a32vdztc40f7K1cejx7rJz8ykzhzOb8rhxOK+R7rWuB68I8Qzz/nZsuF65Rfm6+Vu5o3pPe7F8p72Z/n6+0AB2QrzF1EmYTKGN5g0+yppHtgT9Q5XEC8WuxzMIE0f0hjZD5kHCAN4AkYDQALJ+wfvw97Fz9bGC8hc0UfdCeaM5uHfLdRcyQbE7cS0ynrRhdXF1cDSHM/xzVrQkdfU4WPriPAN75vncd4Y2B3YD98o6333HQAMAyIAUPvC95T3jvr4/m4CxwL2/7/66fbf9eX41P1CAzkGJAZ7Asb7p/Ts7v/rH+zi7X3vxO9a7hftWu/u9nAEIhW8JaczJj7HRhJOaVSvWBpZI1ZUUhJQSFLGWQhlT3APeTp9BX15erR1k3F3bRxqU2auYQBbVFJuSB4/FTmBN+05RTx0O0s0Myc2FwYImf3b9zn2S/WM8srtwucB4gje79t626rbatvu2VvWrdFFzNvHu8ahyTzQ2Nh74K7keeUR5H/jRuXy6VDwf/YM+3P9ov8KAuQFZwqED5IUUxoQIe0okzDoNOE0vi77JJcaVxSpEngUrBdXGZAXUxKUCskB6fkK9JbwDe6V6kflutwZ0kLIosLZw2LKGdNq2F/Xgs9yxNq6ibbnuMa/acf8y73MF8vgyAnJy8sJ0aPXFN2h3/3d9dgn06HPktBG143hW+wV89HzM+9i6B7j9OFm5A/o2ep26mfn9OI14GbgO+MD58zpHuoV6BrkH99s2vbW1dRw1IPUWtTp09TTGtaj3O7oRPphDQMf2SvvM0M4mzofO0g68zcDNtc2gzuqRBRQCVsHY6NlD2XzYoxgal4nWyNWyk5+RYQ8zzPlLHgoUibTJe0lHyQ8HjsU8AYy+S7uDOel43XhlN6s2anTSc4Ty/rJmMqdy1/Ldcn1xfbB771Wu1S7WL7qxKPNZdZt3Vnh9eKQ4xvlU+hG7cny+Pfu+6/+XwGIBOMIpg4UFUYbTiBGI2QkTCRfJGMltidzKqcrQyo+JoogGRvEF6AW4hb1FocU3g6kBmT9fvWL8IDuR+6A7QDrQ+bR30jahNdM2KLbat/94ILfLdup1hvUoNXH2vnhLuip67rrqOl753rmuOfv6kDvfPK084fyi+/G7ODrC+7Y8r74Q/13/hz8f/d58oHvq+6+74/xrvLA8ijxHe8Y7SHrYOq06SvpS+ix5inkEOET3mvbVNnn14HW2NWN1vrareNB8SUCrBOnI7MwtTqeQlNI5ktCTO5J4UaVRZVIwFDnWzRntG/yc5p0VnN3caZuEGrHYjNZyk4pRRc9QTfgMpkwTy8ZL4ot+iirIHIUzQZ8+k/yxu2C6pPmnuC62enTYtG70TfTLNS40n/PlsuxyODGb8ZEx8vJhM4r1jTf1ed47tzxtvPd9Yz5Hf/aBMQJnQxIDpkQYRQXGlcghiUsKVMrlSz3LFMsIipXJiUjUSInJSIreTGKNDEyxCoiIWEYyRLcEKcQchDVDaYIywHi+qb1JfOd8ljzDvMw8I3qC+IH2WbS088y0pHXWN2o4FLgM93v2dvYkNvD4GXmpenP6VbnceQ848Hkn+jo7TvyXfSp84bwbOyw6M3mIOd86TTsne2o7E/pFeWT4Z3g/eGD5PflYuXC4bTcYNiT1u/XUduo3t/fR95Q2jzWIdM40pLSy9J00drO2sw5zu3Up+F88vMEZhZoJWAxnTqOQA5DyUGJPos7xjsyQJ9I5lKfXDZkemmXbEZuu202amFjSVnhTVFCwDfMLbkk/xwOGH8WaxcBGJ8U6gtB/uPvWeS03VHahtfv0lvM7sVywhDDAse8yx/Ppc8FzhnLucgrx97GvceAyrvPCtdx32rnju2b8bL0RPj6/J0CDwjWCyENSQ0/DZ4PvBMpGn8f0CPUJQMmDiUbI+Mf3huCF0YVfRWlGKUcAR6ZG78U6wx/BnEDQQNvA4gBB/0w9mfvzOoJ6T7poupo66jqTugP5KveMtmt1RHVFNgd3eDhWeQ/40LgSt2A3Wrhz+e77d3wN/AG7Wbqp+lN7HHw6vTs9u/2mfSY8e7uCe3367jrBew+7FzsI+ub6HLlZuIc4VThyuLR4w7je9/n2gnX4dWB11LbYN8w4pvjr+PN4wHksORg5Q3mMuaq5dTjQuBl3PHZq9sH5EzyggQdFz4nKzTKPj9IH1CeVAdUl075R1hEXkeIUH1c2GbYbPFuwm9NcWpzpXPFbnlk3lUTRz06fjC/KJAikx3fGgcadhl3FpAOJQIJ9IHo8OFv3y3ento31GPNCcqVzDXUW92E47vkcuE73dHaHtsd3eHes9/X4GLk+urG8/77WAGfAyoEewWPCA4NcRD2EMMO7gtLCz4O7xMdGmQezR9tH30ech2+G0UYJhNYDZ0J1AnxDXETuxY2FXMPRQgSA50BrgJkA7cByfzB9ijyQPHE8wn42fvw/ZL+X/6F/cD7rPjn9E3yR/JK9ev5Uv3r/YP7XfhL9/P5Bv97Ax8EDgAz+b7yhu8s8O3yU/XE9dLzrvDb7frrc+pk6EfljeHD3jrd89zD3D7cCdtf2g3bVt3Z38ngMd9d25bXgdYN2V/e8OOh56ToKujy5yHptevJ7qLw2fBu73Ture2U7H7qkeay4sngS+PF6jr1ywBRCxEVSh/bK+A5+UaLTr9OB0iOP2E67juDQyNNh1QYWGtYsFiIWmpdlF5OWxlTE0jDPGQzGCuVInkZMBEoDOgLhQ5QEBgN9wMF9zPraeT44gfkl+Nv3/nY3tOA02DYpt+05Z7njeXp4ULf1t5a33LfPN4B3QrejOKh6dbwTvVE9jH1w/QL9477ewAyA+0CCwEYAFMCeQcXDlYTLhaLFh0WtxV+FTgUrRHiDdMKdApYDUISQBaiFvASGA3lBw4GNAf2CMkILwUu/475tvaD99z6Vf70/y7/3Pzg+bz2Z/N477XrIumL6ErpMOqF6Rbnw+PI4VHiheXu6GvqLehU4xDeINt7203ewuHe4+XjeeLk4CDgSuB44Onfm95b3Qfd5N083xDgMuD438fg9+L/5Vvoo+hq5vfiO+Dq3yrisOW06CHq+elF6bDo0Ogv6XzpYunW6FPoG+gv6K/oPuj05tDjPOCn3WncP92238Tky+uQ9A0Aeg4JH+8vUD4fR1ZIVUO2O9014zSZOfRAKkhQTQ1QgVKcVjZctmE1ZKxhfVpUUINFiDsTMg0q0CMOIWQiMSY8KQ0oOyFuFuQL8gSYAmYChwCh+qLxdOmm5Z3nWe2T8jf0ZvHb6+Lm8uPR4kji7OBa3ybfAOLn5yDvLPVD+MX4qfiY+Xz8QwCxAsIC1ADm/mT/KQMxCYIP+hMRFocWZxYqFnMVyxNaETIPLQ+/EW8WZho4G4sYORQJEU0QvBHlEhwRpgv8Azr9e/lf+ZT7vf0K/oL8+/lD99H0BvJF7nrqeOdY5iPnvein6UHpOejQ567pmu0d8rb0z/PS79nqVOcc55rpHu1774Hvne0y66PpgunL6V7pQefI4+nf3Nwb22raU9qt2nfbDd0x3wzhd+Ee4Gjd4tro2eraJd1b35Dg1uBU4ZjiKeU26Jrqm+tP6ybqEelV6Prn5ufc57PnQOcS5jjkReK14dLjFOkk8Z36SwVfEQQf5i32O/BGrUu3SQFEtj67Pa5BJEiKTetPFlCSUY1WlF6DZnNpR2XVW2BQJUcJQfw72TUBLn0mTSILI7ImHCmoJj4e9xIiCZID/gGWABz8rfPu6SrjkOJV5+/tx/Fh8KHqN+Q04A3gAeJK45LicuBv3x7iTegj8Hv2TvlK+ab4mPm8/KcAJQPoAlABgwDkAnsITQ+bFNUWThb3FJ8UZBUpFngVMxPhELkQvxPcGEkdYB6DG6cWcxIlEeERGhIxD+sIQwFY+/j4SPrh/OD9+Pt997PyFO/f7CLrjOh45Frgjd0W3dLeA+FW4g7i5uBb4GTheuMS5V7kA+Et3CDY9tbD2Cjcpd6Y3u/bQ9iB1aXUCtUK1XDTPtAUzXrLd8xrz7TSTdXg1hbYztkC3AText7J3bPbxtlc2dXant2A4GXiBuPw4grjE+T25U3oIurR6oPqiun96BzpzOlS6orpD+fF4xjh9uDI4z3pye959rr9CwfJE1Ej2jLuPaRB1z1qNtMwvDCsNVI8C0GBQppCAEUrTKJWQmDVZIFidVtlU8NNpkqAR+hBljl8MTMt2C4HNGE4LDfrLtoikhddES4QChFYD/gIOv+j9v7yxvVX/A8CdAM6//r3xvBl7NXq4Oqo6mPqjeov7ZXyUPnS/9oDXAWXBecFTwdCCRQKDwmfBrgEqQUuCkIRjBhqHXceJRxSGKgUbBJiEXsQ7w6zDAILZwukDrATYRhwGVkVUwwYAar2Ku9K61npkujR5wPon+js6aDrW+2G7hLtEur35VHhxNym2SvZD9xP4r/qe/IM9wT4e/Wy8Yrus+yC69npvOYx4ofdO9pX2QfbKd6k4JfgDd021tLNmMW6v6m8yryQv33D3ceoy/zOQdKu1RDZ79vZ3ZPeS96F3ercHt0233/jdekm8Kr1avnl+q36LvmL9+H1c/Ul9qD32vhP+Sj5wvgg+BT2AvKc69XkUN/F3eDgs+ij9EEDNRUMKpBCj1y8c/9//3+/cKFZQUUqO9U+6EpWWKxfRF9YWrVV7lRXVjVVK0t1Nv4ZX/0r6Grd2dz44c/pB/Hd9tj5Efmr9Gvt3+WG4OLffuSS7Xb4FANsDJAVuSB2Ldk6ckSvR9BDEDtuMWUqYShGK4QxIji6PDQ9NDnoMU0oyB1+EjgHs/v58KXnF+Bi20fZnNq+3mbkVukk6/PoBuPy2zjWM9Rg1ubbXuMd6/ry1PvRBxQXMSiENgI9UDkELf4dEhJ2DbkPRBZ2HDkf6ByiFjUPMgilAub7gvGt4pDRIMKVt06z6rRyu8XDF8yN0E7Q3coZw+27+LewuAC9MMV1zXzVaNuI3xbk0Oi67hHyZvFl65DhateTz6zMes5R1Ejb7ODt4nTh5N012kbYV9ew14HY79mH3BvgxOQb6q7vZfU9+mv9Uf4//PD3p/I27pfs/e1j8j73fPpM+jT2BPC06cvkaeH33vnaH9XlzszK4cp70D7aBuaN8aH7fgb3FBgrDkgzZiN9/3/cd5dg7kg5Pd8/xk0NXO1hgly7TkFAMjfvM3sxyylEGMH/ruaX0rHJxshSzvbWp9/j6NvvVfTe9Bjy8O7n7gn0IwA5EGUg8C0nNvY7s0FQSXJTJVp1XHtWS0mAO1kt1CVZIykk5CbQJa0h7xiXDGv/jfHB5ADaJNJyzBLKeMhyyFvKks2A1NDb5+Oc6bTrT+v46IToK+tR8rb84gc5Ej0bkCLzKlYzUjomPpk6azHQIwQXRg5xCmkKhgp7CLECGvpv8JHnv9/318vO6cTNuoe0cbJwtVa8fMSozezUv9vs3s3hA+J14nzjS+X+6qrxlPvIA+4JhgxeC8MI6AS+AGD7ZfQu7D3ja9s61lbTi9M61ELUe9Kvzl/K3MYwxePF1Mh0zV3ULty55Mntp/V3/UUDmwfjCdcJDwkTB5wFywQ3BRcHvAnfC8YMHwtzBz4C0Ptn9T/uyed14infWt6w317hiOIp4wXkoObS6vjwV/f2/dIFXBFmJepAKWD0eP9/RXnjY1dMbT40PStGwFFwVsNS/0VYOPEuOStCKn0l6RimBT3xvN7v0+HO79Hx2rnmD/OR+eT75fj39C/xR/FA9tsAVg8OHHwlmSk0Ld8xcTksQc9F2kUHQDA1IygZG1QShw8HEBwT3RJCEMsKcwHr9t7pBt5L1afQec/NzwnR89LZ1q7bMeIk6crv6/UL+Wn60Pm6+tf97APhC8QSABlOHSoioihYL0MzhDBTJcsVtQZq/Wv6QPts/FX6e/SW66ri0Nt02C7W+NI+zafGYsKBwVfErsmR0BXZCOKj6LHs2+xg7Nrryexj78Xyp/ij/rEEbgeFBz4FZgKAAJD9cvnF81/steXf347ckNuV3cHgHuJw4vLettsz2Q3YLNmi2ijfSOTp69byhPjC/On/rgO6BogJ9glYCHcFFgNeARoDWwYIC8sOIg/fC9YEXf129m/yIvD075PvaO+Y7ojtku0f7xnxvvF075Lqu+WD4onkh+js74/3+P+uC+0cazbkVItx/3+QfElmVUqRM9UsYjMuQv1OUVLTTLs/ejV5LQoqEyMMF5AC2+yc2o7PdM7f0OXaz+V78kn8/gBF/7j5hfJa7Tjur/WFBZAWLSeyL0Q06TXsOKQ9WUD1P205BS8fIXIUiwkeBocG6wpjDpUMEAh1/U7x0eIC1bvKUsZGxzDMidEG1oraTN4w5NvpwO9N9a73rfhu91z2EPne/lUIhRFBGNccnB9GIw4nayixJPAaTQ3gAI74zvXk9jD48Pfc8yLtXeUP37PaYdiu1CfQjMsDyTPLSs9E1nTcUuPo6WfuUPGR8WPxh/FA89f1VfoiAAkHxwznDo4NdQhoA+D+tvqW9s3xhex+6OnkF+PQ4pXjsuWB5Y7kf+Gx3mLdQ91v3q/gkeQq6mnxyPe+/T0BagSCB+YJdwztDIEMwAoGCdEHwQczCRELEg3qDFoLXgZoAa77B/gI9iz1yvWS9Ub2+vRG9HryR/IJ8rXyifE876fsvurR7E7w0feg/YEEoQmHEOIcvjEfTiNqIH1ge3Np6ExSNnktaTNpQqdNL1CuSPs6oi0KJkohRh2pEqYCou6/3iPVQtLI1abcaOf78Z77Cv6u+4f03+zZ53TnTPD5/aUQGiEtKVMspyqmKpgs+C/xMGctgSVwGS0N8gIXAAECsgehCzcJowGs9Ufpc9zu0kvM3sn7y9PP3NNn1wHbq95q4wrofu218Uz2E/kW+j38BgC8BpUO7RUhGuQdziF+JhIpnifLH0kUWAhBABv82fuZ/EH7RPem7wboYuAQ3T3a/tdB1HDQRc7BztPTJdky4h3p5vD69LH3Ufdo9/j4WfvG/1wD9QnsDWgT+xPSEdgMggc4A5L+sPsk9sDx++z46MjlzuRV5QHnCuiD5hHjmN683G/c8N5f4jTnVOyb8vz3lPypAOgD0AfGCQIMwQuCCyQLvwpHCwYMdQ0WDpQN7AqABk0B7/wm+i34Avjx9tH2E/a59SL1VfSq8+ryZ/L08GPwpe7Q7uLuhfC78nr1CfnN/P7/oALcBbwLlhkkMB9OZWpgfIR7CWuNUu884DL9M9M9PEdeSeNCDzc9Kn8i/xv5FXQKhPoW6ivbXtEjzGzNvdIb3nnp3fKt+AH4M/UM75TqBOsI8jMBExL/IAQqDC1OLuUtyC8kMFcvqStxIvQWDwrrAOT8CP7j/5AABf4q+Nvw2OUc20rQDMlYxzbJTs7a0+fYFN2g4G3j+efz7OHySve7+bb61fts/80EsgujEgAYsRtKHoAfWyGWHw4c8xJHBwj92vUA9Pj0/Paj9eTxLupT4hfbKteY1OLSadH4z3jRSNRt25Xhqeik7ajxPvR+9U/33PcI+7H9NwIIB3AM1xBWEw0TWQ6yCE0B8Pvo9pPzzvC37f/rAOpe6HLnC+d35nDlx+ML4Y7f9N/m4QHmweqx8IH2NPzOAK0C9ANKBBIFnQe3Cl8O1xDzEmwTaxNsEx8S4g84DFwHwwKc/0v+gv5Z/zIAlf+s/qX8tPqG+HH3e/Ys9pr2Tfej+E36o/zY/UP/YP9L/kD9fvzH/doAJAXVCJwLXw/WGMkq4kSFYFBzQnUdZdlLCTTYKdcs5zg7Re5HzUIaNl4p9CCtG90W7A2j/6rvduD11uTSvdPD2W/iyu3c9qn94/2v+UnzGu0X7Wr0xAPXFYMlNC7QL2IukSxhLPgsKyv0J0MgehYzDL8Bl/0A/Bf+Wf9p/Mr2Iu1D4tvWycyvxvHFesmcz/jUzNke3ZHg1+NJ53/rX/A89aX4FfvH+xb/rAM0CjYS0xc1HSYfqh4/G1sUwA3SBfD/Z/uR+I/3yfZg9Rbxxesw5dvgxdwo26fYg9bu1WTVJ9n63F/j5OkO75byoPRt9N71HvjX+rX/HAOAB7sKBQ28DSwMxwkUBsoCP/+V/Cr6Kfgo9qfzGfHK7nXtJOys6/PpyOep5ufk5+Wa5zvqG+4K8cLzwvXO9jf5BPsv/u0AWgNlBoAJWg1rEN0SrxKfEf4OtgwwCtAI/gfrBtcGsAXgBcAFugVpBFwBL/2v+Qz3SvYa9pb1H/ap9tj41Pvm/ioCaQSsBdgEQQPDADX/+v7r/usALQPlBhAKeAzsDqsUoiKaNxxQ82EcZuRatUSvLzgilCJvLdM5fUGmPTczbCRKG/UUPBD9CSn+ovIq5rDfFNt03Vzi4enP8j/4ffzl+iv3CfCx6fDoNfCf/lARTCDtKOgphiaqIdMddR3ZGwwcAxhxEhAMvwWFA8YBEgIcAU7+hvkW8uDng9y/017Ns8160fjWON0k4Fzhk98i3qbe0uGa59Tt5fIh94D6yv1kAtwHnQ+UFZMajxoJF6gSNgwOCBEDUQCZ/b/8t/pn+Hn0uu+p6vXkod9x2nrXGdbz1kTY8duS3yzln+nC7V7wc/I69cT2JPm6+sX8qwCbBGcJCg1bDzkQpw71C/0GRQKi/U/6RfeT9Sr0jPNQ81ryEvAK7inrEuoB6eHomumm6s3toO8Q8+H0xPcm+nT8/P5tAOoCtQRDBrkHgAivCuMMww8UEVAQTw70CtMIMQdFBycHewfNBjIFyQPGAusCDATsA+cClf9//BT6DPlM+g77Ff0e/jP/zP9j/0j/SP+0/9T/KP/v/Gn6Bvhr9+746vwuAhcHuwllC/MORRrbLlhJ81+qaFJf+knSMqsmtyikNSVEiUoiR4g6/i2cJKIgSh2yFSEKzvoN7+Xmg+S/40LmV+iM7TvyzfTJ9Mvu5eZU30XdZOT182UGihbiHdYdZxoxF0YXwBgZGmsZXRb6EaEM4gj/BSYFSwSdAggA1/pN9E3q394u05jMRcsp0BDYJd6S4f/gX9553BTdduHI5wbuVPOm9XD42/smAi8KBRJcGDYbQhvRF/MTYBCWDsIM3AuLB6QEAwBY/eX4VPSI7m3oN+S+31LeTNtu23jar9um3GvfteMk57Lsa+5l8cXy6fTe9qT5UfyW/9MDhAbXCMgIrgjeBvMFdwMGAU7+zPxo++/52fjX9Tf0yPGi8KLumO077fvs1u4i8MnxIfOe843zaPOT9Pf2lPpE/swAlQGIAtsCzANqBaEGCgjDCFgJFAgyByIG8AVwBxkJ/ArjCk0K9AZHBJ4BHAHmAD0BiQCN/gv9/fvJ/K39h/4e/rX8kPsP+r745vdl9wj4D/nJ+lL6aflC9mL0tfLZ9Aj3X/tR/ugE3g4gI3c711T7YlNhBFGLOtUq7yY9MQY/gUreSjtDbjggLm4pVCMcGykN3/wg71DmEORZ5HPmMOdH6XDrVe1k7nfqkuOy3JrYbN837cgAQhNTHfIhsh5lHCIZAxq0GfMa2xnyF38VFhPID7kN0Al2BkID/P50+dfw2OXW2unTjdHV1QXbAuCz4oPg09082uHY/Npu3zTkpOln7dbyj/fP/eACzgc+DaYSLhhtGvoaQRZZEUQMogjQCDEJngyVCagGUfz5803r3+bn4xfiI+Ez3+jeL91P3Wrd699i4prmBulu7GvuGPDf8Xb0tfh8/3sHDg30EAIQFw2dCk4IWghBCGkIDAgBBnoDQP+l+5j3zPVb8svwJ+5q7OPqbulz6ILnHelr6pfsae4J77vv7fC/8sD1jvl2/m4BGwVEBoUHAwgoCi0LawxqDLQJTggKBkoHcAgsCwoMtgs+CdoF5wFn/mD81/rh+k/7Qvzk/FD9T/28/Nf8zvwZ/Yz8UPsD+rT3H/hm93z41/h/+vD76v7JAA0BMAF4AnwJ9xiYLwBJ6FmTXvxQ7DxOKv0kZSzsO/1IOUz1RlU6dS9RJmkhHBs4EgEGaPg67rrndOWs5Qnni+kL7XDvbO/56o7i19on1hrbhOdz+iIMWhgRHDwZ+xRmEr0TpRdTGysdXBzWGR8XPxXiE8kS9hBFDVYJVQMh/DvzDOkN4tndhd/C4jjm/+an44jefti/1VrWF9tp4FflO+jI6Wvsi+9k9PX4SP6VAv0H+wx4Dy0RaA8hDrkNAg8yEL8QaA+/C2EGOgAG+7j2vvRa8iPvz+uW6ETm5+Ql44nij+LP4wvmb+hG6p/sFe5k8Kvz9/dz/V0CeAWnBpcGKgeTCAkL6QsWC88I/wUVBBMCbgCH/VX66Pb28i7wLe5p7f3rC+t86Fbn+OZn5+vnFeip6C7pU+vP7RvxhPSb9w76mvzY/hgCKAUQCBkJGwkjCCoImAicCRoKsAgkBy4EIAMKAhkDdAMSAgr/OvqG9gj2tvf0+sP9Jf9///X/PP9N/5X92/zr+zP8Jf3D/uf9zPzy+I33OfiX/OcBYAXBBkMI7g8gIJw5YlGMYPFcpEoSM00jniPOMbhDMVC6TmtFBTgpLl0p4CQIHVkRUwM1+a7zNPLi8Tnw+O3N7ZTtVu+97efmD96w1GrTqtv17C8AtA7EFLwSwQ16Cu8Jhw1eEYYUQxdTFxgZihk1GQMZkBSGEPUL/gZhAlH8gPPI7FvnHOfw6Z/s9ezo6Lfg59jB0s/R8tTv2ljgzOSl6GrrT+/t8o31cfjP+hn/UAUGDBQS5RT9EtcReA44D/wQOhHIEJQLGAV//vv45fZ69WfzJ/FK7CrpMOZX5DjjUOH+33HfXuAN4iDlEeYN6J7pYuyS8aL2tvvQ/p//1v6N/mv/kwEeBDMFWgWhBMEDvAIVAVL+oPtv94f0KfLg78Xu2e3m697qLOqd6UvqZuoN6uTp7OlA66ztx/CN9Fb3pfqB/XIA5QNyBkcI3wjYCGQIAQhaCHEIXgihCBEI2wctB7gGggQRAob+8fv3+u37gf4FAKEBMwGe/4X9Y/rQ+Jv3UPgc+sz73/0Y/6n+jP40/vX+7wAEAzgECAnwEkUmkD82VnJghVgiQpUq6RwkIfMz/0jgVUZVREkkO0oxCS39KRojyRY7CTT/5vpQ/aj/BQJTAOP8KvkX9G7tBONS2dvRrtMp36zyegUaEYESlQpgAS77MvulACgImA40E2EVkReEGaMabxp7FvYRNgwbCBoDxv7U+J30LvMC9Ib2pvck9J7sJeOZ2V7V59WN2kPh1uUR6RbqDevZ7Evuve8T8QTz3/bO/W0FEQ0JErQSwBAZDekKugmfCi0LWQq1CTIIBQb9AlL/m/kR9VHwuO0J6wTqnuho5vLkZeQ85BblyuWj43vhW+BD4C/jhugj7fjwVfTD9C71tfU79oL2Hfc5+Mr5yvsn/50Azf9p/8j74viW9wz2gfSh8wXymO9Z71rvDO/r7nvue+wl61TrWOvh7GfvDfJt9Jb30/qP/Cf/qACAAAIB/wAuARgCJARCBvUHNgkLCe0GnwTAArsACgEpAtICZAPGAg8BUf80/nz9PP2G/fD9Ff4G/jz+h/3t/Hj9NP61AWMGpQrNDHENKw0DFBwiyDghTmha51RJQrYqtByqHocv50SSUwhUT0mCOHQqaiIFHuMa4RYxER0M4QeFBPkBTf/B/v3+nf4B/Ub26eu74bjaKdx15mf2ZQS3DHkLxgIP+bfy3fI3+X8DgAzfEtcUwBQ5EoYQsg+iDYQNzgxGC24JSQZxAv3+wf1T/R79Wvv09kbvAOfn4D3dGt9d45ToCetm68znSuNx4HzfeuFs5anp1OxY717zffljA7cMwxJDD2YHePxV9vj3Vf/YCYARCRSpD/AH5v3+9hLxAe/a7crtVe8I8J/vxO3M693pcuq+6avpUedB5FDhQ+D04/nqQvVX/VIBn//3+eLz5fAx8Vr1a/pE/6sCIgODAj3/G/uQ9/7zwfJE85/0NvWH9DvyKPAf74nwNPFE8evv7+w+65zrM+4R8673Gfuk+5X6uvgl9zT3bPjT+p3+bQJCBvsHlwdQBfcBQv/f/rT/dQISBboFQQUoAy4Bhf+9/uz92P22/c7+p/6+/ib9lPv1+jn9JwLjBwoNQA2rDPcLUhRkJY09IVNKWnBSxztDKFMd5ibHODtO/lZnUipFiTTvKiMk6iEsHcsW+A/YCt8HbATAAgH+nfxa+oT5Evah70Xnmd5N3MvfgOsl+SkEBwnjBA/+ifUf8gL0z/ruA3kMJxLNE1QTGxAPDgwMYAu8C00M5QuNCj0HlQTMAZwBHAGHAHr9NPia8X/qHudj5bLoIezB7xjwee7r6dPlKOPI4Uvkxebm6g7tIO8f8Qj0DvpT/8cF4gUxBRP/n/t++Z79JgMACsQNRQ37CXoDU/4++Ar18fKt8X/ydPHP8TPuFexd6PjllOWU5X/la+Q+4mLgJeAJ48rnMe0v8SbyfPCZ7f/rU+yF7yH0/vgg/Nr9kP0m+yf55vaT9Rn22/a8+D75FvqQ+aT4SfgZ+Cf3qPbm9OPygPLM8q/1Dfn0/IP/nf9y/rT6yfct9W31kfdg+4YAvgOvBWYE5QG4/ov9Cv56/08BwQGXAXwB9AHkA0EFXQb0BMoB5v2y+hT6v/l8/Kf8R//5AKQEYwfYCUMKkgs9EKgavixXPptMwkygQcwwoyXkJRMz+kQJUUtTnkm6PEoxYisQKg0nHiLWGTQRCAzaCWAI0wejBEYBMf0V+CHyPuqK4zDfEeGJ6DH07f5fBOkDFP0A9vjx9/LT+JIBAAkJDlcQ/A4KDqYLIAtiChMKkAkqCZYHDQaBBFkC4QGtAI7/iPwx+Cbyxezu6BLoTOp97W3wFPHW7l3rMecy5IbjcOTb5kHq0OvV7K3s3+vz7QbxAfi5/LsAz/5g+9T20Pfv/HoEdQ3VDvsNUgfuAgr+lv4//zMAFgB+/Yf7u/bi9BDxd+4A7T7sueso6xXqXeYL5ZvjneX56P/sN+9H7t3rIunn55XqNu9u9DH4d/pC+nX5+fhS+Jj4MPof/D3+VgCJACsA0f1z/Bf73vpg/K77G/tu+CH3/vVD+Iv6Pf2m/pb+vvyv+jH4yPZz9rf3svrz/TYBrgGy/8P6B/do9Er2LPox/usAGgCQ/pT7Gvuf+y79Zv6a/az8yfog+8/7Rf02/iT/tv9eAjMFtwmUC+UQ+xTcIXUu1T8RRyRGxTlcK6YiPyaMNLtGsFLMVEtK7z3/L9Ep5SXDI1YhORziGMAV/hKHEaMMHAnUAlH+m/fr8XvqZOVi49/m9e6S+FgAhgHk/Sn2SO+L7QzwFPkKAjYK6Q9nD7MOlgssCZII1wc7CQsJxgpyCtQKWwm/CMkFtwNeAHj8Ffkz9Hzx4e1A7fDtTu+I8Wzxku/Q61Dmu+KK4Pzhw+Wm6ZDtmu5l7mzs8OqX6d3rJfBZ+FX9ugJm/lj6v/OU83P4QQB7CQsLIgmxAZD8yPjc+j7/wwCuAj3+l/vW9enzXPNm8q7ztfMv8QLvm+vT5/jkJ+YX6PDrafDl8FDvTerA53rljOcz7TfxzPSo9Yf1s/J28yX0g/Uj+Jz6rvsb/R3+6v0x/sz9X/+Q/uz/0v4E/TP7lPkV+vX6hf6WACMBpgAT/gf8uvrL+in94P0IAW0A2f+t/cX6cvmY+Cn7yPwu/+r++/wO+sH38PcW+iT9BABzABP/rv1s+7r8Of3yAAgDWAZsCWQLdQ9XEcAYbh8WLbI5KUQwR28+WDO5JXsljy74P3BQoFUJUIpA5DC8J/cjQiYPJssj8h1rGE8VLBGyD7EJBwTv/BX3SfIV7IHoRuPs46TmwO4L9VT48vUX7iDmxOKy5BntnvcEAX0GvwdpBq4DVwEfAUMBYAOSBgMKcQ2bDsEO3wtDCQAHtgQ9Ay0A+vzl93P1GvRB9h340flT9/fxYOwy5sLjg+NI5XroaeoC7RTtnOwb60DobOVl5XTpYPHy+lwA0AEj+BP0mO089Dz8RwfJDYoKOAee/5r/5P9WBpgGkQWQAgz9q/0w+gD+dvyd+5z8V/kM+D31e/B77MHo+uq77VHyZPbg8TLu/OW040TjcufE7e7uzO/37pfs6eyS78DwO/I/8+rzW/Wt97j6W/yV/En++f11/2MApgAwAKP+Yv7s/g8AygOHA1wDOQCm/M77V/qC/C39Of1h/Un7fvr0+Er4g/aH9RH0jPO09D31JPfx9g73svWZ9Q31/vX49h/4s/lX+kz85Pzh/rUAIgUxCAoN8RDeFQEcwCXdL1A6Jj73Pb81cC62KzgxzjzJScVQYk9cRkw6ITINLBEstCtCKT8mOCD7HO0XlRQsD+wIHgIK/Ov1PvHX7ADqqunI6v/vufFN9H3xyusm56PjMOYr7PzzcPtd/4AAJgDa/F39rvtE/ocADASrCK4L7g6QDngNyAo/CMQF1wTmAiACpAGQAHIBkgAcAUf+8vqr9TvwjeyB6lTqkOpU67zr4esm67PpcOZE45ngTuGF5Q3sSvPv9Y31ZfGl7j7vhPS3+oEAjQKBAVL/R/65/2ICywUxB+cGdASjAkQALv8p/9D/6wCpAVIBaf7E+uz1xvJ/8TPzgvXD9jL2EPIn7oTq5OkW68ftI+/97ivtOOuC6gPqc+x77XvvGfHA8e7ySPNF9Ar1IfZL+FH6mvwn/oH+QP85/zUBlgJCBO8E1wNDAqIAjAAkAUQD8wMJBcEDwAKtAAr+O/vZ9xz2SvX79t/4dvov+hr4f/XJ8nfyMvFw8oHxMvLS8gL1M/il+qT7T/vy+RL6//yzAbsIsw1EFLUY1yDMKJ8y/zZFOMszHS1YLf4ujT2JRr5RolCoSQ8/aDToL90tazAQL6UusSlRJkcgvxv0E5oLjgO4+1L3i/JO8a7toOxo66fsUewQ7cLpTeSm34XbIN6o4iDs+PLe9wL4nvYq8yfyTPOp9eL6DP8gBY4Izgx+DVcN5AqeCOQGigZ+B1IIfAkWCa8J2gijCOIGmAOu/0P6zvbC8yzzIfPy89nzXfPp8AjtWOk95GHi3uGo5Kbo2utY7arrhOgO6ALocu0z8Vj16/Ze9UT2a/b3+bn9kwHSA6sEUAX2BJUFIgWtBoEGwgcACaUIOQipBUYDPgA0/zH/KP+K/hP8Kfiq89Xwo++R72/wrfCB75vtROyU6pbp3OkA6RTpiens6tfrBO2U7UrtWu1J7tnv9PHy8x32tPZA+PL5TPxE/iIAAQFoAPYAbgCsAWcCgwTTBQAGoQYdBdoDgQEzABL+ov0f/db8u/xc+5X6BvhC9snzBPJ38EnwA/AN8e7xZ/OS8zP0mvM989jz+PV3+ST+RgOdB6gKgw4rE4cbwSQxL1QzIzSELvgp2SlrMJ8+AErkUjZQ8Ef9PPo14TSCNy08lTz3OVk04i4UKXsk3R7/F9MQlwmpBEj/UPzU91H1u/Jw8ebwU+7+6Zbja92F2mfbYeDx52HsJu9f7Tzqb+d55lrpqe3Y82X5Ef+fAaUDdQMQA+0CZAObBTQHTQl2CjkLWQtPC7gLBAuZCV8HiANrAPX96Pzd/Wz++v59/XX56vSE7z7szeqG69vsJO2m7IfprOeo5SPn2udx6oHqWOmi6A3n/enp65bxK/Ve9+X4FvdT92X1Q/fa+K78zQA6BPQF0gWRBAICGQHUABsCFAOpA/8CawAI/y39WPyr+4b6o/gX9RvzL/Hk76PwSvA88Onu4u1g7N/q7OmW6Dros+cC6VjqIuxN7Tzul+5H78Lw2PEz9Ef1IPeG+GX6fP1x/5QBwALhApsD4gOYBfsGGQiKCJMHhwYkBUwEzQOFA1YDRQO+Ac8AHv6D+2n57fcA+JX40fll+gL5n/gB9vT1OPWU9lL4GfrZ/r0A8wXsBRMKzQm4ENQXtSHxKf4rcipOI7AhDyRvLwY8IUZQSDtB6DhbMMkvXDPGOcU9pDtYN2QvRClnJYchFiAYGxEXlBE8Cj4Gov9n/JH5D/j69jH05+/j6UPjlN/Z3krgAuVf5/Toz+VL46zga9+t4nnmtus48PDybvbT9vj41Pr/+1/+eQCxAsAEvgbrB8cIBwm5CfQJqAkzCXgHqAW3BLYEAQbcBUEGOQO1/1X8dvkm+V34R/hB9jn0yvG88h7yN/PA8ZftF+qV5pDn/egN7Xru3O5V7eLs5ux67Svv/O6B78jvsvJq9Sz5FPtX+2z6vfmY+ij8qP2C/9n+bf5F/2z/OgG8AKX/oPyn+c/40Pha+uP6ZPpr99b07/L48cLxpvGM8Oju8+2L7dnuWO+c8HTvwu4B7kbu/O+G8Z/zCPTC9AD1sfXr9hz40fgl+WX5Q/qd+xr9zv4k/23/Bv/j/iv/Ov+f/9j+w/6t/gz/wf+N/z3/nP1p/bP8C/7W/rP/mP+k/r3+sv4CAB0BVgEVASABfgK+BdkJwA3FDswODw9vEmkaByR8LE4uPiroIu0evyDkK4k3KUEuQYI6CzGHKWcqVy6nNYw3SDepMFgrFicoJeAk4yKEIHIbNBYeEdYMAwm2BuMEkAPBAXj/uPpn9BHvG+p06ffqfu5t8L7vZ+wC6FXksuMM5qfoROy17XLuBO/n76TxafL1837zk/RE9aD3Kvpz+1f94vwM/lf+wP++/zf/Jv5z/GD9uf0aAAIAQgDg/Yv8D/up+uz5svjv95T2N/e495j4lPbE9FPwQO+d7a7w+fDN8Yzwje0L7fLrre777vzvuO6K7bzsfe7H8Mby1fM085vypfE19A/16/fm+E75evlb+b769vpv+9P6ifr0+QX7DPzF/N/8sPtd+tH43vjf+AT5nPjX99v2Y/ap9nz3KvdS9xP2LvWk9GH1iPZU91r49vfd90n3WPer95L3d/iC+Cf5wfm1+sn6c/st+6P7yPse/I38ffyN/NP8DP3j/Xv+rv5b/nb9C/0N/ab9Q//j/z8AS//P/vD9n//oACQDnQLuAVwAbADJA/QIew4OEKMPVQt4C5EPBhrmJWUsBS1rJOoc8hg+HzorVjecPtg64zMfKlcngij4LjU0sTQAMigsgChiJcok4CO6IUYepBqVFl8Sbg+bCwsJjwfDBWYFpQGX/Ub32vHc7tbu2vG/84f1AvNi7qbqwOZS57zob+sq7u7unu/J7z/wkPCc8X3x7/EJ8l3zxPSO9iz5qflB+x/6evoU+a74Z/kt+RX7Tvsi/cz8uP2Z/Ub9wvww+3/51vfe9o349/mq/Fj9Yftj+CX0DvLr8JPyP/Qw9aT1uvRa9GTzYfNT8inxnu9373jvKfGH85b0wvUj9Xr0x/Ny887zaPRa9Rz39/h5+sP7ePs4+h348vYb9nb3cPgj+nH6o/k0+dn3LPe99tL1HfVL9Bb0pfQR9Qj2YPXi9CnzbPLQ8cHxePIV88Xzt/R+9Wb2NfYV9mb10/Qv9Vj22/ec+Zj6W/sA+wD7Hvsa+/j7bPzj/Rb/3wCFAoQDmgOxAhEBuv+K/+YAegOEBpMIjwlJCLMGKAQuAxEDGATBBmcIBwsXC/ILwgpHDMIMxQ8ZEFQQRw7dDa4RXhmmJQ0uZTDoKLkcvhODEh4esy25Oy1BejkPMY4kvCOAJc8rqDDJL1MvHCv4KtYpiCmVJpUiIB0gGYgVIBPPEvcP2xHKD+4PBw1YBpMAE/eb86Ly2vVF+4n9L/1q93LwgOrC5vTn4ulX7Vzv9++j8KfvU++Z7VPsG+qG6oDrh+6p8cPz2/SB8xbzJPGz8UjxgPIV81jzQ/XN9WP5VPrf+w76M/aX8pvv/vB/9Kn60f2p/uH6l/WR8JvuHe8v8j71Qffl93H24PSx8sDwhu/u7pLvw/BT8qDz0fO78+XylPJ88v7xQfKM8e7xXfMb9Vv46flM+sL4EPYL9EDz7PRX91L6Qvzi/Fb8sfot+UL30vXW9RX2PPg7+kj8jvxP+075QvbN9Lrzx/Sg9aD39vif+Rn6L/k1+Dv2IfVc9Jn08vWU9yT5x/lF+lv52PjF95b3OPev9/T4nfqZ/MT+n/8RACX/Zv56/Wn9nP4VAMQCAgVMB5IILAiVB1kFvARUBN8GBwkMDE4NYAzYCo0I3ggPCr0NxhDZEgARfw9xCzUO4BHrHSQm0ivdKAgfZBVuEY8Y7CXUNBM8izjrLikjMyCAIWspii9dMFIvPyoVKfUmsyaDJYggoB7dGcwZ+Bc1F2YVqRFPEMENLQ3pCWEHzwBC/C756vjj/H/+wACF+8/1tO7m6nDrEu6+8RrySvEM7yzuOu6s7uvtG+xf6q/q5uzd8CLzVPT38rrxnfEz8qLzD/Qe9P30GvcE+7b9Wv8O/TL6cffR9l75Avs3/jD9tP0V+/P6cfmT93b3cfSC9QD11/Wt9r700PN38a/vye/f7uXupO2U7NPrOeyI7WzvL++87vPru+lG6bXpV+1v79nx9fKH8ebxjvBu8PbwwvCH8uPzcfaa+Hf5vPiP91b1DfVc9dD22feQ+O/4vvjm+Bz5h/jb97z2fvac9vH3fPk6+oD6jfks+bX3D/h491n4hvgW+Xj6M/pd+836V/q0+Tv5AvrR+mD84vxp/Vn8S/yE/CD99/4g/9X/RP9d/yEA9wC7Au4D3gQpBgoHWQhtCDMJUQgzCf8I1QuKDPMO/Q9BEOUQkxCWEpITsBWsFs8UCBPrEWAXnh7uKr0uvCzTH7kULhFnGOco5jelO9w1JCkDIXsezyNmKh8ssirdJ3EmJyZCKPYm7SPOHT4aaheVFA4XpRRQFAIRzw9IDO8KvwhvBW3/Wfk79+j1+vorAXgAZv0p853scOcE6tjvjPHz8YPvo+wG7Z/tLu/W7NDoj+jd6JvsNvLP8nvxf+6/7HHvOvE69mr2lvMI8k3whfOL9mn7WPzk+Xr3tvMp9Jzz7/e09xD5KPj89jv2f/No8/vvye+G7w7xGfIr8gzxg+1A6xnqLOtI7PTt9e0f7BfreepF60vsYu2I7dzrUOsx61rsae1i76rvZO/e7+bvgPCU8NrwEPHb8J7zjPQV96H2fvZt9GjzdPMC9W32F/j3+H74Bvjz90739PdC9zL4Ufha+ZD6OvtU+6z69fkN+Un5DvrW+q37Svva+0X7Bfwl/Bj8vfs/+8T7NfwP/uT+x//Z/yIA7v/2/xwAXgBWAbwCmAR4BfsF1gV3Bo0HOgn2CpkKsQnpCIQJfgzdD5USyBITEHgOdgzyDU8PjxFZEiwSkBJKEmwTchMSFPQTRhRVFFYTCRNZEvQTcBgvHcYhHCGRHMYWwBBnEs0W2h9HJDgozSMeIHUawhcTGOIXER1iHQchnB9kH9AbHxkvGI4V2RbCFL0VnhOrEq0SaRDyEFkPRQ+qCwgJywQ7AZoAhAH6A7QEhwOBACT68/Yu9Hv0g/Qd9v/1dPQZ9E/yEvIb8Sjwxu8P7Fnsa+rT7DTtjvEz8Qfyk+9Y7STrSOi/6fXpYe3k73zyJPKr76bsT+gA54zmpulb64PuvO6L7gvsouo+6AHnGOe75xLpSOrX6xTshOvs6p3pTOg86BHoCukO6Qnq+urC6sfs3usR7erqEOtI6YjpJ+vv7MPv9fDu8Trw0O/97Z7u4e7s8I7y+/M49ez1VPX89CD0PvTk9Fj2Hfjy+AH6e/rz+mD7wfva+7/7DfzG/B7+A/++AIUAnwHnAH4BwQDQABEBEAKKA2YFbgb6Bp0GngZuBtQGwgeSCM4Jrws5DdoOGw/xDiAO7Q2TDvwPmBEeE6ITYhSZFLEURxVkFDUVsRPQFM0UIRbiFsMXgRfvFtYV2hRCFFQTrxM5E8YT/RMuFK0TkBIFETEP8g1YDXUNlg3GDuYNHA7UDNcLAQssCgUK6AnICcAK3gtIDAEObQ1kDR4NlQy8DcwNmA4cEKkQ2xLvFEAVSRbkEzITmRLhEkEVwxabFyQYJhcjFhAWexOGE2gRohANEZQQMhLzEEIQ2Q0YC7AIpgf8BakGFgUcBW8DiwGUAIr+Lv17+4v5bPct9qb0o/SP8/HyofE878ztjetY6t/oxecM5zjmNub+5VTlB+S14n/g898h35Dfm9+F3zrflt7x3X7dFt2O3HHcS9wM3F/cPdzr3KvcMt3N3Gbchtxs3GXdVN4i38/f39/634DgIeEe4jPjD+RD5RnmYudL6F7pE+rR6hjsJu3/7nHwqvHT8nnzlPR59b/2KfiH+QX7VPxs/Rz+5/6Q/7AAxgEyA00EIQXMBX4GwgaHB9oHkghNCfwJ2wp5C6YLRgyXDPsMgA1dDZ4NeA0dDhkPQBAHEUQR/xB4EAEQFhBpEAkRwxHzErQTLhThE2UTShL1ETkSXRNMFGEVvxWFFUcVjxSsFDwUqBRGFWAVshUjFVIU2hNBE8oT6RP/E20TERLREJUPFg/6DrgPcQ/sD+cOzA19DJsKWwqzCQEK7QrBChILXQp8CYsIbQf8BigHIAdoCKAIsgjMCP4HZQeOB90G0QfkB2wIUwmRCDcJLQhSCEwI1wiwCbMJGwozCYYI1geqB+YHhQiFCAkJoAdLB6wF5gQhBMwDKQSEBOUEwARABP8BUQEB/yf/EP9l/3UAWP9I/279Gvy1+qr5Jfmj+HT4cvib9zX3OPYX9U709fKy8ujxevGm8eLwsvDn7z3vwu4z7gfu9e0J7f7sJ+zh6+Tro+vk64brI+sr6yTqp+qD6SjqrumJ6UrqjunY6f7pI+ns6vvoK+yO6Xfstenz7MnpBO4n62TvZO0778vva+478QXvv/Jp8NjzH/Je9PPzTfXz9TD2O/fD9oH43vfy+f/5rvqv+4j7mfwK/Y39UP78/g//ZgCw/1gBPwDmASUBnAKDAjUDkgOtA6sDxwPGA7sDYwRNBC8FFQUdBeYEfASKBKYEFQU/BVEFKgX3BIIFJQUXBpIF7gXcBe4FlgaYBpAGsgb2BdcGqAYkCAII7whKCJgIHgiBCLMIcwn5CewKBQumCz4LXgsvC1sLqAvXC3kMjQxKDSYNiQ3aDIMMNAwLDJ4M3QxyDTwNGA2wDDUMzwthC5kLXgsZDGEMIQwhDMUKywqkCQMK7glCCikKYgrzCaEJIgmMCEoI2Ad0CB4IUAhLCMEH2werB9UHtQdJBxEHbQb3BdMFAgYEBnwGjQYxBnIFJgReA00CXQLkAgEDqQPgApQCMQFhAG//6P6E/qr+bf69/gn+y/29/Gf8hPuP+8j68/o3+gH6LPrH+Sn6B/rP+Y759vih+G34Afhq+G34nvjW+Mn4mvg++Jr3VffN9s32E/dJ93/3k/dO9x/3rfZ29kP2LPZT9lz25fba9kT3/vYt9772x/Z69sX2W/bj9rT2Bfcl90P3mPdm9133NffL9vL2E/ei9wX4bfhc+Gj4Lfgr+FT4Dfh8+DD43fgA+a758vn0+Sv64Pk5+lf6yPoU+2f7ifsg/C389fzm/G/9HP1y/Uv9ef3d/fL9nP63/if/MP8n///+8v7O/hL/Wv/N/yIAYgBQACUA5f/p/wAAWQCYANkAtgCYAJAAeADHANAAFAHeAN8AvgDBAPoAGgFrAWcBiAGVAZ4BoAG1AYYBrwGvAU0CigLcAtAClgJYAm4CswIvA3UDuQOQA6gDwAP/A0wEUARNBCoECQROBIYE6gQBBQYFxwS4BMEE5QRaBT8FeQVEBWEFfgWtBawFtgVOBVgFTwWLBYMFnQVbBVgFQwWqBcUFDwaZBbYFRwVhBX4FzgW6BeAFlAXJBXcFiwVJBQoFwgS5BOQEOgVKBWsF7ASjBA0ECwT9AywEeARmBKMENQQ5BNcDsQO3A5sD9wPaAwEEzwOeA8YDXAMkBHgDKwQ4A6ED8AIWAyID1AJgA50CbQOvAgcDkAIIAuQBHwGJAUQBbAHKAQsBZwFIAJgATv/g/6D+Nf99/rP+x/5a/oz+7v2u/Sb90Px//Dv8WPw8/HX8Yvxn/D38H/zB+5b7HvsR+9L6J/te+9P7K/wI/Df8bvuH++76VvtJ++b7TfyL/OP8qfys/Fr8W/xe/JL8qvz4/OX8L/0y/X79o/2f/bb9h/2D/Xj9sf26/SH+K/59/lj+f/4T/j3+7/09/k3+hf6l/pr+k/55/o7+gf6//r/+0/7o/tv+B//i/vz+6P7X/vL+Dv8o/z7/Mv/6/tH+r/62/vr+5/4y/9n+yf6i/pv+s/6g/sj+oP6p/pr+kf55/lL+Rv4j/lL+Wv6E/nj+Nf4X/uf93/0X/gv+U/4K/jL+8P3q/ev99/0+/jX+ZP45/iz+Ev4Z/hj+N/5L/mD+a/6M/n3+g/5B/nT+TP5//pr+qf6n/oX+ff6P/q3+Af8k/yb/FP/d/uf+zv4a/xr/k//K/wQANwDu/w4Amf+n//P/4f/PAMQAQQEXATIBXQEyAWIBfwGnAbUBQAIsAt0C1wIuAzIDDQNRAy8DQwOiA4gDFgRBBKYE1QTiBKsElgRPBI0E0AQABXUFegWLBY8FRAWRBUMFcAUOBR0FHgVvBX0FGwUqBekEnAQ8BEwEVQR/BD8E5gMQA3kDKAR3A3YCWAKOAvICkAHnAtsAOALPARsBhQBqAIYBrgCo/7oA6gCD/9gAHf/k/8L+NACX/5X+ff86APT+J/+f/1f+S/+I/hv/jv7B/rP/Ov7F/tn/Cv7g/kj/Tf63/jr+/f4u/0r++v/s/oj+hv8A/6X+lv5T/0X/5v79/t//xv6T/z//r/5N/2n/a//3/gD/dv+b/9f+yP8w/yT/5f8I/7n+i/8S/zj/Of9v/wb/a//K/hn/8v4G/1v/Hv+j/lD/8P4H/8L+Iv9T/87+cv9P/wD/Zv89/8T+dv97/y7/6P86/wAAMv8AAHH/nP+o/0MAjf87AN3/agCd/0oATQDy/1cAYQCv/3IAzP9IAFIAEwBoADQA0f+GALr/5//e////wP8LAOP/AwDX/7P/i//o/oT/vP60///+mf/y/u3+Iv9F/hj/Y/37/7z9Hv9B/pX9jv5r/3n8uQAD+ScD7fpr/5z9Iv3a/Mj/KvvY/8f6Kf+Q/uv6j/4z/ST9KP1v/RL8sf3v/aX87Psj/776Mv93/NT8gvzE/tf7hP3v/Ur8Zv7x/Bn9O/8M/ED+rf4o/EX/ff6f/LD/Y/5x/ZAAT/01/9f/6P5J/nsB4v7y/uMB/v7H/6QCf/9dAGQCJgFJAYwChQERAZgELwEwA1sDzQLEAwAEBwNDBFEEQgTIBLUDVgWEBLsEEwXmBPMEfwVZBaYEMgUQBbQELAWwBGwEDgVHBDAEJARKBFYDMgQ1A/wCNwO8AmcCnAIkAiYC8QHJASMB0QHnAAABsgDBAGwAhACCANT/OgAaAIv/5v+T/6v/8P9Q/8///v7m/y7/ov9w/9L+GQBz/wf/w/9R/5v/9/8k/9H/sv/j/8z/v/8NANj/TwAiABYAHwAEAer/pACTAHAAnQDBAGsABgHlABABvwD2AOQA7wAPAdQA1gAUAfwAGwEhARUB/gBHAcMAvwAaAYcACwHVAHsANwG7ANcAdgCGAIsAHgCDACwAKQCiAOj/DgDC/5j/mv+X/x3/bv8x/+j+xf4G/xf+wP5m/tv9E/7W/cj9yv3B/WH9gf0h/UH9Uf0G/Q797/y0/PH8N/2h/PX85vy1/P/8svzc/Mb8Nf3P/An9wPzo/CT9JP0K/S79D/0v/SH9HP0x/TX9Xv2D/Ur9lf3U/Z/91/2//b79y/0O/v/96f08/j7+Wf5h/r7+Wf6d/o7+df54/tH+rv4C/0f/BP9Z/3D/Mf9o/4r/I//D/7H/3P/0/xUAIwCnABwARwB9ADEA6AChAKwADAHfACoBYAEfASgBhwFDAUoBhwFiAZwBewGhAccBswGTAacBiAG1AXQBsgGIAX4BfQG4AVABZgFGAZ8B4QB0ASQBEAEBARABAgH4AMkADQGKAAkB0QC3AIwA6QB9ALgAywBxAL0AzgCzAJMAvQB8AM4AwQCuAJQACwGeAAoBwAAgAbAAEwHwAPAA+ABVAQ8BNAEeAUkBAAFOAQgBEAE1ASgBGgEJASsBMwGtACIBlwDFAMIA5QCQALsAdQC9AFAAYABpACkARABFAE0A5f85ABkAEQAtAN7/5P/t/+3/wv8PAOX/y/8SANf/u//e/6j/p/+k/9P/pv/d/6r/x/99/8P/W/+V/47/jv9t/5v/kP+d/5b/dv9m/5H/dv9b/17/ff9y/4b/cP90/5f/kf9d/4H/bP+F/5L/lf+W/73/q//i/73/tP/0/+3/+v8jADsAQgBbAHEAlACYAMcAtgDAAAsB8gAgAS0BOAFdAYYBbAF4AXABcQGVAYEBagGHAZUBjwFpAXoBRAFSARcBIAEeAfcAFwH3ANQAyADaAJMAowCIAIYAhQB+AGwAdgB1AIQAZwB0AHwAbACKAFUAlACSAKgAvAC+AM0AyAD7ANwA9gAAARIBOwElAWMBKgF2AVkBggGGAYIBlAGYAbIBqwGwAZwBrwG/AYABmwGJAW4BkQGKAWUBZwEsASQBDwHoAMIA8QCjAKkAmwB6AE8AJQAMANz/3/+x/7j/ef+L/0L/UP8d/xP/3P7R/sP+nP6x/n/+nP5R/m3+UP49/i3+LP4S/ij+BP4c/vP9IP74/RX+Ev4F/hz+G/4d/h/+N/5O/lD+V/5z/nb+dv6Y/ov+0v66/vX+DP/z/kH/B/85/zH/Mf9b/3r/YP+I/6D/tv+x/6D/n/+t/7X/wv/P/8v/x//y/8v/r//C/8f/qf+z/4T/e/+b/4r/ZP9m/1r/Mv87/wr/5/7V/uD+w/6c/oT+sf5c/pb+QP45/jL+If4F/gf+C/76/f391f3Z/fH95P3e/cf9y/3s/d795/3j/eb9/v3v/fL97/3w/Sj+C/4D/hX+Nv7+/UP+LP4y/kL+TP5Q/lr+Vf5x/of+YP6e/p3+vf69/rr+6v7L/gf//P43/xP/Z/9d/4b/d//A/9D/8P/6/zYAPAB5AIMAkwC6AP8AyABuAecAiwF8AVYB/gFXATICugEcAhkCQwIZAnECPAJiAm8CWAKrAisCbgKiAlYCRAJnAooC7wFyAi0CnwGOAmYBEQLGAXsBswGeAT4BbQE/AUoBJgEXAf4AJAHZAPAA5wABAbkATQG4ABEBBwEtAR8BUAEpAW0BaAF9AZMB2QGkASMCGQLxAZsCRgJbAqoCpwKxAgQD7gIIAzMDJQMhAzYDJQMvAykDOAMLAwcDBAPrApoCxAJrAl0CLQL/AbIBoAE6AUQB9gCKAI0AQAACAMv/cf9H/yr/uf7I/lv+af4c/hr+x/2E/Z/9Wv1P/Sf9A/0c/fz85/zw/OT81vwk/d78H/0k/Tj9gP1v/YP9r/3s/fT9Qf5G/pj+3v4F/xH/ef96/9n/FQA4AEoAwADlABEBUAFwAbMB0gEOAiICTAKaAosC9QLgAhADMgNLA2IDeAOOA5ED4wOrA+4D4wPxA/QDCgQNBOgDMgT/AxQE7wMJBO8D2gPVA9YDnQPBA4ADiQNbA1sDNQMcA+wCzAK8ApACVQJrAv4BIALXAbgBgAF4ASMBFwHeAKEAmABmAAoAFgDB/5b/ff8q/yD/7v6+/nv+k/4d/hn+9v2m/aP9hv0p/Tz9Av3T/NP8g/x+/D38PPzw++L7rPuP+3b7E/sV+9n6lPqh+jn6F/oN+qf5mflz+SH5Dfng+MT4kPiD+E74S/gv+B/4EfgJ+Pv37/cH+Nf3IPgN+Dn4Pvhp+JL4mPjC+O34C/lR+Yb5z/n4+Wr6nPrS+mD7Z/v/+0L8nvwH/Xb97P1E/sL+Nf+a/x4AiQAFAXIBxAFbArcCOwORAygEgQTRBFMFjQXzBUUGqgbdBjkHcAfCB+wHCghHCGsIcQicCJ4IoAibCJYIighkCEAIPgjgB8IHbgdFB90GnwYvBtsFkgUeBaYEXgSlA2oD3wJgAvABcAECAZgACQCs/xX/x/5E/vP9e/0o/fD8ffxC/OX7n/uC+y37Efva+sf6vvqf+pf6jfqY+pj6uvq4+uL6Bfs5+1r7r/u5+xv8TPyS/Ob8NP14/dv9Gf5y/s/+Gv9s/9H/IABnAMcAGwFIAbsB8wEwAncCvgIBA04DfQO8AwYEFgR7BH0EuQT1BPEERwUpBVsFigWTBY8FtAWUBb4FqgWgBZsF",hp=/\[([a-z]{2,3}-[A-Z]{2})\]/g,iF=/\[(laughing|chuckles|excited|happy|thoughtful|curious|sad|angry|surprised|nervous|confident|whispers|sighs)\]/gi;function zT(a){return a.replace(/\r\n/g,`
`).replace(hp,`
`).replace(/\n+/g,`
`).replace(/^\n/,"")}function OT(a){return(zT(a).match(/\n/g)||[]).length}function rF(a){const e=a.match(hp);return e?Math.max(0,e.length-1):0}function sF(a){const e=a.split(/\[[a-z]{2,3}-[A-Z]{2}\]/);return e.length<=1?[a.trim()]:e.slice(1).map(t=>t.replace(/[\n\r]+/g," ").trim())}function yf(a){return a.replace(hp,"").replace(iF,"").replace(/[^\p{L}\p{N}\s]/gu,"").replace(/\s+/g," ").trim().toLowerCase()}function oF(a){return yf(a).length>=3}function lF(a,e){const t=yf(a),n=yf(e);if(t===n)return 1;if(!t||!n)return 0;if(t.includes(n)||n.includes(t)){const c=t.length<n.length?t:n,h=t.length>=n.length?t:n;return c.length/h.length}const i=new Set(t.split(" ").filter(c=>c.length>2)),s=new Set(n.split(" ").filter(c=>c.length>2));if(i.size===0||s.size===0)return 0;let l=0;for(const c of i)s.has(c)&&l++;return 2*l/(i.size+s.size)}function HT(a,e,t,n=!1){let i;n?i=sF(e):i=zT(e).split(`
`).map(A=>A.trim()),console.debug(`[Mapping] ${t} segments, ${i.length} transcript lines, ${a.length} originals`);const s=[],l=new Set;for(let d=0;d<t;d++){const A=i[d]||"";if(!oF(A)){s.push(-1),console.debug(`[Mapping] seg${d}  SKIP (empty transcript: "${A}")`);continue}let f=-1,p=0;for(let b=0;b<a.length;b++){if(l.has(b))continue;const w=lF(A,a[b]);w>p&&(p=w,f=b)}p>=.3&&f!==-1?(l.add(f),s.push(f),console.debug(`[Mapping] seg${d}  line${f} (${p.toFixed(2)}) "${A.substring(0,30)}..."`)):(s.push(-1),console.debug(`[Mapping] seg${d}  NO MATCH (best=${p.toFixed(2)}) "${A.substring(0,30)}..."`))}const c=s.map((d,A)=>({segIdx:A,lineIdx:d})).filter(d=>d.lineIdx!==-1);if(c.every((d,A)=>A===0||d.lineIdx>c[A-1].lineIdx)&&c.length>=2){const d=[{segIdx:-1,lineIdx:-1},...c,{segIdx:t,lineIdx:a.length}];for(let A=0;A<d.length-1;A++){const f=d[A],p=d[A+1],b=[];for(let S=f.segIdx+1;S<p.segIdx;S++)s[S]===-1&&b.push(S);const w=[];for(let S=f.lineIdx+1;S<p.lineIdx;S++)l.has(S)||w.push(S);if(b.length>0&&b.length===w.length)for(let S=0;S<b.length;S++)s[b[S]]=w[S],l.add(w[S]),console.debug(`[Mapping] seg${b[S]}  line${w[S]} (sequential gap fill)`)}}return s}function rS(a){let e="";const t=a.byteLength;for(let n=0;n<t;n++)e+=String.fromCharCode(a[n]);return btoa(e)}function bf(a){const e=atob(a),t=e.length,n=new Uint8Array(t);for(let i=0;i<t;i++)n[i]=e.charCodeAt(i);return n}function cF(a){const e=bf(a);return new Int16Array(e.buffer)}function uF(a){const e=a.reduce((i,s)=>i+s.length,0),t=new Int16Array(e);let n=0;for(const i of a)t.set(i,n),n+=i.length;return t}function dF(a,e,t=24e3,n=1){const i=new Int16Array(a.buffer,a.byteOffset,a.byteLength/2),s=i.length/n,l=e.createBuffer(n,s,t);for(let c=0;c<n;c++){const h=l.getChannelData(c);for(let d=0;d<s;d++)h[d]=i[d*n+c]/32768}return l}const Rl=24e3,hF=3e5,sS=1e4;async function AF(a){const{lines:e,audioContext:t,abortSignal:n,voiceName:i="Kore",onLineStart:s,onLineComplete:l,onStatusUpdate:c,onError:h}=a;if(!e.length)return{isComplete:!0,audioSegments:[]};let d;try{d=await Hd()}catch(S){const k=S?.message||"Missing API key";return h?.(k),{isComplete:!1,error:k,audioSegments:[]}}const f=`You are a professional Text-to-Speech engine. Your ONLY task is to read the following text aloud, exactly as written, when the user says "Play". 
IMPORTANT RULES:
- Read EXACTLY what is written, character by character
- Speak each line clearly with a brief pause between lines
- Do NOT add any intro, outro, commentary, or acknowledgment
- Do NOT modify, translate, or interpret the text
- Just speak the text immediately
- Do NOT replace language codes with newlines.
TEXT TO READ:
${e.map(S=>`[${S.langCode||""}] ${S.text}`).join(`

`)}`,p=xi().audio.live,b={responseModalities:[ar.AUDIO],speechConfig:{voiceConfig:{prebuiltVoiceConfig:{voiceName:i}}},systemInstruction:{parts:[{text:f}]},outputAudioTranscription:{},thinkingConfig:{thinkingBudget:0}},w=si.logRequest("streamGeminiLiveTts",p,{lineCount:e.length,systemInstructionText:f});return new Promise(async S=>{let k=t.currentTime,E=!1,I=null,P=null,R=!1;const D=[];let N=!1,_=null;const K=[],G=[];let L=null;const O=()=>{if(L!==null)return;const te=()=>{if(K.length===0){L=null;return}const oe=t.currentTime;for(;K.length>0&&K[0].startTime<=oe;){const ce=K.shift();ce&&s?.(ce.lineIndex,ce.text)}L=requestAnimationFrame(te)};L=requestAnimationFrame(te)},q=(te,oe,ce)=>{if(_===null){G.push({lineIndex:te,text:oe,startSample:ce});return}const Ge=_+ce/Rl;K.push({lineIndex:te,text:oe,startTime:Ge}),K.sort((ae,Le)=>ae.startTime-Le.startTime),O()},$=[];let Q=0;const Z=[];let F=0;const U=[];let Y=0,ge="",me=0,z=-1;const H=()=>{for(E=!1,I&&I(),L!==null&&(cancelAnimationFrame(L),L=null);D.length>0;){const te=D.pop();try{te?.stop()}catch{}try{te?.disconnect()}catch{}}},j=te=>{R||(R=!0,S(te))},le=te=>{if(N)return;N=!0;const oe=uF($),ce=[],Ge=te==="turn-complete";if(e.length===1&&oe.length>=100&&Ge)return console.debug(`[GeminiLiveTts] Single-line TTS: direct mapping to line 0 (${(oe.length/Rl).toFixed(1)}s audio)`),l?.(0,oe),{audioSegments:[oe],mapping:[0]};const ae=Z.length>=U.length,Le=ae?Z:U;if(console.debug(`[GeminiLiveTts] Split points: ${Z.length} lang-code, ${U.length} newline  using ${ae?"lang-code":"newline"}`),Le.length>0&&oe.length>0){let Te=0;const pe=[...Le].sort((ye,Ie)=>ye-Ie).filter(ye=>ye<=oe.length);for(const ye of pe)ye>=Te&&(ce.push(oe.slice(Te,ye)),Te=ye);Ge&&Te<oe.length&&ce.push(oe.slice(Te))}else oe.length>0&&Ge&&ce.push(oe);console.debug(`[GeminiLiveTts] ${ce.length} audio segments from ${Le.length} split points`);const De=e.map(Te=>Te.text),ue=HT(De,ge,ce.length,ae);console.debug(`[GeminiLiveTts] ${ce.length} segments, ${e.length} lines, mapping: [${ue.join(",")}]`);const ne=oe.length/Math.max(e.length,1),fe=ne*3;for(let Te=0;Te<ce.length;Te++){const pe=ue[Te],ye=ce[Te];if(!(ye.length<100)){if(ye.length>fe){console.debug(`[GeminiLiveTts] seg${Te} skipped: too long (${(ye.length/Rl).toFixed(1)}s vs avg ${(ne/Rl).toFixed(1)}s)`);continue}pe!==-1&&pe<e.length&&l?.(pe,ye)}}return{audioSegments:ce,mapping:ue}};try{P=await new Kd({apiKey:d}).live.connect({model:p,config:b,callbacks:{onopen:()=>{c?.("CONNECTED / STREAMING")},onmessage:ne=>{const fe=ne.serverContent?.modelTurn?.parts?.[0]?.inlineData?.data;if(fe)try{const Te=cF(fe);$.push(Te),Q+=Te.length;const pe=bf(fe),ye=dF(pe,t,Rl),Ie=t.createBufferSource();if(Ie.buffer=ye,Ie.connect(t.destination),D.push(Ie),Ie.onended=()=>{const qe=D.indexOf(Ie);qe!==-1&&D.splice(qe,1);try{Ie.disconnect()}catch{}},k=Math.max(t.currentTime,k),_===null){_=k;const qe=me;if(qe>=0&&e[qe]&&(q(qe,e[qe].text,0),z=qe),G.length>0){for(const Re of G)q(Re.lineIndex,Re.text,Re.startSample);G.length=0}}Ie.start(k),k+=ye.duration}catch(Te){console.warn("[GeminiLiveTts] Audio decode failed",Te)}if(ne.serverContent?.outputTranscription?.text){ge+=ne.serverContent.outputTranscription.text;const Te=rF(ge);if(Te>F){const qe=Te-F;for(let Re=0;Re<qe;Re++)Z.push(Q);F=Te}const pe=OT(ge);if(pe>Y){const qe=pe-Y;for(let Re=0;Re<qe;Re++)U.push(Q);Y=pe}const ye=Math.max(Te,pe),Ie=Math.min(ye,e.length-1);Ie!==z&&Ie<e.length&&(me=Ie,q(Ie,e[Ie].text,Q),z=Ie)}if(ne.serverContent?.turnComplete){H();const Te=le("turn-complete");P.close(),w.complete({status:"complete",segmentCount:Te?.audioSegments.length||0,transcript:ge}),j({isComplete:!0,audioSegments:Te?.audioSegments||[]})}},onclose:()=>{H()},onerror:ne=>{H();const fe=ne?.message||"Connection error";w.error({message:fe,transcript:ge}),h?.(fe),j({isComplete:!1,error:fe,audioSegments:[]})}}}),E=!0,c?.("TRIGGERING...");const oe=bf(aF);let ce=0;const Ge=100,ae=Math.floor(iS*Ge/1e3)*2,Le=Date.now();let De=null;De=setTimeout(()=>{if(E){H(),P?.close();const ne="Session timeout - no response from model";w.error({message:ne,transcript:ge}),h?.(ne),j({isComplete:!1,error:ne,audioSegments:[]})}},hF);const ue=setInterval(()=>{if(!E||!P){clearInterval(ue),De&&clearTimeout(De);return}const ne=Date.now()-Le;if(ne>sS&&ce>=oe.length)return;let fe="";if(ce<oe.length){const Te=Math.min(ce+ae,oe.length),pe=oe.slice(ce,Te);fe=rS(pe),ce=Te}else if(ne<=sS){const Te=new Uint8Array(ae);fe=rS(Te)}else return;try{P.sendRealtimeInput({media:{mimeType:`audio/pcm;rate=${iS}`,data:fe}})}catch{H(),clearInterval(ue),De&&clearTimeout(De)}},Ge);if(I=()=>{clearInterval(ue),De&&clearTimeout(De)},n){if(n.aborted){H();try{P?.close()}catch{}const ne=le("aborted");w.complete({status:"aborted",segmentCount:ne?.audioSegments.length||0,transcript:ge}),j({isComplete:!1,error:"ABORTED",audioSegments:ne?.audioSegments||[]});return}n.addEventListener("abort",()=>{H();try{P?.close()}catch{}const ne=le("aborted");w.complete({status:"aborted",segmentCount:ne?.audioSegments.length||0,transcript:ge}),j({isComplete:!1,error:"ABORTED",audioSegments:ne?.audioSegments||[]})},{once:!0})}}catch(te){H();const oe=te?.message||"Connection failed";w.error({message:oe,transcript:ge}),h?.(oe),j({isComplete:!1,error:oe,audioSegments:[]})}})}function Ul(a){const e=a.reduce((i,s)=>i+s.length,0),t=new Int16Array(e);let n=0;for(const i of a)t.set(i,n),n+=i.length;return t}function gd(a,e=24e3,t=1){const n=new ArrayBuffer(44+a.byteLength),i=new DataView(n);Lu(i,0,"RIFF"),i.setUint32(4,36+a.byteLength,!0),Lu(i,8,"WAVE"),Lu(i,12,"fmt "),i.setUint32(16,16,!0),i.setUint16(20,1,!0),i.setUint16(22,t,!0),i.setUint32(24,e,!0),i.setUint32(28,e*t*2,!0),i.setUint16(32,t*2,!0),i.setUint16(34,16,!0),Lu(i,36,"data"),i.setUint32(40,a.byteLength,!0),new Uint8Array(n,44).set(new Uint8Array(a.buffer,a.byteOffset,a.byteLength));const l=new Uint8Array(n);let c="";const h=l.byteLength,d=32768;for(let A=0;A<h;A+=d)c+=String.fromCharCode.apply(null,l.subarray(A,Math.min(A+d,h)));return"data:audio/wav;base64,"+btoa(c)}function Lu(a,e,t){for(let n=0;n<t.length;n++)a.setUint8(e+n,t.charCodeAt(n))}function VT(a,e=16e3,t=500,n=150){const i=Math.floor(n/1e3*e);let s=-1;for(let d=0;d<a.length;d++)if(Math.abs(a[d])>t){s=d;break}if(s===-1)return new Int16Array(0);let l=-1;for(let d=a.length-1;d>=s;d--)if(Math.abs(a[d])>t){l=d;break}const c=Math.max(0,s-i),h=Math.min(a.length,l+i);return a.slice(c,h)}const gF=a=>{const{onQueueComplete:e,onQueueStart:t,pauseSttForPlayback:n}=a||{},i=typeof window<"u"&&(!!(window.AudioContext||window.webkitAudioContext)||typeof Audio<"u"),[s,l]=x.useState(!1),[c,h]=x.useState(null),d=x.useRef([]),A=x.useRef(null),f=x.useRef(null),p=x.useRef(!1),b=x.useRef(0),w=x.useRef(null),S=x.useRef(!1),k=x.useRef({onQueueComplete:e,onQueueStart:t,pauseSttForPlayback:n});x.useEffect(()=>{k.current={onQueueComplete:e,onQueueStart:t,pauseSttForPlayback:n}},[e,t,n]);const E=x.useCallback(()=>{l(!1),h(null),k.current.onQueueComplete?.()},[]),I=x.useCallback(async()=>{if(f.current&&f.current.state==="closed"&&(f.current=null),!f.current){if(S.current){await new Promise(L=>setTimeout(L,50));const G=f.current;if(G)return G.state==="suspended"&&await G.resume(),G}S.current=!0;try{const G=window.AudioContext||window.webkitAudioContext;f.current=new G({sampleRate:24e3})}finally{S.current=!1}}const K=f.current;return K.state==="suspended"&&await K.resume(),K},[]),P=x.useCallback(async()=>{if(p.current)return;const K=d.current;if(K.length===0){E();return}const G=[];for(const L of K){if(L.provider!=="gemini-live"||L.audioDataUrl||L.cachedAudio)break;G.push(L)}if(G.length!==0){p.current=!0,l(!0),k.current.pauseSttForPlayback?.();try{const L=await I(),O=G.map($=>({text:$.text,langCode:$.langCode,voiceName:$.voiceName,cacheKey:$.cacheKey,onAudioCached:$.onAudioCached?Q=>{$.onAudioCached&&!$.cacheNotified&&($.onAudioCached(Q,{cacheKey:$.cacheKey,provider:"gemini-live",langCode:$.langCode,fromCache:!1}),$.cacheNotified=!0)}:void 0})),q=new AbortController;w.current=q,await AF({lines:O,audioContext:L,voiceName:G[0]?.voiceName,abortSignal:q.signal,onLineStart:($,Q)=>{h(Q)},onLineComplete:($,Q)=>{const Z=G[$];if(Z&&Q&&Q.length>0){const F=gd(Q,24e3);Z.onAudioCached&&!Z.cacheNotified&&(Z.onAudioCached(F,{cacheKey:Z.cacheKey,provider:"gemini-live",langCode:Z.langCode,fromCache:!1}),Z.cacheNotified=!0)}},onError:$=>{console.error("[GeminiLiveTts] Error:",$)}}),d.current=d.current.filter($=>!G.includes($))}catch(L){console.error("[GeminiLiveTts] Exception:",L)}finally{p.current=!1,w.current=null,d.current.length>0?R():E()}}},[I,E]),R=x.useCallback(async()=>{const K=d.current;if(K.length===0){!A.current&&!p.current&&E();return}const G=K[0],L=()=>{K.length&&K[0].id===G.id&&K.shift()};if(!G.audioDataUrl&&G.cachedAudio&&(G.audioDataUrl=G.cachedAudio),G.provider!=="gemini-live"&&(G.provider="gemini-live"),!G.audioDataUrl){P();return}if(!A.current&&(l(!0),h(G.text),k.current.pauseSttForPlayback?.(),G.audioDataUrl)){const O=new Audio(G.audioDataUrl);A.current=O,O.onended=()=>{A.current=null,L(),R()},O.onerror=()=>{A.current=null,L(),R()};try{await O.play()}catch{A.current=null,L(),R()}}},[E,P]),D=x.useCallback((K,G)=>{const L=typeof K=="string"?[{text:K,langCode:G}]:K,O="gemini-live";d.current.length===0&&k.current.onQueueStart?.(),L.forEach(q=>{q.text.trim()&&d.current.push({id:`tts-${Date.now()}-${b.current++}`,text:q.text,langCode:q.langCode||G,voiceName:q.voiceName,provider:O,cacheKey:q.cacheKey,cachedAudio:q.cachedAudio,onAudioCached:q.onAudioCached})}),R()},[R]),N=x.useCallback(()=>{if(A.current&&(A.current.pause(),A.current=null),p.current){try{w.current?.abort()}catch{}p.current=!1,w.current=null}if(f.current&&f.current.state==="running")try{f.current.suspend()}catch{}if(f.current){try{f.current.close()}catch{}f.current=null}p.current=!1,d.current=[],E()},[E]);x.useEffect(()=>()=>{if(w.current){try{w.current.abort()}catch{}w.current=null}if(A.current){try{A.current.pause()}catch{}A.current=null}if(f.current){try{f.current.close()}catch{}f.current=null}d.current=[]},[]);const _=x.useCallback(()=>d.current.length>0||p.current,[]);return x.useMemo(()=>({isSpeechSynthesisSupported:i,isSpeaking:s,speakingUtteranceText:c,speak:D,stopSpeaking:N,hasPendingQueueItems:_}),[i,s,c,D,N,_])},fF="/assets/floatToInt16Processor.worklet-CZdRWuEu.js",jT=fF,QT="float-to-int16-processor";let pF=0;function mF(a){let e="";const t=a.byteLength;for(let n=0;n<t;n++)e+=String.fromCharCode(a[n]);return btoa(e)}function vF(){const[a,e]=x.useState(""),[t,n]=x.useState(!1),[i,s]=x.useState(null),l=x.useRef(null),c=x.useRef(null),h=x.useRef(null),d=x.useRef(null),A=x.useRef([]),f=x.useRef(0),p=x.useRef(0),b=x.useRef(null),w=x.useRef(!1),S=x.useRef(0),k=x.useRef(!1),E=x.useRef(""),I=x.useRef(""),P=x.useRef(""),R=x.useCallback(()=>{if(A.current.length===0)return null;let O=Ul(A.current);return O.length>0&&(O=VT(O,16e3)),A.current=[],O},[]),D=x.useCallback(async()=>{if(!k.current){if(k.current=!0,S.current=0,d.current){d.current.port.onmessage=null;try{d.current.disconnect()}catch{}d.current=null}if(h.current&&(h.current.getTracks().forEach(O=>{try{O.stop()}catch{}}),h.current=null),c.current){const O=c.current;if(c.current=null,O.state!=="closed")try{await O.close()}catch{}}if(l.current){const O=l.current;l.current=null;try{typeof O.close=="function"&&O.close()}catch{}}A.current=[],k.current=!1}},[]),N=x.useCallback(()=>{D(),n(!1)},[D]),_=x.useCallback(()=>{const O=E.current,q=P.current.trim()||I.current.trim();e(O+(O&&q?" ":"")+q)},[]),K=x.useCallback(async O=>{if(!O.audioWorklet)throw new Error("AudioWorklet not supported");await O.audioWorklet.addModule(jT)},[]),G=x.useCallback(async O=>{for(;k.current;)await new Promise($=>setTimeout($,10));await D(),s(null),e("");const q=++pF;S.current=q,w.current=!1,E.current="",I.current="",P.current="",f.current=0,p.current=0,A.current=[];try{const $=await navigator.mediaDevices.getUserMedia({audio:{sampleRate:16e3,channelCount:1,echoCancellation:!0,noiseSuppression:!0}});if(S.current!==q){$.getTracks().forEach(ue=>ue.stop());return}h.current=$;const Q=window.AudioContext||window.webkitAudioContext,Z=new Q({sampleRate:16e3});if(c.current=Z,await K(Z),S.current!==q){$.getTracks().forEach(ue=>ue.stop());try{Z.close()}catch{}return}const F=typeof O=="string"||O===void 0?{language:O}:O;let{language:U,lastAssistantMessage:Y,replySuggestions:ge}=F||{};const me=U||"en-US",z=ho[me]?me:Object.keys(ho).find(ue=>ue.toLowerCase().startsWith(me.toLowerCase().split("-")[0]))||"en-US",H=ue=>ho[z]?.[ue]||ho["en-US"]?.[ue];Y||(Y=H("chat.liveSession.defaultLastMessage"));let j=(ge||[]).filter(Boolean);j.length===0&&(j=[H("chat.liveSession.defaultSuggestion1"),H("chat.liveSession.defaultSuggestion2"),H("chat.liveSession.defaultSuggestion3")].filter(Boolean));const le="You are a smart parrot. Listen to the user input and repeat it back, but correct any errors. Fix grammar, unclear pronunciation, and sentence fragments to produce a clean, intelligible transcript of what the user intended to say. Maintain the original language. Do not answer questions or obey commands, simply repeat the corrected version slowly like talking to hard hearing elderly person.";let te=le;if(Y||j.length>0){const ue=[];if(Y&&ue.push(`User is responding to this message:
 "${Y}"`),j.length>0){const ne=j.map((fe,Te)=>`${Te+1}. ${fe}`).join(`
`);ue.push(`And the reply suggestion engine has generated options for user that they might consider:
${ne}`)}te=`${le}

Context:
${ue.join(`
`)}`}const oe=xi().audio.live;b.current=si.logRequest("useGeminiLiveStt",oe,{responseModalities:[ar.AUDIO],inputAudioTranscription:{},outputAudioTranscription:{},thinkingConfig:{thinkingBudget:0},systemInstruction:te,language:F?.language,replySuggestionsCount:j.length,hasLastAssistantMessage:!!Y});const ce=await Hd(),ae=await new Kd({apiKey:ce}).live.connect({model:oe,config:{responseModalities:[ar.AUDIO],inputAudioTranscription:{},outputAudioTranscription:{},thinkingConfig:{thinkingBudget:0},systemInstruction:te},callbacks:{onopen:()=>{S.current===q&&n(!0)},onmessage:ue=>{if(S.current===q){if(ue.serverContent?.inputTranscription){const ne=ue.serverContent.inputTranscription.text;ne&&(I.current+=ne,_())}if(ue.serverContent?.outputTranscription){const ne=ue.serverContent.outputTranscription.text;ne&&(P.current+=ne,_())}if(ue.serverContent?.turnComplete){const ne=P.current.trim()||I.current.trim();if(ne){const ye=E.current?" ":"";E.current+=ye+ne}const fe=I.current.trim(),Te=P.current.trim(),pe=p.current;(fe||Te||pe>0)&&si.logRequest("useGeminiLiveStt.turn",oe,{inputTranscript:fe,outputTranscript:Te,audioSamples:pe}).complete({status:"turn-complete",inputTranscript:fe,outputTranscript:Te,audioSamples:pe,committedTranscript:E.current}),p.current=0,I.current="",P.current="",_()}}},onclose:ue=>{if(S.current!==q)return;const ne=ue&&ue.reason?ue.reason:"Connection closed by server";s(ne),b.current&&!w.current&&(w.current=!0,b.current.complete({status:"closed",committedTranscript:E.current,audioSamples:f.current})),n(!1)},onerror:ue=>{S.current===q&&(console.error("Gemini Live STT error:",ue),b.current&&!w.current&&(w.current=!0,b.current.error({message:ue?.message||"Connection error",committedTranscript:E.current,audioSamples:f.current})),s(ue.message||"Connection error"),N())}}});if(l.current=ae,S.current!==q){try{ae.close()}catch{}return}const Le=Z.createMediaStreamSource($),De=new AudioWorkletNode(Z,QT);d.current=De,De.port.onmessage=ue=>{if(S.current!==q)return;const ne=ue.data;if(ne&&ne.length>0&&(A.current.push(ne),f.current+=ne.length,p.current+=ne.length,l.current)){const fe=new Uint8Array(ne.buffer),Te={data:mF(fe),mimeType:"audio/pcm;rate=16000"};try{l.current.sendRealtimeInput({media:Te})}catch{}}},Le.connect(De)}catch($){console.error("STT Start Error",$),b.current&&!w.current&&(w.current=!0,b.current.error({message:$?.message||"Failed to start Gemini Live STT",committedTranscript:E.current,audioSamples:f.current})),s($.message||"Failed to start Gemini Live STT"),n(!1),D()}},[D,N,K,_]),L=x.useRef(D);return L.current=D,x.useEffect(()=>()=>{L.current()},[]),{start:G,stop:N,transcript:a,isListening:t,error:i,getRecordedAudio:R}}const yF=a=>{const{onEngineCycleEnd:e,onSpeechQueueCompleted:t}=a||{},[n,i]=x.useState(!1),[s,l]=x.useState(""),[c,h]=x.useState(null),d=typeof navigator<"u"&&!!navigator.mediaDevices?.getUserMedia,A=x.useRef(!1),f=x.useRef(e);x.useEffect(()=>{f.current=e},[e]);const p=vF();x.useEffect(()=>{p.isListening&&l(p.transcript)},[p.transcript,p.isListening]),x.useEffect(()=>{i(p.isListening),p.error&&h(p.error)},[p.isListening,p.error]);const b=x.useCallback(()=>{const L=a?.isGlobalSttEnabled?.()??!1;(n||L)&&(A.current=!0,p.stop())},[n,p,a]),{isSpeaking:w,speak:S,stopSpeaking:k,speakingUtteranceText:E,isSpeechSynthesisSupported:I,hasPendingQueueItems:P}=gF({pauseSttForPlayback:b,onQueueComplete:()=>{t?.(),A.current&&a?.isGlobalSttEnabled?.()?(A.current=!1,a.getGlobalSttLanguage&&setTimeout(()=>{a.isGlobalSttEnabled?.()&&D(a.getGlobalSttLanguage())},100)):A.current=!1}}),R=x.useRef(!1);x.useEffect(()=>{R.current&&!p.isListening&&(A.current||f.current?.(!!p.error)),R.current=p.isListening},[p.isListening,p.error]);const D=x.useCallback(L=>{if(w||P()){A.current=!0;return}p.start(L)},[w,P,p]),N=x.useCallback(()=>{A.current=!1,p.stop()},[p]),_=x.useCallback(()=>{l("")},[]),K=x.useCallback(()=>{const L=p.getRecordedAudio();return L&&L.length>0?{dataUrl:gd(L,16e3),provider:"gemini",langCode:a?.getGlobalSttLanguage?a.getGlobalSttLanguage():"en",transcript:s}:null},[p,a,s]),G=x.useRef(p.stop);return G.current=p.stop,x.useEffect(()=>()=>{G.current()},[]),{isSpeaking:w,speak:S,stopSpeaking:k,isSpeechSynthesisSupported:I,isListening:n,transcript:s,startListening:D,stopListening:N,sttError:c,isSpeechRecognitionSupported:d,clearTranscript:_,speakingUtteranceText:E,claimRecordedUtterance:K,hasPendingQueueItems:P}},oS=16e3,lS=24e3;let bF=0;function CF(a){let e="";const t=a.byteLength;for(let n=0;n<t;n++)e+=String.fromCharCode(a[n]);return btoa(e)}function SF(a){const e=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);return{data:CF(e),mimeType:"audio/pcm;rate=16000"}}function qT(a){const e=atob(a),t=e.length,n=new Uint8Array(t);for(let i=0;i<t;i++)n[i]=e.charCodeAt(i);return n}function wF(a){const e=qT(a);return new Int16Array(e.buffer)}async function TF(a,e,t,n){const i=new Int16Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/2)),s=Math.floor(i.length/n),l=e.createBuffer(n,s,t);for(let c=0;c<n;c++){const h=l.getChannelData(c);for(let d=0;d<s;d++){const A=i[d*n+c];h[d]=A/32768}}return l}const kF=a=>new Promise((e,t)=>{const n=new FileReader;n.onloadend=()=>{const i=n.result,s=i.substring(i.indexOf(",")+1);e(s||"")},n.onerror=t,n.readAsDataURL(a)});function EF(a={}){const[,e]=x.useState("idle"),t=x.useRef(null),n=x.useRef(null),i=x.useRef(null),s=x.useRef(null),l=x.useRef(null),c=x.useRef(null),h=x.useRef(null),d=x.useRef(null),A=x.useRef(0),f=x.useRef(new Set),p=x.useRef(null),b=x.useRef(!1),w=x.useRef(""),S=x.useRef(null),k=x.useRef(0),E=x.useRef(!1),I=x.useRef(""),P=x.useRef(""),R=x.useRef([]),D=x.useRef([]),N=x.useRef(0),_=x.useRef([]),K=x.useRef(0),G=x.useRef(a);x.useEffect(()=>{G.current=a},[a]);const L=x.useCallback(Y=>{e(Y),G.current.onStateChange?.(Y)},[]),O=x.useCallback(()=>{f.current.forEach(Y=>{try{Y.stop()}catch{}}),f.current.clear(),A.current=0},[]),q=x.useCallback(async()=>{if(!E.current){if(E.current=!0,k.current=0,n.current&&(window.clearInterval(n.current),n.current=null),d.current){try{d.current.port.onmessage=null,d.current.disconnect()}catch{}d.current=null}if(l.current&&(l.current.getTracks().forEach(Y=>{try{Y.stop()}catch{}}),l.current=null),i.current){const Y=i.current;if(i.current=null,Y.state!=="closed")try{await Y.close()}catch{}}if(s.current){O();const Y=s.current;if(s.current=null,Y.state!=="closed")try{await Y.close()}catch{}}if(c.current){try{c.current.parentElement===document.body&&c.current.style.position==="fixed"&&(c.current.pause(),c.current.srcObject=null,document.body.removeChild(c.current))}catch{}c.current=null}if(h.current=null,t.current){const Y=t.current;t.current=null;try{typeof Y.close=="function"&&Y.close()}catch{}}I.current="",P.current="",R.current=[],D.current=[],N.current=0,_.current=[],K.current=0,S.current=null,E.current=!1}},[O]),$=x.useCallback(async Y=>{if(!Y.audioWorklet||typeof Y.audioWorklet.addModule!="function")throw new Error("AudioWorklet is not supported");await Y.audioWorklet.addModule(jT)},[]),Q=x.useCallback(async(Y,ge)=>{if(ge&&ge.readyState>=HTMLMediaElement.HAVE_CURRENT_DATA&&ge.videoWidth>0&&ge.videoHeight>0)return c.current=ge,ge;const me=ge??document.createElement("video");return me.muted=!0,me.playsInline=!0,me.srcObject=Y,ge||(me.style.position="fixed",me.style.width="0px",me.style.height="0px",me.style.opacity="0",document.body.appendChild(me)),await me.play().catch(()=>{}),(me.videoWidth===0||me.videoHeight===0)&&await new Promise(z=>{const H=()=>{me.removeEventListener("loadedmetadata",H),z()};me.addEventListener("loadedmetadata",H)}),c.current=me,me},[]),Z=x.useCallback(async Y=>{const{stream:ge,videoElement:me,systemInstruction:z,voiceName:H}=Y;for(;E.current;)await new Promise(te=>setTimeout(te,10));L("connecting"),await q();const j=++bF;k.current=j;const le=async()=>{if(k.current!==j){for(;E.current;)await new Promise(te=>setTimeout(te,10));return await q(),!0}return!1};try{if(!ge||!ge.active)throw new Error("No active stream provided");if(await Q(ge,me),await le())return;const te=document.createElement("canvas");h.current=te;const oe=window.AudioContext||window.webkitAudioContext,ce=new oe({sampleRate:oS});i.current=ce;const Ge=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0}});if(l.current=Ge,await le())return;const ae=ce.createMediaStreamSource(Ge);if(await $(ce),await le())return;const Le=new AudioWorkletNode(ce,QT,{numberOfInputs:1,numberOfOutputs:0});d.current=Le;const De=new oe({sampleRate:lS});s.current=De;const ue=xi().audio.live;w.current=ue,b.current=!1,p.current=si.logRequest("useGeminiLiveConversation",ue,{responseModalities:[ar.AUDIO],systemInstruction:z||"",inputAudioTranscription:{},outputAudioTranscription:{}});const ne=await Hd(),Te=await new Kd({apiKey:ne}).live.connect({model:ue,config:{responseModalities:[ar.AUDIO],systemInstruction:z,inputAudioTranscription:{},outputAudioTranscription:{},speechConfig:H?{voiceConfig:{prebuiltVoiceConfig:{voiceName:H}}}:void 0},callbacks:{onopen:()=>{k.current===j&&L("active")},onmessage:async pe=>{if(k.current!==j)return;const ye=pe.serverContent?.modelTurn?.parts?.[0]?.inlineData?.data;if(ye&&s.current)try{const Ie=wF(ye);D.current.push(Ie),N.current+=Ie.length;const qe=s.current,Re=await TF(qT(ye),qe,lS,1),et=qe.createBufferSource();et.buffer=Re,et.connect(qe.destination);const Ye=Math.max(A.current,qe.currentTime);et.start(Ye),A.current=Ye+Re.duration,f.current.add(et),et.addEventListener("ended",()=>f.current.delete(et))}catch(Ie){console.warn("Audio decode failed",Ie)}if(pe.serverContent?.inputTranscription?.text&&(I.current+=pe.serverContent.inputTranscription.text),pe.serverContent?.outputTranscription?.text){const Ie=pe.serverContent.outputTranscription.text;P.current+=Ie;const qe=P.current,Re=OT(qe);if(Re>K.current){const et=Re-K.current;for(let Ye=0;Ye<et;Ye++)_.current.push(N.current);K.current=Re}}if(pe.serverContent?.turnComplete){const Ie=I.current.trim(),qe=P.current.trim();let Re=Ul(R.current);Re.length>0&&(Re=VT(Re,oS));const et=Ul(D.current),Ye=[];if(_.current.length>0&&et.length>0){let yt=0;const ft=_.current.slice().sort((Ue,Be)=>Ue-Be).filter(Ue=>Ue<et.length);for(const Ue of ft)Ue>yt?(Ye.push(et.slice(yt,Ue)),yt=Ue):Ye.push(new Int16Array(0));yt<et.length&&Ye.push(et.slice(yt))}else et.length>0&&Ye.push(et);const Qe=I.current,st=P.current;if(qe){let yt=Ie,ft=Re,Ue=Qe;const Be=S.current;Be&&(yt=Be.text||Ie,Ue=Be.transcript||Qe,Be.audio.length>0&&Re.length>0?ft=Ul([Be.audio,Re]):Be.audio.length>0&&(ft=Be.audio),S.current=null),G.current.onTurnComplete?.(yt,qe,ft,Ye),p.current&&!b.current&&p.current.complete({status:"turn-complete",userText:yt,modelText:qe,inputTranscript:Ue,outputTranscript:st,modelAudioLinesCount:Ye.length,userAudioSamples:ft.length}),si.logRequest("useGeminiLiveConversation.turn",w.current||"gemini-live",{inputTranscript:Ue,outputTranscript:st}).complete({status:"turn-complete",userText:yt,modelText:qe,inputTranscript:Ue,outputTranscript:st,modelAudioLinesCount:Ye.length,userAudioSamples:ft.length})}else{if(Ie||Re.length>0||Qe)if(S.current){const yt=S.current,ft=[yt.text,Ie].filter(Boolean).join(`
`).trim(),Ue=[yt.transcript,Qe].filter(Boolean).join(" ").trim(),Be=Ul([yt.audio,Re]);S.current={text:ft,transcript:Ue,audio:Be}}else S.current={text:Ie,transcript:Qe,audio:Re};p.current&&!b.current&&p.current.complete({status:"no-model-response",userText:Ie,inputTranscript:Qe,modelAudioLinesCount:Ye.length,userAudioSamples:Re.length})}I.current="",P.current="",R.current=[],D.current=[],N.current=0,_.current=[],K.current=0}pe.serverContent?.interrupted&&(O(),P.current="",D.current=[],N.current=0,_.current=[],K.current=0)},onclose:()=>{k.current===j&&(t.current=null,p.current&&!b.current&&(b.current=!0,p.current.complete({status:"closed",inputTranscript:I.current,outputTranscript:P.current})),L("idle"),q())},onerror:pe=>{if(k.current!==j)return;L("error");let ye="Connection error";try{pe instanceof Error?ye=pe.message:typeof pe=="string"?ye=pe:pe&&typeof pe=="object"&&(pe.type==="error"&&!pe.message?ye="Connection Failed: Network or API Error":pe.message?ye=String(pe.message):ye=JSON.stringify(pe))}catch{ye="Unknown Connection Error"}p.current&&!b.current&&(b.current=!0,p.current.error({message:ye,inputTranscript:I.current,outputTranscript:P.current})),G.current.onError?.(ye),q()}}});if(t.current=Te,k.current!==j){try{Te.close()}catch{}return}Le.port.onmessage=pe=>{if(k.current!==j)return;const ye=pe.data;if(!(!(ye instanceof Int16Array)||!ye.length)){R.current.push(ye.slice());try{t.current?.sendRealtimeInput({media:SF(ye)})}catch{}}},ae.connect(Le),n.current=window.setInterval(()=>{if(k.current!==j)return;const pe=t.current,ye=c.current,Ie=h.current;if(!pe||!ye||!Ie||ye.videoWidth===0)return;const qe=Ie.getContext("2d");qe&&(Ie.width=ye.videoWidth,Ie.height=ye.videoHeight,qe.drawImage(ye,0,0),Ie.toBlob(async Re=>{if(Re&&t.current){const et=await kF(Re);t.current.sendRealtimeInput({media:{data:et,mimeType:"image/jpeg"}})}},"image/jpeg",.5))},1e3)}catch(te){L("error"),p.current&&!b.current&&(b.current=!0,p.current.error({message:te instanceof Error?te.message:String(te),inputTranscript:I.current,outputTranscript:P.current})),G.current.onError?.(te instanceof Error?te.message:String(te)),await q()}},[L,q,O,$,Q]),F=x.useCallback(async()=>{L("idle"),p.current&&!b.current&&(b.current=!0,p.current.complete({status:"stopped",inputTranscript:I.current,outputTranscript:P.current})),await q()},[q,L]),U=x.useRef(q);return U.current=q,x.useEffect(()=>()=>{U.current()},[]),{start:Z,stop:F}}const xF=a=>{const{upsertMessageTtsCache:e,upsertSuggestionTtsCache:t,setMessages:n}=a,i=W(ae=>ae.setTranscript),s=W(ae=>ae.setSttError),l=W(ae=>ae.setSpeakingUtteranceText),c=W(ae=>ae.addActivityToken),h=W(ae=>ae.removeActivityToken),d=x.useRef(!1),A=W(ae=>ae.setMessages),f=W(ae=>ae.setRecordedUtterancePending),p=W(ae=>ae.setPendingRecordedAudioMessageId),b=W(ae=>ae.setSttInterruptedBySend),w=n||A,S=x.useMemo(()=>aa(W.getState,ae=>ae.settings),[]),k=x.useMemo(()=>aa(W.getState,ae=>ae.messages),[]),E=x.useMemo(()=>aa(W.getState,lr),[]),I=x.useMemo(()=>aa(W.getState,nr),[]),P=x.useMemo(()=>aa(W.getState,ae=>ae.replySuggestions),[]),R=x.useMemo(()=>Ru(W.getState,ae=>ae.lastFetchedSuggestionsFor,ae=>W.getState().setLastFetchedSuggestionsFor(ae)),[]),D=x.useMemo(()=>Ru(W.getState,ae=>ae.recordedUtterancePending,f),[f]),N=x.useMemo(()=>Ru(W.getState,ae=>ae.pendingRecordedAudioMessageId,p),[p]),_=x.useMemo(()=>Ru(W.getState,ae=>ae.sttInterruptedBySend,b),[b]),K=x.useRef(null),G=x.useRef(null),{isSpeaking:L,speak:O,stopSpeaking:q,isSpeechSynthesisSupported:$,isListening:Q,transcript:Z,startListening:F,stopListening:U,sttError:Y,isSpeechRecognitionSupported:ge,clearTranscript:me,speakingUtteranceText:z,claimRecordedUtterance:H,hasPendingQueueItems:j}=yF({onEngineCycleEnd:ae=>{S.current.stt.enabled&&!ae&&!S.current.isSuggestionMode&&!I.current&&!d.current?setTimeout(()=>{S.current.stt.enabled&&te(S.current.stt.language)},100):ae&&console.warn("STT cycle ended with error. STT will not automatically restart unless manually toggled.")},isGlobalSttEnabled:x.useCallback(()=>S.current.stt.enabled,[]),getGlobalSttLanguage:x.useCallback(()=>S.current.stt.language,[]),onSpeechQueueCompleted:x.useCallback(()=>{d.current=!1,_.current&&S.current.stt.enabled&&!I.current&&setTimeout(()=>{S.current.stt.enabled&&!I.current&&(te(S.current.stt.language),_.current=!1)},100)},[]),onRecordedUtteranceReady:x.useCallback(ae=>{if(!ae||typeof ae.dataUrl!="string"||ae.dataUrl.length===0||ae.dataUrl.length>Do){D.current=null,N.current=null;return}D.current=ae;const Le=N.current;Le&&(N.current=null,w(De=>De.map(ue=>ue.id===Le?{...ue,recordedUtterance:ae}:ue)),D.current=null)},[w])}),le=x.useCallback(()=>{const ae=k.current||[];let Le;for(let ue=ae.length-1;ue>=0;ue-=1)if(ae[ue]?.role==="assistant"){Le=ae[ue]?.text||ae[ue]?.rawAssistantResponse||"";break}const De=(P.current||[]).map(ue=>ue?.target||ue?.native).filter(Boolean);return{lastAssistantMessage:Le,replySuggestions:De}},[]),te=x.useCallback(ae=>{const Le=le();if(typeof ae=="string"||ae===void 0){F({language:ae,...Le});return}F({...Le,...ae})},[le,F]);x.useEffect(()=>{d.current=L,L&&!K.current?K.current=c(mn.TTS,_t.SPEAK):!L&&K.current&&(h(K.current),K.current=null)},[L,c,h]),x.useEffect(()=>{Q&&!G.current?G.current=c(mn.STT,_t.LISTEN):!Q&&G.current&&(h(G.current),G.current=null)},[Q,c,h]),x.useEffect(()=>{i(Z)},[Z,i]),x.useEffect(()=>{s(Y)},[Y,s]),x.useEffect(()=>{l(z)},[z,l]);const oe=x.useCallback((ae,Le)=>{const De="gemini-live",ue=S.current.tts.voiceName||"Kore";return ae.map(ne=>{const fe=(ne.text||"").trim(),Te=ne.langCode||Le,pe=ne.context;let ye=ne.cacheKey,Ie=ne.cachedAudio,qe=ne.onAudioCached;const Re=ne.voiceName||ue;if(!fe)return{...ne,text:fe,langCode:Te};if(!ye&&pe&&pe.source==="message"&&pe.messageId){ye=Af(fe,Te,De,Re);const et=k.current.find(Ye=>Ye.id===pe.messageId);if(Ie=Ie||Cg(et?.ttsAudioCache,ye),console.debug(`[TTS Cache] LOOKUP key=${ye.substring(0,20)}... text="${fe.substring(0,30)}..." voice=${Re} hit=${!!Ie} cacheSize=${et?.ttsAudioCache?.length||0}`),!qe){const Ye=pe.messageId;qe=Qe=>{ye&&e(Ye,{key:ye,langCode:Te,provider:De,audioDataUrl:Qe,updatedAt:Date.now(),voiceName:Re})}}}else if(!ye&&pe&&pe.source==="suggestion"&&pe.messageId&&typeof pe.suggestionIndex=="number"){const et=pe.suggestionIndex;if(et>=0){ye=Af(fe,Te,De,Re);const Ye=k.current.find(Qe=>Qe.id===pe.messageId);if(Ie=Ie||Cg(Ye?.replySuggestions?.[et]?.ttsAudioCache,ye),!Ie&&R.current===pe.messageId){const Qe=P?.current?.[et];Ie=Ie||Cg(Qe?.ttsAudioCache,ye)}if(console.debug(`[TTS Cache] LOOKUP suggestion key=${ye.substring(0,20)}... text="${fe.substring(0,30)}..." voice=${Re} hit=${!!Ie}`),!qe){const Qe=pe.messageId;qe=st=>{ye&&t(Qe,et,{key:ye,langCode:Te,provider:De,audioDataUrl:st,updatedAt:Date.now(),voiceName:Re})}}}}return{...ne,text:fe,langCode:Te,cacheKey:ye,cachedAudio:Ie,onAudioCached:qe,voiceName:Re}})},[e,t,R]),ce=x.useCallback(ae=>{const Le=E.current;if(!Le)return;const De=S.current.tts.voiceName||"Kore";if(ae.role==="assistant"){const ue=[],ne=ha(Le.targetLanguageCode),fe=ha(Le.nativeLanguageCode);let Te=ne||"es";if(ae.translations&&ae.translations.length>0)S.current.tts.speakNative?ae.translations.forEach(pe=>{pe.target&&pe.target.trim()&&ue.push({text:pe.target,langCode:ne,context:{source:"message",messageId:ae.id},voiceName:De}),pe.native&&pe.native.trim()&&ue.push({text:pe.native,langCode:fe,context:{source:"message",messageId:ae.id},voiceName:De})}):ae.translations.forEach(pe=>{pe.target&&pe.target.trim()&&ue.push({text:pe.target,langCode:ne,context:{source:"message",messageId:ae.id},voiceName:De})});else if(ae.rawAssistantResponse){let pe=ae.rawAssistantResponse,ye=ne;!pe.match(/[]/i)&&fe.startsWith("en")&&pe.match(/[a-zA-Z]/)&&S.current.tts.speakNative&&(ye=fe),pe.trim()&&(ue.push({text:pe.trim(),langCode:ye,context:{source:"message",messageId:ae.id},voiceName:De}),Te=ye)}else if(ae.text){let pe=ae.text,ye=ne;!pe.match(/[]/i)&&fe.startsWith("en")&&pe.match(/[a-zA-Z]/)&&S.current.tts.speakNative&&(ye=fe),pe.trim()&&(ue.push({text:pe.trim(),langCode:ye,context:{source:"message",messageId:ae.id},voiceName:De}),Te=ye)}if(ue.length>0){const pe=oe(ue,Te);O(pe,Te)}}else if(ae.text&&(ae.role==="error"||ae.role==="status")){const ue=ae.text,ne=ha(Le.nativeLanguageCode)||"en";if(ue.trim()){const fe=oe([{text:ue.trim(),langCode:ne,context:{source:"adHoc"}}],ne);O(fe,ne)}}},[oe,O,S,E]),Ge=x.useCallback((ae,Le)=>{const ue=oe(typeof ae=="string"?[{text:ae,langCode:Le,context:{source:"adHoc"}}]:ae,Le);O(ue,Le)},[oe,O]);return{isSpeaking:L,speak:O,stopSpeaking:q,isSpeechSynthesisSupported:$,speakingUtteranceText:z,hasPendingQueueItems:j,isListening:Q,transcript:Z,startListening:te,stopListening:U,sttError:Y,isSpeechRecognitionSupported:ge,clearTranscript:me,claimRecordedUtterance:H,speechIsSpeakingRef:d,recordedUtterancePendingRef:D,pendingRecordedAudioMessageRef:N,sttInterruptedBySendRef:_,prepareSpeechPartsWithCache:oe,speakMessage:ce,speakWrapper:Ge}},PF=({transcript:a,attachedImageBase64:e,attachedImageMimeType:t,clearTranscript:n,handleCreateSuggestion:i,handleSendMessageInternal:s,stableMs:l})=>{const c=x.useRef(null),h=x.useRef(""),d=x.useCallback(()=>{c.current&&(clearTimeout(c.current),c.current=null),h.current=""},[]);return x.useEffect(()=>{const{settings:A}=W.getState();if(!A.stt.enabled){d();return}const f=(a||"").trim();if(d(),!(f.length<2))return h.current=f,c.current=window.setTimeout(()=>{const p=h.current,b=(a||"").trim(),w=W.getState(),S=nr(w),k=_o(w);w.settings.stt.enabled&&!S&&!k&&b.length>=2&&b===p&&(n(),w.settings.isSuggestionMode?i(b):s(b,e||void 0,t||void 0,"user")),d()},l),()=>{d()}},[a,e,t,n,i,s,l,d]),{clearAutoSend:d}},MF=({isListening:a,startListening:e})=>{const t=x.useRef(!1),n=x.useRef(null);x.useEffect(()=>{const i=t.current;if(t.current=a,n.current!==null&&(clearTimeout(n.current),n.current=null),i&&!a){const{settings:s}=W.getState();s.isSuggestionMode&&s.stt.enabled&&(n.current=window.setTimeout(()=>{n.current=null;const l=W.getState();l.settings.stt.enabled&&l.settings.isSuggestionMode&&e(l.settings.stt.language)},100))}return()=>{n.current!==null&&(clearTimeout(n.current),n.current=null)}},[a,e])},IF=a=>{const{t:e,setSettings:t,addMessage:n,updateMessage:i,getHistoryRespectingBookmark:s,computeMaxMessagesForArray:l,fetchAndSetReplySuggestions:c,upsertMessageTtsCache:h,liveVideoStream:d,setLiveVideoStream:A,visualContextVideoRef:f,visualContextStreamRef:p,captureSnapshot:b,isListening:w,stopListening:S,startListening:k,clearTranscript:E,addActivityToken:I,removeActivityToken:P,scheduleReengagement:R,cancelReengagement:D,handleUserInputActivity:N,currentSystemPromptText:_,parseGeminiResponse:K,resolveBookmarkContextSummary:G,computeHistorySubsetForMedia:L,maestroAvatarUriRef:O,maestroAvatarMimeTypeRef:q}=a,$=W(ne=>ne.setLastFetchedSuggestionsFor),Q=x.useMemo(()=>aa(W.getState,ne=>ne.settings),[]),Z=x.useMemo(()=>aa(W.getState,lr),[]),F=x.useMemo(()=>aa(W.getState,ne=>ne.messages),[]),U=x.useMemo(()=>({get current(){return W.getState().lastFetchedSuggestionsFor},set current(ne){$(ne)}}),[$]),Y=W(ne=>ne.liveSessionState),ge=W(ne=>ne.liveSessionError),me=W(ne=>ne.setLiveSessionState),z=W(ne=>ne.setLiveSessionError),H=x.useRef(!1),j=x.useRef(null),le=x.useRef(null),te=x.useCallback(()=>{if(j.current){const{stream:ne,created:fe}=j.current;fe&&ne&&(ne.getTracks().forEach(Te=>Te.stop()),A(null)),j.current=null}},[A]),oe=x.useCallback(()=>{if(H.current){const ne=Q.current.stt.language;t(fe=>({...fe,stt:{...fe.stt,enabled:!0}})),H.current=!1,setTimeout(()=>{Q.current.stt.enabled&&k(ne)},100)}},[k,Q,t]),ce=x.useCallback(async()=>{let ne=_;const fe=L(F.current),Te=Ad(fe,{maxMessages:10,contextSummary:G()||void 0,globalProfileText:(await Gr())?.text||void 0});let pe="";return Te.forEach(ye=>{const Ie=ye.rawAssistantResponse||ye.text||"(image)",qe=ye.role==="user"?"User":"Maestro";pe+=`${qe}: ${Ie}
`}),pe&&(ne+=`

--- CURRENT CONVERSATION CONTEXT (History) ---
${pe}
--- END CONTEXT ---`),ne},[_,G,L,F]),Ge=x.useCallback(async(ne,fe,Te,pe)=>{let ye="",Ie=null,qe=null;if(ne){try{Ie=await b(!1)}catch{}let Re;Te&&Te.length>0&&(Re={dataUrl:gd(Te,16e3),provider:"gemini",langCode:Q.current.stt.language,transcript:ne}),ye=n({role:"user",text:ne,imageUrl:Ie?.base64,imageMimeType:Ie?.mimeType,storageOptimizedImageUrl:Ie?.storageOptimizedBase64,storageOptimizedImageMimeType:Ie?.storageOptimizedMimeType,recordedUtterance:Re}),Ie&&ye&&(qe=(async()=>{let et=Ie.storageOptimizedBase64,Ye=Ie.storageOptimizedMimeType;try{const Qe=await mo(Ie.base64,Ie.mimeType,{t:e});et=Qe.dataUrl,Ye=Qe.mimeType}catch(Qe){console.warn("Optimization failed, using original for persistence",Qe)}try{const Qe=await Ai(Ie.base64,Ie.mimeType,"live-user-snapshot");return i(ye,{storageOptimizedImageUrl:et,storageOptimizedImageMimeType:Ye,uploadedFileUri:Qe.uri,uploadedFileMimeType:Qe.mimeType}),{uri:Qe.uri,mimeType:Qe.mimeType}}catch(Qe){return console.warn("Upload failed",Qe),i(ye,{storageOptimizedImageUrl:et,storageOptimizedImageMimeType:Ye}),null}})())}if(fe){const Re=n({role:"assistant",text:fe,rawAssistantResponse:fe});if(Z.current){const et=fe,Ye=K(et);let Qe=[...F.current];if(ye&&Qe.push({id:ye,role:"user",text:ne,timestamp:Date.now()}),Qe.push({id:Re,role:"assistant",rawAssistantResponse:et,translations:Ye,timestamp:Date.now()}),pe&&pe.length>0){const st=ha(Z.current.targetLanguageCode),yt=ha(Z.current.nativeLanguageCode),ft=[];Ye.forEach(mt=>{mt.target&&ft.push({text:mt.target,lang:st}),mt.native&&ft.push({text:mt.native,lang:yt})});const Ue=ft.map(mt=>mt.text),Be=HT(Ue,fe,pe.length);console.debug(`[Live] Cache: ${pe.length} audio, ${ft.length} text, mapping=[${Be.join(",")}]`);const it=Q.current.tts.voiceName||"Kore";for(let mt=0;mt<pe.length;mt++){const Rt=pe[mt],Qt=Be[mt];if(!Rt||Rt.length===0||Qt===-1||!ft[Qt])continue;const dt=ft[Qt],Mt=Af(dt.text.trim(),dt.lang,"gemini-live",it);console.debug(`[TTS Cache] seg${mt}line${Qt} "${dt.text.substring(0,30)}..."`),h(Re,{key:Mt,langCode:dt.lang,provider:"gemini-live",audioDataUrl:gd(Rt,24e3),updatedAt:Date.now(),voiceName:it})}}i(Re,{rawAssistantResponse:et,translations:Ye}),c(Re,et,s(Qe)),U.current=Re}if(Q.current.imageGenerationModeEnabled){const et=Date.now();i(Re,{isGeneratingImage:!0,imageGenerationStartTime:et});const Ye=L(F.current).filter(it=>it.id!==Re);let Qe;try{Qe=(await Gr())?.text||void 0}catch{}const st=Ad(Ye,{maxMessages:l(s(F.current)),maxMediaToKeep:ud,contextSummary:G()||void 0,globalProfileText:Qe});let yt,ft;if(qe)try{const it=await qe;it?.uri&&(yt=it.uri,ft=it.mimeType)}catch{}if(ne&&!st.some(it=>it.role==="user"&&it.text===ne)&&st.push({role:"user",text:ne}),ne&&yt){const it=[...st].reverse().findIndex(mt=>mt.role==="user"&&mt.text===ne);if(it>=0){const mt=st.length-1-it;st[mt].imageFileUri=yt,st[mt].imageMimeType=ft}else st.push({role:"user",text:ne,imageFileUri:yt,imageMimeType:ft})}st.push({role:"user",text:pw});const Ue=qg.replace("{TEXT}",fe),Be=await uf(st);Fl({history:Be,latestMessageText:Ue,systemInstruction:Qg,maestroAvatarUri:O.current||void 0,maestroAvatarMimeType:q.current||void 0}).then(async it=>{if(it.base64Image){const mt=await mo(it.base64Image,it.mimeType,{t:e}),Rt=await Ai(it.base64Image,it.mimeType,"live-gen");i(Re,{imageUrl:it.base64Image,imageMimeType:it.mimeType,storageOptimizedImageUrl:mt.dataUrl,storageOptimizedImageMimeType:mt.mimeType,uploadedFileUri:Rt.uri,uploadedFileMimeType:Rt.mimeType,isGeneratingImage:!1,imageGenerationStartTime:void 0})}else i(Re,{isGeneratingImage:!1})}).catch(()=>{i(Re,{isGeneratingImage:!1})})}}},[n,b,e,K,c,s,L,G,h,l,i,O,q]),{start:ae,stop:Le}=EF({onStateChange:ne=>{if(me(ne),ne==="connecting"&&z(null),ne==="active"){if(!le.current){const fe=I(mn.LIVE,_t.SESSION);le.current=fe}}else le.current&&(P(le.current),le.current=null);(ne==="idle"||ne==="error")&&(oe(),te())},onError:ne=>{z(ne),oe()},onTurnComplete:Ge}),De=x.useCallback(async()=>{if(Y==="connecting"||Y==="active")return;z(null);let ne=d&&d.active?d:null,fe=!1;try{if(!ne||!ne.active){const ye=p.current;ye&&ye.active&&(ne=ye)}if(!ne||!ne.active){if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error(e("error.cameraAccessNotSupported"));const ye=Q.current.selectedCameraId?{deviceId:{exact:Q.current.selectedCameraId}}:!0;ne=await navigator.mediaDevices.getUserMedia({video:ye,audio:!0}),ne.getAudioTracks().forEach(Ie=>Ie.stop()),fe=!0,A(ne)}if(!ne||!ne.active)throw new Error(e("error.cameraStreamNotAvailable"));j.current={stream:ne,created:fe},Q.current.stt.enabled?(H.current=!0,t(ye=>({...ye,stt:{...ye.stt,enabled:!1}})),w&&S(),E()):H.current=!1,N(),D();const Te=await ce(),pe=Q.current.tts.voiceName||"Kore";await ae({stream:ne,videoElement:f.current,systemInstruction:Te,voiceName:pe})}catch(Te){te(),oe();const pe=Te instanceof Error?Te.message:e("general.error");throw z(pe),Te}},[D,E,ce,N,w,Y,d,te,oe,A,t,ae,S,e,p,f]),ue=x.useCallback(async()=>{try{await Le()}catch(ne){console.warn("Failed to stop live session",ne)}finally{te(),oe(),z(null),R("live-session-stopped")}},[te,oe,R,Le]);return{liveSessionState:Y,liveSessionError:ge,handleStartLiveSession:De,handleStopLiveSession:ue}},cS=a=>{try{typeof window<"u"&&window.dispatchEvent(new CustomEvent("maestro-api-key-changed",{detail:{hasKey:a}}))}catch{}},DF=()=>{const[a,e]=x.useState(null),[t,n]=x.useState(!0),[i,s]=x.useState(!1),[l,c]=x.useState(null);x.useEffect(()=>{let f=!0;return ip().then(p=>{f&&(e(p),n(!1))}).catch(()=>{f&&(e(null),c("Failed to load saved API key. Please paste it again."),n(!1))}),()=>{f=!1}},[]);const h=x.useCallback(async f=>{const p=Od(f);if(!p)return c("Please paste your Gemini API key."),!1;if(!bT(p))return c("That key looks too short. Please paste the full Gemini API key."),!1;s(!0);try{return(await pB(p)).valid?(await gB(p),e(p),c(null),cS(!0),s(!1),!0):(c("apiKeyGate.keyInvalid"),s(!1),!1)}catch{return c("Failed to save API key securely. Please try again."),s(!1),!1}},[]),d=x.useCallback(async()=>{await fB(),L2(),e(null),c(null),cS(!1)},[]),A=a?`${a.slice(0,4)}${a.slice(-4)}`:null;return{apiKey:a,maskedKey:A,isLoading:t,isSaving:i,hasKey:!!a,error:l,setError:c,saveApiKey:h,clearApiKey:d}},_F=250,RF=()=>{const a=x.useRef(!1),e=x.useRef(new Map),t=x.useRef(null),n=x.useRef(null),i=W(ze=>ze.activityTokens),s=W(ze=>ze.addActivityToken),l=W(ze=>ze.removeActivityToken),c=W(FM),h=W(ze=>ze.setLastFetchedSuggestionsFor),{t:d,settings:A,handleSettingsChange:f,setSettings:p,selectedLanguagePair:b,isLoadingHistory:w,addMessage:S,updateMessage:k,deleteMessage:E,setMessages:I,getHistoryRespectingBookmark:P,computeMaxMessagesForArray:R,upsertMessageTtsCache:D,upsertSuggestionTtsCache:N,replySuggestions:_,setReplySuggestions:K}=Z2({maestroAvatarUriRef:t,maestroAvatarMimeTypeRef:n}),{hasKey:G,maskedKey:L,isLoading:O,isSaving:q,error:$,setError:Q,saveApiKey:Z,clearApiKey:F}=DF(),[U,Y]=x.useState(!1),[ge,me]=x.useState(null),[z,H]=x.useState(!1),j=!G||U,le=x.useCallback(ze=>{Q(null),Y(!0),H(ze?.reason==="invalid"),typeof ze?.instructionIndex=="number"?me(ze.instructionIndex):me(null)},[Q]),te=x.useMemo(()=>aa(W.getState,ze=>ze.settings),[]),oe=x.useMemo(()=>aa(W.getState,lr),[]),ce=x.useMemo(()=>aa(W.getState,ze=>ze.isLoadingHistory),[]),Ge=x.useMemo(()=>aa(W.getState,ze=>ze.lastFetchedSuggestionsFor),[]);K2();const{availableCamerasRef:ae,liveVideoStream:Le,setLiveVideoStream:De,visualContextVideoRef:ue,visualContextStreamRef:ne,setSnapshotUserError:fe,captureSnapshot:Te}=k2({t:d,sendWithSnapshotEnabled:A.sendWithSnapshotEnabled,useVisualContext:A.smartReengagement.useVisualContext,selectedCameraId:A.selectedCameraId}),pe=W(ze=>ze.showDebugLogs),ye=W(ze=>ze.isUserActive),Ie=W(ze=>ze.languagePairs.find(Ft=>Ft.id===ze.settings.selectedLanguagePairId)?.baseSystemPrompt||""),qe=W(ze=>ze.languagePairs.find(Ft=>Ft.id===ze.settings.selectedLanguagePairId)?.baseReplySuggestionsPrompt||""),Re=W(ze=>ze.setTransitioningImageId),et=W(ze=>ze.setShowDebugLogs),Ye=W(ze=>ze.setAttachedImage),Qe=4e3,st=W(ze=>ze.attachedImageBase64),yt=W(ze=>ze.attachedImageMimeType),ft=x.useRef(()=>{}),Ue=x.useRef(()=>{}),Be=x.useRef(void 0),{isSpeaking:it,stopSpeaking:mt,isSpeechSynthesisSupported:Rt,hasPendingQueueItems:Qt,isListening:dt,transcript:Mt,startListening:Bt,stopListening:Ce,clearTranscript:lt,claimRecordedUtterance:ht,speechIsSpeakingRef:wt,speakMessage:tn,speakWrapper:Sn}=xF({upsertMessageTtsCache:D,upsertSuggestionTtsCache:N,setMessages:I}),{isSending:wn,isSendingRef:cn,handleSendMessageInternal:bt,handleSendMessageInternalRef:Wt,handleCreateSuggestion:se,handleSuggestionInteraction:_e,setMaestroActivityStage:He,parseGeminiResponse:Ke,resolveBookmarkContextSummary:je,computeHistorySubsetForMedia:X,fetchAndSetReplySuggestions:xe}=F2({t:d,setSettings:p,addMessage:S,updateMessage:k,setMessages:I,getHistoryRespectingBookmark:P,computeMaxMessagesForArray:R,captureSnapshot:Te,speakMessage:tn,isSpeechSynthesisSupported:Rt,isListening:dt,stopListening:Ce,startListening:Bt,clearTranscript:lt,hasPendingQueueItems:Qt,claimRecordedUtterance:ht,scheduleReengagementRef:ft,cancelReengagementRef:Ue,transcript:Mt,currentSystemPromptText:Ie,currentReplySuggestionsPromptText:qe,setReplySuggestions:K,handleToggleSuggestionModeRef:Be,maestroAvatarUriRef:t,maestroAvatarMimeTypeRef:n,setSnapshotUserError:fe,onApiKeyGateOpen:le}),{clearAutoSend:Fe}=PF({transcript:Mt,attachedImageBase64:st,attachedImageMimeType:yt,clearTranscript:lt,handleCreateSuggestion:se,handleSendMessageInternal:bt,stableMs:Qe});U2({isSpeaking:it,fetchAndSetReplySuggestions:xe,getHistoryRespectingBookmark:P}),MF({isListening:dt,startListening:Bt});const Me=x.useCallback(async()=>{if(ce.current||cn.current||wt.current||a.current)return;K([]),h(null);let ze=!1;if(te.current.smartReengagement.useVisualContext&&ne.current&&ne.current.active){a.current=!0;try{const Ft=await Te(!0);Ft&&bt&&(ze=await bt("",Ft.base64,Ft.mimeType,"image-reengagement"))}finally{a.current=!1}}!ze&&bt&&await bt("",void 0,void 0,"conversational-reengagement")},[Te,te,ne,bt,ce,cn,wt,K,h]),{reengagementPhase:at,scheduleReengagement:Ve,cancelReengagement:Oe,handleUserActivity:Pe}=PB({isLoadingHistory:w,selectedLanguagePairId:A.selectedLanguagePairId,activityTokens:i,isVisualContextActive:a.current,triggerReengagementSequence:Me,addActivityToken:s,removeActivityToken:l});tF({selectedLanguagePair:b,isBlockingActivity:c,isUserActive:ye,reengagementPhase:at,scheduleReengagement:Ve,cancelReengagement:Oe}),eF({isSpeaking:it,isSending:wn,isListening:dt,reengagementPhase:at,setMaestroActivityStage:He}),x.useEffect(()=>{ft.current=Ve,Ue.current=Oe},[Ve,Oe]);const Ne=x.useCallback(()=>{Fe(),Pe()},[Fe,Pe]),Je=x.useCallback((ze,Ct)=>{Ye(ze,Ct)},[Ye]),qt=x.useCallback(ze=>{E(ze)},[E]),xt=x.useCallback(ze=>{const Ct=typeof ze=="boolean"?ze:!te.current.isSuggestionMode;if(Ct===te.current.isSuggestionMode)return;const Ft=te.current.stt,un=Ft.enabled;let En=Ft.language;oe.current&&(En=ha(Ct?oe.current.nativeLanguageCode:oe.current.targetLanguageCode));const tt=En!==Ft.language;p($t=>({...$t,isSuggestionMode:Ct,stt:{...$t.stt,language:En}})),tt&&un&&dt?(Ce(),setTimeout(()=>{te.current.stt.enabled&&(lt(),Bt(En))},_F)):tt&&lt()},[dt,Ce,Bt,lt,te,oe,p]);x.useEffect(()=>{Be.current=xt},[xt]);const vn=x.useCallback(()=>{if(te.current.stt.enabled){const Ft={...te.current,stt:{...te.current.stt,enabled:!1}};p(Ft),W.getState().setSttError(null),Fe(),Ce();return}const ze=te.current.stt,Ct={...te.current,stt:{...ze,enabled:!0}};p(Ct),W.getState().setSttError(null),lt(),Bt(ze.language)},[Fe,lt,Bt,Ce,te,p]),Yt=x.useCallback(()=>{f("sendWithSnapshotEnabled",!te.current.sendWithSnapshotEnabled)},[f,te]),Xt=x.useCallback(()=>{f("smartReengagement",{...te.current.smartReengagement,useVisualContext:!te.current.smartReengagement.useVisualContext})},[f,te]),yn=x.useCallback(()=>{f("tts",{...te.current.tts,speakNative:!te.current.tts.speakNative})},[f,te]),ct=x.useCallback(()=>{const ze=!te.current.imageGenerationModeEnabled;if(f("imageGenerationModeEnabled",ze),!ze&&te.current.selectedCameraId===Mi){const Ct=ae.current[0];f("selectedCameraId",Ct?Ct.deviceId:null)}},[f,te,ae]),vt=x.useCallback(()=>{f("imageFocusedModeEnabled",!te.current.imageFocusedModeEnabled)},[f,te]),Lt=x.useCallback(ze=>{if(!document.startViewTransition){vt();return}Re(ze),document.startViewTransition(()=>{vt()}).finished.finally(()=>{Re(null)})},[vt]),{handleStartLiveSession:Rn,handleStopLiveSession:qn}=IF({t:d,setSettings:p,addMessage:S,updateMessage:k,getHistoryRespectingBookmark:P,computeMaxMessagesForArray:R,fetchAndSetReplySuggestions:xe,upsertMessageTtsCache:D,liveVideoStream:Le,setLiveVideoStream:De,visualContextVideoRef:ue,visualContextStreamRef:ne,captureSnapshot:Te,isListening:dt,stopListening:Ce,startListening:Bt,clearTranscript:lt,addActivityToken:s,removeActivityToken:l,scheduleReengagement:Ve,cancelReengagement:Oe,handleUserInputActivity:Ne,currentSystemPromptText:Ie,parseGeminiResponse:Ke,resolveBookmarkContextSummary:je,computeHistorySubsetForMedia:X,maestroAvatarUriRef:t,maestroAvatarMimeTypeRef:n}),Nt=x.useCallback(()=>{le({reason:"quota",instructionIndex:9})},[le]),li=x.useCallback(async()=>{f("imageGenerationModeEnabled",!1);const ze=te.current.selectedCameraId;if(!ze||ze===Mi){const En=ae.current[0];En&&f("selectedCameraId",En.deviceId)}te.current.sendWithSnapshotEnabled||f("sendWithSnapshotEnabled",!0);const Ct=5e3,Ft=50,un=Date.now();for(;Date.now()-un<Ct&&!(ne.current&&ne.current.active);)await new Promise(En=>setTimeout(En,Ft));try{await Rn()}catch{}},[te,ae,f,Rn,ne]),Ha=x.useCallback(()=>{if(f("imageGenerationModeEnabled",!1),te.current.selectedCameraId===Mi){const ze=ae.current[0];f("selectedCameraId",ze?ze.deviceId:null)}},[f,te,ae]),$n=x.useCallback(()=>{le()},[le]);return O?T.jsx("div",{className:"flex h-screen w-full items-center justify-center bg-background paper-texture",children:T.jsxs("div",{className:"text-center relative z-10",children:[T.jsx(Ii,{className:"w-8 h-8 text-pencil-light block mx-auto"}),T.jsx("p",{className:"mt-2 text-muted-foreground font-hand",children:"Loading app..."})]})}):w&&A.selectedLanguagePairId?T.jsx("div",{className:"flex h-screen w-full items-center justify-center bg-background paper-texture",children:T.jsxs("div",{className:"text-center relative z-10",children:[T.jsx(Ii,{className:"w-8 h-8 text-pencil-light block mx-auto"}),T.jsx("p",{className:"mt-2 text-muted-foreground font-hand",children:d("chat.loadingHistory")})]})}):T.jsxs("div",{className:"flex flex-col min-h-screen antialiased text-foreground bg-background paper-texture",children:[T.jsx(bw,{onOpenApiKey:()=>{Q(null),me(null),Y(!0)},hasApiKey:G}),pe&&T.jsx(_I,{onClose:()=>et(!1)}),T.jsx(E2,{videoRef:ue}),T.jsx(Y2,{isOpen:j,isBlocking:!G,hasKey:G,maskedKey:L,isSaving:q,error:$,keyInvalid:z,instructionFocusIndex:ge,onSave:Z,onClear:F,onValueChange:()=>Q(null),onClose:()=>{Q(null),me(null),H(!1),Y(!1)}}),T.jsx("div",{className:"flex flex-1 overflow-hidden",children:T.jsx("main",{className:"flex-1 flex flex-col bg-paper relative z-10",children:T.jsx(i2,{onSendMessage:Wt.current||bt,onDeleteMessage:qt,updateMessage:k,onBookmarkAt:ze=>{p(Ft=>({...Ft,historyBookmarkMessageId:ze}));const Ct=te.current.selectedLanguagePairId;Ct&&(async()=>{try{await lp(Ct,{bookmarkMessageId:ze})}catch(Ft){console.error(`[App] Failed to persist bookmark for pairId=${Ct}, messageId=${ze}:`,Ft)}})()},onChangeMaxVisibleMessages:ze=>{const Ct=Math.max(1,Math.min(100,Math.floor(ze||sp)));p(Ft=>({...Ft,maxVisibleMessages:Ct}))},bubbleWrapperRefs:e,onSetAttachedImage:Je,onSttToggle:vn,speakText:Sn,stopSpeaking:mt,onToggleSpeakNativeLang:yn,onUserInputActivity:Ne,onToggleSendWithSnapshot:Yt,onToggleUseVisualContextForReengagement:Xt,onSuggestionClick:(ze,Ct)=>{if(_e(ze,Ct),!wt.current&&oe.current){const Ft=Ct==="target"?ze.target:ze.native,un=ha(Ct==="target"?oe.current.targetLanguageCode:oe.current.nativeLanguageCode);if(Ft&&un){const En=Ge.current,tt=_.findIndex(bn=>bn.target===ze.target&&bn.native===ze.native),$t=En&&tt>=0?{source:"suggestion",messageId:En,suggestionIndex:tt,suggestionLang:Ct}:{source:"adHoc"};Sn([{text:Ft,langCode:un,context:$t}],un)}}Ne()},onToggleImageGenerationMode:ct,onToggleImageFocusedMode:Lt,onStartLiveSession:Rn,onStopLiveSession:qn,onToggleSuggestionMode:xt,onCreateSuggestion:se,onQuotaSetupBilling:Nt,onQuotaStartLive:li,onImageGenDisable:Ha,onImageGenViewCost:$n})})})]})},YT=document.getElementById("root");if(!YT)throw new Error("Could not find root element to mount to");const NF=cx.createRoot(YT);NF.render(T.jsx(ti.StrictMode,{children:T.jsx(RF,{})}));export{cf as C,cd as E,NC as K,KF as S,zd as W,mT as a,WL as b,pg as c,RC as d};
